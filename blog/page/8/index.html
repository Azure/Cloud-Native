<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-list-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.0">
<title data-rh="true">Learn in #30DaysOfServerless | AI Apps and Agents - Microsoft Azure</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" property="og:image" content="https://azure.github.io/Cloud-Native/img/ogImage.png"><meta data-rh="true" property="og:url" content="https://azure.github.io/Cloud-Native/blog/page/8"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="og:title" content="AI Apps and Agents | Microsoft Azure"><meta data-rh="true" name="og:description" content="Develop adaptive, responsive, and personalized experiences by building and modernizing intelligent applications with Azure!"><meta data-rh="true" name="og:url" content="https://aka.ms/FallForIA"><meta data-rh="true" name="awa-env" content="Production"><meta data-rh="true" property="og:title" content="Learn in #30DaysOfServerless | AI Apps and Agents - Microsoft Azure"><meta data-rh="true" name="description" content="Explore Cloud-Native Technologies, Architectures, and Developer Tools - to build your Serverless Applications at scale!"><meta data-rh="true" property="og:description" content="Explore Cloud-Native Technologies, Architectures, and Developer Tools - to build your Serverless Applications at scale!"><meta data-rh="true" name="docusaurus_tag" content="blog_posts_list"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_posts_list"><meta data-rh="true" name="twitter:url" content="https://azure.github.io/Cloud-Native/blog/21-cloudevents-via-event-grid"><meta data-rh="true" name="twitter:title" content="#30DaysOfServerless: CloudEvents and Azure Event Grid"><meta data-rh="true" name="twitter:description" content="#30DaysOfServerless: How to Consume CloudEvents via Azure Event Grid"><meta data-rh="true" name="twitter:image" content="https://azure.github.io/Cloud-Native/img/banners/post-kickoff.png"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" name="twitter:creator" content="@nitya"><meta data-rh="true" name="twitter:site" content="@AzureAdvocates"><link data-rh="true" rel="icon" href="/Cloud-Native/img/favicon.ico"><link data-rh="true" rel="alternate" href="https://azure.github.io/Cloud-Native/blog/page/8" hreflang="en"><link data-rh="true" rel="alternate" href="https://azure.github.io/Cloud-Native/blog/page/8" hreflang="x-default"><link data-rh="true" rel="canonical" href="https://azure.github.io/Cloud-Native/blog/21-cloudevents-via-event-grid"><link rel="alternate" type="application/rss+xml" href="/Cloud-Native/blog/rss.xml" title="AI Apps and Agents - Microsoft Azure RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Cloud-Native/blog/atom.xml" title="AI Apps and Agents - Microsoft Azure Atom Feed">





<link rel="alternate" type="application/rss+xml" href="/Cloud-Native/cnny-2023/rss.xml" title="AI Apps and Agents - Microsoft Azure RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Cloud-Native/cnny-2023/atom.xml" title="AI Apps and Agents - Microsoft Azure Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/Cloud-Native/30DaysOfIA/rss.xml" title="AI Apps and Agents - Microsoft Azure RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Cloud-Native/30DaysOfIA/atom.xml" title="AI Apps and Agents - Microsoft Azure Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/Cloud-Native/60DaysOfIA/rss.xml" title="AI Apps and Agents - Microsoft Azure RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Cloud-Native/60DaysOfIA/atom.xml" title="AI Apps and Agents - Microsoft Azure Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/Cloud-Native/30-days-of-ia-2024/rss.xml" title="AI Apps and Agents - Microsoft Azure RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Cloud-Native/30-days-of-ia-2024/atom.xml" title="AI Apps and Agents - Microsoft Azure Atom Feed">
<script>!function(t,e,n,c,a,r,s){t[n]=t[n]||function(){(t[n].q=t[n].q||[]).push(arguments)},(r=e.createElement(c)).async=1,r.src="https://www.clarity.ms/tag/d61n997vq9",(s=e.getElementsByTagName(c)[0]).parentNode.insertBefore(r,s)}(window,document,"clarity","script")</script>

<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="https://js.monitor.azure.com/scripts/c/ms.analytics-web-3.min.js"></script><link rel="stylesheet" href="/Cloud-Native/assets/css/styles.149fd0a3.css">
<script src="/Cloud-Native/assets/js/runtime~main.536ae278.js" defer="defer"></script>
<script src="/Cloud-Native/assets/js/main.deaf60a5.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><header><div></div></header><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/Cloud-Native/"></a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="announcementBarBackground_Iz1u"><div class="container"><div class="row"><div class="col col--8 col--offset-2 announcementBarContainer_QNjo"><div class="col-demo"><p class="announcementBarContent_tvcd">Join us Apr 9-10 at  <a class="announcementLink_qKCm" target="_blank" href="https://jdconf.com/?ocid=biafy25h1_cn_webpage_azuremktg" data-bi-area="AnnouncementBar" data-bi-name="Announcement">Microsoft JDConf 2025</a> | Give us a ðŸŒŸ <a class="announcementLink_qKCm" target="_blank" href="https://github.com/azure/cloud-native" data-bi-area="AnnouncementBar" data-bi-name="Give us a star on GitHub">on GitHub</a></p></div></div><div class="col col--2 announcementBarIconContainer_GQot"><div class="col-demo"><a href="https://github.com/azure/cloud-native" target="_blank" class="icon_QeTG" aria-label="Visit us on GitHub"><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="#FFFFFF"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a><a href="https://azure.github.io/Cloud-Native/60DaysOfIA/rss.xml" target="_blank" class="icon_QeTG" aria-label="Subscribe to RSS"><svg width="24" height="24" viewBox="0 0 333333 333333" xmlns="http://www.w3.org/2000/svg" fill="#f49c4f"><path d="M166667 0c92048 0 166667 74619 166667 166667s-74619 166667-166667 166667S0 258715 0 166667 74619 0 166667 0zm-57698 203357c-11551 0-20938 9418-20938 20897 0 11537 9386 20857 20938 20857 11587 0 20967-9320 20967-20857 0-11479-9378-20897-20967-20897zm-20918-61899v30148c19632 0 38081 7677 51977 21585 13883 13868 21548 32406 21548 52114h30276c0-57254-46585-103838-103801-103838v-9zm38-53431v30154c70007 0 126979 57031 126979 127116l30235 3c0-86697-70539-157270-157212-157270l-2-3z"></path></svg></a><svg viewBox="0 0 24 24" width="24" height="24" class="icon_Kj6K"><path fill="white" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg></div></div></div></div></div><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">#30DaysOfServerless</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/blog/29-awesome-azd">Oct | `awesome-azd` Templates</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/blog/serverless-status-post">Serverless September - In a Nutshell</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/blog/29-azure-developer-cli">29. Code to Cloud with `azd`</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/blog/28-where-am-i">28. Serverless + Power Platforms</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/blog/zero2hero-func-07">ðŸš€ | Monitor + Troubleshoot Apps</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/blog/25-aca-java">25. Deploy Spring Boot App to ACA</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/blog/24-aca-dotnet">24. Deploy ASP.NET app to ACA</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/blog/21-cloudevents-via-event-grid">21. CloudEvents with Event Grid</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/blog/20-events-graph">20. Integrate with Microsoft Graph</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/blog/zero2hero-func-05">ðŸš€ | Error Handling w/ Apache Kafka</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/blog/zero2hero-aca-06">ðŸš€ | Observability with ACA</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/blog/18-cloudmail">18. Logic Apps + Computer Vision</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/blog/17-integrate-cosmosdb">17. Logic Apps + Cosmos DB</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/blog/15-microservices-azure">15. ACA + Serverless On Azure</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/blog/14-dapr-aca-quickstart">14. Build ACA with Dapr</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/blog/13-aca-managed-id">13. Secrets + Managed Identity</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/blog/12-build-with-dapr">12. Build With Dapr!</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/blog/zero2hero-func-03">ðŸš€ | Use Custom Handlers For Go</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/blog/zero2hero-aca-04">ðŸš€ | Journey to the Cloud With ACA</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/blog/11-scaling-container-apps">11. Scaling Container Apps</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/blog/microservices-10">10. Microservices Communication</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/blog/09-aca-fundamentals">09. Hello, Azure Container Apps</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/blog/08-functions-azure">08. Functions + Serverless On Azure</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/blog/07-functions-python">07. Functions for Python Devs</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/blog/06-functions-dotnet">06. Functions for .NET Devs</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/blog/zero2hero-func-02">ðŸš€ | Durable Entities Walkthrough</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/blog/zero2hero-aca-01">ðŸš€ | Go Cloud-Native with ACA</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/blog/05-functions-js">05. Functions for JS Devs</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/blog/04-functions-java">04. Functions For Java Devs</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/blog/03-functions-quickstart">03. Build Your First Function</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/blog/02-functions-intro">02. Learn Core Concepts</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/blog/01-kickoff">01. It&#x27;s 30DaysOfServerless!</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/blog/students">Welcome Students!</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/blog/welcome">Hello, ServerlessSeptember</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="https://schema.org/Blog"><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="Introducing CloudEvents, the CNCF&#x27;s standard event spec, and how to consume it through Azure Event Grid, Logic Apps and Azure Functions"><link itemprop="image" href="https://azure.github.io/Cloud-Native/assets/images/banner-44903533e9d0b0bdac7d242027cc0694.png"><meta itemprop="keywords" content="azure,serverless,event grid,logic apps,cloudevents"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/Cloud-Native/blog/21-cloudevents-via-event-grid">21. CloudEvents with Event Grid</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2022-09-21T00:00:00.000Z" itemprop="datePublished">September 21, 2022</time> Â· <!-- -->9 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/justinyoo" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/justinyoo.png" alt="Justin Yoo" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/justinyoo" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Justin Yoo</span></a></div><small class="avatar__subtitle" itemprop="description">Senior Cloud Advocate @Microsoft</small></div></div></div></div></header><div class="markdown" itemprop="articleBody">
<hr>
<p>Welcome to <code>Day 21</code> of #30DaysOfServerless!</p>
<p>We&#x27;ve so far walked through what <a href="https://docs.microsoft.com/azure/event-grid/overview?WT.mc_id=dotnet-75362-juyoo" target="_blank" rel="noopener noreferrer">Azure Event Grid</a> is and how it generally works. Today, let&#x27;s discuss how Azure Event Grid deals with <a href="https://cloudevents.io/" target="_blank" rel="noopener noreferrer">CloudEvents</a>.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-well-cover">What We&#x27;ll Cover<a href="#what-well-cover" class="hash-link" aria-label="Direct link to What We&#x27;ll Cover" title="Direct link to What We&#x27;ll Cover">â€‹</a></h2>
<ul>
<li><a href="#what-well-cover">What We&#x27;ll Cover</a></li>
<li><a href="#what-is-cloudevents">What is CloudEvents?</a></li>
<li><a href="#how-azure-event-grid-brokers-cloudevents">How Azure Event Grid brokers CloudEvents</a>
<ul>
<li><a href="#azure-event-grid-for-azure">Azure Event Grid for Azure</a></li>
<li><a href="#azure-event-grid-for-systems-outside-azure">Azure Event Grid for Systems outside Azure</a></li>
</ul>
</li>
<li><a href="#how-azure-logic-apps-consumes-cloudevents">How Azure Logic Apps consumes CloudEvents</a></li>
<li><a href="#exercise-try-this-yourself">Exercise: Try this yourself!</a></li>
<li><a href="#resources-for-self-study">Resources: For self-study!</a></li>
</ul>
<p><img loading="lazy" alt="Slide for &amp;quot;Brokering Cloud Events,&amp;quot; presented by Justin Yoo (@justinchronicle), discussing Event Grid for integrating cloud services." src="/Cloud-Native/assets/images/banner-44903533e9d0b0bdac7d242027cc0694.png" width="1600" height="672" class="img_ev3q"></p>
<hr>
<p>OK. Let&#x27;s get started!</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-cloudevents">What is CloudEvents?<a href="#what-is-cloudevents" class="hash-link" aria-label="Direct link to What is CloudEvents?" title="Direct link to What is CloudEvents?">â€‹</a></h2>
<p>Needless to say, events are everywhere. Events come not only from event-driven systems but also from many different systems and devices, including IoT ones like Raspberry PI.</p>
<p>But the problem is that every event publisher (system/device that creates events) describes their events differently, meaning there is no standard way of describing events. It has caused many issues between systems, mainly from the interoperability perspective.</p>
<ol>
<li>Consistency: No standard way of describing events resulted in developers having to write their own event handling logic for each event source.</li>
<li>Accessibility: There were no common libraries, tooling and infrastructure to deliver events across systems.</li>
<li>Productivity: The overall productivity decreases because of the lack of the standard format of events.</li>
</ol>
<p><img loading="lazy" alt="Cloud Events Logo" src="/Cloud-Native/assets/images/cloudevents-icon-color-eb63959a4ce7e47461aba884b786ae9b.png" width="200" height="200" class="img_ev3q"></p>
<p>Therefore, <a href="https://cncf.io/" target="_blank" rel="noopener noreferrer">CNCF (Cloud-Native Computing Foundation)</a> has brought up the concept, called <a href="https://cloudevents.io/" target="_blank" rel="noopener noreferrer">CloudEvents</a>. CloudEvents is a specification that commonly describes event data. Conforming any event data to this spec will simplify the event declaration and delivery across systems and platforms and more, resulting in a huge productivity increase.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-azure-event-grid-brokers-cloudevents">How Azure Event Grid brokers CloudEvents<a href="#how-azure-event-grid-brokers-cloudevents" class="hash-link" aria-label="Direct link to How Azure Event Grid brokers CloudEvents" title="Direct link to How Azure Event Grid brokers CloudEvents">â€‹</a></h2>
<p>Before CloudEvents, <a href="https://docs.microsoft.com/azure/event-grid/overview?WT.mc_id=dotnet-75362-juyoo" target="_blank" rel="noopener noreferrer">Azure Event Grid</a> described events in their own way. Therefore, if you want to use Azure Event Grid, you should follow the event format/schema that Azure Event Grid declares. However, not every system/service/application follows the Azure Event Grid schema. Therefore, Azure Event Grid now supports <a href="https://docs.microsoft.com/azure/event-grid/cloudevents-schema?WT.mc_id=dotnet-75362-juyoo" target="_blank" rel="noopener noreferrer">CloudEvents spec</a> as input and output formats.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="azure-event-grid-for-azure">Azure Event Grid for Azure<a href="#azure-event-grid-for-azure" class="hash-link" aria-label="Direct link to Azure Event Grid for Azure" title="Direct link to Azure Event Grid for Azure">â€‹</a></h3>
<p>Take a look at the simple diagram below, which describes how Azure Event Grid captures events raised from various Azure services. In this diagram, Azure Key Vault takes the role of the event source or event publisher, and <a href="https://docs.microsoft.com/azure/logic-apps/logic-apps-overview?WT.mc_id=dotnet-75362-juyoo" target="_blank" rel="noopener noreferrer">Azure Logic Apps</a> takes the role of the event handler (I&#x27;ll discuss Azure Logic Apps as the event handler later in this post). We use <a href="https://docs.microsoft.com/azure/event-grid/system-topics?WT.mc_id=dotnet-75362-juyoo" target="_blank" rel="noopener noreferrer">Azure Event Grid System Topic</a> for Azure.</p>
<p><img loading="lazy" alt="Azure Event Grid for Azure" src="/Cloud-Native/assets/images/21-cloudevents-via-event-grid-01-694e11ff4422f7f4f28ae03f08580170.png" width="3840" height="840" class="img_ev3q"></p>
<p>Therefore, let&#x27;s create an <a href="https://docs.microsoft.com/azure/event-grid/system-topics?WT.mc_id=dotnet-75362-juyoo" target="_blank" rel="noopener noreferrer">Azure Event Grid System Topic</a> that captures events raised from <a href="https://docs.microsoft.com/azure/key-vault/general/basic-concepts?WT.mc_id=dotnet-75362-juyoo" target="_blank" rel="noopener noreferrer">Azure Key Vault</a> when a new version of a secret is added.</p>
<p><img loading="lazy" alt="Azure Event Grid System Topic for Key Vault" src="/Cloud-Native/assets/images/21-cloudevents-via-event-grid-02-534038bbd75d4593fb17b225b4ed3d0a.png" width="3744" height="1430" class="img_ev3q"></p>
<p>As Azure Event Grid makes use of the <a href="https://www.enterpriseintegrationpatterns.com/PublishSubscribeChannel.html" target="_blank" rel="noopener noreferrer">pub/sub pattern</a>, you need to create the <a href="https://docs.microsoft.com/azure/event-grid/concepts?WT.mc_id=dotnet-75362-juyoo#event-subscriptions" target="_blank" rel="noopener noreferrer">Azure Event Grid Subscription</a> to consume the events. Here&#x27;s the subscription that uses the Event Grid data format:</p>
<p>![Azure Event Grid System Subscription for Key Vault in Event Grid Format][./img/21-cloudevents-via-event-grid-03.png]</p>
<p>Once you create the subscription, create a new version of the secret on Azure Key Vault. Then, Azure Key Vault raises an event, which is captured in the Event Grid format:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;id&quot;: &quot;6f44b9c0-d37e-40e7-89be-f70a6da291cc&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;topic&quot;: &quot;/subscriptions/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx/resourceGroups/rg-aegce-krc/providers/Microsoft.KeyVault/vaults/kv-xxxxxxxx&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;subject&quot;: &quot;hello&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;eventType&quot;: &quot;Microsoft.KeyVault.SecretNewVersionCreated&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;data&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;Id&quot;: &quot;https://kv-xxxxxxxx.vault.azure.net/secrets/hello/064dfc082fec463f8d4610ed6118811d&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;VaultName&quot;: &quot;kv-xxxxxxxx&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;ObjectType&quot;: &quot;Secret&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;ObjectName&quot;: &quot;hello&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;Version&quot;: &quot;064dfc082fec463f8d4610ed6118811d&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;NBF&quot;: null,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;EXP&quot;: null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;dataVersion&quot;: &quot;1&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;metadataVersion&quot;: &quot;1&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;eventTime&quot;: &quot;2022-09-21T07:08:09.1234567Z&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>So, how is it different from the CloudEvents format? Let&#x27;s take a look. According to the <a href="https://github.com/cloudevents/spec/blob/v1.0/json-format.md#23-examples" target="_blank" rel="noopener noreferrer">spec</a>, the JSON data in CloudEvents might look like this:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;id&quot; : &quot;C234-1234-1234&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;source&quot; : &quot;/mycontext&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;specversion&quot; : &quot;1.0&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;type&quot; : &quot;com.example.someevent&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;comexampleextension1&quot; : &quot;value&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;time&quot; : &quot;2018-04-05T17:31:00Z&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;datacontenttype&quot; : &quot;application/cloudevents+json&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;data&quot; : {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;appinfoA&quot; : &quot;abc&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;appinfoB&quot; : 123,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;appinfoC&quot; : true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This time, let&#x27;s create another subscription using the CloudEvents schema. Here&#x27;s how to create the subscription against the system topic:</p>
<p><img loading="lazy" alt="Azure Event Grid System Subscription for Key Vault in CloudEvents Format" src="/Cloud-Native/assets/images/21-cloudevents-via-event-grid-04-b80d8235ced38e84b57edcf3897aa6a3.png" width="3744" height="2017" class="img_ev3q"></p>
<p>Therefore, Azure Key Vault emits the event data in the CloudEvents format:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;id&quot;: &quot;6f44b9c0-d37e-40e7-89be-f70a6da291cc&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;source&quot;: &quot;/subscriptions/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx/resourceGroups/rg-aegce-krc/providers/Microsoft.KeyVault/vaults/kv-xxxxxxxx&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;specversion&quot;: &quot;1.0&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;type&quot;: &quot;Microsoft.KeyVault.SecretNewVersionCreated&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;subject&quot;: &quot;hello&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;time&quot;: &quot;2022-09-21T07:08:09.1234567Z&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;data&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;Id&quot;: &quot;https://kv-xxxxxxxx.vault.azure.net/secrets/hello/064dfc082fec463f8d4610ed6118811d&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;VaultName&quot;: &quot;kv-xxxxxxxx&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;ObjectType&quot;: &quot;Secret&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;ObjectName&quot;: &quot;hello&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;Version&quot;: &quot;064dfc082fec463f8d4610ed6118811d&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;NBF&quot;: null,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;EXP&quot;: null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Can you identify some differences between the Event Grid format and the CloudEvents format? Fortunately, both Event Grid schema and CloudEvents schema look similar to each other. But they might be significantly different if you use a different event source outside Azure.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="azure-event-grid-for-systems-outside-azure">Azure Event Grid for Systems outside Azure<a href="#azure-event-grid-for-systems-outside-azure" class="hash-link" aria-label="Direct link to Azure Event Grid for Systems outside Azure" title="Direct link to Azure Event Grid for Systems outside Azure">â€‹</a></h3>
<p>As mentioned above, the event data described outside Azure or your own applications within Azure might not be understandable by Azure Event Grid. In this case, we need to use <a href="https://docs.microsoft.com/azure/event-grid/custom-topics?WT.mc_id=dotnet-75362-juyoo" target="_blank" rel="noopener noreferrer">Azure Event Grid Custom Topic</a>. Here&#x27;s the diagram for it:</p>
<p><img loading="lazy" alt="Azure Event Grid for Applications outside Azure" src="/Cloud-Native/assets/images/21-cloudevents-via-event-grid-05-3302c0aa7803104c5fcd4efd83b7f112.png" width="3840" height="840" class="img_ev3q"></p>
<p>Let&#x27;s create the Azure Event Grid Custom Topic. When you create the topic, make sure that you use the CloudEvent schema during the provisioning process:</p>
<p><img loading="lazy" alt="Azure Event Grid Custom Topic" src="/Cloud-Native/assets/images/21-cloudevents-via-event-grid-06-240c34d97c26b9175b4d6f05c88bbddb.png" width="3744" height="2018" class="img_ev3q"></p>
<p>If your application needs to publish events to Azure Event Grid Custom Topic, your application should build the event data in the CloudEvents format. If you use a .NET application, add the <a href="https://www.nuget.org/packages/Azure.Messaging.EventGrid" target="_blank" rel="noopener noreferrer">NuGet package</a> first.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dotnet add package Azure.Messaging.EventGrid</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Then, create the publisher instance. You&#x27;ve already got the topic endpoint URL and the access key.</p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var topicEndpoint = new Uri(&quot;&lt;Azure Event Grid Custom Topic Endpoint URL&gt;&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var credential = new AzureKeyCredential(&quot;&lt;Azure Event Grid Custom Topic Access Key&gt;&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var publisher = new EventGridPublisherClient(topicEndpoint, credential);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now, build the event data like below. Make sure that you follow the CloudEvents schema that requires additional metadata like event source, event type and content type.</p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var source = &quot;/your/event/source&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var type = &quot;com.source.event.your/OnEventOccurs&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var data = new MyEventData() { Hello = &quot;World&quot; };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var @event = new CloudEvent(source, type, data);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>And finally, send the event to Azure Event Grid Custom Topic.</p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">await publisher.SendEventAsync(@event);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The captured event data looks like the following:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;id&quot;: &quot;cc2b2775-52b8-43b8-a7cc-c1c33c2b2e59&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;source&quot;: &quot;/your/event/source&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;type&quot;: &quot;com.source.event.my/OnEventOccurs&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;data&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;Hello&quot;: &quot;World&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;time&quot;: &quot;2022-09-21T07:08:09.1234567+00:00&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;specversion&quot;: &quot;1.0&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>However, due to limitations, someone might insist that their existing application doesn&#x27;t or can&#x27;t emit the event data in the CloudEvents format. In this case, what should we do? There&#x27;s no standard way of sending the event data in the CloudEvents format to Azure Event Grid Custom Topic. One of the approaches we may be able to apply is to put a converter between the existing application and Azure Event Grid Custom Topic like below:</p>
<p><img loading="lazy" alt="Azure Event Grid for Applications outside Azure with Converter" src="/Cloud-Native/assets/images/21-cloudevents-via-event-grid-07-f7192ae5bffc82738d60b79649a643bd.png" width="3840" height="840" class="img_ev3q"></p>
<p>Once the Function app (or any converter app) receives legacy event data, it internally converts the CloudEvents format and publishes it to Azure Event Grid.</p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var data = default(MyRequestData);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using (var reader = new StreamReader(req.Body))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var serialised = await reader.ReadToEndAsync();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    data = JsonConvert.DeserializeObject&lt;MyRequestData&gt;(serialised);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var converted = new MyEventData() { Hello = data.Lorem };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var @event = new CloudEvent(source, type, converted);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The converted event data is captured like this:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;id&quot;: &quot;df296da3-77cd-4da2-8122-91f631941610&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;source&quot;: &quot;/your/event/source&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;type&quot;: &quot;com.source.event.my/OnEventOccurs&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;data&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;Hello&quot;: &quot;ipsum&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;time&quot;: &quot;2022-09-21T07:08:09.1234567+00:00&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;specversion&quot;: &quot;1.0&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This approach is beneficial in many integration scenarios to make all the event data canonicalised.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-azure-logic-apps-consumes-cloudevents">How Azure Logic Apps consumes CloudEvents<a href="#how-azure-logic-apps-consumes-cloudevents" class="hash-link" aria-label="Direct link to How Azure Logic Apps consumes CloudEvents" title="Direct link to How Azure Logic Apps consumes CloudEvents">â€‹</a></h2>
<p>I put <a href="https://docs.microsoft.com/azure/logic-apps/logic-apps-overview?WT.mc_id=dotnet-75362-juyoo" target="_blank" rel="noopener noreferrer">Azure Logic Apps</a> as the event handler in the previous diagrams. According to the <a href="https://github.com/cloudevents/spec/blob/v1.0/http-webhook.md#4-abuse-protection" target="_blank" rel="noopener noreferrer">CloudEvents spec</a>, each event handler must implement request validation to avoid abuse. One good thing about using Azure Logic Apps is that it has already implemented this request validation feature. It implies that we just subscribe to the topic and consume the event data.</p>
<p>Create a new Logic Apps instance and add the HTTP Request trigger. Once it saves, you will get the endpoint URL.</p>
<p><img loading="lazy" alt="Azure Logic Apps with HTTP Request Trigger" src="/Cloud-Native/assets/images/21-cloudevents-via-event-grid-08-8eb13d8f2eb780c1ac54987644c832cd.png" width="3744" height="2018" class="img_ev3q"></p>
<p>Then, create the Azure Event Grid Subscription with:</p>
<ul>
<li>Endpoint type: Webhook</li>
<li>Endpoint URL: The Logic Apps URL from above.</li>
</ul>
<p><img loading="lazy" alt="Azure Logic Apps with HTTP Request Trigger" src="/Cloud-Native/assets/images/21-cloudevents-via-event-grid-09-f4132c208e6f6a4ce229c6d907cdd061.png" width="3744" height="2018" class="img_ev3q"></p>
<p>Once the subscription is ready, this Logic Apps works well as the event handler. Here&#x27;s how it receives the CloudEvents data from the subscription.</p>
<p><img loading="lazy" alt="Azure Logic Apps that Received CloudEvents data" src="/Cloud-Native/assets/images/21-cloudevents-via-event-grid-10-0d9e5e1baa7b398319a99d651d91cf61.png" width="3744" height="2018" class="img_ev3q"></p>
<p>Now you&#x27;ve got the CloudEvents data. It&#x27;s entirely up to you to handle that event data however you want!</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="exercise-try-this-yourself">Exercise: Try this yourself!<a href="#exercise-try-this-yourself" class="hash-link" aria-label="Direct link to Exercise: Try this yourself!" title="Direct link to Exercise: Try this yourself!">â€‹</a></h2>
<p>You can fork this <a href="https://github.com/justinyoo/azure-event-grid-cloudevents-sample" target="_blank" rel="noopener noreferrer">GitHub repository</a> to your account and play around with it to see how Azure Event Grid with CloudEvents works. Alternatively, the &quot;Deploy to Azure&quot; button below will provision all necessary Azure resources and deploy an Azure Functions app to mimic the event publisher.</p>
<p><a href="https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fjustinyoo%2Fazure-event-grid-cloudevents-sample%2Fmain%2FResources%2Fazuredeploy.json" target="_blank" rel="noopener noreferrer"><img loading="lazy" src="https://raw.githubusercontent.com/Azure/azure-quickstart-templates/master/1-CONTRIBUTION-GUIDE/images/deploytoazure.svg?sanitize=true" alt="Deploy To Azure" class="img_ev3q"></a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="resources-for-self-study">Resources: For self-study!<a href="#resources-for-self-study" class="hash-link" aria-label="Direct link to Resources: For self-study!" title="Direct link to Resources: For self-study!">â€‹</a></h2>
<p>Want to know more about CloudEvents in real-life examples? Here are several resources you can take a look at:</p>
<ul>
<li><a href="https://techcommunity.microsoft.com/t5/apps-on-azure-blog/azure-cli-for-eventgrid-subscription-to-custom-topic/ba-p/2038834?WT.mc_id=dotnet-75362-juyoo" target="_blank" rel="noopener noreferrer">Azure CLI for EventGrid Subscription to Custom Topic</a></li>
<li><a href="https://techcommunity.microsoft.com/t5/apps-on-azure-blog/cloudevents-for-azure-eventgrid-via-azure-functions/ba-p/2048140?WT.mc_id=dotnet-75362-juyoo" target="_blank" rel="noopener noreferrer">CloudEvents for Azure EventGrid via Azure Functions</a></li>
<li><a href="https://techcommunity.microsoft.com/t5/apps-on-azure-blog/websub-to-eventgrid-via-cloudevents-and-beyond/ba-p/2092709?WT.mc_id=dotnet-75362-juyoo" target="_blank" rel="noopener noreferrer">WebSub to EventGrid via CloudEvents, and Beyond</a></li>
<li><a href="https://techcommunity.microsoft.com/t5/apps-on-azure-blog/event-driven-keyvault-secrets-rotation-management/ba-p/2187249?WT.mc_id=dotnet-75362-juyoo" target="_blank" rel="noopener noreferrer">Event-Driven KeyVault Secrets Rotation Management</a></li>
</ul></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Cloud-Native/blog/tags/serverless-september">serverless-september</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Cloud-Native/blog/tags/cloudevents">cloudevents</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Cloud-Native/blog/tags/azure-event-grid">azure-event-grid</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Cloud-Native/blog/tags/azure-logic-apps">azure-logic-apps</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Cloud-Native/blog/tags/azure-functions">azure-functions</a></li></ul></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/Cloud-Native/blog/page/7"><div class="pagination-nav__label">Newer Entries</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/Cloud-Native/blog/page/9"><div class="pagination-nav__label">Older Entries</div></a></nav></main></div></div></div><footer><div></div></footer></div>
</body>
</html>