<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://azure.github.io/Cloud-Native/blog</id>
    <title>Building Cloud Native Apps Blog</title>
    <updated>2022-08-17T00:00:00.000Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://azure.github.io/Cloud-Native/blog"/>
    <subtitle>Building Cloud Native Apps Blog</subtitle>
    <icon>https://azure.github.io/Cloud-Native/img/favicon.ico</icon>
    <entry>
        <title type="html"><![CDATA[Hello, ServerlessSeptember]]></title>
        <id>welcome</id>
        <link href="https://azure.github.io/Cloud-Native/blog/welcome"/>
        <updated>2022-08-17T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[üçÇ It's September?]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-its-september">üçÇ It's September?<a class="hash-link" href="#-its-september" title="Direct link to heading">‚Äã</a></h2><p>Well, almost! September 1 is a few days away and I'm excited! Why? Because it's the perfect time to revisit <strong>#Serverless September</strong>, a month of</p><blockquote><p>".. content-driven learning where experts and practitioners share their insights and tutorials on how to use serverless technologies effectively in today's ecosystems"</p></blockquote><p>If the words look familiar, it's because I actually wrote them <a href="https://dev.to/azure/serverlessseptember-just-5-things-you-need-to-know-3p9e" target="_blank" rel="noopener noreferrer">2 years ago</a> when we launched the 2020 edition of this series. You might even recall <em>this</em> whimsical image I drew to capture the concept of September (fall) and Serverless (event-driven on-demand compute). Since then, a lot has happened in the serverless ecosystem!</p><p>You can still browse the <a href="https://dev.to/azure/serverlessseptember-2020-content-collection-443k" target="_blank" rel="noopener noreferrer">2020 Content Collection</a> to find great talks, articles and code samples to get started using Serverless on Azure. But read on to learn what's new!</p><p><img loading="lazy" src="/Cloud-Native/assets/images/2020-banner-df0f19ddc745fc4a518f5fa1ee9e7c7f.png" width="1000" height="420" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="-whats-new">üßê What's New?<a class="hash-link" href="#-whats-new" title="Direct link to heading">‚Äã</a></h2><p>Well - quite a few things actually. This year, <a href="https://twitter.com/devanshidiaries" target="_blank" rel="noopener noreferrer">Devanshi Joshi</a> and I expanded the original concept in a number of ways. Here's just a few of them that come to mind.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="new-website">New Website<a class="hash-link" href="#new-website" title="Direct link to heading">‚Äã</a></h3><p>This year, we created <em>this</em> website (shortcut: <a href="https://aka.ms/serverless-september" target="_blank" rel="noopener noreferrer">https://aka.ms/serverless-september</a>) to serve as a permanent home for content in 2022 and beyond - making it a  canonical source for the <code>#serverless</code> posts we publish to  tech communities like <a href="https://dev.to/azure" target="_blank" rel="noopener noreferrer">dev.to</a>, <a href="https://techcommunity.microsoft.com/t5/azure-developer-community-blog/bg-p/AzureDevCommunityBlog?WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Azure Developer Community</a> and <a href="https://techcommunity.microsoft.com/t5/apps-on-azure-blog/bg-p/AppsonAzureBlog/label-name/Serverless?WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Apps On Azure</a>. We hope this also makes it easier for you to search for, or discover, current and past articles that support your learning journey!</p><p>Start by bookmarking these two sites:</p><ul><li><a href="https://azure.microsoft.com/solutions/cloud-native-apps/?WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Build Cloud Native Apps on Azure</a></li><li><a href="https://azure.microsoft.com/solutions/serverless/?WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Go Serverless On Azure</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="more-options">More Options<a class="hash-link" href="#more-options" title="Direct link to heading">‚Äã</a></h3><p>Previous years focused on curating and sharing content authored by Microsoft and community contributors, showcasing serverless examples and best practices. This was perfect for those who already had experience with the core devtools and concepts.</p><p>This year, we wanted to combine <em>beginner-friendly</em> options (for those just starting their serverless journey) with more <em>advanced insights</em> (for those looking to skill up further). Here's a sneak peek at some of the initiatives we've got planned!</p><p><img loading="lazy" src="/Cloud-Native/assets/images/post-kickoff-4a04995b44f0cc4a784fb4ab5e29cf7c.png" width="1500" height="630" class="img_ev3q"></p><p>We'll also explore the full spectrum of serverless - from Functions-as-a-Service (for granularity) to Containerization (for deployment) and Microservices (for scalability). Here are a few services and technologies you'll get to learn more about:</p><ul><li><a href="https://docs.microsoft.com/azure/azure-functions/functions-overview?WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Azure Functions</a></li><li><a href="https://docs.microsoft.com/azure/container-apps/overview?WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Azure Container Apps</a></li><li><a href="https://dapr.io/?WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Distributed Application Runtime (dapr)</a></li><li><a href="https://docs.microsoft.com/azure/event-grid/?WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Azure Event Grid</a></li><li><a href="https://docs.microsoft.com/azure/static-web-apps/?WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Azure Logic Apps</a></li><li><a href="https://docs.microsoft.com/azure/logic-apps/?WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Azure Static Web Apps</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="Ô∏è-join-us">‚ö°Ô∏è Join us!<a class="hash-link" href="#Ô∏è-join-us" title="Direct link to heading">‚Äã</a></h2><p>This has been a labor of love from multiple teams at Microsoft! We can't wait to share all the resources that we hope will help <em>you</em> skill up on all things Serverless this September! Here are a couple of ways to participate:</p><ul><li><strong><a href="https://azure.github.io/Cloud-Native/blog/rss.xml" target="_blank" rel="noopener noreferrer">Subscribe to this blog</a></strong> - get notified early when we publish!</li><li><strong><a href="https://dev.to/azure" target="_blank" rel="noopener noreferrer">Follow Azure on dev.to</a></strong> - look for the #ServerlessSeptember series!</li><li><strong><a href="https://aka.ms/serverless-september" target="_blank" rel="noopener noreferrer">Bookmark this site</a></strong> and check back regularly for updates.</li></ul>]]></content>
        <author>
            <name>Nitya Narasimhan</name>
            <uri>https://github.com/nitya</uri>
        </author>
        <author>
            <name>Devanshi Joshi</name>
            <uri>https://github.com/devanshidiaries</uri>
        </author>
        <category label="hello" term="hello"/>
        <category label="serverless-september" term="serverless-september"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Welcome Students!]]></title>
        <id>students</id>
        <link href="https://azure.github.io/Cloud-Native/blog/students"/>
        <updated>2022-08-31T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[‚ú® Serverless September For Students]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-serverless-september-for-students">‚ú® Serverless September For Students<a class="hash-link" href="#-serverless-september-for-students" title="Direct link to heading">‚Äã</a></h2><p>My love for the tech industry grows as it evolves. Not just for the new technologies to play with, but seeing how paths into a tech career continue to expand. Allowing so many new voices, ideas and perspectives to our industry. With <a href="https://azure.microsoft.com/resources/cloud-computing-dictionary/what-is-serverless-computing/?WT.mc_id=academic-75239-sagibbon" target="_blank" rel="noopener noreferrer">serverless computing</a> removing barriers of entry for so many.</p><p>It's a reason I enjoy working with universities and students. I get to hear the excitement of learning, fresh ideas and perspectives from our student community. All you students are incredible! How you view serverless, and what it can do, so cool!  </p><p>This year for Serverless September we want to hear all the amazing ways our student community is learning and working with Azure Serverless, and have all new ways for you to participate. </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="getting-started">Getting Started<a class="hash-link" href="#getting-started" title="Direct link to heading">‚Äã</a></h3><p>If you don't already have an <a href="https://docs.microsoft.com/azure/education-hub/azure-dev-tools-teaching/azure-students-program?WT.mc_id=academic-75239-sagibbon" target="_blank" rel="noopener noreferrer">Azure for Students</a> account you can easily get your <strong>FREE</strong> account created at <a href="https://azure.microsoft.com/free/students/?WT.mc_id=academic-75239-sagibbon" target="_blank" rel="noopener noreferrer">Azure for Students Sign up</a>.</p><p>If you are new to serverless, here are a couple links to get you started:</p><ul><li><a href="https://azure.microsoft.com/solutions/cloud-native-apps/?WT.mc_id=academic-75239-sagibbon" target="_blank" rel="noopener noreferrer">Build Cloud Native Apps on Azure</a></li><li><a href="https://azure.microsoft.com/solutions/serverless/?WT.mc_id=academic-75239-sagibbon" target="_blank" rel="noopener noreferrer">Go Serverless On Azure</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="no-experience-no-problem">No Experience, No problem<a class="hash-link" href="#no-experience-no-problem" title="Direct link to heading">‚Äã</a></h3><p>For Serverless September we have planned beginner friendly content all month long. Covering such services as:</p><ul><li><a href="https://docs.microsoft.com/azure/azure-functions/functions-overview?WT.mc_id=academic-75239-sagibbon" target="_blank" rel="noopener noreferrer">Azure Functions</a></li><li><a href="https://docs.microsoft.com/azure/container-apps/overview?WT.mc_id=academic-75239-sagibbon" target="_blank" rel="noopener noreferrer">Azure Container Apps</a></li><li><a href="https://dapr.io/" target="_blank" rel="noopener noreferrer">Distributed Application Runtime (dapr)</a></li><li><a href="https://docs.microsoft.com/azure/event-grid/?WT.mc_id=academic-75239-sagibbon" target="_blank" rel="noopener noreferrer">Azure Event Grid</a></li><li><a href="https://docs.microsoft.com/azure/static-web-apps/?WT.mc_id=academic-75239-sagibbon" target="_blank" rel="noopener noreferrer">Azure Logic Apps</a></li><li><a href="https://docs.microsoft.com/azure/logic-apps/?WT.mc_id=academic-75239-sagibbon" target="_blank" rel="noopener noreferrer">Azure Static Web Apps</a></li></ul><p>You can follow <a href="https://azure.github.io/Cloud-Native/blog/" target="_blank" rel="noopener noreferrer">#30DaysOfServerles</a> here on the blog for daily posts covering concepts, scenarios, and how to create end-to-end solutions. </p><p>Join the <a href="https://azure.github.io/Cloud-Native/serverless-september/CloudSkills/" target="_blank" rel="noopener noreferrer">Cloud Skills Challenge</a> where we have selected a list of Learn Modules for you to go through at your own pace, including deploying a full stack application with <a href="https://docs.microsoft.com/azure/logic-apps/?WT.mc_id=academic-75239-sagibbon" target="_blank" rel="noopener noreferrer">Azure Static Web Apps</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="have-a-question">Have A Question<a class="hash-link" href="#have-a-question" title="Direct link to heading">‚Äã</a></h3><p>We want to hear it! All month long we will have <strong>Ask The Expert</strong> sessions. <a href="https://github.com/Azure/Cloud-Native/issues/new?assignees=&amp;labels=ask+the+expert&amp;template=---ask-the-expert-.md&amp;title=%5BAsk+The+Expert%5D++" target="_blank" rel="noopener noreferrer">Submit your questions</a> at any time and will be be sure to get one of our Azure Serverless experts to get you an answer. </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="share-what-youve-created">Share What You've Created<a class="hash-link" href="#share-what-youve-created" title="Direct link to heading">‚Äã</a></h3><p>If you have written a blog post, recorded a video, have an open source Azure Serverless project, we'd love to see it! Here is some links for you to share your creations</p><ul><li><a href="https://github.com/Azure/Cloud-Native/issues/new?assignees=&amp;labels=&amp;template=---community-buzz--share-technical-articles.md&amp;title=" target="_blank" rel="noopener noreferrer">Written an article or recorded a video involving Azure Serverless</a></li><li><a href="https://github.com/Azure/Cloud-Native/issues/new?assignees=&amp;labels=&amp;template=---community-showcase--share-code-projects.md&amp;title=%5BShowcase+Submission%5D" target="_blank" rel="noopener noreferrer">Have an open source Serverless project you built</a></li><li><a href="https://github.com/Azure/Cloud-Native/issues/new?assignees=&amp;labels=&amp;template=---serverless-hacks--share-your-hack-.md&amp;title=%5BServerless+Hacks%5D" target="_blank" rel="noopener noreferrer">Crafted a Serverless Hack</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="-explore-student-resources">üß≠ Explore Student Resources<a class="hash-link" href="#-explore-student-resources" title="Direct link to heading">‚Äã</a></h2><ul><li><a href="https://docs.microsoft.com/learn/student-hub/?WT.mc_id=academic-75239-sagibbon" target="_blank" rel="noopener noreferrer">Microsoft Student Hub</a> - highlight student focused resources across Microsoft</li><li><a href="https://studentambassadors.microsoft.com/?WT.mc_id=academic-75239-sagibbon" target="_blank" rel="noopener noreferrer">Microsoft Learn Student Ambassadors</a> - our student focused community program</li><li><a href="https://imaginecup.microsoft.com/Events?ocid=pre_web_ambassador_learnmore_all?WT.mc_id=academic-75239-sagibbon" target="_blank" rel="noopener noreferrer">Imagine Cup</a> - our annual student innovation competition</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="Ô∏è-join-us">‚ö°Ô∏è Join us!<a class="hash-link" href="#Ô∏è-join-us" title="Direct link to heading">‚Äã</a></h2><p>Multiple teams across Microsoft are working to create Serverless September! They all want to hear from our incredible student community. We can't wait to share all the Serverless September resources and hear what you have learned and created. Here are some ways to keep up to date on all Serverless September activity:</p><ul><li><strong><a href="https://azure.github.io/Cloud-Native/blog/rss.xml" target="_blank" rel="noopener noreferrer">Subscribe to this blog</a></strong> - get notified early when we publish!</li><li><strong><a href="https://dev.to/azure" target="_blank" rel="noopener noreferrer">Follow Azure on dev.to</a></strong> - look for the #ServerlessSeptember series!</li><li><strong><a href="https://aka.ms/serverless-september?WT.mc_id=academic-75239-sagibbon" target="_blank" rel="noopener noreferrer">Bookmark this site</a></strong> and check back regularly for updates.</li></ul>]]></content>
        <author>
            <name>Sara Gibbons</name>
            <uri>https://github.com/saragibby</uri>
        </author>
        <category label="students" term="students"/>
        <category label="serverless-september" term="serverless-september"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[01. It's 30DaysOfServerless!]]></title>
        <id>01-kickoff</id>
        <link href="https://azure.github.io/Cloud-Native/blog/01-kickoff"/>
        <updated>2022-09-01T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[What We'll Cover]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-well-cover">What We'll Cover<a class="hash-link" href="#what-well-cover" title="Direct link to heading">‚Äã</a></h2><ul><li>What is Serverless September? (6 initiatives)</li><li>How can I <em>participate</em>? (3 actions)</li><li>How can I <em>skill up</em> (30 days)</li><li>Who is behind this? (Team Contributors)</li><li>How can <em>you</em> contribute? (Custom Issues)</li><li><strong>Exercise</strong>: Take the <a href="https://docs.microsoft.com/learn/challenges?id=b950cd7a-d456-46ab-81ba-3bd1ad86dc1c&amp;WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Cloud Skills Challenge</a>!</li><li><strong>Resources</strong>: <a href="https://aka.ms/30DaysOfServerless/collection" target="_blank" rel="noopener noreferrer">#30DaysOfServerless Collection</a>.</li></ul><hr><p><img loading="lazy" alt="Serverless September" src="/Cloud-Native/assets/images/post-kickoff-4a04995b44f0cc4a784fb4ab5e29cf7c.png" width="1500" height="630" class="img_ev3q"></p><p>Welcome to <code>Day 01</code> of <a href="https://aka.ms/serverless-september" target="_blank" rel="noopener noreferrer">üçÇ #ServerlessSeptember</a>! Today, we kick off a full month of content and activities to skill you up on all things Serverless on Azure with content, events, and community interactions! Read on to learn about what we have planned!</p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="explore-our-initiatives">Explore our initiatives<a class="hash-link" href="#explore-our-initiatives" title="Direct link to heading">‚Äã</a></h2><p>We have a number of initiatives planned for the month to help you learn and skill up on relevant technologies. Click on the links to visit the relevant pages for each. </p><ul><li><a href="/Cloud-Native/serverless-september/30DaysOfServerless">#30DaysOfServerless</a> - 4 themed weeks of daily articles in a structured roadmap</li><li><a href="/Cloud-Native/serverless-september/ZeroToHero">Zero To Hero</a> - 4-part series from Product Engineering teams on best practices</li><li><a href="/Cloud-Native/serverless-september/ServerlessHacks">Serverless Hacks</a> - build a serverless tollbooth by solving 8 challenges - with help!</li><li><a href="/Cloud-Native/serverless-september/30DaysOfServerless">Cloud Skills Challenge</a> - skill up by competing with peers to complete modules</li><li><a href="/Cloud-Native/serverless-september/AskTheExpert/">Ask The Expert</a> - join live Q&amp;A sessions with Product Engineering teams</li><li><a href="https://github.com/Azure/Cloud-Native/issues/new/choose" target="_blank" rel="noopener noreferrer">Community Buzz</a> - participate by submitting questions, or contributing content</li></ul><p>We'll go into more details about <strong>#30DaysOfServerless</strong> in this post - don't forget to <a href="https://azure.github.io/Cloud-Native/blog/rss.xml" target="_blank" rel="noopener noreferrer">subscribe</a> to the blog to get daily posts delivered directly to your preferred feed reader!</p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="register-for-events">Register for events!<a class="hash-link" href="#register-for-events" title="Direct link to heading">‚Äã</a></h2><p>What are 3 things you can do today, to jumpstart your learning journey?</p><ul><li><strong>Register</strong> for live Q&amp;A sessions (free, online)<ul><li>Sep 15 - <a href="https://reactor.microsoft.com/reactor/events/17000/" target="_blank" rel="noopener noreferrer">Ask The Expert: Azure Functions</a></li><li>Sep 29 - <a href="https://reactor.microsoft.com/reactor/events/17000/" target="_blank" rel="noopener noreferrer">Ask the Expert: Azure Container Apps</a></li></ul></li><li><strong>Register</strong> for the <a href="https://docs.microsoft.com/learn/challenges?id=b950cd7a-d456-46ab-81ba-3bd1ad86dc1c&amp;WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Cloud Skills Challenge</a> - 30 days to complete it!</li><li><strong>Register</strong> for the <a href="https://docs.microsoft.com/events/learn-events/reactor-serverlessseptember/?wt.mc_id=eventspg_16946_webpage_reactor&amp;WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Serverless Hacks Challenge</a> office hours (weekly)</li></ul><p><img loading="lazy" alt="Serverless Hacks" src="/Cloud-Native/assets/images/serverless-hacks-ad41c4867d9cc7bf26669d6263422b27.png" width="800" height="450" class="img_ev3q"></p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="30daysofserverless">#30DaysOfServerless<a class="hash-link" href="#30daysofserverless" title="Direct link to heading">‚Äã</a></h2><p><a href="/Cloud-Native/serverless-september/30DaysOfServerless">#30DaysOfServerless</a> is a month-long series of daily blog posts grouped into 4 themed weeks - taking you from core concepts to end-to-end solution examples in 30 days. Each article will be short (5-8 mins reading time) and provide exercises and resources to help you reinforce learnings and take next steps.</p><p>This series focuses on the <a href="https://azure.microsoft.com/solutions/serverless/?WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Serverless On Azure</a> learning journey in <strong>four stages</strong>, each building on the previous week to help you skill up in a beginner-friendly way:</p><ul><li><strong>Week 1:</strong> Get started with serverless using <a href="https://docs.microsoft.com/azure/azure-functions/functions-overview?WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Azure Functions</a> </li><li><strong>Week 2:</strong> Build &amp; deploy microservices with <a href="https://docs.microsoft.com/azure/container-apps/overview?WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Azure Container Apps</a> and <a href="https://dapr.io/?WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Dapr</a>.</li><li><strong>Week 3:</strong> Streamline integrations using <a href="https://docs.microsoft.com/azure/logic-apps/?WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Azure Logic Apps</a> and <a href="https://docs.microsoft.com/azure/event-grid/overview?WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Azure Event Grid</a></li><li><strong>Week 4:</strong> Develop End-to-End solutions with <a href="https://azure.microsoft.com/solutions/serverless/?WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Serverless on Azure</a></li></ul><p><img loading="lazy" src="/Cloud-Native/assets/images/banner-f8260b93015d1d9ff71a4d152767d58b.png" width="1600" height="672" class="img_ev3q"></p><p>We have a <a href="/Cloud-Native/serverless-september/30DaysOfServerless">tentative roadmap</a> for the topics we hope to cover and will keep this updated as we go with links to actual articles as they get published.</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Week 1: FOCUS ON FUNCTIONS ‚ö°Ô∏è</div><div class="admonitionContent_S0QG"><p>Here's a sneak peek at what we have planned for week 1. We'll start with a broad look at fundamentals, walkthrough examples for each targeted programming language, then wrap with a post that showcases the role of Azure Functions in powering different serverless scenarios.</p><ul><li>Sep 02: Learn Core Concepts for Azure Functions</li><li>Sep 03: Build and deploy your first Function</li><li>Sep 04: Azure Functions - for Java Developers!</li><li>Sep 05: Azure Functions - for JavaScript Developers!</li><li>Sep 06: Azure Functions - for .NET Developers!</li><li>Sep 07: Azure Functions - for Python Developers!</li><li>Sep 08: Wrap: Azure Functions + Serverless on Azure</li></ul></div></div><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="ways-to-participate">Ways to Participate..<a class="hash-link" href="#ways-to-participate" title="Direct link to heading">‚Äã</a></h2><p>We hope you are as excited as we are, to jumpstart this journey. We want to make this a <strong>useful, beginner-friendly</strong> journey and we need your help!</p><p>Here are the many ways you can participate:</p><ul><li><strong><a href="https://dev.to/azure" target="_blank" rel="noopener noreferrer">Follow Azure on dev.to</a></strong> - we'll republish posts under <a href="https://dev.to/nitya/series/19576" target="_blank" rel="noopener noreferrer">this series page</a> and welcome comments and feedback there!</li><li><strong><a href="https://github.com/Azure/Cloud-Native/discussions" target="_blank" rel="noopener noreferrer">Discussions on GitHub</a></strong> - Use this if you have feedback for us (on how we can improve these resources), or want to chat with your peers about serverless topics.</li><li><strong><a href="https://github.com/Azure/Cloud-Native/issues/new/choose" target="_blank" rel="noopener noreferrer">Custom Issues</a></strong> - just pick a template, create a new issue by filling in the requested details, and submit. You can use these to:<ul><li>submit questions for <strong>AskTheExpert</strong> (live Q&amp;A) ahead of time</li><li>submit your own articles or projects for community to learn from</li><li>share your <strong>ServerlessHack</strong> and get listed in our Hall Of Fame!</li><li>report bugs or share ideas for improvements</li></ul></li></ul><p>Here's the list of custom issues currently defined.</p><p><img loading="lazy" alt="Community Buzz" src="/Cloud-Native/assets/images/community-buzz-8b0a4bdba21ad5e4da34ee5498ea807a.png" width="602" height="498" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="lets-get-started">Let's Get Started!<a class="hash-link" href="#lets-get-started" title="Direct link to heading">‚Äã</a></h2><p>Now you know everything! We hope you are as excited as we are to dive into a full month of active learning and doing! Don't forget to <a href="https://azure.github.io/Cloud-Native/blog/rss.xml?WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">subscribe</a> for updates in your favorite feed reader! <strong>And look out for our first Azure Functions post tomorrow!</strong></p><hr>]]></content>
        <author>
            <name>Nitya Narasimhan</name>
            <uri>https://github.com/nitya</uri>
        </author>
        <author>
            <name>Devanshi Joshi</name>
            <uri>https://github.com/devanshidiaries</uri>
        </author>
        <category label="hello" term="hello"/>
        <category label="serverless-september" term="serverless-september"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[02. Learn Core Concepts]]></title>
        <id>02-functions-intro</id>
        <link href="https://azure.github.io/Cloud-Native/blog/02-functions-intro"/>
        <updated>2022-09-02T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Introduction to Azure Functions, from core concepts to hello world!]]></summary>
        <content type="html"><![CDATA[<hr><p>Welcome to Day 2Ô∏è‚É£ of #30DaysOfServerless!</p><p>Today, we kickstart our journey into serveless on Azure with a look at <em>Functions As a Service</em>. We'll explore Azure Functions - from core concepts to usage patterns. </p><p>Ready? Let's Go!</p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-well-cover">What We'll Cover<a class="hash-link" href="#what-well-cover" title="Direct link to heading">‚Äã</a></h2><ul><li>What is Functions-as-a-Service? (FaaS)</li><li>What is Azure Functions?</li><li>Triggers, Bindings and Custom Handlers</li><li>What is Durable Functions?</li><li>Orchestrators, Entity Functions and Application Patterns</li><li><strong>Exercise</strong>: Take the <a href="https://docs.microsoft.com/learn/challenges?id=b950cd7a-d456-46ab-81ba-3bd1ad86dc1c&amp;WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Cloud Skills Challenge</a>!</li><li><strong>Resources</strong>: <a href="https://aka.ms/30DaysOfServerless/collection" target="_blank" rel="noopener noreferrer">#30DaysOfServerless Collection</a>.</li></ul><p><img loading="lazy" src="/Cloud-Native/assets/images/banner-625fc9c41bfc17643b5e473ad62165f1.png" width="1600" height="672" class="img_ev3q"></p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-what-is-faas">1. What is FaaS?<a class="hash-link" href="#1-what-is-faas" title="Direct link to heading">‚Äã</a></h2><p>Faas stands for <a href="https://docs.microsoft.com/azure/architecture/guide/technology-choices/compute-decision-tree?WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Functions As a Service (FaaS)</a>. But what does that mean for us as application developers? We know that
building and deploying modern applications <strong>at scale</strong> can get <em>complicated</em> and it starts with us needing to take decisions on <em>Compute</em>. In other words, we need to answer this question: "<strong>where should I host my application given my resource dependencies and scaling requirements?</strong>" </p><p><img loading="lazy" alt="this useful flowchart" src="/Cloud-Native/assets/images/compute-choices-4a01cddc51a10a415928d2b002f58786.png" width="1345" height="1704" class="img_ev3q"></p><p>Azure has <a href="https://docs.microsoft.com/azure/architecture/guide/technology-choices/compute-decision-tree?WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">this useful flowchart</a> (shown below) to guide your decision-making. You'll see that hosting options generally fall into three categories:</p><ul><li><strong>Infrastructure as a Service (IaaS)</strong> - where you provision and manage Virtual Machines yourself (cloud provider manages infra).</li><li><strong>Platform as a Service (PaaS)</strong> - where you use a provider-<em>managed</em> hosting environment like Azure Container Apps.</li><li><strong>Functions as a Service (FaaS)</strong> - where you forget about hosting environments and simply <em>deploy your code</em> for the provider to run.</li></ul><p>Here, "serverless" compute refers to hosting options where we (as developers) can focus on building apps <em>without having to manage the infrastructure</em>. See <a href="https://azure.microsoft.com/solutions/serverless/?WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">serverless compute options on Azure</a> for more information.</p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-azure-functions">2. Azure Functions<a class="hash-link" href="#2-azure-functions" title="Direct link to heading">‚Äã</a></h2><p><a href="https://docs.microsoft.com/azure/azure-functions/?WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Azure Functions</a> is the Functions-as-a-Service (FaaS) option on Azure. It is the ideal serverless solution if your application is event-driven with short-lived workloads. With Azure Functions, we develop applications as modular blocks of code (<code>functions</code>) that are executed on demand, in response to configured events (<code>triggers</code>). This approach brings us two advantages:</p><ul><li><em>It saves us money.</em> We only pay for the time the function runs.</li><li><em>It scales with demand.</em> We have 3 hosting plans for flexible scaling behaviors.</li></ul><p>Azure Functions can be programmed in many popular languages (C#, F#, Java, JavaScript, TypeScript, PowerShell or Python), with Azure providing <a href="https://docs.microsoft.com/azure/azure-functions/supported-languages?WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">language-specific</a> handlers and default <a href="https://docs.microsoft.com/azure/azure-functions/supported-languages#languages-by-runtime-version?WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">runtimes</a> to execute them.</p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Concept: Custom Handlers</div><div class="admonitionContent_S0QG"><ul><li>What if we wanted to program in a non-supported language? </li><li>Or we wanted to use a different runtime for a supported language? </li></ul></div></div><p><strong><a href="https://docs.microsoft.com/azure/azure-functions/functions-custom-handlers?WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Custom Handlers</a></strong> have you covered! These are lightweight webservers that can receive and process input events from the Functions host - and return responses that can be delivered to any output targets. By this definition, custom handlers can be implemented by <em>any language that supports receiving HTTP events</em>. Check out <a href="https://docs.microsoft.com/azure/azure-functions/create-first-function-vs-code-other?tabs=go%2Cmacos&amp;WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">the quickstart for writing a custom handler</a> in Rust or Go.</p><p><img loading="lazy" alt="Custom Handlers" src="/Cloud-Native/assets/images/azure-functions-custom-handlers-overview-de72de160aa84f99c6eb68de567db126.png" width="855" height="575" class="img_ev3q"></p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Concept: Trigger and Bindings</div><div class="admonitionContent_S0QG"><p>We talked about what functions are (code blocks). But when are they invoked or executed? And how do we provide inputs (arguments) and retrieve outputs (results) from this execution?</p></div></div><p>This is where <strong>triggers</strong> and <strong>bindings</strong> come in.</p><ul><li><code>Triggers</code> define how a function is invoked and what associated data it will provide. <em>A function must have exactly one trigger</em>.</li><li><code>Bindings</code> <em>declaratively</em> define how a resource is connected to the function. The resource or binding can be of type input, output, or both. <em>Bindings are optional. A Function can have multiple input, output bindings</em>.</li></ul><p>Azure Functions comes with a number of <a href="https://docs.microsoft.com/azure/azure-functions/functions-triggers-bindings?tabs=csharp#supported-bindings&amp;WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">supported bindings</a> that can be used to integrate relevant services to power a specific scenario. For instance:</p><ul><li><a href="https://docs.microsoft.com/azure/azure-functions/functions-bindings-http-webhook?tabs=in-process%2Cfunctionsv2&amp;pivots=programming-language-javascript&amp;WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">HTTP Triggers</a> - invokes the function in response to an <code>HTTP request</code>. Use this to implement serverless APIs for your application.</li><li><a href="https://docs.microsoft.com/azure/azure-functions/functions-bindings-event-grid?tabs=in-process%2Cextensionv3&amp;pivots=programming-language-javascript&amp;WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Event Grid Triggers</a> invokes the function on receiving events from an Event Grid. Use this to process events reactively, and potentially publish responses back to custom Event Grid topics.</li><li><a href="https://docs.microsoft.com/azure/azure-functions/functions-bindings-signalr-service-trigger?tabs=in-process&amp;pivots=programming-language-javascript&amp;WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">SignalR Service Trigger</a> invokes the function in response to messages from Azure SignalR, allowing your application to take actions with <em>real-time contexts</em>.</li></ul><p>Triggers and bindings help you abstract your function's interfaces to other components it interacts with, eliminating hardcoded integrations. They are <a href="https://docs.microsoft.com/azure/azure-functions/functions-triggers-bindings?tabs=csharp#trigger-and-binding-definitions&amp;WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">configured differently based on the programming language</a> you use. For example - JavaScript functions are configured in the <a href="https://docs.microsoft.com/azure/azure-functions/functions-reference?tabs=blob#function-code?WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">functions.json</a> file. Here's an example of what that looks like.</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string-property property" style="color:#36acaa">"disabled"</span><span class="token operator" style="color:#393A34">:</span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string-property property" style="color:#36acaa">"bindings"</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// ... bindings here</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string-property property" style="color:#36acaa">"type"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"bindingType"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string-property property" style="color:#36acaa">"direction"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"in"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string-property property" style="color:#36acaa">"name"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"myParamName"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">// ... more depending on binding</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The key thing to remember is that triggers and bindings have a <code>direction</code> property - triggers are always <code>in</code>, input bindings are <code>in</code> and output bindings are <code>out</code>. Some bindings can support a special <code>inout</code> direction. </p><p>The documentation has <a href="https://docs.microsoft.com/azure/azure-functions/functions-triggers-bindings?tabs=javascript#supported-bindings&amp;WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">code examples</a> for bindings to popular Azure services. Here's an example of the bindings and trigger configuration for a <a href="https://docs.microsoft.com/azure/azure-functions/functions-bindings-storage-blob-input?tabs=in-process%2Cextensionv5&amp;pivots=programming-language-javascript#example&amp;WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">BlobStorage</a> use case.</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// function.json configuration</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string-property property" style="color:#36acaa">"bindings"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-property property" style="color:#36acaa">"queueName"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"myqueue-items"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-property property" style="color:#36acaa">"connection"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"MyStorageConnectionAppSetting"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-property property" style="color:#36acaa">"name"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"myQueueItem"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-property property" style="color:#36acaa">"type"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"queueTrigger"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-property property" style="color:#36acaa">"direction"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"in"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-property property" style="color:#36acaa">"name"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"myInputBlob"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-property property" style="color:#36acaa">"type"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"blob"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-property property" style="color:#36acaa">"path"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"samples-workitems/{queueTrigger}"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-property property" style="color:#36acaa">"connection"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"MyStorageConnectionAppSetting"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-property property" style="color:#36acaa">"direction"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"in"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-property property" style="color:#36acaa">"name"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"myOutputBlob"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-property property" style="color:#36acaa">"type"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"blob"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-property property" style="color:#36acaa">"path"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"samples-workitems/{queueTrigger}-Copy"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-property property" style="color:#36acaa">"connection"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"MyStorageConnectionAppSetting"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-property property" style="color:#36acaa">"direction"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"out"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string-property property" style="color:#36acaa">"disabled"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The code below shows the function implementation. In this scenario, the function is triggered by a <em>queue message</em> carrying an <em>input payload</em> with a blob name. In response, it copies that data to the resource associated with the <em>output binding</em>.</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// function implementation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method-variable function-variable method function property-access" style="color:#d73a49">exports</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">context</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'Node.js Queue trigger function processed'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">bindings</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">myQueueItem</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">bindings</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">myOutputBlob</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">bindings</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">myInputBlob</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Concept: Custom Bindings</div><div class="admonitionContent_S0QG"><p>What if we have a more complex scenario that requires bindings for non-supported resources? </p></div></div><p>There is an option create custom bindings if necessary. We don't have time to dive into details here but definitely check out the <a href="https://github.com/Azure/azure-webjobs-sdk/wiki/Creating-custom-input-and-output-bindings" target="_blank" rel="noopener noreferrer">documentation</a></p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-durable-functions">3. Durable Functions<a class="hash-link" href="#3-durable-functions" title="Direct link to heading">‚Äã</a></h2><p>This sounds great, right?. But now, let's talk about one challenge for Azure Functions. In the use cases so far, the functions are <em>stateless</em> - they take inputs at runtime if necessary, and return output results if required. But they are otherwise self-contained, which is great for scalability!</p><p>But what if I needed to build more complex <em>workflows</em> that need to store and transfer state, and complete operations in a reliable manner? <a href="https://docs.microsoft.com/azure/azure-functions/durable/durable-functions-overview?tabs=csharp&amp;WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Durable Functions</a> are an extension of Azure Functions that makes <em>stateful workflows</em> possible.</p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Concept: Orchestrator Functions</div><div class="admonitionContent_S0QG"><p>How can I create workflows that coordinate functions?</p></div></div><p>Durable Functions use <a href="https://docs.microsoft.com/azure/azure-functions/durable/durable-functions-orchestrations?tabs=csharp&amp;WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">orchestrator functions</a> to coordinate execution of other Durable functions within a given Functions app. These functions are <em>durable and reliable</em>. Later in this post, we'll talk briefly about some application patterns that showcase popular orchestration scenarios.</p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Concept:  Entity Functions</div><div class="admonitionContent_S0QG"><p>How do I persist and manage state across workflows?</p></div></div><p>Entity Functions provide explicit <em>state mangement</em> for Durable Functions, defining operations to read and write state to <em>durable entities</em>. They are associated with a special <em>entity trigger</em> for invocation. These are currently available only for a subset of programming languages so check to see if they are supported for your programming language of choice.</p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>USAGE: Application Patterns</div><div class="admonitionContent_S0QG"></div></div><p>Durable Functions are a fascinating topic that would require a separate, longer post, to do justice. For now,
let's look at some <a href="https://docs.microsoft.com/azure/azure-functions/durable/durable-functions-entities?tabs=csharp&amp;WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">application patterns</a> that showcase the value of these starting with the simplest one - <a href="https://docs.microsoft.com/azure/azure-functions/durable/durable-functions-overview?tabs=csharp#chaining&amp;WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Function Chaining</a> as shown below:</p><p><img loading="lazy" alt="Function Chaining" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAzkAAACTCAIAAAAiH0BbAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAB7FSURBVHhe7d0JfFxVvQfwc2bNZF+aNGnTpoUsbVJKkUUooCA+tBv6RBEXHq5FBWwVceejCDxRVFpWwY/v8wH1PZenaFtaQDZ5FIHK0tKmbZrShTZNmiaZSTKZ5c6955175zTNMklm5s5M7vL7fvJp5947kPzP/G7znzN3oYwxAgAAAACG5BB/AwAAAIDxoFcDAAAAMC70agAAAADGhV4NAAAAwLjQqwEAAAAYF3o1AAAAAONCrwYAAABgXOjVAAAAAIwLvRoAAACAcaFXAwAAADAu9GoAAAAAxoVeDQAAAMC40KsBAAAAGBd6NQAAAADjQq8GAAAAYFyUMSYegiXsaDsWleS9B7oHghF1cV/XwJD6YBJet+uc5ln8gcftXNxUwx+c01KrbQEwKOQc7AA5hzj0auZ2wh98q62T78lbtx/es79Lism1NTOcTlpcVOx0uvgTysuKPW53/MkTkWW5u8fPHzCm+APqg0NHuvmfZzTNOrt59oJ5MxY31syqKlafCjAdkHOwA+QcJoJezZQOHO197pX9G/6xp7dvqKqyrLCwqLqqonJGqdPhFM/IhM7jPd0neoPBYNeJ3nyv++Jz5i2/uInv52IzQJYh52AHyDlMCb2ayfC3XOt/91L7oZ6ampl1tbP42yyxIcsC/QNHj3V3dHbx93VrPrUUk+qQVcg52AFyDklCr2Ym/7N5+6Mb31jY1DB3drVYlXP8zdnutn0XnTX35s9cLFYBZBRyDnaAnEPy0KuZxh+2bH/sufbzz10ilqfVjta9LfOKb7r2IrEMkCHIOdgBcg4pwTU7TOPBP7yyqLlRLEy3lgX1v9/8hlgAyBzkHOwAOYeUoFczDf/A0KF3OsTCdDv8TqcUk8UCQOYg52AHyDmkxKa9mkk/+T3U0fv6jtZQOCyWp0M0Kr3Vum/P/nfEMhgYcp425NxEkPO0IedmgXk1M2H5c9/plh9/euu2N3YePXZcrM2V3r7+N3fu2fjUCwc7g7JvrlgLkGnIOdgBcg7Js+m5BbxqSqlYMIklV66rnHcuf8CYEh48kUeCAwOButrq0pLi8rKS6qqK+NMyq7unr7cv0OcPvHP0uNvjYa4Sd0El1a76031w25t/Xht/GhgTcp4k5NzUkPMkIefmhV7NNIb37WFMkaMhv0MJOUm4p6evpqrc6XJUlJVR6ig/eXnr8tJij2eq61wrcvcJ9fLWwxe8PtHbw/880nGivKyUOH0SyfP4ShzOUf8f7NvGh5yPhJxbFXI+EnJuSejVTGP8vj2GFBnkhUnhQV6fzxVlLMZXDgwMRqNS/AkTcTmdJaXqNRgpcYZkL3/gzisa/nMi2LeNDzkfCTm3KuR8JOTcknLaq7Hgv8jQNuLIE8vjxRQSVXjEJkCJEiLeWXTmR9THOlhy384x7NsTQc71QM7NAjnXAzk3BeOEPKe9mtz2PtL/HHEkmsLlVfCvPomGJ60oRuiSX9HaL4jFdGHf1g/79kSQcz2Qc7NAzvVAzk3BOCHP3XmgLPQWCe0g7griKkv8pZRQpYR4Soh7gi+u7lr9NQNkD3IOdoCcg+UZKuQ57NX8G4gcIFQ95SSxkEwU8TABOUR8cx2Nd4pFAENCzsEOkHOwPEOFPFe9GpNY/2biUI9zTIASEmM0MsmHvowoUdp0F/FO2z1uAaaGnIMdIOdgeQYLeY56NRZ8lYTeIg6fWB6DUhKWicwmKJsSqZ/MuoZWXyVWABgScg52gJyD5Rkt5Lnq1fx/JWxowm8nMxrm/ekEDao8RHxzHE0/EYsARoWcgx0g52B5Rgt5Tno1eZD1P0FogVgcgxfL+9PYRHOJ2kRi40+It0asADAm5BzsADkHyzNeyHPRq7GBZ0ikbcIrlDBCedmJ+1NtIrHmalrzCbECwKiQc7AD5Bwsz4Ahz0mv5n9MPBqPFxtViDTBh77KEMmb7Wj6mVgEMDDkHOwAOQfLM2DIs96rMamTDb5AHPliebyQLB6MxYisTSTmzRYrAIwKOQc7QM7B8owZ8uzPq/U/SaQjhHrE4ki8LZUYTXx/hvhE4lV01qfECgAjQ87BDpBzsDxDhjzrvZoS2EBI6peSU2+hVe1ovEssAhgbcg52gJyD5Rkz5Jnp1V7vCHx5w87vP912PBgRqzQs0k4GX0o8l8jb0hhTD9BL8CMwIkdo453EN1esIOSPbx377F92PLTtsFgGyDnkHOwAOQfLM13IM9CrvXio9/qNrc8f6P3d9o51Ww+KtRoW2Exi3YS6xPJIvGxeszL+zvHaRGL1lXT2tWIFIa8c8d/6XPurRwK/2Hrgh8/uy+X95gHikHOwA+QcLM+MIdfbqz29/8TXt+yJyEpFvjvP5Rjdoirq1eQmukXDRJeSi08kNv1cLGr6QlJUVorzXOX5nt+/dey7f2+TEowXQLYg52AHyDlYnklDrqtXe3zv8W8/tVdmzOd2DETl6iLvjRfME9t4fxp8nQy9NuFcIq85waXktInEhjuIr06s0Lx3XvnHFlX7QxJ/XO5z/3V317efVMc6vhUgq5BzsAPkHCzPvCFPv1d7rLXz+0+38Qe8Mx2MyDN87vtWNp9ZXRzfyrHA39RrjST8FokvJadNJM78EK39nFhxks/tvP39jR9bVMMrZ4yU+dyb27pv2rx7SJro1FmAzEDOwQ6Qc7A8U4c8zV7tDzs6fvBsu8tBvVrNlQWee1e2tFQVic2cElI/901431P+PRNeSk4JE28VXbBOLI7moPRHlzV8cvEsf4RXznjlz7zds/bx1v5ITDwDINOQc7AD5Bwsz+whT6dXe/SNI3e8sJ93ph6XYyAiVxXympubqwrFZg0LbiWRvYlv0cAIGZLVP0dhRA7Thjuo79SE5Hi3XFr/mSWz/eGYwli5z/3i4b6vbmrt06YZATILOQc7yGLO65FzMAQLhDzlXu2hbYd/+uKBPJfT7aS85ppCzwMrWxZWjqqZU/r+SlhU+4x3NL4iqqiXkhv1nbWJxKpVtPYLYsXEvvWe01efM6c/HJN5o5rn3nY08JWNu8acdgugE3IOdpDdnM9BzmH6WSPkqfVq9758cP0/Dxa4Rc2zirz3rWppmDH2XvQs5icDTyc+QI8LK2P7UyVMPBV09GkUk/jahfO/8u46/gPwTrU0z7Wja+D6DbuO9ofFZgB9kHOwA+QcLM8yIU+hV/vZi28/+OrhYq/L5aT9kVhtsfe+lS0NFWNr5tjAsyR6gNBxJ77y/jR+KblRnas2kdh4Jy1oECuScMP5dWsuqAtKsqRVvvtE8PqNuw75Q2IzQLqQc7AD5Bwsz0ohT7ZXu/359l+/dqTYy3tT2h+OzS32PbCqpb4icRPK/P8rHo1BqXYpOa3+YbEgmfnhZD4VEliMKFH+9+pz59584fwQr1xmJXmu/b1DX9qws70nGH+WoXxn/RMDmNVPVy5HDzlPG0KuX87GEDlPD0KuH0KeXsjplJfTlRV263P7/rSzszTP7aCEN6fzSn33rmrhf4pnjMaiR5S956snvlK3WDWMMdorEXn0yRS8jPx64i4nShJH27EooR7HGY+S/PnxFb/bfvQn//e21+XwONVjBqsLPeuWjz1mcDxeNR178m0WLbly3Wl1VY/cdmVRwQQX2UsC/59UzjtXLBhA98Ftb/55rVjIpoyM3pSQc50y9TLZNudcDqKOnOuRwRfItjlHyNML+RTzapKifPfve9WafaLm+WX5909cM8cCm4jUlaBm/t8nvJQcf2awjfS9QAIvT/X1T3LiVVr5weGauU+dOfuWS+qjMca/irzOrsHoDZt2be/sF5sNo0+qvPaWP+M9WXqyPXrIeUYg5PpldQyRc/0Qcv0Q8jRCPlmvFo7J39iyZ8Oe42W8ZqLWfHp5/oNXtMyduGaO+TckqJlTmDqXmODdDyMOD3EWEmfBpF+FRJHJ7A/T074n/ruTPrao5rbLGmKKEokphV5nb0i6fuOuV4/4xWZjcHnysZOnLaujh5xnCkKuX/bGEDnPCIRcP4Q8jZBP2KsFo/LXN+9+qv0Er5n/pIFIrL5CbU5nFye6+shJLLSLhP6V4GQK/r+IyHT8peSSJweJbw5deK9YHO2KhTNvf38j4wMbUwo8Tv7Dr928+8VDfWKzMWAn1yNLo4ecZxZCrl82xhA5zyCEXD+EPNWQJ+7VAmFpzePqXeiHa26aUXD/ykWT18yxwAYi9xHqFMvDmHYpOd6l8gfJfI3BZMJivGaaVyvWjLOiqerOy5t4PSFJyfc4ef03bdn9zNs9YrMxYCfXI+Ojh5xnA0KuX2bHEDnPOIRcP4Q8pZAnOLegdyi6ZvPu1zoCpXmi5oWVBfetbJlZONWRgEyW2y4hoTeIY/Q5sfz/EmN0IDaqoPG1jRQbvTkaIPPXOhbcLRYn9vyBnm89uVdS1DuzhiX1Pqm8dV3WWBnfOiz5Y1GvuPHRwx29YiFdLperrPYsscCLiw6VubtTPbjSjMeiGmf0xkPOhxnqZTLpMdeGjTpyzmXk1eEy+AKZLucGHMNhdgj52F7tRJDX3PrmsYHSPBdf9EdiLVWF965onrpmXsjgy0r75cTBn5loui6+K01eLcefFlGoXxLP53/FAqT4HMd5z6kfACdh66G+m5/cE5Jk3qhG1Ps6kB9d1sAbWLFZk3yvlqU9Ko2AmvF3mHFGbwzkfCRDvUxmzDlnzKgj53HZC1XaL5Dpcm7AMYyzSchH/XzdwciNm3bxmkviNYdjZ1QVJtWcapj/LxPeo57jBU9ZM8cIDY64s6kS4dXSlgeTrJm7sK5s/fKFhR5XMCp7XQ6+C9/yTNvGPV1iszFgCl0PnaOHnOcGQq6fnjFEznMAIdcPIU8m5Kd+xK7ByA2bWnd0DfLmlHeHg1H5zOqi+1e1VBV4xDMmJw+y/i1jJxJTxX+ckKze0F70p4zEQrThdlp8dnw5SefWlt6zsrk0zx2WFK/TwUu/5Zl9f9uNds060h495DyXEHL90htD5DxnEHL9EPIpQy56taAkf+vJvW91qbOIvI+MyEpdqe+eFc0V+cnVzH/AwedIpF2bS0wXL1VmdGj4FFnt3qg1H6F1a7TF1JxVU3zXBxbwFjXGGK/c7aA/eHYfzgy1kjRGDznPPYRcv1THEDnPMYRcP4R88pCLXm3fieC/OgIlXnd8wi8kKRfMKZ2RZHOqYkrPI0QOEzlAZP+4L74y/tUvvpisVTkar5bXLK47R7XzXevognviG9Nwbm1J44wC9dNfQjxOBy/qibbjYpthYCfXI9XRQ86nBUKuX0pjiJznHkKuH0I+SchFrzaz0FNV4AnLSvxncTtpe++Q9jA5Soh65tEZn6Xl19Ly/6Dl19DyT9OyT2lfn6RlV9Oyj9PSj9LSD9OSVbTkCuKaQdjomzPwbywpp/pTFuNDQxfeQ/Nma5vT0R2MdvSH1UsX8x+QqcefLqic4jYO04IHtDdS/sVbHxPLkIqURg85ny4IuX7JjyFyPi0Qcv0Q8olCfuo80OcP9Ny0ZY+DUl4zXwxG5Y+fUf3d99bHt2YSk+Q97yaR/cQx4sIn/HsGJBpSRPeonu/6NceCX2gL6QiEpa9t3v36sf4Ct1NmLBCOXbNk1jcvPt2ljQKvenrPAx2JKbIzfOieb36waf7Y03RHMt15Q5xxRm8Ycj6eoV4mM+acM1rUkfORchOqlF4g0+XcgGNoq5CLeTXukvkV37/k9HBMlhXGt+S7nb/Z3nHHP9rF5sxR+p8m4b2jPiTm3y+q0HC8Zkpi/aTsPEfDHfGNafCHpa8+3vrKkYCoORL7wtm1/CWM12woqbYaMFIao4ec5x5Crl+qY4ic5xhCrh9CPknIT/Vq3L83V69dOm8wGuNP5e9SSr3u37zZccfzma488DdCJK3WEYIxEp/gU893LaLNvyTOyW7gNYmeoegNm1q3HQ2U5rliChuIyNefN/emi04Tm40Eu7ceaY8ecp5LCLl+6Y0hcp4zCLl+CPnkIR/Vq3GfP3vOZ99V6w+rx7aplee5f7u94z8z16gyuY8NPD/q3lv8RwjJNMq0nyV+vusdtPjUdY1T0h2M3rip9Y2O/rI8N68hKMn8hbzh/Hlis5Fg99ZD5+gh57mBkOunZwyR8xxAyPVDyKcMufqtxvjGRaddc+asQFhSGHNSUpLn1uYV94vN+qg1Rw8SOuJkDZmoR+eptPNdqz9C627QFlN2PBi5ftOuHdpJvPyn5zXffNH8L54zR2w2EuzeemRk9JDzbEPI9dM/hsh5ViHk+pkv5Mo0hDzB/UDjfr717V+/drTI43Q5KG9X+8LSNUtmfU/3UXvKwc+wvv8mzjKxTNWJRDogE4d2vqt3Nj3/n9RbLbam4tiAev3i3d3BUp9Lklk4Jn/zotM+vSTxGRnJn1uw9NMPDIWiYiFdRUVFeRULxEK60TTjMdfGGb2JIOecoV4mM+acM3jUbZ7zjLw6XAZfINPl3IBjOIa1Qz5hr8Y9+Oqh+18+nO9xurXK/Vrluk6yiHWrJ1PIfkLd6iKvWWa0N8q7VPXtmByi7/obrVyhbkrR0f7wVze17u0JlvDmVKv5O+85/ROLZ4nN4yTfq2XEyN3Sbr/D9MvI6E0COc+ITL1Mts05l9WoT0fO/0orV6qbUmTYnGfwBbJtzhHyuFRDnuAz0GFfPq/uGxfPD0lyVGG8gyzN03vUnhJ4gkjviJo5vncFebVMrV8aJHVr0vsF9k4g9JWNu9q0mqMxFokpt1xSP0nN0ygbrYZ9ZGn0kPPMQsj1y8YYTkfO0/kdZoqcI+T6IeQphXyyXo37zFm1t1xaL8lKRFbiles6ai+wkRCneMxLjco0LBOH4+T5rreJTak42KfW/HbvULFWs6QoP7i0/mOLasRmI8HurUdWRw85zxSEXL/sjSFynhEIuX4Ieaohn6JX465aVHPbZQ2MkXAsXrnrt2k1qiz6Dgu+POpkCt6fMt64RoirmLb8ijhHbEoOr/aGTbsO9YV4zbwzjSnKre9r+EhLOp8cZxt2bz1yMHrIuX4IuX7ZHkPkXCeEXD+EPI2QT92rcasWzPzpB5qcDhpSK6clWqOaauWs/0kS6zz1oW9EoRGFUO1818Yf06LF2rNSsK8nyJvTw4FwkVazwsjt72/80MKZYrPBYPfWIzejh5zrhJDrl4MxRM71QMj1Q8jTCHlSvRp32ekz7l620OdyDElyevOKLPA4f41OLhAajKnVqzel/yid82WxPml7ugev37irYyBc5HWq11Vh5I73N65oqhKbDaaqogi7d9pyOXrIedoQcv1yNobIeXoQcv0Q8vRCnmyvxl1YV3bPiuaSPNdgNF65Oq+YZOUssp8EXxFzifw/DstEYkQJEt88x8KUb0rfenzwxk2tXYPRIq8rLKm3bv3x5U3LGo27/zz18Oexe6ctx6OHnKcHIdcvl2OInKcBIdcPIU8v5Cn0atzZs0vuX9VSVeAZiMbi84pJnmTB+p8gseOEutQFWaHqh778S6EtDxBvaseN7uwauH7TruPBaKHXGZIUp4Pe9YEFl9fPEJsBdEPOwQ6Qc7A8y4Q8tV6Na6kqevCKlrklvv4Ir1zMK055t1QW2CQu+8v7ySGZxBQiD5J5X6czlmnbk7X9WP8Nm1r7QlKRVrNHrbnp0tMqxGaADEHOwQ6Qc7A8a4Q85V6Nq68oeGBVS0NFgV9UPsW8Igu1kuA24ihQa44xGuI195PSCxwNPxLPSM7rHYGvPt7qD0sFHmdQUrxO+rNlC947Hzs2ZAVyDnaAnIPlWSDk6fRq3NxS3y+vaFk8s8gf5pVT3qg+OnHlLLBRu+yv+r3Uu2hJYe18118SR178CcnYdkStmffFvOahqOJzOe5e3nxRXbnYDJAFyDnYAXIOlmf2kKfZq3FVhV7eqL67tqQvJFFKyrTKf7H1ABtzzyomq5/78gp5fxpVSChGWJg2/SSl8113dPZ/bUtrMKpoNcsFHse65QvPn1MqNgNkDXIOdoCcg+WZOuTp92pcmc+9fkXzJfPL45UXeV1/2tnZFYyIzRoWepOEthOHT10IyiTaT2o+Tud8SduYrD/u7OwORnm1g1GZf5f1y5vPq8WODTmCnIMdIOdgeeYNua5ejeM/xN3Lm5c1Vp4IRnuHopUF7nz3yeuRaFhgi/pBL3WQsEJDA6RwPl2wTmxLWm1xXkRmx4PR0jz3vSubz55dIjYA5ARyDnaAnIPlmTTklI2d/kuHrLDfbj96yB/+aEt1c1WhWMsxSW67VGtR82lPiESG6NkbaWVqp1FwIUn+3faOzsHI1WfU1FcUiLU68Kopb6pNZcmV6yrnnSsWDKD74LY3/7xWLNgDcp4DyPm0Q85zADmfXqYLeWZ6tYmw4MvKvg8Qp5cEFdrTQxq+7Wj8sdg2rbBv62fD32ETQc4zCDk3LOQ8g5BzYzJsyPV+Bjo59RYNLEgUSvt7ScVSR/0PxQYAC0HOwQ6Qc7A8w4Y8m72aEmaBzcRZQAaChJZo57t6xSYAy0DOwQ6Qc7A8A4c8i70aC/6TRPaQmJsOBGnTnbToDLEBwEKQc7AD5Bwsz8ghz2av5t9ASIz4e0jN1XTudWItgLUg52AHyDlYnpFDnrVeTR5gwWdIWKLO0+nC9WIlgMUg52AHyDlYnrFDnq1ejQVfJKE2MuSkC++j3iqxFsBakHOwA+QcLM/gIc9Wr6YENpH+CJ11E636oFgFYDnIOdgBcg6WZ/CQZ6VXY3KA9PyF+t7taLhVrAKwHOQc7AA5B8szfsizM6828BQJ9tAFv1YvKAdgVcg52AFyDpZn+JBnZ16t6zeO2ttpcYtYBrAi5BzsADkHyzN+yDPfq7HwHuKYSefeLJYBrAg5BztAzsHyTBHyLMyrhQ/T2u8Qs92dDSA1yDnYAXIOlmeGkGe8V2O0aCn1nSaWAKwJOQc7QM7B8swR8oz3apQ4C8VDAMtCzsEOkHOwPHOEPCvnFgAAAABARqBXAwAAADAu9GoAAAAAxmXTXo3itCawAeQc7AA5B8vDvBoAAACAcaFXMw2X08mYIhYALAo5BztAziEl6NVM40OXtUQHjouF6RYJ9py3eJ5YAMgc5BzsADmHlKBXM41vfu49i+d7YoNHFVkSq6YDU+TYYOfcssjPv7FMrALIHOQc7AA5h5RQxph4CGbw6IbX/+ux14i7iLmKPb4SsTYnYtEhFvUrkb6P/tui6646z+t2iQ0AmYacgx0g55Ak9GrmE5FiG55t3fRC2+63uwqKyiSW5/Lku/OKxOaMkiKDfJd2k3AkGCgv833okoVXLzuzqMArNgNkDXIOdoCcQzLQq5nYQDCy9Y2Dr+/u2LGva8/+zrLSUuKgMeJTFMr3dupw8ucMP5gEY0osEhz5wOMY4n/29fadNqdyUcPMc5pnLT2rbkZpgfpsgNxCzsEOkHOYBHo169jRdiwqyTv2qn++vqezPxjmKw8e6QlHpjgewuV01s+r5A+8btcFi2v5g3MWaX+2qH8CGApyDnaAnMNI6NUAAAAAjAvngQIAAAAYV7Z7tS3X0YSu2yKeMKx9/YXqhgvXt4sVAKaRVM5HPwlJB9NJJufiX/KTkHMwneT7Fm74ydmNujHm1dRiG9a+JJYArEbbnZc/LJY0L61tSLzrA5hVgn/JkXOwsvb1t4/6dz1rctOrrd7Mxnjo5HX3tDdh/JfY0nX7Nq8W6wBMaZKcczziYi0XD/vDy/FbDEwn+ZzvW7dUXfXw7ZhcA9OZPOea9vXX8rcmS1ev1nKeVdM+r7av9SVtSLauqRdrACxn2UNjIr7soXi3trMNv8TAMsbmvH7NI/FuDcCCttyldmrrHrm5WazIomnv1dSde1yzCgAA5qe+GSdkUSPeioPVbLlO+0TwkdzMMxnjeDUAu2lv26n+hV9iYF3t6y9UD9Jcuu5mvB0Hi4kfqLb6+7n6RDA3vdrDy+PnSQzDUTpgQSnkvP3xP76EX2JgSpPmfORpoOppBqs34wAXMKXJch4/UG315tx9KIh5NYCci+/oOXxPBjBN+C88vDUHaxGnFOT0rXZuerVx51PgCDWwoCRzvuU6db5h6bp92A3AjCbNef2arWItFz8PFO0amNGEOT95SkFO32pjXg0gl7Zcp11nbfVmfDAElscbN9Gu4aodYBG5PaVgGHo1gJwZbtQwsww2Ub/iKly1A6wjflaYeonnU+LXfxbrsjSHjF4NIDfQqIEdxa/aAQB6oFcDyD715Dg0amBt2imgo2cVxBsUsvSqFfjIH6xg1AGZQvyDfnHHjiz9Cz/tvZp6AzlB26dPTS3iaFSwCu1YVNW4s8Bxb2uwltER1/5Rx9GZAHphXg0AAPTTZhzG3tZZPZkOc8kAOlHGmHgIAAAAAAaDeTUAAAAA40KvBgAAAGBc6NUAAAAAjAu9GgAAAIBxoVcDAAAAMC70agAAAADGhV4NAAAAwLjQqwEAAAAYF3o1AAAAAONCrwYAAABgXOjVAAAAAIwLvRoAAACAcaFXAwAAADAu9GoAAAAAxoVeDQAAAMC40KsBAAAAGBUh/w89pfkMtDs2kQAAAABJRU5ErkJggg==" width="825" height="147" class="img_ev3q"></p><p> Here, we want to execute a sequence of named functions <em>in a specific order</em>. As shown in the snippet below, the orchestrator function coordinates invocations on the given functions in the desired sequence - "chaining" inputs and outputs to establish the workflow. Take note of the <code>yield</code> keyword. This triggers a checkpoint, preserving the current state of the function for reliable operation.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">const df = require("durable-functions");</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module.exports = df.orchestrator(function*(context) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        const x = yield context.df.callActivity("F1");</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        const y = yield context.df.callActivity("F2", x);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        const z = yield context.df.callActivity("F3", y);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return    yield context.df.callActivity("F4", z);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } catch (error) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Error handling or compensation goes here.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">});</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Other application patterns for durable functions include:</p><ul><li><a href="https://docs.microsoft.com/azure/azure-functions/durable/durable-functions-overview?tabs=javascript#fan-in-out&amp;WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Fan-out/fan-in</a></li><li><a href="https://docs.microsoft.com/azure/azure-functions/durable/durable-functions-overview?tabs=javascript#async-http&amp;WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Async HTTP APIs</a></li><li><a href="https://docs.microsoft.com/azure/azure-functions/durable/durable-functions-overview?tabs=javascript#monitoring&amp;WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Monitoring</a></li><li><a href="https://docs.microsoft.com/azure/azure-functions/durable/durable-functions-overview?tabs=javascript#human&amp;WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Human Interaction</a></li><li><a href="https://docs.microsoft.com/azure/azure-functions/durable/durable-functions-overview?tabs=javascript#aggregator&amp;WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Aggregator (stateful entities)</a></li></ul><p>There's a lot more to explore but we won't have time to do that today. Definitely <a href="https://docs.microsoft.com/azure/azure-functions/durable/?WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">check the documentation</a> and take a minute to read the <a href="https://docs.microsoft.com/azure/azure-functions/functions-compare-logic-apps-ms-flow-webjobs#compare-azure-functions-and-azure-logic-apps?WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">comparison with Azure Logic Apps</a> to understand what each technology provides for serverless workflow automation.</p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="4-exercise">4. Exercise<a class="hash-link" href="#4-exercise" title="Direct link to heading">‚Äã</a></h2><p>That was a lot of information to absorb! Thankfully, there are a lot of examples in the documentation that can help put these in context. Here are a couple of exercises you can do, to reinforce your understanding of these concepts.</p><ul><li>Explore the <a href="https://docs.microsoft.com/azure/azure-functions/functions-triggers-bindings?tabs=csharp#supported-bindings&amp;WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">supported bindings</a> for Azure Functions.</li><li>Look at <a href="https://docs.microsoft.com/azure/azure-functions/functions-triggers-bindings?tabs=javascript#bindings-code-examples&amp;WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">code examples</a>, think of usage scenarios.</li></ul><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="5-whats-next">5. What's Next?<a class="hash-link" href="#5-whats-next" title="Direct link to heading">‚Äã</a></h2><p>The goal for today was to give you a quick tour of key terminology and concepts related to Azure Functions. Tomorrow, we dive into <em>the developer experience</em>, starting with core tools for local development and ending by deploying our first Functions app.</p><p>Want to do some prep work? Here are a few useful links:</p><ul><li><a href="https://docs.microsoft.com/azure/azure-functions/create-first-function-vs-code-node?WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Azure Functions Quickstart</a></li><li><a href="https://docs.microsoft.com/azure/azure-functions/durable/quickstart-js-vscode" target="_blank" rel="noopener noreferrer">Durable Functions Quickstart</a></li><li><a href="https://docs.microsoft.com/azure/azure-functions/functions-develop-vs-code?tabs=csharp&amp;WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Azure Functions VS Code Extension</a></li><li><a href="https://docs.microsoft.com/azure/azure-functions/functions-triggers-bindings?tabs=javascript#bindings-code-examples&amp;WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Azure Functions Core Tools</a></li></ul><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="6-resources">6. Resources<a class="hash-link" href="#6-resources" title="Direct link to heading">‚Äã</a></h2><ul><li>Developer Guide: <a href="https://docs.microsoft.com/azure/azure-functions/functions-reference?tabs=blob" target="_blank" rel="noopener noreferrer">Azure Functions</a></li><li>Azure Functions: <a href="https://docs.microsoft.com/azure/azure-functions/functions-twitter-email" target="_blank" rel="noopener noreferrer">Tutorials</a> and <a href="https://docs.microsoft.com/samples/browse/?products=azure-functions&amp;languages=javascript" target="_blank" rel="noopener noreferrer">Samples</a></li><li>Durable Functions: <a href="https://docs.microsoft.com/azure/azure-functions/durable/durable-functions-sequence?tabs=javascript" target="_blank" rel="noopener noreferrer">Tutorials</a> and <a href="https://docs.microsoft.com/samples/browse/?products=azure-functions&amp;term=durable&amp;terms=durable&amp;languages=javascript" target="_blank" rel="noopener noreferrer">Samples</a> </li><li>Self-Paced Learning: <a href="https://docs.microsoft.com/learn/browse/?products=azure-functions&amp;filter-products=Functions" target="_blank" rel="noopener noreferrer">MS Learn Modules</a></li><li>Video Playlists: <a href="https://www.youtube.com/c/AzureFunctions" target="_blank" rel="noopener noreferrer">Azure Functions on YouTube </a></li></ul><hr>]]></content>
        <author>
            <name>Nitya Narasimhan</name>
            <uri>https://github.com/nitya</uri>
        </author>
        <category label="serverless-september" term="serverless-september"/>
        <category label="30-days-of-serverless" term="30-days-of-serverless"/>
        <category label="azure-functions" term="azure-functions"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[03. Build Your First Function]]></title>
        <id>03-functions-quickstart</id>
        <link href="https://azure.github.io/Cloud-Native/blog/03-functions-quickstart"/>
        <updated>2022-09-03T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Let's build our first Azure Functions app - and get familiar with the relevant developer tools and resources!]]></summary>
        <content type="html"><![CDATA[<hr><p>Welcome to <code>Day 3</code> of #30DaysOfServerless!</p><p><em>Yesterday</em> we learned core concepts and terminology for Azure Functions, the signature <em>Functions-as-a-Service</em> option on Azure. <em>Today</em> we take our first steps into building and deploying an Azure Functions app, and validate local development setup.</p><p>Ready? Let's go.</p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-well-cover">What We'll Cover<a class="hash-link" href="#what-well-cover" title="Direct link to heading">‚Äã</a></h2><ul><li>Review the <a href="https://docs.microsoft.com/azure/azure-functions/functions-reference?tabs=blob&amp;WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Azure Functions Developer Guide</a></li><li>Build your first Function App <a href="https://docs.microsoft.com/azure/azure-functions/create-first-function-vs-code-node?WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">with VS Code</a></li><li>Develop locally <a href="https://docs.microsoft.com/azure/azure-functions/functions-core-tools-reference?tabs=v2" target="_blank" rel="noopener noreferrer">using Azure Functions Core Tools</a></li><li>Review <a href="https://docs.microsoft.com/azure/azure-functions/functions-develop-local?WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Local Testing &amp; Development</a> guidelines</li><li>Check out the <a href="https://docs.microsoft.com/azure/azure-functions/durable/quickstart-js-vscode?WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Durable Functions Quickstart</a></li><li><strong>Exercise</strong>: Take the <a href="https://docs.microsoft.com/learn/challenges?id=b950cd7a-d456-46ab-81ba-3bd1ad86dc1c&amp;WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Cloud Skills Challenge</a>!</li><li><strong>Resources</strong>: <a href="https://aka.ms/30DaysOfServerless/collection" target="_blank" rel="noopener noreferrer">#30DaysOfServerless Collection</a>.</li></ul><p><img loading="lazy" src="/Cloud-Native/assets/images/banner-6b30abae3a64206ec53107075cc227e0.png" width="1600" height="672" class="img_ev3q"></p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="developer-guidance">Developer Guidance<a class="hash-link" href="#developer-guidance" title="Direct link to heading">‚Äã</a></h2><p>Before we jump into development, let's familiarize ourselves with language-specific guidance from the Azure Functions Developer Guide. We'll review the <a href="https://docs.microsoft.com/azure/azure-functions/functions-reference?tabs=blob&amp;WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">JavaScript version</a> but guides for F#, Java, Python, C# and PowerShell are also available.</p><ol><li><p>A <strong>function</strong> is defined by two things: <em>code</em> (written in a supported programming language) and <em>configuration</em> (specified in a <code>functions.json</code> file, declaring the triggers, bindings and other context for execution).</p></li><li><p>A <strong>function app</strong> is the <em>unit of deployment</em> for your functions, and is associated with a single execution context or runtime. It can contain multiple functions, but they <em>must</em> be in the same language. </p></li><li><p>A <strong>host configuration</strong> is <em>runtime-specific configuration</em> that affects all functions running in a given function app instance. It is defined in a <code>host.json</code> file.</p></li><li><p>A recommended <strong>folder structure</strong> is defined for the function app, but may vary based on the programming language used. Check <a href="https://docs.microsoft.com/azure/azure-functions/functions-reference?tabs=blob#folder-structure&amp;WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">the documentation on folder structures</a> to learn the default for <em>your</em> preferred language.</p></li></ol><p>Here's an <a href="https://docs.microsoft.com/azure/azure-functions/functions-reference-node?WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">example of the JavaScript folder structure</a> for a function app containing two functions with some shared dependencies. Note that <code>host.json</code> (runtime configuration) is defined once, in the root directory. And <code>function.json</code> is defined separately for each function.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">FunctionsProject</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> | - MyFirstFunction</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> | | - index.js</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> | | - function.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> | - MySecondFunction</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> | | - index.js</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> | | - function.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> | - SharedCode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> | | - myFirstHelperFunction.js</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> | | - mySecondHelperFunction.js</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> | - node_modules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> | - host.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> | - package.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> | - local.settings.json</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We'll dive into what the contents of these files look like, when we build and deploy the first function. We'll cover <code>local.settings.json</code> in the <em>About Local Testing</em> section at the end.</p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="my-first-function-app">My First Function App<a class="hash-link" href="#my-first-function-app" title="Direct link to heading">‚Äã</a></h2><p>The documentation provides <strong>quickstart</strong> options for all supported languages. We'll walk through the <em>JavaScript</em> versions in this article. You have two options for development: </p><ul><li>using <a href="https://docs.microsoft.com/azure/azure-functions/create-first-function-vs-code-node" target="_blank" rel="noopener noreferrer">Visual Studio Code</a> for an IDE-driven experience</li><li>using <a href="https://docs.microsoft.com/azure/azure-functions/create-first-function-cli-node?tabs=azure-cli%2Cbrowser" target="_blank" rel="noopener noreferrer">Azure CLI</a> for a commandline-driven experience.</li></ul><p>I'm a huge fan of VS Code - so I'll be working through that tutorial today. </p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>PRE-REQUISITES</div><div class="admonitionContent_S0QG"><ul><li>Have an Azure account (with active subscription) | <strong><a href="https://azure.microsoft.com/free/?ref=microsoft.com&amp;utm_source=microsoft.com&amp;utm_medium=docs&amp;utm_campaign=visualstudio" target="_blank" rel="noopener noreferrer">Create one for free</a></strong></li><li>Install Azure Functions Core Tools | <strong><a href="https://docs.microsoft.com/azure/azure-functions/functions-run-local#v2" target="_blank" rel="noopener noreferrer">Verify it's version 4.x</a></strong></li><li>Install Azure Functions VS Code Extension | <strong><a href="https://marketplace.visualstudio.com/items?itemName=ms-azuretools.vscode-azurefunctions" target="_blank" rel="noopener noreferrer">Currently v 1.7.4</a></strong></li><li>Install Node.js v16 or v18 (preview) | <strong><a href="https://github.com/nvm-sh/nvm" target="_blank" rel="noopener noreferrer">Manage versions with NVM</a></strong></li></ul><p>Don't forget to validate your setup by checking the versions of installed software.</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="install-vscode-extension">Install VSCode Extension<a class="hash-link" href="#install-vscode-extension" title="Direct link to heading">‚Äã</a></h3><p>Installing the Visual Studio Code extension should automatically open this page in your IDE with similar quickstart instructions, but potentially more recent screenshots.</p><p><img loading="lazy" alt="Visual Studio Code Extension for VS Code" src="/Cloud-Native/assets/images/vscode-1a329646eebc0a4dc8c1abca1d7295fc.png" width="1318" height="968" class="img_ev3q"></p><p> Note that it may make sense to install the <a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode.vscode-node-azure-pack" target="_blank" rel="noopener noreferrer">Azure tools for Visual Studio Code</a> extensions pack if you plan on working through the many projects in Serverless September. This includes the Azure Functions extension by default.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-first-function-app">Create First Function App<a class="hash-link" href="#create-first-function-app" title="Direct link to heading">‚Äã</a></h3><p>Walk through the <a href="https://docs.microsoft.com/azure/azure-functions/create-first-function-vs-code-node#create-an-azure-functions-project" target="_blank" rel="noopener noreferrer">Create local [project]</a> steps of the quickstart. The process is quick and painless and scaffolds out this folder structure and files. Note the existence (and locations) of <code>functions.json</code> and <code>host.json</code> files.</p><p> <img loading="lazy" alt="Final screenshot for VS Code workflow" src="/Cloud-Native/assets/images/vscode-6-5d66f662cb59d39b41f90ab0bf78380e.png" width="1299" height="898" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="explore-the-code">Explore the Code<a class="hash-link" href="#explore-the-code" title="Direct link to heading">‚Äã</a></h3><p><strong>Check out the <code>functions.json</code> configuration file.</strong> It shows that the function is activated by an <code>httpTrigger</code> with an input binding (tied to <code>req</code> payload) and an output binding (tied to <code>res</code> payload). And it supports both GET and POST requests on the exposed URL.</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">"bindings"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">"authLevel"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"anonymous"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">"type"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"httpTrigger"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">"direction"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"in"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">"name"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"req"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">"methods"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">"get"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">"post"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">"type"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"http"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">"direction"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"out"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">"name"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"res"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Check out <code>index.js</code> - the function implementation</strong>. We see it logs a message to the console when invoked. It then extracts a <code>name</code> value from the input payload (req) and crafts a different <code>responseMessage</code> based on the presence/absence of a valid name. It returns this response in the output payload (res).</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method-variable function-variable method function property-access" style="color:#d73a49">exports</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">context</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> req</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'JavaScript HTTP trigger function processed a request.'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">req</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">query</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">name</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">req</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">body</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> req</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">body</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> responseMessage </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"Hello, "</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> name </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">". This HTTP triggered function executed successfully."</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"This HTTP triggered function executed successfully. Pass a name in the query string or in the request body for a personalized response."</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">res</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// status: 200, /* Defaults to 200 */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">body</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> responseMessage</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="preview-function-app-locally">Preview Function App Locally<a class="hash-link" href="#preview-function-app-locally" title="Direct link to heading">‚Äã</a></h3><p>You can now run this function app locally using <a href="https://docs.microsoft.com/azure/azure-functions/functions-run-local" target="_blank" rel="noopener noreferrer">Azure Functions Core Tools</a>. VS Code integrates seamlessly with this CLI-based tool, making it possible for you to exploit all its capabilities without leaving the IDE. In fact, the workflow will even prompt you to <em>install</em> those tools if they didn't already exist in your local dev environment.</p><p>Now run the function app locally by clicking on the "Run and Debug" icon in the activity bar (highlighted, left) and pressing the "‚ñ∂Ô∏è" (<code>Attach to Node Functions</code>) to start execution. On success, your console output should show something like this. </p><p> <img loading="lazy" alt="Final screenshot for VS Code workflow" src="/Cloud-Native/assets/images/vscode-7-2f28ace0fb1cb00d05da8286d02f310b.png" width="1298" height="896" class="img_ev3q"></p><p>You can test the function locally by visiting the Function Url shown (<code>http://localhost:7071/api/HttpTrigger1</code>) or by opening the <em>Workspace</em> region of the Azure extension, and selecting the <code>Execute Function now</code> menu item as shown.</p><p> <img loading="lazy" alt="Final screenshot for VS Code workflow" src="/Cloud-Native/assets/images/vscode-8-bbc6b836396915dda8611f19a2db7914.png" width="1298" height="713" class="img_ev3q"></p><p>In the latter case, the <code>Enter request body</code> popup will show a pre-populated request of <code>{"name":"Azure"}</code> that you can submit. </p><p> <img loading="lazy" alt="Final screenshot for VS Code workflow" src="/Cloud-Native/assets/images/vscode-9-fe412b128bece77a4f0846dc33f6eb7c.png" width="810" height="86" class="img_ev3q"></p><p> On successful execution, your VS Code window will show a notification as follows. Take note of the console output - it shows the message encoded in <code>index.js</code>.</p><p> <img loading="lazy" alt="Final screenshot for VS Code workflow" src="/Cloud-Native/assets/images/vscode-10-bd3741ae917136d4fdf6cc65960275ac.png" width="670" height="234" class="img_ev3q"></p><p>You can also visit the deployed function URL directly in a local browser - testing the case for a request made with no <code>name</code> payload attached. Note how the response in the browser now shows the non-personalized version of the message!</p><p> <img loading="lazy" alt="Final screenshot for VS Code workflow" src="/Cloud-Native/assets/images/vscode-11-430e971fc73867eb792a9eadac4430f8.png" width="442" height="95" class="img_ev3q"></p><div class="theme-admonition theme-admonition-success alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span><mdxadmonitiontitle>üéâ <strong>Congratulations</strong></mdxadmonitiontitle></div><div class="admonitionContent_S0QG"><p>You created and ran a function app locally!</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="redeploy-to-azure">(Re)Deploy to Azure<a class="hash-link" href="#redeploy-to-azure" title="Direct link to heading">‚Äã</a></h3><p>Now, just follow the <a href="https://docs.microsoft.com/azure/azure-functions/create-first-function-vs-code-node#publish-the-project-to-azure" target="_blank" rel="noopener noreferrer">creating a function app in Azure</a> steps to deploy it to Azure, using an active subscription! The deployed app resource should now show up under the <code>Function App</code> Resources where you can click <code>Execute Function Now</code> to test the Azure-deployed version instead. You can also look up the function URL in the portal and visit that link in your local browser to trigger the function without the name context.</p><div class="theme-admonition theme-admonition-success alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span><mdxadmonitiontitle>üéâ <strong>Congratulations</strong></mdxadmonitiontitle></div><div class="admonitionContent_S0QG"><p>You have an Azure-hosted serverless function app!</p></div></div><p>Challenge yourself and try to <a href="https://docs.microsoft.com/azure/azure-functions/create-first-function-vs-code-node#run-the-function-in-azure" target="_blank" rel="noopener noreferrer">change the code and redeploy</a> to Azure to return something different. <em>You have effectively created a serverless API endpoint!</em> </p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="about-core-tools">About Core Tools<a class="hash-link" href="#about-core-tools" title="Direct link to heading">‚Äã</a></h2><p>That was a lot to cover! In the next few days we'll have more examples for Azure Functions app development - focused on different programming languages. So let's wrap today's post by reviewing two helpful resources.</p><p>First, let's talk about <a href="https://docs.microsoft.com/azure/azure-functions/functions-core-tools-reference?tabs=v2" target="_blank" rel="noopener noreferrer">Azure Functions Core Tools</a> - the command-line tool that lets you develop, manage, and deploy, Azure Functions projects from your <strong>local development environment</strong>. It is used transparently by the VS Code extension - but you can use it directly from a terminal for a powerful command-line end-to-end developer experience! The Core Tools commands are organized into the following contexts:</p><ul><li><a href="https://docs.microsoft.com/azure/azure-functions/functions-core-tools-reference?tabs=v2#func-init" target="_blank" rel="noopener noreferrer"><code>func</code></a> - commands to create and run functions locally</li><li><a href="https://docs.microsoft.com/azure/azure-functions/functions-core-tools-reference?tabs=v2#func-azure-functionapp-fetch-app-settings" target="_blank" rel="noopener noreferrer"><code>func azure</code></a> - work with resource slike Azure Functions and Azure Storage</li><li><a href="https://docs.microsoft.com/azure/azure-functions/functions-core-tools-reference?tabs=v2#func-durable-delete-task-hub" target="_blank" rel="noopener noreferrer"><code>func durable</code></a> - work with Durable Functions</li><li><a href="https://docs.microsoft.com/azure/azure-functions/functions-core-tools-reference?tabs=v2#func-extensions-install" target="_blank" rel="noopener noreferrer"><code>func extensions</code></a> - manage extensions (default nuget.org)</li><li><a href="https://docs.microsoft.com/azure/azure-functions/functions-core-tools-reference?tabs=v2#func-kubernetes-deploy" target="_blank" rel="noopener noreferrer"><code>func kubernetes</code></a> - work with Kubernetes and Azure Functions</li><li><a href="https://docs.microsoft.com/azure/azure-functions/functions-core-tools-reference?tabs=v2#func-settings-decrypt" target="_blank" rel="noopener noreferrer"><code>func settings</code></a> - manage environment settings for local Functions host</li><li><a href="https://docs.microsoft.com/azure/azure-functions/functions-core-tools-reference?tabs=v2#func-templates-list" target="_blank" rel="noopener noreferrer"><code>func templates</code></a> - list available templates</li></ul><p>Learn how to <a href="https://docs.microsoft.com/azure/azure-functions/functions-run-local?tabs=v4%2Cmacos%2Ccsharp%2Cportal%2Cbash" target="_blank" rel="noopener noreferrer">work with Azure Functions Core Tools</a>. Not only can it help with quick command execution, it can also be invaluable for debugging issues that may not always be visible or understandable in an IDE.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="about-local-testing">About Local Testing<a class="hash-link" href="#about-local-testing" title="Direct link to heading">‚Äã</a></h2><p>You might have noticed that the scaffold also produced a <code>local.settings.json</code> file. What is that and why is it useful? By definition, the local.settings.json file <em>"stores app settings and settings used by local development tools. Settings in the local.settings.json file are used only when you're running your project locally."</em></p><p>Read the guidance on <a href="https://docs.microsoft.com/azure/azure-functions/functions-develop-local?WT.mc_id=javascript-74010-ninarasi#local-settings-file" target="_blank" rel="noopener noreferrer">Code and test Azure Functions Locally</a> to learn more about how to configure development environments locally, for your preferred programming language, to support testing and debugging on the local Functions runtime.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="exercise">Exercise<a class="hash-link" href="#exercise" title="Direct link to heading">‚Äã</a></h2><p>We made it! Now it's your turn!! Here are a few things you can try to apply what you learned and reinforce your understanding:</p><ul><li>Walk through this quickstart on your own!</li><li>Then try the <a href="https://docs.microsoft.com/azure/azure-functions/durable/quickstart-js-vscode?WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Durable Functions Quickstart</a> as a stretch goal!</li><li>And take the <a href="https://docs.microsoft.com/learn/challenges?id=b950cd7a-d456-46ab-81ba-3bd1ad86dc1c&amp;WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Cloud Skills Challenge</a> to skill up in fun ways</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="resources">Resources<a class="hash-link" href="#resources" title="Direct link to heading">‚Äã</a></h2><p>Bookmark and visit the <a href="https://aka.ms/30DaysOfServerless/collection" target="_blank" rel="noopener noreferrer">#30DaysOfServerless Collection</a>. It's the one-stop collection of resources we will keep updated with links to relevant documentation and learning resources.</p>]]></content>
        <author>
            <name>Nitya Narasimhan</name>
            <uri>https://github.com/nitya</uri>
        </author>
        <category label="serverless-september" term="serverless-september"/>
        <category label="30-days-of-serverless" term="30-days-of-serverless"/>
        <category label="azure-functions" term="azure-functions"/>
        <category label="vscode" term="vscode"/>
        <category label="devtools" term="devtools"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[04. Functions For Java Devs]]></title>
        <id>04-functions-java</id>
        <link href="https://azure.github.io/Cloud-Native/blog/04-functions-java"/>
        <updated>2022-09-04T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Introducing Azure Functions to the Java Developer. Learn how to create and deploy your first Java Functions app, and where you can go from here.]]></summary>
        <content type="html"><![CDATA[<hr><p>Welcome to <code>Day 4</code> of #30DaysOfServerless!</p><p><em>Yesterday</em> we walked through an Azure Functions Quickstart with JavaScript, and used it to understand the general Functions App structure, tooling and developer experience. </p><p><em>Today</em> we'll look at developing Functions app with a <em>different</em> programming language - namely, <strong>Java</strong> - and explore developer guidance, tools and resources to build serverless Java solutions on Azure.</p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-well-cover">What We'll Cover<a class="hash-link" href="#what-well-cover" title="Direct link to heading">‚Äã</a></h2><ul><li><strong>Developer Guidance</strong>: For Azure Functions on Java</li><li><strong>Build &amp; Deploy</strong>: Our First Java Functions App</li><li><strong>Usage Tutorials</strong>: Integrate App with other Azure Services</li><li><strong>Azure Samples</strong>: Explore samples for other triggers, bindings</li><li><strong>Exercise:</strong> <a href="https://docs.microsoft.com/learn/modules/develop-azure-functions-app-with-maven-plugin/" target="_blank" rel="noopener noreferrer">Develop Java serverless Functions on Azure using Maven</a> </li><li><strong>Resources</strong>: Check out <a href="https://developer.microsoft.com/java/" target="_blank" rel="noopener noreferrer">Java at Microsoft</a> and use <a href="https://aka.ms/JavaYourWay" target="_blank" rel="noopener noreferrer">Java Your Way</a>!</li></ul><p><img loading="lazy" src="/Cloud-Native/assets/images/banner-1fe4ed12e849a9e072fc54371b92edab.png" width="1600" height="672" class="img_ev3q"></p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="developer-guidance">Developer Guidance<a class="hash-link" href="#developer-guidance" title="Direct link to heading">‚Äã</a></h2><p>If you're a Java developer new to serverless on Azure, start by exploring the <a href="https://docs.microsoft.com/azure/azure-functions/functions-reference-java?tabs=bash%2Cconsumption" target="_blank" rel="noopener noreferrer">Azure Functions Java Developer Guide</a>. It covers: </p><ul><li>Quickstarts with <a href="https://docs.microsoft.com/azure/azure-functions/create-first-function-vs-code-java" target="_blank" rel="noopener noreferrer">Visual Studio Code</a> and <a href="https://docs.microsoft.com/azure/azure-functions/create-first-function-cli-java?tabs=bash%2Cazure-cli%2Cbrowser" target="_blank" rel="noopener noreferrer">Azure CLI</a></li><li>Building with Maven-based tooling for <a href="https://docs.microsoft.com/azure/azure-functions/functions-create-first-java-gradle" target="_blank" rel="noopener noreferrer">Gradle</a>, <a href="https://docs.microsoft.com/azure/azure-functions/functions-create-maven-eclipse" target="_blank" rel="noopener noreferrer">Eclipse</a> &amp; <a href="https://docs.microsoft.com/azure/azure-functions/functions-create-maven-intellij" target="_blank" rel="noopener noreferrer">IntelliJ IDEA</a></li><li>Exploring <a href="https://docs.microsoft.com/azure/azure-functions/functions-reference-java?tabs=bash%2Cconsumption#project-scaffolding" target="_blank" rel="noopener noreferrer">project scaffolding</a> &amp; <a href="https://docs.microsoft.com/azure/azure-functions/functions-reference-java?tabs=bash%2Cconsumption#jdk-runtime-availability-and-support" target="_blank" rel="noopener noreferrer">JDK runtimes</a> (Java 8 and Java 11)</li><li>Using <a href="https://docs.microsoft.com/azure/azure-functions/functions-reference-java?tabs=bash%2Cconsumption#triggers-and-annotations" target="_blank" rel="noopener noreferrer">Java annotations for Triggers, Bindings</a> - with <a href="https://docs.microsoft.com/java/api/com.microsoft.azure.functions.annotation?view=azure-java-stable" target="_blank" rel="noopener noreferrer">reference</a> docs.</li><li>Adopting <a href="https://docs.microsoft.com/azure/azure-functions/functions-best-practices?tabs=java" target="_blank" rel="noopener noreferrer">best practices</a> for hosting, reliability and efficiency.</li><li>Java <a href="https://docs.microsoft.com/samples/azure-samples/azure-functions-samples-java/azure-functions-java/" target="_blank" rel="noopener noreferrer">code samples</a> and <a href="https://docs.microsoft.com/azure/azure-functions/functions-event-hub-cosmos-db?tabs=bash" target="_blank" rel="noopener noreferrer">integration tutorials</a></li></ul><p>In this blog post, we'll dive into one quickstart, and discuss other resources briefly, for awareness! Do check out the recommended exercises and resources for self-study! </p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="my-first-java-functions-app">My First Java Functions App<a class="hash-link" href="#my-first-java-functions-app" title="Direct link to heading">‚Äã</a></h2><p>In today's post, we'll walk through the <a href="https://docs.microsoft.com/azure/azure-functions/create-first-function-vs-code-java" target="_blank" rel="noopener noreferrer">Quickstart: Azure Functions</a> tutorial using Visual Studio Code. In the process, we'll setup our development environment with the relevant command-line tools and VS Code extensions to make building Functions app simpler.</p><p><em>Note: Completing this exercise may incur a a cost of a few USD cents based on your Azure subscription. Explore <a href="https://azure.microsoft.com/pricing/details/functions/#pricing" target="_blank" rel="noopener noreferrer">pricing details</a> to learn more</em>.</p><p>First, make sure you have your development environment setup and configured.</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>PRE-REQUISITES</div><div class="admonitionContent_S0QG"><ol><li><strong>An Azure account with an active subscription</strong> - <a href="https://azure.microsoft.com/free/?ref=microsoft.com&amp;utm_source=microsoft.com&amp;utm_medium=docs&amp;utm_campaign=visualstudio" target="_blank" rel="noopener noreferrer">Create an account for free</a></li><li><strong>The Java Development Kit, version 11 or 8.</strong> - <a href="https://docs.microsoft.com/azure/developer/java/fundamentals/java-support-on-azure" target="_blank" rel="noopener noreferrer">Install</a></li><li><strong>Apache Maven, version 3.0 or above.</strong> - <a href="https://maven.apache.org/" target="_blank" rel="noopener noreferrer">Install</a></li><li><strong>Visual Studio Code.</strong> - <a href="https://code.visualstudio.com/" target="_blank" rel="noopener noreferrer">Install</a></li><li><strong>The Java extension pack</strong> - <a href="https://marketplace.visualstudio.com/items?itemName=vscjava.vscode-java-pack" target="_blank" rel="noopener noreferrer">Install</a></li><li><strong>The Azure Functions extension for Visual Studio Code</strong> - <a href="https://marketplace.visualstudio.com/items?itemName=ms-azuretools.vscode-azurefunctions" target="_blank" rel="noopener noreferrer">Install</a></li></ol></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="vs-code-setup">VS Code Setup<a class="hash-link" href="#vs-code-setup" title="Direct link to heading">‚Äã</a></h3><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>NEW TO VISUAL STUDIO CODE?</div><div class="admonitionContent_S0QG"><p>Start with the <a href="https://code.visualstudio.com/docs/languages/java" target="_blank" rel="noopener noreferrer">Java in Visual Studio Code</a> tutorial to jumpstart your learning!</p></div></div><p>Install the <a href="https://marketplace.visualstudio.com/items?itemName=vscjava.vscode-java-pack" target="_blank" rel="noopener noreferrer">Extension Pack for Java</a> (shown below) to install 6 popular extensions to help development workflow from creation to testing, debugging, and deployment.</p><p><img loading="lazy" alt="Extension Pack for Java" src="/Cloud-Native/assets/images/java-extensions-5c720de054b0eda999f162bc9a49955a.png" width="973" height="573" class="img_ev3q"></p><p>Now, it's time to get started on our first Java-based Functions app.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-create-app">1. Create App<a class="hash-link" href="#1-create-app" title="Direct link to heading">‚Äã</a></h3><ol><li><p>Open a command-line terminal and create a folder for your project. Use the <code>code</code> command to launch Visual Studio Code from that directory as shown:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">mkdir</span><span class="token plain"> java-function-resource-group-api</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token builtin class-name">cd</span><span class="token plain"> java-function-resource-group-api</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ code </span><span class="token builtin class-name">.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Open the Visual Studio Command Palette (<kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>p</kbd>) and select <code>Azure Functions: create new project</code> to kickstart the create workflow. Alternatively, you can click the Azure icon (on activity sidebar), to get the <code>Workspace</code> window,  click "+" and pick the "Create Function" option as shown below.</p><p><img loading="lazy" alt="Screenshot of creating function in Azure from Visual Studio Code." src="/Cloud-Native/assets/images/32-create-new-project-07d80b09a19bd07e1de4b7cb9727481e.png" width="1128" height="512" class="img_ev3q"></p></li><li><p>This triggers a multi-step workflow. Fill in the information for each step as shown in the following prompts. <strong>Important:</strong> Start this process from an empty folder - the workflow will populate it with the scaffold for your Java-based Functions app.</p><table><thead><tr><th>Prompt</th><th>Value</th></tr></thead><tbody><tr><td><strong>Choose the directory location.</strong></td><td>You should either create a new folder or choose an empty folder for the project workspace. Don't choose a project folder that is already part of a workspace.</td></tr><tr><td><strong>Select a language</strong></td><td>Choose <code>Java</code>.</td></tr><tr><td><strong>Select a version of Java</strong></td><td>Choose <code>Java 11</code> or <code>Java 8</code>, the Java version on which your functions run in Azure. Choose a Java version that you've verified locally.</td></tr><tr><td><strong>Provide a group ID</strong></td><td>Choose <code>com.function</code>.</td></tr><tr><td><strong>Provide an artifact ID</strong></td><td>Enter <code>myFunction</code>.</td></tr><tr><td><strong>Provide a version</strong></td><td>Choose <code>1.0-SNAPSHOT</code>.</td></tr><tr><td><strong>Provide a package name</strong></td><td>Choose <code>com.function</code>.</td></tr><tr><td><strong>Provide an app name</strong></td><td>Enter <code>HttpExample</code>.</td></tr><tr><td><strong>Select the build tool for Java project</strong></td><td>Choose <code>Maven</code>.</td></tr></tbody></table></li></ol><p>Visual Studio Code uses the provided information and generates an Azure Functions project. You can view the local project files in the Explorer - it should look like this:</p><p><img loading="lazy" alt="Azure Functions Scaffold For Java" src="/Cloud-Native/assets/images/java-scaffold-4b46320f72ecaf9273320f0a21af381a.png" width="1458" height="897" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-preview-app">2. Preview App<a class="hash-link" href="#2-preview-app" title="Direct link to heading">‚Äã</a></h3><p>Visual Studio Code integrates with the Azure Functions Core tools to let you run this project on your local development computer before you publish to Azure.</p><ol><li><p>To build and run the application, use the following Maven command. You should see output similar to that shown below.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ mvn clean package azure-functions:run</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Now listening on: http://0.0.0.0:7071</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Application started. Press Ctrl+C to shut down.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Http Functions:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  HttpExample: </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">GET,POST</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> http://localhost:7071/api/HttpExample</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Copy the URL of your HttpExample function from this output to a browser and append the query string <strong>?name=&lt;YOUR_NAME&gt;</strong>, making the full URL something like <code>http://localhost:7071/api/HttpExample?name=Functions</code>. The browser should display a message that echoes back your query string value. The terminal in which you started your project also shows log output as you make requests.</p></li></ol><div class="theme-admonition theme-admonition-success alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>üéâ CONGRATULATIONS</div><div class="admonitionContent_S0QG"><p>You created and ran a function app locally!</p></div></div><p>With the <strong>Terminal</strong> panel focused, press <kbd>Ctrl + C</kbd> to stop Core Tools and disconnect the debugger. After you've verified that the function runs correctly on your local computer, it's time to use Visual Studio Code and Maven to publish and test the project on Azure.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-sign-into-azure">3. Sign into Azure<a class="hash-link" href="#3-sign-into-azure" title="Direct link to heading">‚Äã</a></h3><p>Before you can deploy, sign in to your Azure subscription.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">az login</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The az login command signs you into your Azure account.</p><p>Use the following command to deploy your project to a new function app.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mvn clean package azure-functions:deploy</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>When the creation is complete, the following Azure resources are created in your subscription:</p><ul><li>Resource group. Named as java-functions-group.</li><li>Storage account. Required by Functions. The name is generated randomly based on Storage account name requirements.</li><li>Hosting plan. Serverless hosting for your function app.The name is <em>java-functions-app-service-plan</em>.</li><li>Function app. A function app is the deployment and execution unit for your functions. The name is randomly generated based on your artifactId, appended with a randomly generated number.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-deploy-app">4. Deploy App<a class="hash-link" href="#4-deploy-app" title="Direct link to heading">‚Äã</a></h3><ol><li><p>Back in the <strong>Resources</strong> area in the side bar, expand your subscription, your new function app, and <strong>Functions</strong>. Right-click (Windows) or <kbd>Ctrl -</kbd> click (macOS) the <code>HttpExample</code> function and choose <strong>Execute Function Now...</strong>.</p><p><img loading="lazy" alt="Screenshot of executing function in Azure from Visual Studio Code." src="/Cloud-Native/assets/images/32-execute-function-now-917cb96cfd96a78734f14c35ec707ad0.png" width="964" height="587" class="img_ev3q"></p></li><li><p>In <strong>Enter request body</strong> you see the request message body value of <code>{ "name": "Azure" }</code>. Press Enter to send this request message to your function.</p></li><li><p>When the function executes in Azure and returns a response, a notification is raised in Visual Studio Code.</p></li></ol><p>You can also copy the complete Invoke URL shown in the output of the publish command into a browser address bar, appending the query parameter ?name=Functions. The browser should display similar output as when you ran the function locally.</p><div class="theme-admonition theme-admonition-success alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>üéâ CONGRATULATIONS</div><div class="admonitionContent_S0QG"><p>You deployed your function app to Azure, and invoked it!</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-clean-up">5. Clean up<a class="hash-link" href="#5-clean-up" title="Direct link to heading">‚Äã</a></h3><p>Use the following command to delete the resource group and all its contained resources to avoid incurring further costs.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">az group delete --name java-functions-group</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="next-steps">Next Steps<a class="hash-link" href="#next-steps" title="Direct link to heading">‚Äã</a></h2><p>So, where can you go from here? The example above used a familiar <code>HTTP Trigger</code> scenario with a single Azure service (Azure Functions). Now, think about how you can build richer workflows by using other triggers and integrating with other Azure or third-party services.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="other-triggers-bindings">Other Triggers, Bindings<a class="hash-link" href="#other-triggers-bindings" title="Direct link to heading">‚Äã</a></h3><p>Check out <a href="https://docs.microsoft.com/samples/azure-samples/azure-functions-samples-java/azure-functions-java/" target="_blank" rel="noopener noreferrer">Azure Functions Samples In Java</a> for samples (and short use cases) that highlight other triggers - with code! This includes triggers to integrate with CosmosDB, Blob Storage, Event Grid, Event Hub, Kafka and more.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="scenario-with-integrations">Scenario with Integrations<a class="hash-link" href="#scenario-with-integrations" title="Direct link to heading">‚Äã</a></h3><p>Once you've tried out the samples, try building an end-to-end scenario by using these triggers to integrate seamlessly with other Services. Here are a couple of useful tutorials:</p><ul><li>Azure Functions with <a href="https://docs.microsoft.com/azure/azure-functions/functions-event-hub-cosmos-db?tabs=bash" target="_blank" rel="noopener noreferrer">Event Hub trigger and CosmosDB output binding</a></li><li>GitHub Star Count app with <a href="https://docs.microsoft.com/azure/azure-signalr/signalr-quickstart-azure-functions-java?toc=%2Fazure%2Fazure-functions%2Ftoc.json" target="_blank" rel="noopener noreferrer">SignalR trigger</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="exercise">Exercise<a class="hash-link" href="#exercise" title="Direct link to heading">‚Äã</a></h2><p>Time to put this into action and validate your development workflow:</p><ul><li>Walk through this tutorial yourself, and deploy your first function!</li><li>Complete the <a href="https://docs.microsoft.com/learn/modules/develop-azure-functions-app-with-maven-plugin/" target="_blank" rel="noopener noreferrer">Develop Java serverless Functions on Azure using Maven</a> module</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="resources">Resources<a class="hash-link" href="#resources" title="Direct link to heading">‚Äã</a></h2><ul><li><a href="https://docs.microsoft.com/azure/azure-functions/create-first-function-vs-code-java" target="_blank" rel="noopener noreferrer">Azure Functions: Java Quickstarts</a></li><li><a href="https://docs.microsoft.com/learn/paths/best-practices-java-azure/" target="_blank" rel="noopener noreferrer">Best Practices for Java Apps On Azure</a></li><li><a href="https://developer.microsoft.com/java/" target="_blank" rel="noopener noreferrer">Java at Microsoft</a> </li><li><a href="https://docs.microsoft.com/azure/azure-functions/functions-event-hub-cosmos-db?tabs=bash" target="_blank" rel="noopener noreferrer">Java with EventHub Trigger and CosmosDB Binding</a></li><li><a href="https://docs.microsoft.com/azure/azure-signalr/signalr-quickstart-azure-functions-java?toc=%2Fazure%2Fazure-functions%2Ftoc.json" target="_blank" rel="noopener noreferrer">Java Integrations: Azure Functions and SignalR</a></li><li><a href="https://docs.microsoft.com/samples/browse/?products=azure-functions&amp;languages=java" target="_blank" rel="noopener noreferrer">Java Samples: Azure Functions</a></li></ul>]]></content>
        <author>
            <name>Rory Preddy</name>
            <uri>https://github.com/roryp</uri>
        </author>
        <category label="serverless-september" term="serverless-september"/>
        <category label="azure-functions" term="azure-functions"/>
        <category label="java" term="java"/>
        <category label="serverless" term="serverless"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[05. Functions for JS Devs]]></title>
        <id>05-functions-js</id>
        <link href="https://azure.github.io/Cloud-Native/blog/05-functions-js"/>
        <updated>2022-09-05T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Introduction to Azure Functions, from core concepts to hello world!]]></summary>
        <content type="html"><![CDATA[<hr><p>Welcome to <code>Day 5</code> of #30DaysOfServerless!</p><p><em>Yesterday</em> we looked at Azure Functions from the perspective of a Java developer. <em>Today</em>, we'll do a similar walkthrough from the perspective of a JavaScript developer. </p><p>And, we'll use this to explore another popular usage scenario for Azure Functions: <strong>building a serverless HTTP API using JavaScript</strong>. </p><p>Ready? Let's go.</p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-well-cover">What We'll Cover<a class="hash-link" href="#what-well-cover" title="Direct link to heading">‚Äã</a></h2><ul><li>Developer Guidance</li><li>Create Azure Function with CLI</li><li>Calling an external API</li><li>Azure Samples &amp; Scenarios for JS</li><li>Exercise: Support searching</li><li>Resources: For self-study!</li></ul><p><img loading="lazy" src="/Cloud-Native/assets/images/banner-9887d529ebe65c9a0d6bdc2a9ad3af3d.png" width="1600" height="672" class="img_ev3q"></p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="developer-guidance">Developer Guidance<a class="hash-link" href="#developer-guidance" title="Direct link to heading">‚Äã</a></h2><p>If you're a JavaScript developer new to serverless on Azure, start by exploring the <a href="https://docs.microsoft.com/azure/azure-functions/functions-reference-node?tabs=v2-v3-v4-export%2Cv2-v3-v4-done%2Cv2%2Cv2-log-custom-telemetry%2Cv2-accessing-request-and-response%2Cwindows-setting-the-node-version&amp;WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Azure Functions JavaScript Developers Guide</a>. It covers:</p><ul><li>Quickstarts for Node.js - using Visual Code, CLI or Azure Portal</li><li>Guidance on hosting options and performance considerations</li><li>Azure Functions <a href="https://docs.microsoft.com/azure/azure-functions/functions-triggers-bindings?tabs=javascript#bindings-code-examples?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">bindings</a> and (<a href="https://docs.microsoft.com/samples/browse/?products=azure-functions&amp;languages=javascript&amp;WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">code samples</a>) for JavaScript</li><li>Scenario examples - integrations with other Azure Services</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="nodejs-18-support">Node.js 18 Support<a class="hash-link" href="#nodejs-18-support" title="Direct link to heading">‚Äã</a></h3><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Node.js 18 Support (Public Preview)</div><div class="admonitionContent_S0QG"><p>Azure Functions support for Node.js 18 <a href="https://azure.microsoft.com/updates/public-preview-nodejs-18-in-azure-functions/?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">entered Public Preview on Aug 31, 2022</a> and is supported by the <a href="https://docs.microsoft.com/azure/azure-functions/functions-versions?tabs=azure-cli%2Cin-process%2Cv4&amp;pivots=programming-language-javascript&amp;WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Azure Functions v.4.x runtime!</a></p></div></div><p>As we continue to explore how we can use Azure Functions, today we're going to look at using JavaScript to create one, and we're going to be using the newly released <strong>Node.js 18 support for Azure Functions</strong> to make the most out of the platform. </p><p>Ensure you have Node.js 18 and Azure Functions v4.x versions installed, along with a text editor (I'll use VS Code in this post), and a terminal, then we're ready to go.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="scenario-calling-the-github-api">Scenario: Calling The GitHub API<a class="hash-link" href="#scenario-calling-the-github-api" title="Direct link to heading">‚Äã</a></h2><p>The application we're going to be building today will use the GitHub API to return a random commit message, so that we don't need to come up with one ourselves! After all, naming things can be really hard! ü§£ </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="creating-the-azure-function">Creating the Azure Function<a class="hash-link" href="#creating-the-azure-function" title="Direct link to heading">‚Äã</a></h3><p>To create our Azure Function, we're going to use the <a href="https://docs.microsoft.com/azure/azure-functions/functions-run-local?tabs=v4%2Cwindows%2Ccsharp%2Cportal%2Cbash&amp;WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Azure Functions CLI</a>, which we can install using npm:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">npm</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> --global azure-function-core-tools</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Once that's installed, we can use the new <code>func</code> command to initalise our project:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">func init --worker-runtime </span><span class="token function" style="color:#d73a49">node</span><span class="token plain"> --language javascript</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>When running <code>func init</code> we can either provide the <code>worker-runtime</code> and <code>language</code> as arguments, or use the menu system that the tool will provide us. For brevity's stake, I've used the arguments here, specifying that we want <code>node</code> as the runtime and <code>javascript</code> as the language, but you could change that to <code>typescript</code> if you'd prefer to use TypeScript.</p><p>Once the <code>init</code> command is completed, you should have a <code>.vscode</code> folder, and the files <code>.gitignore</code>, <code>host.json</code>, <code>local.settings.json</code>, and <code>package.json</code>.</p><p><img loading="lazy" alt="Files generated by func init" src="data:image/png;base64,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#gh-light-mode-only" width="393" height="145" class="img_ev3q"><img loading="lazy" alt="Files generated by func init" src="/Cloud-Native/assets/images/01-4fcbf1e505abbc007af37bacc7f5a648.png#gh-dark-mode-only" width="398" height="151" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="adding-a-http-trigger">Adding a HTTP Trigger<a class="hash-link" href="#adding-a-http-trigger" title="Direct link to heading">‚Äã</a></h3><p>We have an empty Functions app so far, what we need to do next is create a Function that it will run, and we're going to make a HTTP Trigger Function, which is a Function that responds to HTTP requests. We'll use the <code>func new</code> command to create that:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">func new --template </span><span class="token string" style="color:#e3116c">"HTTP Trigger"</span><span class="token plain"> --name </span><span class="token string" style="color:#e3116c">"get-commit-message"</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>When this completes, we'll have a folder for the Function, using the name we provided, that contains the files<code>function.json</code> and <code>index.js</code>. Let's open the <code>function.json</code> to understand it a little bit:</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">"bindings"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">"authLevel"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"function"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">"type"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"httpTrigger"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">"direction"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"in"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">"name"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"req"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">"methods"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">"get"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">"post"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">"type"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"http"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">"direction"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"out"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">"name"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"res"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This file is used to tell Functions about the Function that we've created and what it does, so it knows to handle the appropriate events. We have a <code>bindings</code> node which contains the event bindings for our Azure Function. The first binding is using the <code>type</code> <code>httpTrigger</code>, which indicates that it'll be executed, or <em>triggered</em>, by a HTTP event, and the <code>methods</code> indicates that it's listening to both <strong>GET</strong> and <strong>POST</strong> (you can change this for the right HTTP methods that you want to support). The HTTP request information will be bound to a property in the Functions context called <code>req</code>, so we can access query strings, the request body, etc.</p><p>The other binding we have has the direction of <code>out</code>, meaning that it's something that the Function will <em>return</em> to the called, and since this is a HTTP API, the <code>type</code> is <code>http</code>, indicating that we'll return a HTTP response, and that response will be on a property called <code>res</code> that we add to the Functions context.</p><p>Let's go ahead and start the Function and call it:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">func start</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="Starting the Function" src="/Cloud-Native/assets/images/02-5465d74b194eeb2b24c1e07527101c4d.png#gh-light-mode-only" width="979" height="332" class="img_ev3q"><img loading="lazy" alt="Starting the Function" src="/Cloud-Native/assets/images/02-fac7c01dc73086fb13b94fce2598287d.png#gh-dark-mode-only" width="977" height="321" class="img_ev3q"></p><p>With the Function started, access the endpoint <code>http://localhost:7071/api/get-commit-message</code> via a browser or using <code>cURL</code>:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> http://localhost:7071/api/get-commit-message</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">?name</span><span class="token punctuation" style="color:#393A34">\</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">ServerlessSeptember</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="Hello from Azure Functions" src="/Cloud-Native/assets/images/03-46daa7bf98bd7e984487f9dbac0352f8.png#gh-light-mode-only" width="1327" height="94" class="img_ev3q"><img loading="lazy" alt="Hello from Azure Functions" src="/Cloud-Native/assets/images/03-5b84201a90f55af098a07a30fb6f9c27.png#gh-dark-mode-only" width="1356" height="45" class="img_ev3q"></p><div class="theme-admonition theme-admonition-success alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>üéâ CONGRATULATIONS</div><div class="admonitionContent_S0QG"><p>You created and ran a JavaScript function app locally!</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="calling-an-external-api">Calling an external API<a class="hash-link" href="#calling-an-external-api" title="Direct link to heading">‚Äã</a></h3><p>It's time to update the Function to do what we want to do - call the GitHub Search API and get some commit messages. The endpoint that we'll be calling is <a href="https://api.github.com/search/commits?q=language:javascript" target="_blank" rel="noopener noreferrer">https://api.github.com/search/commits?q=language:javascript</a>.</p><p><em>Note: The GitHub API is <a href="https://docs.github.com/en/rest/overview/resources-in-the-rest-api#rate-limiting" target="_blank" rel="noopener noreferrer">rate limited</a> and this sample will call it unauthenticated, so be aware of that in your own testing.</em></p><p>To call this API, we'll leverage the newly released <a href="https://nodejs.org/en/blog/announcements/v18-release-announce/#fetch-experimental" target="_blank" rel="noopener noreferrer"><code>fetch</code> support in Node 18</a> and <code>async</code>/<code>await</code>, to make for a very clean Function.</p><p>Open up the <code>index.js</code> file, and delete the contents of the existing <code>Function</code>, so we have a empty one:</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method-variable function-variable method function property-access" style="color:#d73a49">exports</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">context</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> req</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><em>The default template uses CommonJS, but you can use ES Modules with Azure Functions if you prefer.</em></p><p>Now we'll use <code>fetch</code> to call the API, and unpack the JSON response:</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method-variable function-variable method function property-access" style="color:#d73a49">exports</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">context</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> req</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> res </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">fetch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"https://api.github.com/search/commits?q=language:javascript"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> json </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> res</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">json</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> messages </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> json</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">items</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">map</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">item</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> item</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">commit</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">message</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">res</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">body</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            messages</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>To send a response to the client, we're setting the <code>context.res</code> property, where <code>res</code> is the name of the output binding in our <code>function.json</code>, and giving it a body that contains the commit messages.</p><p>Run <code>func start</code> again, and call the endpoint:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> http://localhost:7071/api/get-commit-message</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The you'll get some commit messages:</p><p><img loading="lazy" alt="A series of commit messages from the GitHub Search API" src="/Cloud-Native/assets/images/04-e5fe925bdf149b76462f6d163e70184b.png#gh-light-mode-only" width="1085" height="741" class="img_ev3q"><img loading="lazy" alt="A series of commit messages from the GitHub Search API" src="/Cloud-Native/assets/images/04-a2f00f010001f8e8bdd45e60a8e4fb9d.png#gh-dark-mode-only" width="1877" height="690" class="img_ev3q"></p><div class="theme-admonition theme-admonition-success alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>üéâ CONGRATULATIONS</div><div class="admonitionContent_S0QG"><p>There we go, we've created an Azure Function which is used as a proxy to another API, that we call (using native <code>fetch</code> in Node.js 18) and from which we return a subset of the JSON payload.</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="next-steps">Next Steps<a class="hash-link" href="#next-steps" title="Direct link to heading">‚Äã</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="other-triggers-bindings">Other Triggers, Bindings<a class="hash-link" href="#other-triggers-bindings" title="Direct link to heading">‚Äã</a></h3><p>This article focused on using the HTTPTrigger and relevant bindings, to build a serverless API using Azure Functions. How can you explore other supported bindings, with code samples to illustrate usage?</p><ul><li>Start with the <a href="https://docs.microsoft.com/azure/azure-functions/functions-triggers-bindings?tabs=javascript#bindings-code-examples?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Bindings</a> documentation to get a list of supported triggers/bindings for JavaScript</li><li>Explore the <a href="https://www.serverlesslibrary.net/?language=JavaScript" target="_blank" rel="noopener noreferrer">Azure serverless community library</a> and <a href="https://docs.microsoft.com/samples/browse/?products=azure-functions&amp;languages=javascript&amp;WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Azure Samples</a> resources by technology.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="scenarios-with-integrations">Scenarios with Integrations<a class="hash-link" href="#scenarios-with-integrations" title="Direct link to heading">‚Äã</a></h3><p>Once you've tried out the samples, try building an end-to-end scenario by using these triggers to integrate seamlessly with other services. Here are some suggestions:</p><ul><li><a href="https://docs.microsoft.com/azure/azure-functions/functions-bindings-storage-queue?tabs=in-process%2Cextensionv5%2Cextensionv3&amp;pivots=programming-language-javascript&amp;WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Azure Queue storage trigger and bindings</a></li><li><a href="https://docs.microsoft.com/azure/azure-signalr/signalr-quickstart-azure-functions-javascript?toc=%2Fazure%2Fazure-functions%2Ftoc.json&amp;WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Show GitHub start count with Azure SignalR service</a></li><li><a href="https://docs.microsoft.com/azure/developer/javascript/how-to/with-web-app/graphql/azure-function-hello-world?tabs=visualstudiocode&amp;WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Deploy a GraphQL API as an Azure Function</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="exercise-support-searching">Exercise: Support searching<a class="hash-link" href="#exercise-support-searching" title="Direct link to heading">‚Äã</a></h2><p>The GitHub Search API allows you to provide search parameters via the <code>q</code> query string. In this sample, we hard-coded it to be <code>language:javascript</code>, but as a follow-on exercise, expand the Function to allow the caller to provide the search terms as a query string to the Azure Function, which is passed to the GitHub Search API. Hint - have a look at the <code>req</code> argument.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="resources">Resources<a class="hash-link" href="#resources" title="Direct link to heading">‚Äã</a></h2><ul><li><a href="https://azure.microsoft.com/updates/public-preview-nodejs-18-in-azure-functions/?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Public preview of Node.js 18 for Azure Functions</a></li><li><a href="https://nodejs.org/en/blog/announcements/v18-release-announce/#fetch-experimental" target="_blank" rel="noopener noreferrer"><code>fetch</code> support in Node.js 18</a></li><li><a href="https://docs.microsoft.com/learn/modules/shift-nodejs-express-apis-serverless/?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Refactor Node.js and Express APIs to Serverless APIs with Azure Functions</a></li></ul>]]></content>
        <author>
            <name>Aaron Powell</name>
            <uri>https://github.com/aaronpowell</uri>
        </author>
        <category label="serverless-september" term="serverless-september"/>
        <category label="30-days-of-serverless" term="30-days-of-serverless"/>
        <category label="azure-functions" term="azure-functions"/>
        <category label="azure-container-apps" term="azure-container-apps"/>
        <category label="javascript" term="javascript"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[üöÄ | Go Cloud Native with ACA]]></title>
        <id>zero2hero-aca-01</id>
        <link href="https://azure.github.io/Cloud-Native/blog/zero2hero-aca-01"/>
        <updated>2022-09-06T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[In this article, we discuss how Azure Container Apps is purpose-built to support cloud native applications.]]></summary>
        <content type="html"><![CDATA[<hr><p>Welcome to <code>Day 6</code> of #30DaysOfServerless!</p><p>Today, we have a special set of posts from our <a href="/Cloud-Native/serverless-september/ZeroToHero">Zero To Hero üöÄ</a> initiative, featuring blog posts authored by our Product Engineering teams for #ServerlessSeptember. <em>Posts were originally published on the <a href="https://techcommunity.microsoft.com/t5/apps-on-azure-blog/go-cloud-native-with-azure-container-apps/ba-p/3616407?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Apps on Azure</a> blog on Microsoft Tech Community.</em></p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-well-cover">What We'll Cover<a class="hash-link" href="#what-well-cover" title="Direct link to heading">‚Äã</a></h2><ul><li>Defining Cloud Native</li><li>Introduction to Azure Container Apps</li><li>Dapr In Azure Container Apps</li><li>Conclusion</li></ul><p><img loading="lazy" src="/Cloud-Native/assets/images/zero-to-hero-kendall-b022e8dde332ed17596b3cd761631148.png" width="1600" height="672" class="img_ev3q"></p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="defining-cloud-native">Defining Cloud Native<a class="hash-link" href="#defining-cloud-native" title="Direct link to heading">‚Äã</a></h2><p>While I‚Äôm positive I‚Äôm not the first person to ask this, I think it‚Äôs an appropriate way for us to kick off this article: <strong>‚ÄúHow many developers does it take to define cloud native?‚Äù</strong> I hope you aren‚Äôt waiting for a punch line because I seriously want to know your thoughts (drop your perspectives in the comments..) but if you ask me, the limit does not exist!</p><p>A quick online search of the topic returns a laundry list of articles, e-books, twitter threads, etc. all trying to nail down the one true definition. While diving into the rabbit hole of cloud native, you will inevitably find yourself on the Cloud Native Computing Foundation (CNCF) site. The CNCF is part of the Linux Foundation and aims to make "cloud native computing ubiquitous" through deep open source project and community involvement. The CNCF has also published arguably the most popularized definition of cloud native which begins with the following statement:</p><blockquote><p>‚ÄúCloud native technologies empower organizations to build and run scalable applications in modern, dynamic environments such as public, private, and hybrid clouds."</p></blockquote><p>Over the past four years, my day-to-day work has been driven primarily by the surging demand for application containerization and the drastic adoption of Kubernetes as the de-facto container orchestrator. Customers are eager to learn and leverage patterns, practices and technologies that enable building "loosely coupled systems that are resilient, manageable, and observable". Enterprise developers at these organizations are being tasked with rapidly deploying event-driven, horizontally-scalable, polyglot services via repeatable, code-to-cloud pipelines.</p><p>While building cloud native solutions can enable rapid innovation, the transition to adopting a cloud native architectural approach comes with a steep learning curve and a new set of considerations. In a document published by Microsoft called What is Cloud Native?, there are a few key areas highlighted to aid customers in the adoption of best practices for building modern, portable applications which I will summarize below:</p><p><strong>Cloud infrastructure</strong></p><ul><li>Cloud native applications leverage cloud infrastructure and make use of Platform-as-a-service offerings</li><li>Cloud native applications depend on highly-elastic infrastructure with automatic scaling, self-healing, and monitoring capabilities</li></ul><p><strong>Modern application design</strong></p><ul><li>Cloud native applications should be constructed using principles outlined in the 12 factor methodology</li></ul><p><strong>Microservices</strong></p><ul><li>Cloud native applications are typically composed of microservices where each core function, or service, is built and deployed independently</li></ul><p><strong>Containers</strong></p><ul><li>Cloud native applications are typically deployed using containers as a packaging mechanism where an application's code and dependencies are bundled together for consistency of deployment</li><li>Cloud native applications leverage container orchestration technologies- primarily Kubernetes- for achieving capabilities such as workload scheduling, self-healing, auto-scale, etc.</li></ul><p><strong>Backing services</strong></p><ul><li>Cloud native applications are ideally stateless workloads which retrieve and store data in data stores external to the application hosting infrastructure. Cloud providers like Azure provide an array of backing data services which can be securely accessed from application code and provide capabilities for ensuring application data is highly-available</li></ul><p><strong>Automation</strong></p><ul><li>Cloud native solutions should use deployment automation for backing cloud infrastructure via versioned, parameterized Infrastructure as Code (IaC) templates which provide a consistent, repeatable process for provisioning cloud resources.</li><li>Cloud native solutions should make use of modern CI/CD practices and pipelines to ensure successful, reliable infrastructure and application deployment.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="azure-container-apps">Azure Container Apps<a class="hash-link" href="#azure-container-apps" title="Direct link to heading">‚Äã</a></h2><p>In many of the conversations I've had with customers that involve talk of Kubernetes and containers, the topics of cost-optimization, security, networking, and reducing infrastructure and operations inevitably arise. I personally have yet to meet with any customers eager to have their developers get more involved with infrastructure concerns.</p><p>One of my former colleagues, Jeff Hollan, made a statement while appearing on a 2019 episode of The Cloud Native Show where he shared his perspective on Cloud Native:</p><blockquote><p>"When I think about cloud native... it's writing applications in a way where you are specifically thinking about the benefits the cloud can provide... to me, serverless is the perfect realization of that because the only reason you can write serverless applications is because the cloud exists."</p></blockquote><p>I must say that I agree with Jeff's perspective. In addition to optimizing development practices for the cloud native world, reducing infrastructure exposure and operations is equally as important to many organizations and can be achieved as a result of cloud platform innovation.</p><p>In May of 2022, Microsoft announced the general availability of Azure Container Apps. Azure Container Apps provides customers with the ability to run microservices and containerized applications on a serverless, consumption-based platform. </p><p>For those interested in taking advantage of the open source ecosystem while reaping the benefits of a managed platform experience, Container Apps run on Kubernetes and provides a set of managed open source projects embedded directly into the platform including the Kubernetes Event Driven Autoscaler (KEDA), the Distributed Application Runtime (Dapr) and Envoy.</p><p><img loading="lazy" src="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/401287i073CFBD50CB3A0B9/image-size/large?v=v2&amp;px=999&amp;WT.mc_id=javascript-74010-cxa" alt="Azure Kubernetes Service vs. Azure Container Apps" class="img_ev3q"></p><p>Container apps provides other cloud native features and capabilities in addition to those above including, but not limited to: </p><ul><li><a href="https://docs.microsoft.com/azure/container-apps/application-lifecycle-management?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Revisions</a>: immutable snapshot representative of a specific version of a container app which can take advantage of the <a href="https://docs.microsoft.com/azure/container-apps/revisions-manage?tabs=bash&amp;WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">managed traffic splitting capability</a> </li><li><a href="https://docs.microsoft.com/azure/container-apps/health-probes?tabs=arm-template?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Health probes</a>: Based on <a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Kubernetes health probes</a> with support for Readiness, Liveness and Startup </li><li><a href="https://docs.microsoft.com/azure/container-apps/authentication-openid?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Built-in authentication</a></li><li><a href="https://docs.microsoft.com/azure/container-apps/managed-identity?tabs=portal%2Cdotnet&amp;WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Managed Identity</a></li><li><a href="https://docs.microsoft.com/azure/container-apps/custom-domains-certificates?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Custom domain names and certificates</a></li><li><a href="https://docs.microsoft.com/azure/container-apps/networking?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Virtual Network injection</a></li><li><a href="https://docs.microsoft.com/azure/container-apps/observability?tabs=bash&amp;WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Platform observability</a> : log streaming, console connect, Azure monitor </li></ul><p>The ability to dynamically scale and support growing numbers of users, events, and requests is one of the core requirements for most cloud native, distributed applications. Azure Container Apps is purpose-built with this and other cloud native tenants in mind. </p><p><img loading="lazy" src="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/401522iACA9C8FFC49FE161/image-size/large?v=v2&amp;px=999" alt="What can you build with Azure Container Apps?" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="dapr-in-azure-container-apps">Dapr in Azure Container Apps<a class="hash-link" href="#dapr-in-azure-container-apps" title="Direct link to heading">‚Äã</a></h2><p>As a quick personal note before we dive into this section I will say I am a bit bias about Dapr. When Dapr was first released, I had an opportunity to immediately get involved and became an early advocate for the project. It is created by developers for developers, and solves tangible problems customers architecting distributed systems face:</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>HOW DO I</div><div class="admonitionContent_S0QG"><ul><li>integrate with external systems that my app has to react and respond to?</li><li>create event driven apps which reliably send events from one service to another?</li><li>observe the calls and events between my services to diagnose issues in production?</li><li>access secrets securely from within my application?</li><li>discover other services and call methods on them?</li><li>prevent committing to a technology early and have the flexibility to swap out an alternative based on project or environment changes?</li></ul></div></div><p>While existing solutions were in the market which could be used to address some of the concerns above, there was not a lightweight, CNCF-backed project which could provide a unified approach to solve the more fundamental ask from customers: "How do I make it easy for developers to build microservices based on cloud native best practices?"</p><div class="theme-admonition theme-admonition-success alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Enter Dapr!</div><div class="admonitionContent_S0QG"><p>The <a href="https://dapr.io/" target="_blank" rel="noopener noreferrer">Distributed Application Runtime (Dapr)</a> provides APIs that simplify microservice connectivity. Whether your communication pattern is service to service invocation or pub/sub messaging, Dapr helps you write resilient and secured microservices. By letting Dapr‚Äôs sidecar take care of the complex challenges such as service discovery, message broker integration, encryption, observability, and secret management, you can focus on business logic and keep your code simple."</p></div></div><p>The Container Apps platform provides a managed and supported Dapr integration which eliminates the need for deploying and managing the Dapr OSS project. In addition to providing managed upgrades, the platform also exposes a simplified Dapr interaction model to increase developer productivity and reduce the friction required to leverage Dapr capabilities. While the Dapr integration makes it easier for customers to adopt cloud native best practices in container apps it is not required to make use of the container apps platform. </p><p><img loading="lazy" src="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/401284iA1296A6F33D804B2/image-size/large?v=v2&amp;px=999" alt="Image on Dapr" class="img_ev3q"></p><p>For additional insight into the dapr integration visit aka.ms/aca-dapr. </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a class="hash-link" href="#conclusion" title="Direct link to heading">‚Äã</a></h2><p>Backed by and integrated with powerful cloud native technologies, Azure Container Apps strives to make developers productive, while reducing the operational overhead and learning curve that typically accompanies adopting a cloud-native strategy. </p><p>If you are interested in building resilient, portable and highly-scalable apps visit <a href="https://azure.microsoft.com/services/container-apps/" target="_blank" rel="noopener noreferrer">Azure Container Apps | Microsoft Azure</a> today!</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>ASK THE EXPERT: LIVE Q&amp;A</div><div class="admonitionContent_S0QG"><p>The Azure Container Apps team will answer questions live on <strong>September 29</strong>. </p><ul><li><a href="https://reactor.microsoft.com/reactor/events/17004/?WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Sign up to attend</a> for live Q&amp;A with the team</li><li><a href="https://github.com/Azure/Cloud-Native/issues/new?assignees=&amp;labels=ask+the+expert&amp;template=---ask-the-expert-.md&amp;title=%5BAsk+The+Expert%5D++" target="_blank" rel="noopener noreferrer">submit your questions</a> ahead of time, for prioritization.</li></ul></div></div>]]></content>
        <author>
            <name>Kendall Roden</name>
            <uri>https://github.com/kendallroden</uri>
        </author>
        <category label="serverless-september" term="serverless-september"/>
        <category label="zero-to-hero" term="zero-to-hero"/>
        <category label="azure-functions" term="azure-functions"/>
        <category label="azure-container-apps" term="azure-container-apps"/>
        <category label="dapr" term="dapr"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[üöÄ | Durable Entities Walkthrough]]></title>
        <id>zero2hero-func-02</id>
        <link href="https://azure.github.io/Cloud-Native/blog/zero2hero-func-02"/>
        <updated>2022-09-06T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Durable Entities are a special type of Azure Functions that allow you to implement stateful objects in a serverless environment.]]></summary>
        <content type="html"><![CDATA[<hr><p>Welcome to <code>Day 6</code> of #30DaysOfServerless!</p><p>Today, we have a special set of posts from our <a href="/Cloud-Native/serverless-september/ZeroToHero">Zero To Hero üöÄ</a> initiative, featuring blog posts authored by our Product Engineering teams for #ServerlessSeptember. <em>Posts were originally published on the <a href="https://techcommunity.microsoft.com/t5/apps-on-azure-blog/a-walkthrough-of-durable-entities/ba-p/3616832?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Apps on Azure</a> blog on Microsoft Tech Community.</em></p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-well-cover">What We'll Cover<a class="hash-link" href="#what-well-cover" title="Direct link to heading">‚Äã</a></h2><ul><li>What are Durable Entities</li><li>Some Background</li><li>A Programming Model</li><li>Entities for a Micro-Blogging Platform</li></ul><p><img loading="lazy" src="/Cloud-Native/assets/images/zero-to-hero-david-2236e6d82fe0064fef5a652807264fd7.png" width="1600" height="672" class="img_ev3q"></p><hr><p><a href="https://docs.microsoft.com/azure/azure-functions/durable/durable-functions-entities?tabs=csharp&amp;WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Durable Entities</a> are a special type of Azure Function that allow you to implement stateful objects in a serverless environment. They make it easy to introduce stateful components to your app without needing to manually persist data to external storage, so you can focus on your business logic. We‚Äôll demonstrate their power with a real-life example in the last section.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="entities-101-some-background">Entities 101: Some Background<a class="hash-link" href="#entities-101-some-background" title="Direct link to heading">‚Äã</a></h2><p>Programming Durable Entities feels a lot like object-oriented programming, except that these ‚Äúobjects‚Äù exist in a distributed system. Like objects, each Entity instance has a unique identifier, i.e. an entity ID that can be used to read and manipulate their internal state. Entities define a list of operations that constrain how their internal state is managed, like an object interface.</p><p>Some experienced readers may realize that Entities sound a lot like an implementation of the Actor Pattern. For a discussion of the relationship between Entities and Actors, please refer to <a href="https://docs.microsoft.com/azure/azure-functions/durable/durable-functions-entities?tabs=csharp#comparison-with-virtual-actors" target="_blank" rel="noopener noreferrer">this documentation</a>.</p><p>Entities are a part of the Durable Functions Extension, an extension of Azure Functions that empowers programmers with stateful abstractions for serverless, such as Orchestrations (i.e. workflows).</p><p><a href="https://docs.microsoft.com/azure/azure-functions/durable/durable-functions-overview?tabs=csharp" target="_blank" rel="noopener noreferrer">Durable Functions</a> is available in most Azure Functions runtime environments: .NET, Node.js, Python, PowerShell, and Java (preview). For this article, we‚Äôll focus on the C# experience, but note that Entities are also available in Node.js and Python; their availability in other languages is underway.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="entities-102-the-programming-model">Entities 102: The programming model<a class="hash-link" href="#entities-102-the-programming-model" title="Direct link to heading">‚Äã</a></h2><p>Imagine you want to implement a simple Entity that just counts things. Its interface allows you to get the current count, add to the current count, and to reset the count to zero.</p><p>If you implement this in an object-oriented way, you‚Äôd probably define a class (say ‚ÄúCounter‚Äù) with a method to get the current count (say ‚ÄúCounter.Get‚Äù), another to add to the count (say ‚ÄúCounter.Add‚Äù), and another to reset the count (say ‚ÄúCounter.Reset‚Äù). Well, the implementation of an Entity in C# is not that different from this sketch:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[JsonObject(MemberSerialization.OptIn)] </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class Counter </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [JsonProperty("value")] </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public int Value { get; set; } </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void Add(int amount)  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        this.Value += amount; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public Task Reset()  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        this.Value = 0; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return Task.CompletedTask; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public Task&lt;int&gt; Get()  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return Task.FromResult(this.Value); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [FunctionName(nameof(Counter))] </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static Task Run([EntityTrigger] IDurableEntityContext ctx) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        =&gt; ctx.DispatchAsync&lt;Counter&gt;(); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">} </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We‚Äôve defined a class named Counter, with an internal count stored in the variable ‚ÄúValue‚Äù which is manipulated through the ‚ÄúAdd‚Äù and ‚ÄúReset‚Äù methods, and which can be read via ‚ÄúGet‚Äù.</p><p>The ‚ÄúRun‚Äù method is simply boilerplate required for the Azure Functions framework to interact with the object we‚Äôve defined ‚Äì it‚Äôs the method that the framework calls internally when it needs to load the Entity object. When <code>DispatchAsync</code> is called, the Entity and its corresponded state (the last count in ‚ÄúValue‚Äù) is loaded from storage. Again, this is mostly just boilerplate: your Entity‚Äôs business logic lies in the rest of the class.</p><p>Finally, the Json annotation on top of the class and the Value field tells the Durable Functions framework that the ‚ÄúValue‚Äù field is to be durably persisted as part of the durable state on each Entity invocation. If you were to annotate other class variables with JsonProperty, they would also become part of the managed state.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="entities-for-a-micro-blogging-platform">Entities for a micro-blogging platform<a class="hash-link" href="#entities-for-a-micro-blogging-platform" title="Direct link to heading">‚Äã</a></h2><p>We‚Äôll try to implement a simple micro-blogging platform, a la Twitter. Let‚Äôs call it ‚ÄúChirper‚Äù. In Chirper, users write chirps (i.e tweets), they can follow, and unfollow other users, and they can read the chirps of users they follow.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="defining-entity">Defining Entity<a class="hash-link" href="#defining-entity" title="Direct link to heading">‚Äã</a></h3><p>Just like in OOP, it‚Äôs useful to begin by identifying what are the stateful agents of this scenario. In this case, users have state (who they follow and their chirps), and chirps have state in the form of their content. So, we could model these stateful agents as Entities!</p><p>Below is a potential way to implement a User for Chirper as an Entity:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  [JsonObject(MemberSerialization = MemberSerialization.OptIn)] </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public class User: IUser  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      [JsonProperty] </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      public List&lt;string&gt; FollowedUsers { get; set; }  = new List&lt;string&gt;(); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      public void Add(string user) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          FollowedUsers.Add(user); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      } </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      public void Remove(string user) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          FollowedUsers.Remove(user); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      } </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      public Task&lt;List&lt;string&gt;&gt; Get() </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          return Task.FromResult(FollowedUsers); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      } </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // note: removed boilerplate ‚ÄúRun‚Äù method, for conciseness. </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  } </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In this case, our Entity‚Äôs internal state is stored in ‚ÄúFollowedUsers‚Äù which is an array of accounts followed by this user. The operations exposed by this entity allow clients to read and modify this data: it can be read by ‚ÄúGet‚Äù, a new follower can be added via ‚ÄúAdd‚Äù, and a user can be unfollowed via ‚ÄúRemove‚Äù.</p><p>With that, we‚Äôve modeled a Chirper‚Äôs user as an Entity! Recall that Entity instances each has a unique ID, so we can consider that unique ID to correspond to a specific user account.</p><p>What about chirps? Should we represent them as Entities as well? That would certainly be valid. However, we would then need to create a mapping between an entity ID and every chirp entity ID that this user wrote.</p><p>For demonstration purposes, a simpler approach would be to create an Entity that stores the list of all chirps authored by a given user; call it UserChirps. Then, we could fix each User Entity to share the same entity ID as its corresponding UserChirps Entity, making client operations easier.</p><p>Below is a simple implementation of UserChirps:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  [JsonObject(MemberSerialization = MemberSerialization.OptIn)] </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public class UserChirps : IUserChirps </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      [JsonProperty] </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      public List&lt;Chirp&gt; Chirps { get; set; } = new List&lt;Chirp&gt;(); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      public void Add(Chirp chirp) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          Chirps.Add(chirp); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      } </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      public void Remove(DateTime timestamp) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          Chirps.RemoveAll(chirp =&gt; chirp.Timestamp == timestamp); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      } </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      public Task&lt;List&lt;Chirp&gt;&gt; Get() </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          return Task.FromResult(Chirps); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      } </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // Omitted boilerplate ‚ÄúRun‚Äù function </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  } </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Here, our state is stored in Chirps, a list of user posts. Our operations are the same as before: Get, Read, and Add. It‚Äôs the same pattern as before, but we‚Äôre representing different data.</p><p>To put it all together, let‚Äôs set up Entity clients to generate and manipulate these Entities according to some REST API.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="interacting-with-entity">Interacting with Entity<a class="hash-link" href="#interacting-with-entity" title="Direct link to heading">‚Äã</a></h3><p>Before going there, let‚Äôs talk briefly about how you can interact with an Entity. Entity interactions take one of two forms -- <a href="https://docs.microsoft.com/azure/azure-functions/durable/durable-functions-entities?tabs=csharp#access-entities" target="_blank" rel="noopener noreferrer">calls and signals</a>:</p><p>Calling an entity is a two-way communication. You send an operation message to the entity and then wait for the response message before you continue. The response can be a result value or an error.
Signaling an entity is a one-way (fire-and-forget) communication. You send an operation message but don‚Äôt wait for a response. You have the reassurance that the message will be delivered eventually, but you don‚Äôt know when and don‚Äôt know what the response is.
For example, when you read the state of an Entity, you are performing a ‚Äúcall‚Äù interaction. When you record that a user has followed another, you may choose to simply signal it.</p><p>Now say user with a given userId (say ‚ÄúdurableFan99‚Äù ) wants to post a chirp. For this, you can write an HTTP endpoint to signal the UserChips entity to record that chirp. We can leverage the HTTP Trigger functionality from Azure Functions and pair it with an entity client binding that signals the Add operation of our Chirp Entity:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[FunctionName("UserChirpsPost")] </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public static async Task&lt;HttpResponseMessage&gt; UserChirpsPost( </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [HttpTrigger(AuthorizationLevel.Function, "post", Route = "user/{userId}/chirps")] </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    HttpRequestMessage req, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DurableClient] IDurableClient client, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ILogger log,  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    string userId) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Authenticate(req, userId); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var chirp = new Chirp() </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            UserId = userId, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Timestamp = DateTime.UtcNow, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Content = await req.Content.ReadAsStringAsync(), </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        await client.SignalEntityAsync&lt;IUserChirps&gt;(userId, x =&gt; x.Add(chirp)); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return req.CreateResponse(HttpStatusCode.Accepted, chirp); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Following the same pattern as above, to get all the chirps from a user, you could read the status of your Entity via <code>ReadEntityStateAsync</code>, which follows the call-interaction pattern as your client expects a response:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[FunctionName("UserChirpsGet")] </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public static async Task&lt;HttpResponseMessage&gt; UserChirpsGet( </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  [HttpTrigger(AuthorizationLevel.Function, "get", Route = "user/{userId}/chirps")] HttpRequestMessage req, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  [DurableClient] IDurableClient client, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ILogger log, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  string userId) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Authenticate(req, userId); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      var target = new EntityId(nameof(UserChirps), userId); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      var chirps = await client.ReadEntityStateAsync&lt;UserChirps&gt;(target); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      return chirps.EntityExists </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ? req.CreateResponse(HttpStatusCode.OK, chirps.EntityState.Chirps) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            : req.CreateResponse(HttpStatusCode.NotFound); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  } </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And there you have it! To play with a complete implementation of Chirper, you can try out our sample in the <a href="https://github.com/Azure/azure-functions-durable-extension/tree/dev/samples/entitites-csharp/Chirper" target="_blank" rel="noopener noreferrer">Durable Functions extension repo</a>.  </p><p>Thank you!</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>Thanks for following along, and we hope you find Entities as useful as we do! If you have questions or feedback, please file issues in the repo above or tag us <a href="https://twitter.com/AzureFunctions" target="_blank" rel="noopener noreferrer">@AzureFunctions</a> on Twitter</p></div></div>]]></content>
        <author>
            <name>David Justo</name>
            <uri>https://github.com/davidmrdavid</uri>
        </author>
        <category label="serverless-september" term="serverless-september"/>
        <category label="zero-to-hero" term="zero-to-hero"/>
        <category label="azure-functions" term="azure-functions"/>
        <category label="azure-container-apps" term="azure-container-apps"/>
        <category label="dapr" term="dapr"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[06. Functions for .NET Devs]]></title>
        <id>06-functions-dotnet</id>
        <link href="https://azure.github.io/Cloud-Native/blog/06-functions-dotnet"/>
        <updated>2022-09-06T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[#30DaysOfServerless: Azure Functions for the .NET Developer]]></summary>
        <content type="html"><![CDATA[<hr><p>Welcome to <code>Day 6</code> of #30DaysOfServerless!</p><p>The theme for this week is Azure Functions. Today we're going to talk about why Azure Functions are a great fit for .NET developers.</p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-well-cover">What We'll Cover<a class="hash-link" href="#what-well-cover" title="Direct link to heading">‚Äã</a></h2><ul><li>What is serverless computing? </li><li>How does Azure Functions fit in?</li><li>Let's build a simple Azure Function in .NET</li><li>Developer Guide, Samples &amp; Scenarios</li><li>Exercise: Explore the <a href="https://docs.microsoft.com/training/paths/create-serverless-applications/?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Create Serverless Applications</a> path.</li><li>Resources: For self-study!</li></ul><p><img loading="lazy" alt="A banner image that has the title of this article with the author&amp;#39;s photo and a drawing that summarizes the demo application." src="/Cloud-Native/assets/images/banner-18ebad619fd86fe2eef71ab09e7388a8.png" width="1600" height="672" class="img_ev3q"></p><hr><p>The leaves are changing colors and there's a chill in the air, or for those lucky folks in the Southern Hemisphere, the leaves are budding and a warmth is in the air. Either way, that can only mean one thing - it's <strong>Serverless September!üçÇ</strong> So today, we're going to take a look at Azure Functions - what they are, and <em>why they're a great fit for .NET developers</em>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-serverless-computing">What is serverless computing?<a class="hash-link" href="#what-is-serverless-computing" title="Direct link to heading">‚Äã</a></h2><p>For developers, serverless computing means you write highly compact individual functions that do one thing - and run in the cloud. These functions <a href="https://docs.microsoft.com/azure/azure-functions/functions-triggers-bindings?tabs=csharp&amp;WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">are triggered by some external event</a>. That event could be a record being inserted into a database, a file uploaded into BLOB storage, a timer interval elapsed, or even a simple HTTP request.</p><p>But... servers are still definitely involved! What has changed from other types of cloud computing is that the idea and <strong>ownership of the server</strong> has been abstracted away.</p><p>A lot of the time you'll hear folks refer to this as <a href="/Cloud-Native/blog/02-functions-intro">Functions as a Service or FaaS</a>. The defining characteristic is all you need to do is put together your application logic. Your code is going to be invoked in response to events - and the cloud provider takes care of everything else. You literally get to focus on only the business logic you need to run in response to something of interest - <strong>no worries about hosting</strong>.</p><p>You do not need to worry about wiring up the plumbing between the service that originates the event and the serverless runtime environment. The cloud provider will handle the mechanism to call your function in response to whatever event you chose to have the function react to. And it passes along any data that is relevant to the event to your code.</p><p>And here's a really neat thing. <strong>You only pay for the time the serverless function is running.</strong> So, if you have a function that is triggered by an HTTP request, and you rarely get requests to your function, you would rarely pay.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="how-does-azure-functions-fit-in">How does Azure Functions fit in?<a class="hash-link" href="#how-does-azure-functions-fit-in" title="Direct link to heading">‚Äã</a></h3><p>Microsoft's <a href="https://docs.microsoft.com/azure/azure-functions/?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Azure Functions</a> is a modern serverless architecture, offering event-driven cloud computing that is easy for developers to use. It provides a way to run small pieces of code or Functions in the cloud without developers having to worry themselves about the infrastructure or platform the Function is running on.</p><p>That means we're only concerned about writing the logic of the Function. And we can write that logic in our choice of languages... like C#. We are also able to add packages from NuGet to Azure Functions‚Äîthis way, we don't have to reinvent the wheel and can use well-tested libraries.</p><p>And the Azure Functions runtime takes care of a ton of neat stuff for us, like passing in information about the event that caused it to kick off - in a strongly typed variable. It also <a href="https://docs.microsoft.com/azure/azure-functions/functions-triggers-bindings?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">"binds"</a> to other services, like Azure Storage, we can easily access those services from our code without having to worry about new'ing them up.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="lets-build-an-azure-function">Let's build an Azure Function!<a class="hash-link" href="#lets-build-an-azure-function" title="Direct link to heading">‚Äã</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="scaffold-the-function">Scaffold the Function<a class="hash-link" href="#scaffold-the-function" title="Direct link to heading">‚Äã</a></h3><p>Don't worry about having an Azure subscription or even being connected to the internet‚Äîwe can develop and debug Azure Functions locally using either <a href="https://docs.microsoft.com/azure/azure-functions/functions-develop-vs?tabs=in-process&amp;WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Visual Studio</a> or <a href="https://docs.microsoft.com/azure/azure-functions/functions-develop-vs-code?tabs=csharp&amp;WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Visual Studio Code</a>!</p><p>For this example, I'm going to use Visual Studio Code to build up a Function that responds to an <a href="https://docs.microsoft.com/azure/azure-functions/functions-bindings-http-webhook-trigger?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">HTTP trigger</a> and then writes a message to an <a href="https://docs.microsoft.com/azure/azure-functions/functions-bindings-storage-queue-output?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Azure Storage Queue</a>.</p><p><img loading="lazy" alt="Diagram of the how the Azure Function will use the HTTP trigger and the Azure Storage Queue Binding" src="data:image/png;base64,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" width="720" height="405" class="img_ev3q"></p><p>The incoming HTTP call is the <strong>trigger</strong> and the message queue the Function writes to is an <strong>output binding</strong>. Let's have at it!</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>You do need to have some tools downloaded and installed to get started. First and foremost, you'll need <a href="https://code.visualstudio.com/" target="_blank" rel="noopener noreferrer">Visual Studio Code</a>. Then you'll need the <a href="https://marketplace.visualstudio.com/items?itemName=ms-azuretools.vscode-azurefunctions&amp;WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Azure Functions extension</a> for VS Code to do the development with. Finally, you'll need the <a href="https://docs.microsoft.com/azure/storage/common/storage-use-azurite?tabs=visual-studio-code&amp;WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Azurite Emulator</a> installed as well‚Äîthis will allow us to write to a message queue locally.</p><p>Oh! And of course, <a href="https://docs.microsoft.com/dotnet/core/tools/?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">.NET 6</a>!</p></div></div><p>Now with all of the tooling out of the way, let's write a Function!</p><ol><li><p>Fire up Visual Studio Code. Then, from the command palette, type: <code>Azure Functions: Create New Project</code></p><p><img loading="lazy" alt="Screenshot of create a new function dialog in VS Code" src="/Cloud-Native/assets/images/1-create-new-cdcb7b7ec3ac86f77ed5eee0a728d237.png" width="1004" height="278" class="img_ev3q"></p></li><li><p>Follow the steps as to which directory you want to create the project in and which .NET runtime and language you want to use.</p><p><img loading="lazy" alt="Screenshot of VS Code prompting which directory and language to use" src="/Cloud-Native/assets/images/2-language-445030b4cf730aea1af1f7c02051136d.png" width="1003" height="278" class="img_ev3q"></p></li><li><p>Pick <strong>.NET 6</strong> and <strong>C#</strong>.</p><p>It will then prompt you to pick the folder in which your Function app resides and then select a template.</p><p><img loading="lazy" alt="Screenshot of VS Code prompting you to pick the Function trigger template" src="/Cloud-Native/assets/images/3-selecttemplate-e9f332784945383b44256950ec2669e1.png" width="1164" height="278" class="img_ev3q"></p><p>Pick the <strong>HTTP trigger</strong> template. When prompted for a name, call it: <strong>PostToAQueue</strong>.</p></li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="execute-the-function-locally">Execute the Function Locally<a class="hash-link" href="#execute-the-function-locally" title="Direct link to heading">‚Äã</a></h3><ol><li>After giving it a namespace, it prompts for an authorization level‚Äîpick Anonymous. <strong>Now we have a Function!</strong> Let's go ahead and hit F5 and see it run!</li></ol><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>After the templates have finished installing, you may get a prompt to download additional components‚Äîthese are NuGet packages. Go ahead and do that.</p></div></div><p>When it runs, you'll see the Azure Functions logo appear in the Terminal window with the URL the Function is located at. Copy that link.</p><p><img loading="lazy" alt="Screenshot of the Azure Functions local runtime starting up" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAD+CAMAAAC3IsjXAAADAFBMVEX////+//8zMzP///iPMzP2/////9Gvp8LfwsIzbbBVxO5+1f3/9cb4+Pj9/f319fWgmoT//c7//t6xbTPp8LV+nrz/5Zz/7a0FmLzPur7H7NX///38/PzC2/gzM47AvRi7uoS8097//+yv7fwzkdHv7+/7+/vR///B6P/X9f/y8vLs////6a7/6Lb6+vr///Kat8/I8P/96KbP9f//8dylx+ja6q3S+//f9/+UmACXmgCUmimUmkKlmxipoBh1oryUoHulmnOimnu2nlKioISwnmuUpZS+ojmbp6XIqjmUr73VtADZtxjVtELZtzHVt0qev97gvEKewt7ssm7dvlrjv0qix96lx97nwlKpzs6X1vOpzvew1ff10HP42YTP7//Z+f/Z//+v4/q26frs7OxVmMyv7e7n5+e++f/b/P8Fmr4FmsUlosc9mLwFtN89nsktp88tqtZOncU9pdRdmMldm7w9sNyGmMuGmsdVvuOeosCeoMuno8uvqLyvqMVmyfJuyfC+sLyOxOPHtLx+1fCnyc2Pz/+e4/3nzsnvzsfn1cn30Mfv1c332cv/1svH8t//28334NTP8v3/5dLH/+H36NzH///e///n/////+n///vEvWvf7K3i4uL+67XZ8f+1ugC3ugC1uim1ukK/unO8unu1vnvNvznIvVK8voTbyQC1wJTUxDneyhi6wqXeyjHbyUK1xr3bzEriz0K3ys7gz1rl0Erq0lK60N6/1N6/1OfB2c78zY/12nP44ITP6v/66qX96q3U8f/JycnZ2dlENjP5//8zNXE3Mzf/8MwzQElvNDSUTzOf4/80M1TLjjNssepZNDM4crQ3isinfVxuyvL826j//eU1V5elXTXVnFR0RjSixOe23f8zPGGGOTM1VYRcgKe7fDVwoNDRpXuGvuvs/u6lckTl/P//+dGLX0BYpNxgRjaPy/+PzfXyu3vlwI2+8v9RkcyIxfnQ0NDy/P9Ad7fd3d3/7MAzYXJYVIx3W0eCfaTeqFozhpypsZVCaAF+AAAKIUlEQVR42uydd3DTVhjAhU0KdvIHiVmBI0CSO5JzcmEESCfde6eTbjg46N67pZPuPWgLB9170T1CB3eOjZ3lBOIMCM0GQhnJpccq7ZPfkxRZSmzj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" width="300" height="254" class="img_ev3q"></p><ol start="2"><li>Type the link into a browser, adding a <code>name</code> parameter as shown in this example: <code>http://localhost:7071/api/PostToAQueue?name=Matt</code>. The Function will respond with a message. You can even set breakpoints in Visual Studio Code and step through the code!</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="write-to-azure-storage-queue">Write To Azure Storage Queue<a class="hash-link" href="#write-to-azure-storage-queue" title="Direct link to heading">‚Äã</a></h3><p>Next, we'll get this HTTP trigger Function to write to a local Azure Storage Queue. First we need to add the Storage NuGet package to our project. In the terminal, type:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dotnet </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"> package Microsoft.Azure.WebJobs.Extensions.Storage</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then set a configuration setting to tell the Function runtime where to find the Storage. Open up local.settings.json and set "AzureWebJobsStorage" to "UseDevelopmentStorage=true". The full file will look like:</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">"IsEncrypted"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">"Values"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">"AzureWebJobsStorage"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"UseDevelopmentStorage=true"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">"AzureWebJobsDashboard"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">""</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then create a new class within your project. This class will hold nothing but properties. Call it whatever you want and add whatever properties you want to it. I called mine TheMessage and added an Id and Name properties to it.</p><div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public class TheMessage</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public string Id { get; set; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public string Name { get; set; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Finally, change your PostToAQueue Function, so it looks like the following:</p><div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public static class PostToAQueue</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [FunctionName("PostToAQueue")]        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static async Task&lt;IActionResult&gt; Run(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        [HttpTrigger(AuthorizationLevel.Anonymous, "get", "post", Route = null)] HttpRequest req,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        [Queue("demoqueue", Connection = "AzureWebJobsStorage")] IAsyncCollector&lt;TheMessage&gt; messages,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ILogger log)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        string name = req.Query["name"];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        await messages.AddAsync(new TheMessage { Id = System.Guid.NewGuid().ToString(), Name = name });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new OkResult();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Note the addition of the <code>messages</code> variable. This is telling the Function to use the storage connection we specified before via the <code>Connection</code> property. And it is also specifying which queue to use in that storage account, in this case <code>demoqueue</code>.</p><p>All the code is doing is pulling out the <code>name</code> from the query string, new'ing up a new <code>TheMessage</code> class and adding that to the <code>IAsyncCollector</code> variable.</p><p><strong>That will add the new message to the queue!</strong></p><p>Make sure Azurite is started within VS Code (both the queue and blob emulators). Run the app and send the same GET request as before: <code>http://localhost:7071/api/PostToAQueue?name=Matt</code>.</p><p>If you have the Azure Storage Explorer installed, you can browse your local Queue and see the new message in there!</p><p><img loading="lazy" alt="Screenshot of Azure Storage Explorer with the new message in the queue" src="/Cloud-Native/assets/images/7-new-queue-700eb55117dd898b1fda2c98baeaea3b.png" width="1015" height="469" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="summing-up">Summing Up<a class="hash-link" href="#summing-up" title="Direct link to heading">‚Äã</a></h2><p>We had a quick look at what Microsoft's serverless offering, Azure Functions, is comprised of. It's a full-featured FaaS offering that enables you to write functions in your language of choice, including reusing packages such as those from NuGet.</p><p>A highlight of Azure Functions is the way they are triggered and bound. The triggers define how a Function starts, and bindings are akin to input and output parameters on it that correspond to external services. The best part is that the Azure Function runtime takes care of maintaining the connection to the external services so you don't have to worry about new'ing up or disposing of the connections yourself. </p><p>We then wrote a quick Function that gets triggered off an HTTP request and then writes a query string parameters from that request into a local Azure Storage Queue.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="whats-next">What's Next<a class="hash-link" href="#whats-next" title="Direct link to heading">‚Äã</a></h2><p>So, where can you go from here? </p><p>Think about how you can <strong>build real-world scenarios by integrating other Azure services</strong>. For example, you could use serverless integrations to build a workflow where the input payload received using an HTTP Trigger, is now stored in Blob Storage (output binding), which in turn triggers another service (e.g., Cognitive Services) that processes the blob and returns an enhanced result. </p><p><em>Keep an eye out for an update to this post where we walk through a scenario like this with code</em>. Check out the  resources below to help you get started on your own.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="exercise">Exercise<a class="hash-link" href="#exercise" title="Direct link to heading">‚Äã</a></h2><p>This brings us close to the end of Week 1 with Azure Functions. We've learned core concepts, built and deployed our first Functions app, and explored quickstarts and scenarios for different programming languages. So, what can you do to explore this topic on your own?</p><ul><li>Explore the <a href="https://docs.microsoft.com/training/paths/create-serverless-applications/?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Create Serverless Applications</a> learning path which has several modules that explore Azure Functions integrations with various services.</li><li>Take up the <a href="https://docs.microsoft.com/training/challenges?id=b950cd7a-d456-46ab-81ba-3bd1ad86dc1c&amp;WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Cloud Skills Challenge</a> and complete those modules in a fun setting where you compete with peers for a spot on the leaderboard!</li></ul><p>Then come back tomorrow as we wrap up the week with a discussion on end-to-end scenarios, a recap of what we covered this week, and a look at what's ahead next week.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="resources">Resources<a class="hash-link" href="#resources" title="Direct link to heading">‚Äã</a></h2><p>Start here for developer guidance in getting started with Azure Functions as a .NET/C# developer:</p><ul><li><a href="https://docs.microsoft.com/azure/azure-functions/functions-dotnet-class-library?tabs=v2%2Ccmd&amp;WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Develop C# class library functions using Azure Functions</a>. </li><li><a href="https://docs.microsoft.com/azure/azure-functions/dotnet-isolated-process-guide?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Using C# to develop .NET isolated process functions</a>.</li><li><a href="https://docs.microsoft.com/azure/azure-functions/functions-create-your-first-function-visual-studio?tabs=in-process&amp;WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Quickstart: Create your first C# function in Azure using Visual Studio</a>.</li></ul><p>Then learn about <a href="https://docs.microsoft.com/azure/azure-functions/functions-triggers-bindings?tabs=csharp#bindings-code-examples?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">supported Triggers and Bindings</a> for C#, with code snippets to show how they are used. </p><p>Finally, explore <a href="https://docs.microsoft.com/samples/browse/?products=azure-functions&amp;languages=csharp&amp;WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Azure Functions samples for C#</a> and learn to implement serverless solutions. Examples include:</p><ul><li>Using Azure Functions to <a href="https://docs.microsoft.com/samples/azure-samples/azure-search-dotnet-samples/check-storage-usage/?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">check storage of Azure Cognitive Services on a schedule</a> using Timer Triggers.</li><li>Using Azure Functions to <a href="https://docs.microsoft.com/samples/azure-samples/azure-sql-binding-func-dotnet-todo/todo-backend-dotnet-azure-sql-bindings-azure-functions/?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">implement a ToDo Backend API</a> illustrating Azure SQL integration.</li></ul>]]></content>
        <author>
            <name>Mike James</name>
            <uri>https://github.com/MikeCodesDotNet</uri>
        </author>
        <author>
            <name>Matt Soucoup</name>
            <uri>https://github.com/codemillmatt</uri>
        </author>
        <category label="serverless-september" term="serverless-september"/>
        <category label="30-days-of-serverless" term="30-days-of-serverless"/>
        <category label="azure-functions" term="azure-functions"/>
        <category label="dotnet" term="dotnet"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[07. Functions for Python Devs]]></title>
        <id>07-functions-python</id>
        <link href="https://azure.github.io/Cloud-Native/blog/07-functions-python"/>
        <updated>2022-09-07T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Let's build a wildfire detection site and application using Azure Functions for Python, with Timer Trigger and CosmosDB bindings!]]></summary>
        <content type="html"><![CDATA[<hr><p>Welcome to <code>Day 7</code> of #30DaysOfServerless!</p><p>Over the past couple of days, we've explored Azure Functions from the perspective of specific programming languages. Today we'll continue that trend by looking at Python - exploring the Timer Trigger and CosmosDB binding, and showcasing integration with a FastAPI-implemented web app.</p><p>Ready? Let's go.</p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-well-cover">What We'll Cover<a class="hash-link" href="#what-well-cover" title="Direct link to heading">‚Äã</a></h2><ul><li><strong>Developer Guidance</strong>: Azure Functions On Python</li><li><strong>Build &amp; Deploy</strong>: Wildfire Detection Apps with Timer Trigger + CosmosDB</li><li><strong>Demo: My Fire Map App</strong>: Using FastAPI and Azure Maps to visualize data</li><li><strong>Next Steps</strong>: Explore Azure Samples</li><li><strong>Exercise</strong>: Try this yourself!</li><li><strong>Resources</strong>: For self-study!</li></ul><p><img loading="lazy" src="/Cloud-Native/assets/images/banner-f95b9523f699cefc9fce9bd396101d6e.png" width="1600" height="672" class="img_ev3q"></p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="developer-guidance">Developer Guidance<a class="hash-link" href="#developer-guidance" title="Direct link to heading">‚Äã</a></h2><p>If you're a Python developer new to serverless on Azure, start with the <a href="https://docs.microsoft.com/azure/azure-functions/functions-reference-python?tabs=asgi%2Capplication-level&amp;WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Azure Functions Python Developer Guide</a>. It covers:</p><ul><li>Quickstarts with Visual Studio Code and Azure CLI</li><li>Adopting best practices for hosting, reliability and efficiency.</li><li>Tutorials showcasing Azure automation, image classification and more</li><li>Samples showcasing Azure Functions features for Python developers</li></ul><p>Now let's dive in and build our first Python-based Azure Functions app.</p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="detecting-wildfires-around-the-world">Detecting Wildfires Around the World?<a class="hash-link" href="#detecting-wildfires-around-the-world" title="Direct link to heading">‚Äã</a></h2><p>I live in California which is known for lots of wildfires. I wanted to create a proof of concept for developing an application that could let me know if there was a wildfire detected near my home. </p><p>NASA has a few satelites orbiting the Earth that can detect wildfires. These satelites take scans of the radiative heat in and use that to determine the likelihood of a wildfire. NASA updates their information about every 30 minutes and it can take about four hours for to scan and process information. </p><p><img loading="lazy" alt="Fire Point Near Austin, TX" src="/Cloud-Native/assets/images/Fire Point in Austin, TX-7614014f192cd32f19c4cfb29fa2b2ec.png" width="2312" height="1786" class="img_ev3q"></p><p>I want to get the information but I don't want to ping NASA or another service every time I check.</p><p>What if I occaisionally download all the data I need? Then I can ping that as much as I like.</p><p>I can create a script that does just that. Any time I say <em>I can create a script</em> that is a verbal queue for me to consider using an Azure function. With the function being ran in the cloud, I can ensure the script runs even when I'm not at my computer. </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="how-the-timer-trigger-works">How the Timer Trigger Works<a class="hash-link" href="#how-the-timer-trigger-works" title="Direct link to heading">‚Äã</a></h3><p>This function will utilize the Timer Trigger. This means Azure will call this function to run at a scheduled interval. This isn't the only way to keep the data in sync, but we know that arcgis, the service that we're using says that data is only updated every 30 minutes or so.</p><p>To learn more about the TimerTrigger as a concept, check out the <a href="https://docs.microsoft.com/azure/azure-functions/functions-bindings-timer?tabs=in-process&amp;pivots=programming-language-python&amp;WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Azure Functions documentation around Timers</a>.</p><p>When we create the function we tell it a few things like where the script will live (in our case in <code>__init__.py</code>) the type and direction and notably <em>often it should run</em>. We specify the timer using <code>schedule": &lt;The CRON INTERVAL&gt;</code>. For us we're using <code>0 0,30 * * *</code> which means every 30 minutes at the hour and half-hour.</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">"scriptFile"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"__init__.py"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">"bindings"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">"name"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"reqTimer"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">"type"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"timerTrigger"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">"direction"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"in"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">"schedule"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"0 0,30 * * * *"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Next, we create the code that runs when the function is called.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="connecting-to-the-database-and-our-source">Connecting to the Database and our Source<a class="hash-link" href="#connecting-to-the-database-and-our-source" title="Direct link to heading">‚Äã</a></h3><blockquote><p>Disclaimer: The data that we're pulling is for educational purposes only. This is not meant to be a production level application. You're welcome play with this project but ensure that you're using the data <a href="https://www.esri.com/legal/overview" target="_blank" rel="noopener noreferrer">in compliance with Esri</a>.</p></blockquote><p>Our function does two important things. </p><ol><li>It pulls data from ArcGIS that meets the parameters</li><li>It stores that pulled data into our database</li></ol><p>If you want to check out the code in its entirety, check out the <a href="https://github.com/kjaymiller/fire-map" target="_blank" rel="noopener noreferrer">GitHub repository</a>.</p><p>Pulling the data from ArcGIS is easy. We can use the <a href="https://developers.arcgis.com/python/" target="_blank" rel="noopener noreferrer">ArcGIS Python API</a>. Then, we need to load the service layer. Finally we query that layer for the specific data.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">write_new_file_data</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">gis_id</span><span class="token punctuation" style="color:#393A34">:</span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> layer</span><span class="token punctuation" style="color:#393A34">:</span><span class="token builtin">int</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> FeatureSet</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">"""Returns a JSON String of the Dataframe"""</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fire_data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> g</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">content</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">gis_id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    feature </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> fire_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">layers</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">layer</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># Loading Featured Layer from ArcGIS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    q </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> feature</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">query</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        where</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">"confidence &gt;= 65 AND hours_old  &lt;= 4"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">#The filter for the query</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return_distince_values</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        out_fields</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">"confidence, hours_old"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># The data we want to store with our points</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        out_sr</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">4326</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># The spatial reference of the data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> q   </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then we need to store the data in our database.</p><p>We're using <a href="https://docs.microsoft.com/azure/cosmos-db/introduction?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Cosmos DB</a> for this. COSMOSDB is a NoSQL database, which means that the data looks a lot like a python dictionary as it's JSON. This means that we don't need to worry about converting the data into a format that can be stored in a relational database.</p><p>The second reason is that Cosmos DB is tied into the Azure ecosystem so that if we want to create functions Azure events around it, we can.</p><p>Our script grabs the information that we pulled from ArcGIS and stores it in our database. </p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> CosmosClient</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">from_connection_string</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">COSMOS_CONNECTION_STRING</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> client</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    container </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> database</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_container_client</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">container</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">CONTAINER</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> record </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> container</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">create_item</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            record</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            enable_automatic_id_generation</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In our code each of these functions live in their own space. So in the main function we focus solely on what azure functions will be doing. The script that gets called is <code>__init__.py</code>. There we'll have the function call the other functions running.</p><p>We created another function called <code>load_and_write</code> that does all the work outlined above. <code>__init__.py</code> will call that.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">reqTimer</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> func</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">TimerRequest</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    database</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">database</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    container</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">container</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> update_db</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">load_and_write</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">gis_id</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">GIS_LAYER_ID</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> database</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">database</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> container</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">container</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then we deploy the function to Azure. I like to use VS Code's Azure Extension but you can also deploy it <a href="https://docs.microsoft.com/azure/azure-functions/functions-deployment-technologies?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">a few other ways</a>.</p><p><img loading="lazy" alt="Deploying the function via VS Code" src="/Cloud-Native/assets/images/Deploy to Function App using VS Code-a6e29125024c61cfae89968f59f3c85a.png" width="2136" height="1202" class="img_ev3q"></p><p>Once the function is deployed we can load the Azure portal and see a ping whenever the function is called.
<img loading="lazy" alt="The pings correspond to the Function being ran" src="/Cloud-Native/assets/images/Function Execution Count-68436884afb4df22b0fbd2f59342c62f.png" width="2826" height="868" class="img_ev3q"></p><p>We can also see the data now living in the datastore.
<img loading="lazy" alt="Document in Cosmos DB" src="/Cloud-Native/assets/images/Data Explorer-6c96e5a94835155e2e0ec88ba092fa0b.png" width="2692" height="1340" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="its-in-the-database-now-what">It's in the Database, Now What?<a class="hash-link" href="#its-in-the-database-now-what" title="Direct link to heading">‚Äã</a></h3><p>Now the real fun begins. We just loaded the last bit of fire data into a database. We can now query that data and serve it to others. </p><p>As I mentioned before, our Cosmos DB data is also stored in Azure, which means that we can deploy Azure Functions <a href="https://docs.microsoft.com/azure/azure-functions/functions-bindings-cosmosdb-v2?tabs=in-process%2Cfunctionsv2&amp;pivots=programming-language-python&amp;WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">to trigger when new data is added</a>. Perhaps you can use this to check for fires near you and use a <a href="https://docs.microsoft.com/azure/logic-apps/logic-apps-overview?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Logic App</a> to send an alert to your phone or email.</p><p>Another option is to create a web application that talks to the database and displays the data. I've created an example of this using FastAPI ‚Äì <a href="https://jm-func-us-fire-notify.azurewebsites.net" target="_blank" rel="noopener noreferrer">https://jm-func-us-fire-notify.azurewebsites.net</a>.</p><p><img loading="lazy" alt="Website that Checks for Fires" src="/Cloud-Native/assets/images/Check for Fires-aaebf80301801989c99380d6f342f1bc.gif" width="800" height="450" class="img_ev3q"></p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="next-steps">Next Steps<a class="hash-link" href="#next-steps" title="Direct link to heading">‚Äã</a></h2><p>This article showcased the Timer Trigger and the HTTP Trigger for Azure Functions in Python. Now try exploring other triggers and bindings by browsing <a href="https://docs.microsoft.com/azure/azure-functions/functions-triggers-bindings?tabs=python#bindings-code-examples&amp;WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Bindings code samples for Python</a> and <a href="https://docs.microsoft.com/samples/browse/?products=azure-functions&amp;WT.mc_id=javascript-74010-cxa&amp;languages=python&amp;WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Azure Functions samples for Python</a></p><p>Once you've tried out the samples, you may want to explore more advanced integrations or extensions for serverless Python scenarios. Here are some suggestions:</p><ul><li><a href="https://docs.microsoft.com/azure/azure-functions/develop-python-worker-extensions?tabs=windows%2Cpypi&amp;WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Develop Python worker extensions for Azure Functions</a> and publish to PyPI or GitHub.</li><li><a href="https://docs.microsoft.com/azure/azure-functions/functions-add-output-binding-storage-queue-cli?pivots=programming-language-python&amp;tabs=in-process%2Cbash%2Cbrowser&amp;WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Connect Azure Functions to Azure Storage</a> using the CLI</li><li><a href="https://docs.microsoft.com/azure/azure-signalr/signalr-quickstart-azure-functions-python?toc=%2Fazure%2Fazure-functions%2Ftoc.json&amp;WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Create Real-Time alerts with Azure Functions and SignalR Service</a></li></ul><p>And check out the resources for more tutorials to build up your Azure Functions skills.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="exercise">Exercise<a class="hash-link" href="#exercise" title="Direct link to heading">‚Äã</a></h2><p>I encourage you to fork <a href="https://github.com/kjaymiller/fire-map" target="_blank" rel="noopener noreferrer">the repository</a> and try building and deploying it yourself! You can see the TimerTrigger and a HTTPTrigger building the website. </p><p>Then try extending it. Perhaps if wildfires are a big thing in your area, you can use some of the data available in <a href="https://planetarycomputer.microsoft.com?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Planetary Computer</a> to check out some other datasets.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="resources">Resources<a class="hash-link" href="#resources" title="Direct link to heading">‚Äã</a></h2><ul><li><a href="https://docs.microsoft.com/azure/azure-functions/functions-reference-python?tabs=asgi%2Capplication-level&amp;WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Azure For Functions Python Developer Guide</a></li><li><a href="https://docs.microsoft.com/azure/azure-functions/create-first-function-vs-code-python?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Python Quickstart: Create Your First Function App</a></li><li><a href="https://docs.microsoft.com/samples/azure-samples/fastapi-on-azure-functions/azure-functions-python-create-fastapi-app/?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Use FastAPI Framework With Azure Functions</a></li><li><a href="https://docs.microsoft.com/samples/azure-samples/flask-app-on-azure-functions/azure-functions-python-create-flask-app/?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Use Flask Framework with Azure Functions</a></li><li><a href="https://docs.microsoft.com/azure/azure-functions/functions-machine-learning-tensorflow?tabs=bash&amp;WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Tutorial: Apply ML models in Azure Functions with Python and TensorFlow</a></li></ul>]]></content>
        <author>
            <name>Jay Miller</name>
            <uri>https://github.com/kjaymiller</uri>
        </author>
        <category label="serverless-september" term="serverless-september"/>
        <category label="30-days-of-serverless" term="30-days-of-serverless"/>
        <category label="azure-functions" term="azure-functions"/>
        <category label="python" term="python"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[08. Functions + Serverless On Azure]]></title>
        <id>08-functions-azure</id>
        <link href="https://azure.github.io/Cloud-Native/blog/08-functions-azure"/>
        <updated>2022-09-08T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Introduction to Azure Functions, from core concepts to hello world!]]></summary>
        <content type="html"><![CDATA[<hr><div class="theme-admonition theme-admonition-warning alert alert--danger admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>SEP 08: CHANGE IN PUBLISHING SCHEDULE</div><div class="admonitionContent_S0QG"><p>Starting from Week 2 (Sep 8), we'll be publishing blog posts in <em>batches</em> rather than on a daily basis, so you can read a series of related posts together. <em>Don't want to miss updates?</em> Just <a href="https://azure.github.io/Cloud-Native/blog/rss.xml" target="_blank" rel="noopener noreferrer">subscribe to the feed</a></p></div></div><hr><p>Welcome to <code>Day 8</code> of #30DaysOfServerless!</p><p>This marks the end of our <a href="https://azure.github.io/Cloud-Native/serverless-september/30DaysOfServerless/#azure-functions" target="_blank" rel="noopener noreferrer">Week 1 Roadmap</a> focused on Azure Functions!! Today, we'll do a quick recap of all #ServerlessSeptember activities in Week 1, set the stage for Week 2 - and leave you with some excellent tutorials you should explore to build more advanced scenarios with Azure Functions.</p><p>Ready? Let's go.</p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-well-cover">What We'll Cover<a class="hash-link" href="#what-well-cover" title="Direct link to heading">‚Äã</a></h2><ul><li>Azure Functions: Week 1 Recap</li><li>Advanced Functions: Explore Samples</li><li>End-to-End: Serverless Hacks &amp; Cloud Skills</li><li>What's Next: Hello, Containers &amp; Microservices</li><li>Challenge: <a href="https://docs.microsoft.com/training/paths/create-serverless-applications/?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Complete the Learning Path</a></li></ul><p><img loading="lazy" src="/Cloud-Native/assets/images/banner-90895ff214888259c44f6d70b6646e1c.png" width="1600" height="672" class="img_ev3q"></p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="week-1-recap-30days--functions">Week 1 Recap: #30Days &amp; Functions<a class="hash-link" href="#week-1-recap-30days--functions" title="Direct link to heading">‚Äã</a></h2><p>Congratulations!! We made it to the end of Week 1 of #ServerlessSeptember. Let's recap what we learned so far:</p><ul><li>In <a href="/Cloud-Native/blog/02-functions-intro">Core Concepts</a> we looked at where Azure Functions fits into the serverless options available on Azure. And we learned about key concepts like Triggers, Bindings, Custom Handlers and Durable Functions.</li><li>In <a href="/Cloud-Native/blog/03-functions-quickstart">Build Your First Function</a> we looked at the tooling options for creating Functions apps, testing them locally, and deploying them to Azure - as we built and deployed our first Functions app.</li><li>In the next 4 posts, we explored new Triggers, Integrations, and Scenarios - as we looked at building Functions Apps in Java, JavaScript, .NET and Python.</li><li>And in the Zero-To-Hero series, we learned about <a href="/Cloud-Native/blog/zero2hero-func-02">Durable Entities</a> - and how we can use them to create <em>stateful</em> serverless solutions using a <a href="https://github.com/Azure/azure-functions-durable-extension/tree/dev/samples/entitites-csharp/Chirper" target="_blank" rel="noopener noreferrer">Chirper Sample</a> as an example scenario.</li></ul><p>The illustrated roadmap below summarizes what we covered each day this week, as we bring our <strong>Functions-as-a-Service</strong> exploration to a close.</p><p><img loading="lazy" src="/Cloud-Native/assets/images/roadmap-Week1-e6f2178c0374c42ef50be53bee433ad9.png" width="1920" height="1080" class="img_ev3q"></p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="advanced-functions-code-samples">Advanced Functions: Code Samples<a class="hash-link" href="#advanced-functions-code-samples" title="Direct link to heading">‚Äã</a></h2><p>So, now that we've got our first Functions app under our belt, and validated our local development setup for tooling, where can we go next? A good next step is to explore different triggers and bindings, that drive richer end-to-end scenarios. For example:</p><ul><li><a href="https://docs.microsoft.com/azure/azure-functions/functions-twitter-email?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer"><strong>Integrate Functions with Azure Logic Apps</strong></a> - we'll discuss Azure Logic Apps in Week 3. For now, think of it as a <a href="https://docs.microsoft.com/azure/logic-apps/logic-apps-overview?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">workflow automation</a> tool that lets you integrate seamlessly with other supported Azure services to drive an end-to-end scenario. In this tutorial, we set up a workflow connecting Twitter (get tweet) to Azure Cognitive Services (analyze sentiment) - and use that to trigger an Azure Functions app to send email about the result.</li><li><a href="https://docs.microsoft.com/azure/event-grid/resize-images-on-storage-blob-upload-event?tabs=nodejsv10&amp;WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer"><strong>Integrate Functions with Event Grid</strong></a> - we'll discuss Azure Event Grid in Week 3. For now, think of it as an eventing service connecting event sources (publishers) to event handlers (subscribers) at cloud scale. In this tutorial, we handle a common use case - a workflow where loading an image to Blob Storage triggers an Azure Functions app that implements a <a href="https://github.com/Azure-Samples/storage-blob-resize-function-node" target="_blank" rel="noopener noreferrer">resize function</a>, helping automatically generate thumbnails for the uploaded image.</li><li><a href="https://docs.microsoft.com/training/modules/automatic-update-of-a-webapp-using-azure-functions-and-signalr/?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer"><strong>Integrate Functions with CosmosDB and SignalR</strong></a> to bring real-time push-based notifications to your web app. It achieves this by using a Functions app that is triggered by changes in a CosmosDB backend, causing it to broadcast that update (<em>push notification</em> to connected web clients over SignalR, in real time.</li></ul><p>Want more ideas? Check out the <a href="https://docs.microsoft.com/samples/browse/?products=azure-functions&amp;WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Azure Samples for Functions</a> for implementations, and browse the <a href="https://docs.microsoft.com/azure/architecture/browse/?expanded=azure&amp;products=azure-functions&amp;WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Azure Architecture Center</a> for reference architectures from real-world scenarios that involve Azure Functions usage.</p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="e2e-scenarios-hacks--cloud-skills">E2E Scenarios: Hacks &amp; Cloud Skills<a class="hash-link" href="#e2e-scenarios-hacks--cloud-skills" title="Direct link to heading">‚Äã</a></h2><p><em>Want to systematically work your way through a single End-to-End scenario involving Azure Functions alongside other serverless support technologies?</em> Check out the <a href="/Cloud-Native/serverless-september/ServerlessHacks">Serverless Hacks</a> activity happening during #ServerlessSeptember, and learn to build this <strong>"Serverless Tollbooth Application"</strong> in a series of 10 challenges. Check out the <a href="https://aka.ms/serverless-september/videos" target="_blank" rel="noopener noreferrer">video series for a reference solution in .NET</a> and sign up for weekly office hours to join peers and discuss your solutions or challenges.</p><p><img loading="lazy" src="/Cloud-Native/assets/images/wth-serverless-78cb1c6f4c8f3b2997e9a8a9aee4de1b.png" width="1908" height="994" class="img_ev3q"></p><p><em>Or perhaps you prefer to learn core concepts with code in a structured learning path?</em> We have that covered. Check out the <a href="https://docs.microsoft.com/training/paths/create-serverless-applications/?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">12-module</a> <strong>"Create Serverless Applications"</strong> course from Microsoft Learn which walks your through concepts, one at a time, with code. Even better - <a href="https://docs.microsoft.com/learn/challenges?id=b950cd7a-d456-46ab-81ba-3bd1ad86dc1c&amp;WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">sign up for the free Cloud Skills Challenge</a> and <em>complete the same path</em> (in under 30 days) but this time, with the added fun of competing against your peers for a spot on a leaderboard, and swag.</p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="whats-next-hello-cloud-native">What's Next? Hello, Cloud Native!<a class="hash-link" href="#whats-next-hello-cloud-native" title="Direct link to heading">‚Äã</a></h2><p>So where to next? In Week 2 we turn our attention from <em>Functions-as-a-Service</em> to building more complex backends using <em>Containers and Microservices</em>. We'll focus on two core technologies - <a href="https://docs.microsoft.com/azure/container-apps/?WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Azure Container Apps</a> and <a href="https://docs.dapr.io/?WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Dapr</a> (Distributed Application Runtime) - both key components of a broader vision around <strong><a href="https://azure.microsoft.com/solutions/cloud-native-apps/?WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Building Cloud Native Applications in Azure</a></strong>.</p><p>What is Cloud Native you ask? </p><p>Fortunately for you, we have an excellent introduction in our Zero-to-Hero article on <a href="/Cloud-Native/blog/zero2hero-aca-01">Go Cloud Native with Azure Container Apps</a> - that explains the <strong>5 pillars of Cloud Native</strong> and highlights the value of Azure Container Apps (scenarios) and Dapr (sidecar architecture) for simplified microservices-based solution with auto-scale capability. Prefer a visual summary? Here's an illustrate guide to that article for convenience.</p><p><img loading="lazy" alt="Go Cloud Native" src="/Cloud-Native/assets/images/Go-Cloud-Native-f6ac3225c3d9741a1fbff81030f7f830.png" width="1024" height="1024" class="img_ev3q"> <a target="_blank" href="/Cloud-Native/assets/files/Go-Cloud-Native-orig-02eae8571b232d447aef410a525763f7.png"><strong>Download a higher resolution version of the image</strong></a></p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="take-the-challenge"><a href="https://docs.microsoft.com/learn/challenges?id=b950cd7a-d456-46ab-81ba-3bd1ad86dc1c&amp;WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Take The Challenge</a><a class="hash-link" href="#take-the-challenge" title="Direct link to heading">‚Äã</a></h2><p>We typically end each post with an exercise or activity to reinforce what you learned. For Week 1, we encourage you to take the Cloud Skills Challenge and work your way through at least a subset of the modules, for hands-on experience with the different Azure Functions concepts, integrations, and usage.</p><blockquote><p>See you in Week 2!</p></blockquote>]]></content>
        <author>
            <name>Nitya Narasimhan</name>
            <uri>https://github.com/nitya</uri>
        </author>
        <author>
            <name>Devanshi Joshi</name>
            <uri>https://github.com/devanshidiaries</uri>
        </author>
        <category label="serverless-september" term="serverless-september"/>
        <category label="30-days-of-serverless" term="30-days-of-serverless"/>
        <category label="serverless-hacks" term="serverless-hacks"/>
        <category label="zero-to-hero" term="zero-to-hero"/>
        <category label="ask-the-expert" term="ask-the-expert"/>
        <category label="azure-functions" term="azure-functions"/>
        <category label="azure-container-apps" term="azure-container-apps"/>
        <category label="azure-event-grid" term="azure-event-grid"/>
        <category label="azure-logic-apps" term="azure-logic-apps"/>
        <category label="serverless-e2e" term="serverless-e2e"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[09. Hello, Azure Container Apps]]></title>
        <id>09-aca-fundamentals</id>
        <link href="https://azure.github.io/Cloud-Native/blog/09-aca-fundamentals"/>
        <updated>2022-09-09T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Kickstarting Week 2 of #30DaysOfServerless with an introduction to Azure Container Apps and core concepts relevant to building microservices-driven solutions]]></summary>
        <content type="html"><![CDATA[<hr><p>Welcome to <code>Day 9</code> of #30DaysOfServerless!</p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-well-cover">What We'll Cover<a class="hash-link" href="#what-well-cover" title="Direct link to heading">‚Äã</a></h2><ul><li>The Week Ahead</li><li>Hello, Container Apps!</li><li>Quickstart: Build Your First ACA!</li><li>Under The Hood: Core ACA Concepts</li><li>Exercise: Try this yourself!</li><li>Resources: For self-study!</li></ul><p><img loading="lazy" src="/Cloud-Native/assets/images/banner-2b8cf81d448cbb7f947a85dd71631b84.png" width="1600" height="672" class="img_ev3q"></p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-week-ahead">The Week Ahead<a class="hash-link" href="#the-week-ahead" title="Direct link to heading">‚Äã</a></h2><p>Welcome to Week 2 of #ServerlessSeptember, where we put the focus on <strong>Microservices</strong> and building Cloud Native applications that are optimized for <strong>serverless</strong> solutions on Azure. One week is not enough to do this complex topic justice so consider this a 7-part jumpstart to the longer journey.</p><ol><li><strong>Hello, Container Apps (ACA)</strong> - Learn about Azure Container Apps, a key service that helps you <em>run microservices and containerized apps on a serverless platform</em>. Know the core concepts. (<em>Tutorial 1: First ACA</em>)</li><li><strong>Communication with Microservices</strong> - Dive deeper into two key concepts: <em>environments</em> and <em>virtual networking</em>. Learn how microservices communicate in ACA, and walkthrough an example. <em>(Tutorial 2: ACA with 3 Microservices)</em></li><li><strong>Scaling Your Container Apps</strong> - Learn about KEDA. Understand how to configure your ACA for auto-scaling with KEDA-supported triggers. Put this into action by walking through a tutorial. <em>(Tutorial 3: Configure Autoscaling</em>)</li><li><strong>Hello, Distributed Application Runtime (Dapr)</strong> - Learn about Dapr and how its <em>Building Block APIs</em> simplify microservices development with ACA. Know how the <em>sidecar pattern</em> enables incremental adoption of Dapr APIs without requiring any Dapr code integration in app. (<em>Tutorial 4: Setup &amp; Explore Dapr</em>)</li><li><strong>Building ACA with Dapr</strong> - See how Dapr works with ACA by building a Dapr-enabled Azure Container App. Walk through a .NET tutorial using Pub/Sub and State Management APIs in an enterprise scenario. (<em>Tutorial 5: Build ACA with Dapr</em>)</li><li><strong>Managing Secrets With Dapr</strong> - We'll look at the Secrets API (a key Building Block of Dapr) and learn how it simplifies management of sensitive information in ACA.</li><li><strong>Microservices + Serverless On Azure</strong> - We recap Week 2 (<em>Microservices</em>) and set the stage for Week 3 ( <em>Integrations</em>) of Serverless September. Plus, self-study resources including ACA development tutorials in different languages.</li></ol><p>Ready? Let's go!</p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="azure-container-apps">Azure Container Apps!<a class="hash-link" href="#azure-container-apps" title="Direct link to heading">‚Äã</a></h2><p>When building your application, your first decision is about <em>where you host your application</em>. The <a href="https://docs.microsoft.com/azure/architecture/guide/technology-choices/compute-decision-tree?WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Azure Architecture Center has a handy chart</a> to help you decide between choices like Azure Functions, Azure App Service, Azure Container Instances, Azure Container Apps and more. But if you are new to this space, you'll need a good understanding of the terms and concepts behind the services Today, we'll focus on <em>Azure Container Apps</em> (ACA) - so let's start with the fundamentals.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="containerized-app-defined">Containerized App Defined<a class="hash-link" href="#containerized-app-defined" title="Direct link to heading">‚Äã</a></h3><p>A containerized app is one where the application components, dependencies, and configuration, are packaged into a single file (<strong>container image</strong>), which can be instantiated in an isolated runtime environment (<strong>container</strong>) that is portable across hosts (OS). This makes containers lightweight and scalable - and ensures that applications behave consistently on different host platforms.</p><p>Container images can be shared via  <strong>container registries</strong> (public or private) helping developers discover and deploy related apps with less effort. <strong>Scaling</strong> a containerized app can be as simple as activating more instances of its container image. However, this requires <strong>container orchestrators</strong> to automate the management of container apps for efficiency. Orchestrators use technologies like Kubernetes to support capabilities like <em>workload scheduling, self-healing and auto-scaling on demand</em>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="cloud-native--microservices">Cloud Native &amp; Microservices<a class="hash-link" href="#cloud-native--microservices" title="Direct link to heading">‚Äã</a></h3><p>Containers are seen as one of the <a href="https://techcommunity.microsoft.com/t5/apps-on-azure-blog/go-cloud-native-with-azure-container-apps/ba-p/3616407?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">5 pillars of Cloud Native app development</a>, an approach where applications are designed explicitly to take advantage of the unique benefits of modern dynamic environments (involving public, private and hybrid clouds). Containers are particularly suited to <strong>serverless solutions based on microservices</strong>.</p><ul><li><em>With serverless</em> - developers use <strong>managed services</strong> instead of managing their own infrastructure. Services are typically event-driven and can be configured for autoscaling with rules tied to event triggers. Serverless is cost-effective, with developers paying only for the compute cycles and resources they use.</li><li><em>With microservices</em> - developers <strong>compose their applications from independent components</strong>. Each component can be deployed in its own container, and scaled at that granularity. This simplifies component reuse (across apps) and maintainability (over time) - with developers evolving functionality at microservice (vs. app) levels.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="hello-azure-container-apps">Hello, Azure Container Apps!<a class="hash-link" href="#hello-azure-container-apps" title="Direct link to heading">‚Äã</a></h3><p>Azure Container Apps is the managed service that helps you run containerized apps and microservices as a serverless compute solution, on Azure. You can:</p><ul><li><strong>deploy serverless API endpoints</strong> - autoscaled by HTTP request traffic</li><li><strong>host background processing apps</strong> - autoscaled by CPU or memory load</li><li><strong>handle event-driven processing</strong> - autoscaled by #messages in queue</li><li><strong>run microservices</strong> - autoscaled by any KEDA-supported scaler.</li></ul><p>Want a quick intro to the topic? Start by watching the short video below - then read these two posts from our <em>ZeroToHero</em> series:</p><ul><li><a href="https://techcommunity.microsoft.com/t5/apps-on-azure-blog/go-cloud-native-with-azure-container-apps/ba-p/3616407?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Go cloud native with Azure Container Apps</a> - also see <a href="http://localhost:3000/Cloud-Native/assets/images/Go-Cloud-Native-f6ac3225c3d9741a1fbff81030f7f830.png" target="_blank" rel="noopener noreferrer">the illustrated guide</a></li><li><a href="https://techcommunity.microsoft.com/t5/apps-on-azure-blog/journey-to-the-cloud-with-azure-container-apps/ba-p/3622609?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Journey to the cloud with Azure Container Apps</a> - for developer tooling options.</li></ul><iframe width="600" height="400" src="https://www.youtube.com/embed/b3dopSTnSRg" title="How to Build and Deliver Apps Fast and Scalable with Azure Container Apps" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"></iframe><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="deploy-your-first-aca">Deploy Your First ACA<a class="hash-link" href="#deploy-your-first-aca" title="Direct link to heading">‚Äã</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="dev-options">Dev Options<a class="hash-link" href="#dev-options" title="Direct link to heading">‚Äã</a></h3><p>We typically have <strong>three options</strong> for development:</p><ul><li>Use the <a href="https://docs.microsoft.com/azure/container-apps/get-started-existing-container-image-portal?pivots=container-apps-private-registry" target="_blank" rel="noopener noreferrer">Azure Portal</a> - provision and deploy from a browser.</li><li>Use <a href="https://docs.microsoft.com/azure/container-apps/deploy-visual-studio-code" target="_blank" rel="noopener noreferrer">Visual Studio Code</a> (with relevant extensions) - if you prefer an IDE</li><li>Using <a href="https://docs.microsoft.com/azure/container-apps/get-started-existing-container-image?tabs=bash&amp;pivots=container-apps-private-registry" target="_blank" rel="noopener noreferrer">Azure CLI</a> - if you prefer to build and deploy from command line.</li></ul><p>The documentation site has quickstarts for three contexts:</p><ul><li><a href="https://docs.microsoft.com/azure/container-apps/quickstart-portal" target="_blank" rel="noopener noreferrer">using a sample container image</a> - pre-existing example on Azure for convenience</li><li><a href="https://docs.microsoft.com/azure/container-apps/get-started-existing-container-image-portal?pivots=container-apps-private-registry" target="_blank" rel="noopener noreferrer">using a custom container image</a> - to understand container registry usage</li><li><a href="https://docs.microsoft.com/azure/container-apps/quickstart-code-to-cloud?tabs=bash%2Ccsharp&amp;pivots=acr-remote" target="_blank" rel="noopener noreferrer">using code on your local machine</a> - to start from source repo</li></ul><p>For this quickstart, we'll go with the first option (sample image) so we can move quickly to core concepts. We'll leave the others as an exercise for you to explore.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-setup-resources">1. Setup Resources<a class="hash-link" href="#1-setup-resources" title="Direct link to heading">‚Äã</a></h3><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>PRE-REQUISITES</div><div class="admonitionContent_S0QG"><p>You need:</p><ul><li>An Azure account with an active subscription</li><li>An installed <a href="https://docs.microsoft.com/cli/azure/install-azure-cli" target="_blank" rel="noopener noreferrer">Azure CLI</a></li></ul></div></div><p>Start by logging into Azure from the CLI. The command should launch a browser to complete the auth flow (or give you an option to take an alternative path).</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ az login</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Successful authentication will result in extensive command-line output detailing the status of your subscription. </p><p>Next, install the Azure Container Apps extension for the CLI</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ az extension </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"> --name containerapp --upgrade</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The installed extension </span><span class="token string" style="color:#e3116c">'containerapp'</span><span class="token plain"> is </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> preview.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Once successfully installed, register the <code>Microsoft.App</code> namespace.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ az provider register --namespace Microsoft.App</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then set local <em>environment variables</em> in that terminal - and verify they are set correctly:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token assign-left variable" style="color:#36acaa">RESOURCE_GROUP</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">"my-container-apps"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token assign-left variable" style="color:#36acaa">LOCATION</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">"canadacentral"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token assign-left variable" style="color:#36acaa">CONTAINERAPPS_ENVIRONMENT</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">"my-environment"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$LOCATION</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$RESOURCE_GROUP</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$CONTAINERAPPS_ENVIRONMENT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">canadacentral my-container-apps my-environment</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now you can use Azure CLI to provision a <em>resource group</em> for this tutorial. Creating a resource group also makes it easier for us to delete/reclaim all resources used at the end of this tutorial.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">az group create </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --name </span><span class="token variable" style="color:#36acaa">$RESOURCE_GROUP</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --location </span><span class="token variable" style="color:#36acaa">$LOCATION</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-success alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Congratulations</div><div class="admonitionContent_S0QG"><p>You completed the Setup step!</p><p>On completion, the console should print out the details of the newly created resource group. You should also be able to visit the Azure Portal and find the newly-active <code>my-container-apps</code> resource group under your active subscription.</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-create-environment">2. Create Environment<a class="hash-link" href="#2-create-environment" title="Direct link to heading">‚Äã</a></h3><p>An environment is like the picket fence around your property. It creates a <em>secure boundary</em> that contains a group of container apps - such that all apps deployed to it share the same virtual network and logging resources.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ az containerapp </span><span class="token function" style="color:#d73a49">env</span><span class="token plain"> create </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --name </span><span class="token variable" style="color:#36acaa">$CONTAINERAPPS_ENVIRONMENT</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --resource-group </span><span class="token variable" style="color:#36acaa">$RESOURCE_GROUP</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --location </span><span class="token variable" style="color:#36acaa">$LOCATION</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">No Log Analytics workspace provided.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Generating a Log Analytics workspace with name </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This can take a few minutes. When done, you will see the terminal display more details. You can also check the resource group in the portal and see that a <em>Container Apps Environment</em> and a <em>Log Analytics Workspace</em> are created for you as part of this step.</p><p>You've got the fence set up. Now it's time to build your home - er, container app!</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-create-container-app">3. Create Container App<a class="hash-link" href="#3-create-container-app" title="Direct link to heading">‚Äã</a></h3><p>Here's the command we'll use to create our first Azure Container App. Note that the <code>--image</code> argument provides the link to a pre-existing <code>containerapps-helloworld</code> image. </p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">az containerapp create </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --name my-container-app </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --resource-group </span><span class="token variable" style="color:#36acaa">$RESOURCE_GROUP</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --environment </span><span class="token variable" style="color:#36acaa">$CONTAINERAPPS_ENVIRONMENT</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --image mcr.microsoft.com/azuredocs/containerapps-helloworld:latest </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --target-port </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --ingress </span><span class="token string" style="color:#e3116c">'external'</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --query properties.configuration.ingress.fqdn</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Container app created. Access your app at </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">URL</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <code>--ingress</code> property shows that the app is open to <em>external</em> requests; in other words, it is publicly visible at the <code>&lt;URL&gt;</code> that is printed out on the terminal on successsful completion of this step.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-verify-deployment">4. Verify Deployment<a class="hash-link" href="#4-verify-deployment" title="Direct link to heading">‚Äã</a></h3><p>Let's see if this works. You can verify that your container app by visitng the URL returned above in your browser. You should see something like this!</p><p><img loading="lazy" alt="Container App Hello World" src="/Cloud-Native/assets/images/container-app-1a029ba3f5cdc98611115e803e2b3faf.png" width="613" height="429" class="img_ev3q"></p><p>You can also visit the Azure Portal and look under the created Resource Group. You should see a new <code>Container App</code> type of resource was created after this step.</p><div class="theme-admonition theme-admonition-success alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Congratulations</div><div class="admonitionContent_S0QG"><p>You just created and deployed your first "Hello World" Azure Container App! This validates your local development environment setup and existence of a valid Azure subscription.</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-clean-up-your-resources">5. Clean Up Your Resources<a class="hash-link" href="#5-clean-up-your-resources" title="Direct link to heading">‚Äã</a></h3><p>It's good practice to clean up resources once you are done with a tutorial. </p><div class="theme-admonition theme-admonition-warning alert alert--danger admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>THIS ACTION IS IRREVERSIBLE</div><div class="admonitionContent_S0QG"><p> This command deletes the resource group we created above - and all resources in it. So make sure you specified the right name, then confirm deletion.</p></div></div><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ az group delete --name </span><span class="token variable" style="color:#36acaa">$RESOURCE_GROUP</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Are you sure you want to perform this operation? </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">y/n</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">: </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Note that you can also delete the resource group from the Azure Portal interface if that feels more comfortable. For now, we'll just use the Portal to verify that deletion occurred. If you had previously opened the Resource Group page for the created resource, just refresh it. You should see something like this:</p><p><img loading="lazy" alt="Resource Not Found" src="/Cloud-Native/assets/images/resource-not-found-110bd93de87498c4c7a70722f1ee7c01.png" width="438" height="216" class="img_ev3q"></p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="core-concepts">Core Concepts<a class="hash-link" href="#core-concepts" title="Direct link to heading">‚Äã</a></h2><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>COMING SOON</div><div class="admonitionContent_S0QG"><p>An illustrated guide summarizing these concepts in a single sketchnote.</p></div></div><p>We covered a lot today - we'll stop with a quick overview of core concepts behind Azure Container Apps, each linked to documentation for self-study. We'll dive into more details on <em>some</em> of these concepts in upcoming articles:</p><ul><li><a href="https://docs.microsoft.com/azure/container-apps/environment" target="_blank" rel="noopener noreferrer">Environments</a> - are the <em>secure boundary</em> around a group of container apps that are deployed in the same virtual network. They write logs to a shared Log Analytics workspace and can communicate seamlessly using Dapr, if used.</li><li><a href="https://docs.microsoft.com/azure/container-apps/containers" target="_blank" rel="noopener noreferrer">Containers</a> refer to the <em>container image</em> deployed in the Azure Container App. They can use any runtime, programming language, or development stack - and be discovered using any public or private container registry. A container app can support multiple containers.</li><li><a href="https://docs.microsoft.com/azure/container-apps/revisions" target="_blank" rel="noopener noreferrer">Revisions</a> are <em>immutable</em> snapshots of an Azure Container App. The first revision is created when the ACA is first deployed, with new revisions created when redeployment occurs with <a href="https://docs.microsoft.com/azure/container-apps/revisions#revision-scope-changes" target="_blank" rel="noopener noreferrer">revision-scope changes</a>. Multiple revisions can run concurrently in an environment.</li><li><a href="https://docs.microsoft.com/azure/container-apps/application-lifecycle-management" target="_blank" rel="noopener noreferrer">Application Lifecycle Management</a> revolves around these revisions, with a container app having three phases: <em>deployment</em>, <em>update</em> and <em>deactivation</em>.</li><li><a href="https://docs.microsoft.com/azure/container-apps/microservices" target="_blank" rel="noopener noreferrer">Microservices</a> are independent units of functionality in cloud native architectures. <em>A single container app typically represents a single microservice</em>, and can be composed from one or more containers. Microservices can now be scaled and upgraded indepedently, giving your application more flexbility and control.</li><li><a href="https://docs.microsoft.com/azure/container-apps/networking" target="_blank" rel="noopener noreferrer">Networking</a> architecture consist of a virtual network (VNET) associated with the environment. Unless you provide a custom VNET at environment creation time, a default VNET is automatically created. The VNET configuration determines access (ingress, internal vs. external) and can influence auto-scaling choices (e.g., use HTTP Edge Proxy and scale based on number of HTTP requests).</li><li><a href="https://docs.microsoft.com/azure/container-apps/observability" target="_blank" rel="noopener noreferrer">Observability</a> is about monitoring the health of your application and diagnosing it to improve reliability or performance. Azure Container Apps has a number of features - from Log streaming and Container console to integration with Azure Monitor - to provide a holistic view of application status over time.</li><li><a href="https://docs.microsoft.com/azure/container-apps/authentication" target="_blank" rel="noopener noreferrer">Easy Auth</a> is possible with built-in support for authentication and authorization including support for popular identity providers like Facebook, Google, Twitter and GitHub - alongside the Microsoft Identity Platform.</li></ul><p>Keep these terms in mind as we walk through more tutorials this week, to see how they find application in real examples. Finally, a note on Dapr, the <a href="http://dapr.io" target="_blank" rel="noopener noreferrer">Distributed Application Runtime</a> that abstracts away many of the challenges posed by distributed systems - and lets you focus on your application logic.</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>DAPR INTEGRATION MADE EASY</div><div class="admonitionContent_S0QG"><p><a href="https://docs.microsoft.com/azure/container-apps/dapr-overview?tabs=bicep1%2Cyaml" target="_blank" rel="noopener noreferrer">Dapr</a> uses a sidecar architecture, allowing Azure Container Apps to communicate with Dapr Building Block APIs over either gRPC or HTTP. Your ACA can be built to run with or without Dapr - giving you the flexibility to <em>incrementally adopt</em> specific APIs and unlock related capabilities as the need arises.</p></div></div><p><img loading="lazy" src="https://docs.dapr.io/images/overview-sidecar-model.png" class="img_ev3q"></p><p>In later articles this week, we'll do a deeper dive into Dapr and build our first Dapr-enable Azure Container App to get a better understanding of this integration.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="exercise">Exercise<a class="hash-link" href="#exercise" title="Direct link to heading">‚Äã</a></h2><p>Congratulations! You made it! By now you should have a good idea of what Cloud Native development means, why Microservices and Containers are important to that vision - and how Azure Container Apps helps simplify the building and deployment of <em>microservices based applications</em> using <em>serverless architectures</em> on Azure.</p><p>Now it's your turn to reinforce learning by doing.</p><ul><li>Try walking through this quickstart yourself, but <a href="https://docs.microsoft.com/azure/container-apps/quickstart-portal" target="_blank" rel="noopener noreferrer">using the Azure Portal</a> option.</li><li>Then try a <a href="https://docs.microsoft.com/azure/container-apps/deploy-visual-studio-code" target="_blank" rel="noopener noreferrer">custom container image</a> option using Visual Studio Code, and validate your IDE-based setup for future tutorials.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="resources">Resources<a class="hash-link" href="#resources" title="Direct link to heading">‚Äã</a></h2><p>Three key resources to bookmark and explore:</p><ul><li><a href="https://docs.microsoft.com/azure/container-apps/" target="_blank" rel="noopener noreferrer">Azure Container Apps</a> - documentation</li><li><a href="https://docs.dapr.io/" target="_blank" rel="noopener noreferrer">Distributed Application Runtime (Dapr)</a> - documentation</li><li><a href="https://docs.microsoft.com/azure/container-apps/samples" target="_blank" rel="noopener noreferrer">Azure Container Apps</a> - samples for exploration</li></ul>]]></content>
        <author>
            <name>Nitya Narasimhan</name>
            <uri>https://github.com/nitya</uri>
        </author>
        <category label="serverless-september" term="serverless-september"/>
        <category label="30-days-of-serverless" term="30-days-of-serverless"/>
        <category label="azure-container-apps" term="azure-container-apps"/>
        <category label="dapr" term="dapr"/>
        <category label="microservices" term="microservices"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[10. Microservices Communication]]></title>
        <id>microservices-10</id>
        <link href="https://azure.github.io/Cloud-Native/blog/microservices-10"/>
        <updated>2022-09-10T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Continuing our journey into Azure Container Apps with a look at microservices hosting, and how they communicate with each other in the context of Azure Container Apps!]]></summary>
        <content type="html"><![CDATA[<hr><p>Welcome to <code>Day 10</code> of #30DaysOfServerless!</p><p>We continue our exploraton into Azure Container Apps, with today's focus being <em>communication</em> between microservices, and how to configure your Azure Container Apps environment in the context of a deployment example.</p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-well-cover">What We'll Cover<a class="hash-link" href="#what-well-cover" title="Direct link to heading">‚Äã</a></h2><ul><li>ACA Environments &amp; Virtual Networking</li><li>Basic Microservices Communications</li><li>Walkthrough: ACA Deployment Example</li><li>Summary and Next Steps</li><li>Exercise: Try this yourself!</li><li>Resources: For self-study!</li></ul><p><img loading="lazy" src="/Cloud-Native/assets/images/banner-011f28077c2b653cb428e81b3645ca5b.png" width="1600" height="672" class="img_ev3q"></p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a class="hash-link" href="#introduction" title="Direct link to heading">‚Äã</a></h2><p>In yesterday's post, we learned what the Azure Container Apps (ACA) service is and the problems it aims to solve. It is considered to be a Container-as-a-Service platform since much of the complex implementation details of running a Kubernetes cluster is managed for you.</p><p>Some of the use cases for ACA include event-driven processing jobs and background tasks, but this article will focus on hosting microservices, and how they can communicate with each other within the ACA service. At the end of this article, you will have a solid understanding of how networking and communication is handled and will leave you with a few tutorials to try.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="environments-and-virtual-networking-in-aca">Environments and virtual networking in ACA<a class="hash-link" href="#environments-and-virtual-networking-in-aca" title="Direct link to heading">‚Äã</a></h2><p>Before we jump into microservices communication, we should review how networking works within ACA. With ACA being a managed service, Azure will take care of most of your underlying infrastructure concerns. As you provision an ACA resource, Azure provisions an Environment to deploy Container Apps into. This environment is your isolation boundary.</p><p><img loading="lazy" src="https://docs.microsoft.com/azure/container-apps/media/environments/azure-container-apps-environments.png" alt="Azure Container Apps Environment" class="img_ev3q"></p><p>By default, Azure creates and manages a new Virtual Network (VNET) for you and the VNET is associated with the environment. As you deploy container apps, they are deployed into the same VNET and the environment is assigned a static public IP address which allows your apps to be accessible over the internet. This VNET is not visible or manageable.</p><p>If you need control of the networking flows within the VNET, you can pre-provision one and tell Azure to deploy an environment within it. This "bring-your-own" VNET model allows you to deploy an environment in either <strong>External</strong> or <strong>Internal</strong> modes. Deploying an environment in <strong>External</strong> mode gives you the flexibility of managing your own VNET, while still allowing your containers to be accessible from outside the environment; a static public IP address is assigned to the environment. When deploying in <strong>Internal</strong> mode, your containers are accessible within the environment and/or VNET but not accessible from the internet.</p><p>Bringing your own VNET will require some planning and you will need dedicate an empty subnet which will be used exclusively by the ACA environment. The size of your subnet will be dependant on how many containers you plan on deploying and your scaling requirements and one requirement to know is that the subnet address range must have have a <code>/23</code> CIDR prefix at minimum. You will also need to think about your deployment strategy since ACA has the concept of <strong>Revisions</strong> which will also consume IPs from your subnet.</p><p>Some additional restrictions to consider when planning your subnet address space is listed in the Resources section below and can be addressed in future posts, so be sure to follow us on <a href="https://dev.to/azure" target="_blank" rel="noopener noreferrer">dev.to</a> and bookmark the <a href="https://aka.ms/serverless-september" target="_blank" rel="noopener noreferrer">ServerlessSeptember</a> site.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="basic-microservices-communication-in-aca">Basic microservices communication in ACA<a class="hash-link" href="#basic-microservices-communication-in-aca" title="Direct link to heading">‚Äã</a></h2><p>When it comes to communications between containers, ACA addresses this concern with its <strong>Ingress</strong> capabilities. With <strong>HTTP Ingress</strong> enabled on your container app, you can expose your app on a HTTPS endpoint.</p><p>If your environment is deployed using default networking and your containers needs to be accessible from outside the environment, you will need to set the <strong>Ingress traffic</strong> option to <strong>Accepting traffic from anywhere</strong>. This will generate a Full-Qualified Domain Name (FQDN) which you can use to access your app right away. The ingress feature also generates and assigns a Secure Socket Layer (SSL) certificate for the FQDN.</p><p><img loading="lazy" alt="External ingress on Container App" src="/Cloud-Native/assets/images/external-ingress-a58989faae5a9d1d6dd0367a2bab4aa6.png" width="1145" height="961" class="img_ev3q"></p><p>If your environment is deployed using default networking and your containers only need to communicate with other containers in the environment, you'll need to set the <strong>Ingress traffic</strong> option to <strong>Limited to Container Apps Environment</strong>. You get a FQDN here as well, but in the section below we'll see how that changes.</p><p><img loading="lazy" alt="Internal ingress on Container App" src="/Cloud-Native/assets/images/internal-ingress-3213762a354d70c030a4f78f805d3d5b.png" width="1141" height="954" class="img_ev3q"></p><p>As mentioned in the networking section above, if you deploy your ACA environment into a VNET in <strong>internal</strong> mode, your options will be <strong>Limited to Container Apps Environment</strong> or <strong>Limited to VNet</strong>.</p><p><img loading="lazy" alt="Ingress on internal virtual network" src="/Cloud-Native/assets/images/internal-vnet-ingress-bc30bf6819a1bd37aa60f3f8f5f23001.png" width="2072" height="1596" class="img_ev3q"></p><blockquote><p>Note how the <strong>Accepting traffic from anywhere</strong> option is greyed out. If your VNET is deployed in <strong>external</strong> mode, then the option will be available.</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="lets-walk-though-an-example-aca-deployment">Let's walk though an example ACA deployment<a class="hash-link" href="#lets-walk-though-an-example-aca-deployment" title="Direct link to heading">‚Äã</a></h2><p>The diagram below illustrates a simple microservices application that I deployed to ACA. The three container apps all have ingress enabled. The <code>greeting-service</code> app calls two backend services; a <code>hello-service</code> that returns the text <strong>Hello</strong> (in random casing) and a <code>world-service</code> that returns the text <strong>World</strong> (in a few random languages). The greeting-service concatenates the two strings together and returns <strong>Hello World</strong> to the browser. The greeting-service is the only service accessible via external ingress while two backend services are only accessible via internal ingress.</p><p><img loading="lazy" alt="Greeting Service overview" src="/Cloud-Native/assets/images/greeting-service-overview-82b526122516cb01180da2f93577dde2.png" width="975" height="718" class="img_ev3q"></p><p>With ingress enabled, let's take a quick look at the FQDN structures. Here is the FQDN of the <strong>external</strong> greeting-service.</p><p><code>https://greeting-service.victoriouswave-3749d046.eastus.azurecontainerapps.io</code></p><p>We can break it down into these components:</p><p><code>https://</code><strong>[YOUR-CONTAINER-APP-NAME]</strong><code>.</code><strong>[RANDOM-NAME]</strong><code>-</code><strong>[RANDOM-CHARACTERS]</strong><code>.</code><strong>[AZURE-REGION]</strong><code>.containerapps.io</code></p><p>And here is the FQDN of the <strong>internal</strong> hello-service.</p><p><code>https://hello-service.internal.victoriouswave-3749d046.eastus.azurecontainerapps.io</code></p><p>Can you spot the difference between FQDNs?</p><p>That was too easy üòâ... the word <code>internal</code> is added as a subdomain in the FQDN between your container app name and the random name for all internal ingress endpoints.</p><p><code>https://</code><strong>[YOUR-CONTAINER-APP-NAME]</strong><code>.internal.</code><strong>[RANDOM-NAME]</strong><code>-</code><strong>[RANDOM-CHARACTERS]</strong><code>.</code><strong>[AZURE-REGION]</strong><code>.containerapps.io</code></p><p>Now that we know the internal service FQDNs, we use them in the greeting-service app to achieve basic service-to-service communications.</p><p>So we can inject FQDNs of downstream APIs to upstream apps using environment variables, but the downside to this approach is that need to deploy downstream containers ahead of time and this dependency will need to be planned for during your deployment process. There are ways around this and one option is to leverage the auto-injected environment variables within your app code.</p><p>If I use the Console blade for the hello-service container app and run the <code>env</code> command, you will see environment variables named <code>CONTAINER_APP_NAME</code> and <code>CONTAINER_APP_ENV_DNS_SUFFIX</code>. You can use these values to determine FQDNs within your upstream app.</p><p><img loading="lazy" alt="hello-service environment variables" src="/Cloud-Native/assets/images/hello-service-b70e9c9ef34aac8e97e71d35d60a74bb.png" width="2342" height="1992" class="img_ev3q"></p><p>Back in the <code>greeting-service</code> container I can invoke the hello-service container's <code>sayhello</code> method. I know the container app name is hello-service and this service is exposed over an internal ingress, therefore, if I add the <code>internal</code> subdomain to the <code>CONTAINER_APP_ENV_DNS_SUFFIX</code> I can invoke a HTTP request to the hello-service from my greeting-service container.</p><p><img loading="lazy" alt="Invoke the sayHello method from the greeting-service container" src="/Cloud-Native/assets/images/say-hello-5da6958b9234cb77ac10233e86aa8c35.png" width="1133" height="955" class="img_ev3q"></p><p>As you can see, the ingress feature enables communications to other container apps over HTTP/S and ACA will inject environment variables into our container to help determine what the ingress FQDNs would be. All we need now is a little bit of code modification in the greeting-service app and build the FQDNs of our backend APIs by retrieving these environment variables.</p><p><img loading="lazy" alt="Greeting service code" src="/Cloud-Native/assets/images/greeting-service-code-1cd635977624067366d2a9956fcb86ee.png" width="764" height="468" class="img_ev3q"></p><p>... and now we have a working microservices app on ACA! üéâ</p><p><img loading="lazy" alt="Hello World" src="/Cloud-Native/assets/images/aca-microservice-52095d278f64dc70345877580846389e.png" width="683" height="422" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="summary-and-next-steps">Summary and next steps<a class="hash-link" href="#summary-and-next-steps" title="Direct link to heading">‚Äã</a></h2><p>We've covered Container Apps networking and the basics of how containers communicate with one another. However, there is a better way to address service-to-service invocation using Dapr, which is an open-source framework for building microservices. It is natively integrated into the ACA service and in a future post, you'll learn how to enable it in your Container App to address microservices concerns and more. So stay tuned!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="exercises">Exercises<a class="hash-link" href="#exercises" title="Direct link to heading">‚Äã</a></h2><p>As a takeaway for today's post, I encourage you to complete this <a href="https://docs.microsoft.com/azure/container-apps/communicate-between-microservices?tabs=bash&amp;pivots=acr-remote" target="_blank" rel="noopener noreferrer">tutorial</a> and if you'd like to deploy the sample app that was presented in this article, my teammate <a href="https://github.com/smurawski" target="_blank" rel="noopener noreferrer">@StevenMurawski</a> is hosting a <a href="https://github.com/smurawski/docker-compose-examples" target="_blank" rel="noopener noreferrer">docker-compose-examples</a> repo which includes samples for deploying to ACA using Docker Compose files. To learn more about the <code>az containerapp compose</code> command, a link to his blog articles are listed in the Resources section below.</p><p>If you have any questions or feedback, please let us know in the comments below or reach out on Twitter <a href="https://twitter.com/pauldotyu" target="_blank" rel="noopener noreferrer">@pauldotyu</a></p><p>Have fun packing and shipping containers! See you in the next post!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="resources">Resources<a class="hash-link" href="#resources" title="Direct link to heading">‚Äã</a></h2><ul><li><a href="https://docs.microsoft.com/azure/container-apps/communicate-between-microservices?tabs=bash&amp;pivots=acr-remote" target="_blank" rel="noopener noreferrer">Tutorial: Communication between microservices in Azure Container Apps</a></li><li><a href="https://github.com/smurawski/docker-compose-examples/tree/main/nodejs_greet" target="_blank" rel="noopener noreferrer">Tutorial: greeting-service (docker-compose-example)</a></li><li><a href="https://docs.microsoft.com/azure/container-apps/environment" target="_blank" rel="noopener noreferrer">Concept: Azure Container App Environments</a></li><li><a href="https://docs.microsoft.com/azure/container-apps/networking#http-edge-proxy-behavior" target="_blank" rel="noopener noreferrer">Concept: Azure Container App Ingress</a></li><li><a href="https://docs.microsoft.com/azure/container-apps/networking#restrictions" target="_blank" rel="noopener noreferrer">Concept: Azure Container App VNET Restrictions</a></li><li><a href="https://techcommunity.microsoft.com/t5/apps-on-azure-blog/accelerating-azure-container-apps-with-the-azure-cli-and-compose/ba-p/3516636" target="_blank" rel="noopener noreferrer">Blog: Accelerating Azure Container Apps with the Azure CLI and Compose Files</a></li><li><a href="https://techcommunity.microsoft.com/t5/apps-on-azure-blog/more-fun-with-azure-container-apps-and-compose-files/ba-p/3570234" target="_blank" rel="noopener noreferrer">Blog: More Fun with Azure Container Apps and Compose Files</a></li></ul><blockquote><p>The sample app presented here was inspired by services demonstrated in the book <a href="https://www.amazon.com/Introducing-Distributed-Application-Runtime-Dapr/dp/1484269977" target="_blank" rel="noopener noreferrer">Introducing Distributed Application Runtime (Dapr): Simplifying Microservices Applications Development Through Proven and Reusable Patterns and Practices</a>. Go check it out to leran more about Dapr!</p></blockquote>]]></content>
        <author>
            <name>Paul Yu</name>
            <uri>https://github.com/pauldotyu</uri>
        </author>
        <category label="serverless-september" term="serverless-september"/>
        <category label="30-days-of-serverless" term="30-days-of-serverless"/>
        <category label="azure-container-apps" term="azure-container-apps"/>
        <category label="microservices" term="microservices"/>
        <category label="docker-compose" term="docker-compose"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[11. Scaling Container Apps]]></title>
        <id>11-scaling-container-apps</id>
        <link href="https://azure.github.io/Cloud-Native/blog/11-scaling-container-apps"/>
        <updated>2022-09-11T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[<FIXME>]]></summary>
        <content type="html"><![CDATA[<hr><p>Welcome to <code>Day 11</code> of #30DaysOfServerless!</p><p>Yesterday we explored Azure Container Concepts related to environments, networking and microservices communication - and illustrated these with a deployment example. Today, we turn our attention to <em>scaling</em> your container apps with demand.</p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-well-cover">What We'll Cover<a class="hash-link" href="#what-well-cover" title="Direct link to heading">‚Äã</a></h2><ul><li>What makes ACA Serverless?</li><li>What is Keda?</li><li>Scaling Your ACA</li><li>ACA Scaling In Action</li><li>Exercise: Explore <a href="https://aka.ms/oss-labs" target="_blank" rel="noopener noreferrer">azure-opensource-labs</a> examples</li><li>Resources: For self-study!</li></ul><p><img loading="lazy" src="/Cloud-Native/assets/images/banner-3e6ce6ac4f59bb1c536972dced457df3.png" width="1600" height="672" class="img_ev3q"></p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="so-what-makes-azure-container-apps-serverless">So, what makes Azure Container Apps "serverless"?<a class="hash-link" href="#so-what-makes-azure-container-apps-serverless" title="Direct link to heading">‚Äã</a></h2><p>Today we are going to focus on what makes Azure Container Apps (ACA) a "serverless" offering. But what does the term "<em>serverless</em>" really mean? As much as we'd like to think there aren't any servers involved, that is certainly not the case. In general, "serverless" means that most (if not all) server maintenance has been abstracted away from you.</p><p>With serverless, you don't spend any time managing and patching servers. This concern is offloaded to Azure and you simply focus on adding business value through application delivery. In addition to operational efficiency, cost efficiency can be achieved with serverless on-demand pricing models. Your workload horizontally scales out based on need and you only pay for what you use. To me, this is <strong>serverless</strong>, and my teammate <a href="https://github.com/smurawski" target="_blank" rel="noopener noreferrer">@StevenMurawski</a> said it best... "<em>being able to <strong>scale to zero </strong>is what gives ACA it's serverless magic</em>."</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="scaling-your-container-apps">Scaling your Container Apps<a class="hash-link" href="#scaling-your-container-apps" title="Direct link to heading">‚Äã</a></h2><p>If you don't know by now, ACA is built on a solid open-source foundation. Behind the scenes, it runs on a managed Kubernetes cluster and includes several open-source components out-of-the box including <a href="https://dapr.io/" target="_blank" rel="noopener noreferrer">Dapr</a> to help you build and run microservices, <a href="https://www.envoyproxy.io/" target="_blank" rel="noopener noreferrer">Envoy Proxy</a> for ingress capabilities, and <a href="https://keda.sh/" target="_blank" rel="noopener noreferrer">KEDA</a> for event-driven autoscaling. Again, you do not need to install these components yourself. All you need to be concerned with is enabling and/or configuring your container app to leverage these components.</p><p>Let's take a closer look at autoscaling in ACA to help you optimize your container app.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-keda">What is KEDA?<a class="hash-link" href="#what-is-keda" title="Direct link to heading">‚Äã</a></h3><p>KEDA stands for <strong>K</strong>ubernetes <strong>E</strong>vent-<strong>D</strong>riven <strong>A</strong>utoscaler. It is an open-source project initially started by Microsoft and Red Hat and has been donated to the <a href="https://www.cncf.io/" target="_blank" rel="noopener noreferrer">Cloud Native Computing Foundation (CNCF)</a>. It is being maintained by a <a href="https://keda.sh/community/" target="_blank" rel="noopener noreferrer">community of 200+ contributors and adopted by many large organizations</a>. In terms of its status as a CNCF project it is currently in the <a href="https://github.com/cncf/toc/blob/main/process/graduation_criteria.md#incubating-stage" target="_blank" rel="noopener noreferrer"><strong>Incubating Stage</strong></a> which means the project has gone through significant due diligence and on its way towards the <a href="https://github.com/cncf/toc/blob/main/process/graduation_criteria.md#graduation-stage" target="_blank" rel="noopener noreferrer"><strong>Graduation Stage</strong></a>.</p><p>Prior to KEDA, horizontally scaling your Kubernetes deployment was achieved through the <a href="https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale/" target="_blank" rel="noopener noreferrer">Horizontal Pod Autoscaler (HPA)</a> which relies on resource metrics such as CPU and memory to determine when additional replicas should be deployed. Being limited to CPU and memory falls a bit short for certain workloads. This is especially true for apps that need to processes messages from a queue or HTTP-based apps that can handle a specific amount of incoming HTTP requests at a time. KEDA aims to fill that gap and provides a much more robust framework for scaling by working in conjunction with HPA. It offers many <a href="https://keda.sh/docs/scalers/" target="_blank" rel="noopener noreferrer">scalers</a> for you to implement and even allows your deployments to <strong>scale to zero</strong>! ü•≥</p><p><img loading="lazy" alt="KEDA architecture" src="/Cloud-Native/assets/images/keda-arch-78fe1c48e2a47e18e6a933d96b90450a.png" width="1183" height="966" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="configuring-aca-scale-rules">Configuring ACA scale rules<a class="hash-link" href="#configuring-aca-scale-rules" title="Direct link to heading">‚Äã</a></h3><p>As I mentioned above, ACA's autoscaling feature leverages KEDA and gives you the ability to configure the number of replicas to deploy based on rules (event triggers). The number of replicas can be configured as a static number or a range (minimum and maximum). So if you need your containers to run 24/7, set the min and max to be the same value. By default, when you deploy a container app, it is set to scale from 0 to 10 replicas. The default scaling rule uses <strong>HTTP scaling</strong> and defaults to a <a href="https://docs.microsoft.com/azure/container-apps/scale-app#http" target="_blank" rel="noopener noreferrer">minimum of 10 concurrent requests</a> per second. Once the threshold of 10 concurrent request per second is met, another replica will be deployed until it reaches the maximum number of replicas.</p><blockquote><p>At the time of this writing, a container app can have up to 30 replicas.</p></blockquote><p><img loading="lazy" alt="Default autoscaler" src="/Cloud-Native/assets/images/default-autoscaler-0be6a2dc11199a7e41b54c6902c80cf1.png" width="908" height="724" class="img_ev3q"></p><p>As a best practice, if you have a <strong>Min / max replicas</strong> range configured, you should configure a scaling rule even if it is just explicitly setting the default values.</p><p><img loading="lazy" alt="Adding HTTP scaling rule" src="/Cloud-Native/assets/images/http-rule-0bab06ac77d779fb39cb439bd5e8d40f.png" width="896" height="723" class="img_ev3q"></p><p>In addition to <strong>HTTP scaling</strong>, you can also configure an <strong>Azure queue</strong> rule, which allows you to use <a href="https://docs.microsoft.com/azure/storage/queues/storage-queues-introduction" target="_blank" rel="noopener noreferrer">Azure Storage Queues</a> as an event data source.</p><p><img loading="lazy" alt="Adding Azure Queue scaling rule" src="/Cloud-Native/assets/images/queue-rule-3405f4470633607d27599bedf3698d3f.png" width="890" height="725" class="img_ev3q"></p><p>The most flexibility comes with the <strong>Custom</strong> rule type. This opens up a LOT more options for scaling. All of <a href="https://keda.sh/docs/scalers/" target="_blank" rel="noopener noreferrer">KEDA's event-based scalers</a> are supported with this option üöÄ</p><p><img loading="lazy" alt="Adding Custom scaling rule" src="/Cloud-Native/assets/images/custom-rule-8b8243abebed96f7510e03e130741648.png" width="894" height="723" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="translating-keda-templates-to-azure-templates">Translating KEDA templates to Azure templates<a class="hash-link" href="#translating-keda-templates-to-azure-templates" title="Direct link to heading">‚Äã</a></h3><p>When you implement <strong>Custom</strong> rules, you need to become familiar with translating KEDA templates to <a href="https://docs.microsoft.com/azure/container-apps/azure-resource-manager-api-spec?tabs=arm-template" target="_blank" rel="noopener noreferrer">Azure Resource Manager templates</a> or <a href="https://docs.microsoft.com/azure/container-apps/azure-resource-manager-api-spec?tabs=yaml" target="_blank" rel="noopener noreferrer">ACA YAML manifests</a>. The <a href="https://keda.sh/docs/scalers/" target="_blank" rel="noopener noreferrer">KEDA scaler</a> documentation is great and it should be simple to translate KEDA template <code>metadata</code> to an ACA rule <code>metadata</code>.</p><p>The images below shows how to translated a scaling rule which uses Azure Service Bus as an event data source. The custom rule type is set to <code>azure-servicebus</code> and details of the service bus is added to the Metadata section. One important thing to note here is that the connection string to the service bus was added as a secret on the container app and the trigger parameter must be set to <code>connection</code>.</p><p><img loading="lazy" alt="Azure Container App custom rule metadata" src="/Cloud-Native/assets/images/keda-metadata-cb6407e6b7c4f9265d18904fd60f417a.png" width="1169" height="885" class="img_ev3q"></p><p><img loading="lazy" alt="Azure Container App custom rule metadata" src="/Cloud-Native/assets/images/aca-metadata-0e2c72a8f725a134927c493dde7d6c3e.png" width="1167" height="888" class="img_ev3q"></p><p>Additional examples of KEDA scaler conversion can be found in the resources section and example video below.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="see-container-app-scaling-in-action">See Container App scaling in action<a class="hash-link" href="#see-container-app-scaling-in-action" title="Direct link to heading">‚Äã</a></h2><p>Now that we've built up some foundational knowledge on how ACA autoscaling is implemented and configured, let's look at a few examples.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="autoscaling-based-on-http-traffic-load">Autoscaling based on HTTP traffic load<a class="hash-link" href="#autoscaling-based-on-http-traffic-load" title="Direct link to heading">‚Äã</a></h3><div style="padding:56.25% 0 0 0;position:relative"><iframe src="https://player.vimeo.com/video/746678347?h=8f5ada4431&amp;badge=0&amp;autopause=0&amp;player_id=0&amp;app_id=58479" frameborder="0" allow="autoplay; fullscreen; picture-in-picture" style="position:absolute;top:0;left:0;width:100%;height:100%" title="http-scaling"></iframe></div><script src="https://player.vimeo.com/api/player.js"></script><h3 class="anchor anchorWithStickyNavbar_LWe7" id="autoscaling-based-on-azure-service-bus-message-queues">Autoscaling based on Azure Service Bus message queues<a class="hash-link" href="#autoscaling-based-on-azure-service-bus-message-queues" title="Direct link to heading">‚Äã</a></h3><div style="padding:56.25% 0 0 0;position:relative"><iframe src="https://player.vimeo.com/video/746678266?h=89701121ed&amp;badge=0&amp;autopause=0&amp;player_id=0&amp;app_id=58479" frameborder="0" allow="autoplay; fullscreen; picture-in-picture" style="position:absolute;top:0;left:0;width:100%;height:100%" title="event-driven-scaling.mp4"></iframe></div><script src="https://player.vimeo.com/api/player.js"></script><h2 class="anchor anchorWithStickyNavbar_LWe7" id="summary">Summary<a class="hash-link" href="#summary" title="Direct link to heading">‚Äã</a></h2><p>ACA brings you a true serverless experience and gives you the ability to configure autoscaling rules based on KEDA scaler templates. This gives you flexibility to scale based on a wide variety of data sources in an event-driven manner. With the amount built-in scalers currently available, there is probably a scaler out there for all your use cases. If not, I encourage you to get involved with the <a href="https://keda.sh/community/" target="_blank" rel="noopener noreferrer">KEDA community</a> and help make it better!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="exercise">Exercise<a class="hash-link" href="#exercise" title="Direct link to heading">‚Äã</a></h2><p>By now, you've probably read and seen enough and now ready to give this autoscaling thing a try. The example I walked through in the videos above can be found at the <a href="https://aka.ms/oss-labs" target="_blank" rel="noopener noreferrer">azure-opensource-labs</a> repo. I highly encourage you to head over to the <a href="https://github.com/Azure-Samples/azure-opensource-labs/tree/main/cloud-native/containerapps-terraform" target="_blank" rel="noopener noreferrer">containerapps-terraform</a> folder and try the lab out. There you'll find instructions which will cover all the steps and tools you'll need implement autoscaling container apps within your own Azure subscription.</p><p>If you have any questions or feedback, please let us know in the comments below or reach out on Twitter <a href="https://twitter.com/pauldotyu" target="_blank" rel="noopener noreferrer">@pauldotyu</a></p><p>Have fun scaling your containers!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="resources">Resources<a class="hash-link" href="#resources" title="Direct link to heading">‚Äã</a></h2><ul><li><a href="https://docs.microsoft.com/azure/container-apps/scale-app" target="_blank" rel="noopener noreferrer">Set scaling rules in Azure Container Apps</a></li><li><a href="https://keda.sh/" target="_blank" rel="noopener noreferrer">Kubernetes Event-driven Autoscaling (KEDA)</a></li><li><a href="https://keda.sh/docs/scalers/" target="_blank" rel="noopener noreferrer">KEDA Scalers</a></li><li><a href="https://docs.microsoft.com/azure/container-apps/scale-app#keda-scalers-conversion" target="_blank" rel="noopener noreferrer">KEDA scalers conversion</a></li></ul>]]></content>
        <author>
            <name>Paul Yu</name>
            <uri>https://github.com/pauldotyu</uri>
        </author>
        <category label="serverless-september" term="serverless-september"/>
        <category label="30-days-of-serverless" term="30-days-of-serverless"/>
        <category label="azure-container-apps" term="azure-container-apps"/>
        <category label="keda" term="keda"/>
        <category label="autoscaling" term="autoscaling"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[üöÄ | Journey to the Cloud With ACA]]></title>
        <id>zero2hero-aca-04</id>
        <link href="https://azure.github.io/Cloud-Native/blog/zero2hero-aca-04"/>
        <updated>2022-09-12T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[In this article, we discuss how Azure Container Apps is purpose-built to support cloud native applications.]]></summary>
        <content type="html"><![CDATA[<hr><p>Welcome to <code>Day 12</code> of #30DaysOfServerless!</p><p>Today, we have a special set of posts from our <a href="/Cloud-Native/serverless-september/ZeroToHero">Zero To Hero üöÄ</a> initiative, featuring blog posts authored by our Product Engineering teams for #ServerlessSeptember. <em>Posts were originally published on the <a href="https://techcommunity.microsoft.com/t5/apps-on-azure-blog/journey-to-the-cloud-with-azure-container-apps/ba-p/3622609?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Apps on Azure</a> blog on Microsoft Tech Community.</em></p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-well-cover">What We'll Cover<a class="hash-link" href="#what-well-cover" title="Direct link to heading">‚Äã</a></h2><ul><li>Using Visual Studio</li><li>Using Visual Studio Code: Docker, ACA extensions</li><li>Using Azure CLI</li><li>Using CI/CD Pipelines</li></ul><p><img loading="lazy" src="/Cloud-Native/assets/images/zero-to-hero-anthony-2bc58afc7d6bdff1e92a0c3b87ae02cc.png" width="1600" height="672" class="img_ev3q"></p><hr><p>Last week, <a href="https://techcommunity.microsoft.com/t5/user/viewprofilepage/user-id/296868?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">@kendallroden</a> wrote about <a href="https://techcommunity.microsoft.com/t5/apps-on-azure-blog/go-cloud-native-with-azure-container-apps/ba-p/3616407" target="_blank" rel="noopener noreferrer">what it means to be cloud native</a> and how Azure Container Apps provides a serverless containers platform for hosting all of your cloud native applications. Today, we‚Äôll walk through a few ways to get your apps up and running on Azure Container Apps.</p><p>Depending on where you are in your cloud native app development journey, you might choose to use different tools to deploy your apps.</p><ul><li><strong>‚ÄúRight-click, publish‚Äù</strong> ‚Äì Deploying an app directly from an IDE or code editor is often seen as a bad practice, but it‚Äôs one of the quickest ways to test out an app in a cloud environment.</li><li><strong>Command line interface</strong> ‚Äì CLIs are useful for deploying apps from a terminal. Commands can be run manually or in a script.</li><li><strong>Continuous integration/deployment</strong> ‚Äì To deploy production apps, the recommended approach is to automate the process in a robust CI/CD pipeline.</li></ul><p>Let's explore some of these options in more depth.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="visual-studio">Visual Studio<a class="hash-link" href="#visual-studio" title="Direct link to heading">‚Äã</a></h2><p>Visual Studio 2022 has built-in support for deploying .NET applications to Azure Container Apps. You can use the familiar publish dialog to provision Container Apps resources and deploy to them directly. This helps you prototype an app and see it run in Azure Container Apps with the least amount of effort.</p><p><img loading="lazy" alt="Journey to the cloud with Azure Container Apps" src="/Cloud-Native/assets/images/anthony-create-new-3b4fb5406c400d538bab76fe7afe145f.png" width="400" height="306" class="img_ev3q"></p><p>Once you‚Äôre happy with the app and it‚Äôs ready for production, Visual Studio allows you to push your code to GitHub and set up a GitHub Actions workflow to build and deploy your app every time you push changes. You can do this by checking a box.</p><p><img loading="lazy" alt="Journey to the cloud with Azure Container Apps" src="/Cloud-Native/assets/images/anthony-deployment-type-7bdc05a874a9ccd029d95d29f291fa21.png" width="400" height="281" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="visual-studio-code">Visual Studio Code<a class="hash-link" href="#visual-studio-code" title="Direct link to heading">‚Äã</a></h2><p>There are a couple of valuable extensions that you‚Äôll want to install if you‚Äôre working in VS Code.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="docker-extension">Docker extension<a class="hash-link" href="#docker-extension" title="Direct link to heading">‚Äã</a></h3><p>The Docker extension provides commands for building a container image for your app and pushing it to a container registry. It can even do this without requiring Docker Desktop on your local machine --- the ‚ÄúBuild image in Azure‚Äù command remotely builds and pushes a container image to Azure Container Registry.</p><p><img loading="lazy" alt="Journey to the cloud with Azure Container Apps" src="/Cloud-Native/assets/images/anthony-vscode-docker-6ea4d15571d8ece1448056dc390e467f.png" width="400" height="170" class="img_ev3q"></p><p>And if your app doesn‚Äôt have a dockerfile, the extension will generate one for you.</p><p><img loading="lazy" alt="Journey to the cloud with Azure Container Apps" src="/Cloud-Native/assets/images/anthony-vscode-dockerfile-139bab8d59d5b6c201294b5bc8a24b5a.png" width="399" height="54" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="azure-container-apps-extension">Azure Container Apps extension<a class="hash-link" href="#azure-container-apps-extension" title="Direct link to heading">‚Äã</a></h3><p>Once you‚Äôve built your container image and pushed it to a registry, the Azure Container Apps VS Code extension provides commands for creating a container app and deploying revisions using the image you‚Äôve built.</p><p><img loading="lazy" alt="Journey to the cloud with Azure Container Apps" src="/Cloud-Native/assets/images/anthony-aca-extension-420d267387b72d29143f03f8833da305.png" width="399" height="199" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="azure-cli">Azure CLI<a class="hash-link" href="#azure-cli" title="Direct link to heading">‚Äã</a></h2><p>The Azure CLI can be used to manage pretty much anything in Azure. For Azure Container Apps, you‚Äôll find commands for creating, updating, and managing your Container Apps resources.</p><p>Just like in VS Code, with a few commands in the Azure CLI, you can create your Azure resources, build and push your container image, and then deploy it to a container app.</p><p>To make things as simple as possible, the Azure CLI also has an ‚Äúaz containerapp up‚Äù command. This single command takes care of everything that‚Äôs needed to turn your source code from your local machine to a cloud-hosted application in Azure Container Apps.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">az containerapp up --name myapp --source ./src</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We saw earlier that Visual Studio can generate a GitHub Actions workflow to automatically build and deploy your app on every commit. ‚Äúaz containerapp up‚Äù can do this too. The following adds a workflow to a repo.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">az containerapp up --name myapp --repo https://github.com/myorg/myproject</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="cicd-pipelines">CI/CD pipelines<a class="hash-link" href="#cicd-pipelines" title="Direct link to heading">‚Äã</a></h2><p>When it‚Äôs time to take your app to production, it‚Äôs strongly recommended to set up a CI/CD pipeline to automatically and repeatably build, test, and deploy it. We‚Äôve already seen that tools such as Visual Studio and Azure CLI can automatically generate a workflow for GitHub Actions. You can set up a pipeline in Azure DevOps too. This is an example Azure DevOps pipeline.</p><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">trigger</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">branches</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">include</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">pool</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">vmImage</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ubuntu</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">stages</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">stage</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">jobs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">job</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">displayName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Build app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">steps</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">task</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Docker@2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">inputs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">containerRegistry</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'myregistry'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">repository</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'hello-aca'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">command</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'buildAndPush'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">Dockerfile</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'hello-container-apps/Dockerfile'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">tags</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'$(Build.BuildId)'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">stage</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Deploy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">jobs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">job</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> deploy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">displayName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Deploy app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">steps</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">task</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> AzureCLI@2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">inputs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">azureSubscription</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'my-subscription(5361b9d6-46ea-43c3-a898-15f14afb0db6)'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">scriptType</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'bash'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">scriptLocation</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'inlineScript'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">inlineScript</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          # automatically install Container Apps CLI extension</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          az config set extension.use_dynamic_install=yes_without_prompt</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic"># ensure registry is configured in container app</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          az containerapp registry set \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">-</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">name hello</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">aca \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">-</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">resource</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">group mygroup \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">-</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">server myregistry.azurecr.io \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">-</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">identity system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic"># update container app</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          az containerapp update \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">-</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">name hello</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">aca \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">-</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">resource</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">group mygroup \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">-</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">image myregistry.azurecr.io/hello</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">aca</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">$(Build.BuildId)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Conclusion</p><p>In this article, we looked at a few ways to deploy your cloud native applications to Azure Container Apps and how to decide which one to use based on where you are in your app‚Äôs journey to the cloud.</p><p>To learn more, visit <a href="https://azure.microsoft.com/services/container-apps/?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Azure Container Apps | Microsoft Azure</a> today!</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>ASK THE EXPERT: LIVE Q&amp;A</div><div class="admonitionContent_S0QG"><p>The Azure Container Apps team will answer questions live on <strong>September 29</strong>. </p><ul><li><a href="https://reactor.microsoft.com/reactor/events/17004/?WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Sign up to attend</a> for live Q&amp;A with the team</li><li><a href="https://github.com/Azure/Cloud-Native/issues/new?assignees=&amp;labels=ask+the+expert&amp;template=---ask-the-expert-.md&amp;title=%5BAsk+The+Expert%5D++" target="_blank" rel="noopener noreferrer">submit your questions</a> ahead of time, for prioritization.</li></ul></div></div>]]></content>
        <author>
            <name>Anthony Chu</name>
            <uri>https://github.com/anthonychu</uri>
        </author>
        <category label="serverless-september" term="serverless-september"/>
        <category label="zero-to-hero" term="zero-to-hero"/>
        <category label="azure-functions" term="azure-functions"/>
        <category label="azure-container-apps" term="azure-container-apps"/>
        <category label="dapr" term="dapr"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[üöÄ | Use Custom Handlers For Go]]></title>
        <id>zero2hero-func-03</id>
        <link href="https://azure.github.io/Cloud-Native/blog/zero2hero-func-03"/>
        <updated>2022-09-12T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Azure functions support multiple programming languages including C#, F#, Java, JavaScript, Python, typescript, and PowerShell. If you want to get extended language support with Azure functions for other languages such as Go, and Rust, that‚Äôs where custom handler comes in.]]></summary>
        <content type="html"><![CDATA[<hr><p>Welcome to <code>Day 12</code> of #30DaysOfServerless!</p><p>Today, we have a special set of posts from our <a href="/Cloud-Native/serverless-september/ZeroToHero">Zero To Hero üöÄ</a> initiative, featuring blog posts authored by our Product Engineering teams for #ServerlessSeptember. <em>Posts were originally published on the <a href="https://techcommunity.microsoft.com/t5/apps-on-azure-blog/building-serverless-go-applications-with-azure-functions-custom/ba-p/3623617?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Apps on Azure</a> blog on Microsoft Tech Community.</em></p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-well-cover">What We'll Cover<a class="hash-link" href="#what-well-cover" title="Direct link to heading">‚Äã</a></h2><ul><li>What are Custom Handlers, and why use them?</li><li>How Custom Handler Works</li><li>Message Processing With Azure Custom Handler</li><li>Azure Portal Monitoring</li></ul><p><img loading="lazy" src="/Cloud-Native/assets/images/zero-to-hero-melony-a4e4f337b95ea7199352808d42961764.png" width="1600" height="672" class="img_ev3q"></p><hr><p>If you have been working with <a href="https://docs.microsoft.com/azure/azure-functions/?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Azure Functions</a> for a while, you may know Azure Functions is a serverless FaaS (Function as a Service) offered provided by Microsoft Azure, which is built for your key scenarios, including building web APIs, processing file uploads, responding to database changes, processing IoT data streams, managing message queues, and more.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="custom-handlers-what-and-why">Custom Handlers: What and Why<a class="hash-link" href="#custom-handlers-what-and-why" title="Direct link to heading">‚Äã</a></h2><p>Azure functions support multiple programming languages including C#, F#, Java, JavaScript, Python, typescript, and PowerShell. If you want to get <strong>extended language support with Azure functions for other languages</strong> such as Go, and Rust, that‚Äôs where custom handler comes in.</p><p>An Azure function custom handler allows the use of any language that supports HTTP primitives and author Azure functions. With custom handlers, you can use triggers and input and output bindings via extension bundles,  hence it supports all the triggers and bindings you're used to with Azure functions.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-a-custom-handler-works">How a Custom Handler Works<a class="hash-link" href="#how-a-custom-handler-works" title="Direct link to heading">‚Äã</a></h2><p>Let‚Äôs take a look at custom handlers and how it works.  </p><ul><li>A request is sent to the function host when an event is triggered.  It‚Äôs up to the function host to issue a request payload to the custom handler, which holds the trigger and inputs binding data as well as other metadata for the function. </li><li>The custom handler is a local HTTP web server. It executes the function code and returns a response payload to the Functions host. </li><li>The Functions host passes data from the response to the function's output bindings which will be passed to the downstream stream services for data processing. </li></ul><p>Check out <a href="https://docs.microsoft.com/azure/azure-functions/functions-custom-handlers?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">this article to know more about Azure functions custom handlers</a>.</p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="message-processing-with-custom-handlers">Message processing with Custom Handlers<a class="hash-link" href="#message-processing-with-custom-handlers" title="Direct link to heading">‚Äã</a></h2><p><a href="https://docs.microsoft.com/azure/architecture/guide/technology-choices/messaging?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Message processing</a> is one of the key scenarios that Azure functions are trying to address. In the message-processing scenario, events are often collected in queues. These events can trigger Azure functions to execute a piece of business logic. </p><p>You can use the Service Bus trigger to respond to messages from an <a href="https://docs.microsoft.com/azure/service-bus-messaging/service-bus-messaging-overview?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Azure Service Bus queue</a> - it's then up to the Azure functions custom handlers to take further actions to process the messages. The process is described in the following diagram:</p><p><img loading="lazy" alt="Building Serverless Go Applications with Azure functions custom handlers" src="/Cloud-Native/assets/images/melony-processing-42772dfd2586d1ff1cf70e085d3702e6.png" width="999" height="188" class="img_ev3q"></p><p>In Azure function, the <code>function.json</code> defines the function's trigger, input and output bindings, and other configuration settings. Note that every function can have multiple bindings, but it can only have one trigger. The following is an example of setting up the Service Bus queue trigger in the function.json file :</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token property" style="color:#36acaa">"bindings"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token property" style="color:#36acaa">"name"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"queueItem"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token property" style="color:#36acaa">"type"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"serviceBusTrigger"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token property" style="color:#36acaa">"direction"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"in"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token property" style="color:#36acaa">"queueName"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"functionqueue"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token property" style="color:#36acaa">"connection"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"ServiceBusConnection"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can add a binding definition in the function.json to write the output to a database or other locations of your desire. <a href="https://docs.microsoft.com/azure/azure-functions/functions-triggers-bindings?tabs=csharp#add-bindings-to-a-function&amp;WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Supported bindings can be found here</a>.</p><p>As we‚Äôre programming in Go, so we need to set the value of <code>defaultExecutablePath</code> to handler in the <code>customHandler.description</code> section in the <code>host.json</code> file.</p><p>Assume we‚Äôre programming in Windows OS, and we have named our go application as <code>server.go</code>,  after we executed <code>go build server.go</code> command,  it produces an executable called <code>server.exe</code>. So here we set <code>server.exe</code> in the <code>host.json</code> as the following example :</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">"customHandler"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">"description"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">"defaultExecutablePath"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"./server.exe"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">"workingDirectory"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">""</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">"arguments"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We‚Äôre showcasing a simple Go application here with Azure functions custom handlers where we print out the messages received from the function host. The following is the full code of <code>server.go</code> application :</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">package</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">"encoding/json"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">"fmt"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">"log"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">"net/http"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">"os"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> InvokeRequest </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Data     </span><span class="token keyword" style="color:#00009f">map</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">json</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">RawMessage</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Metadata </span><span class="token keyword" style="color:#00009f">map</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">]</span><span class="token keyword" style="color:#00009f">interface</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">queueHandler</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">w http</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ResponseWriter</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> r </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">http</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Request</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> invokeRequest InvokeRequest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    d </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> json</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">NewDecoder</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">r</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Body</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    d</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Decode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">invokeRequest</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> parsedMessage </span><span class="token builtin">string</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    json</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Unmarshal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">invokeRequest</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Data</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">"queueItem"</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">parsedMessage</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">parsedMessage</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    customHandlerPort</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> exists </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">LookupEnv</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"FUNCTIONS_CUSTOMHANDLER_PORT"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!</span><span class="token plain">exists </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        customHandlerPort </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"8080"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mux </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> http</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">NewServeMux</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mux</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">HandleFunc</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"/MessageProcessorFunction"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> queueHandler</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"Go server Listening on: "</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> customHandlerPort</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Fatal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">http</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">ListenAndServe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">":"</span><span class="token operator" style="color:#393A34">+</span><span class="token plain">customHandlerPort</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> mux</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Ensure you have <a href="https://github.com/Azure/azure-functions-core-tools" target="_blank" rel="noopener noreferrer">Azure functions core tools</a> installed, then we can use func start command to start our function. Then we‚Äôll have have a <a href="https://github.com/cloudmelon/cloud-native-serverless/tree/main/message-sender-servicebus/MessageSendToServiceBus" target="_blank" rel="noopener noreferrer">C#-based Message Sender application</a> on Github to send out 3000 messages to the Azure service bus queue. You‚Äôll see Azure functions instantly start to process the messages and print out the message as the following:</p><p><img loading="lazy" alt="Monitoring Serverless Go Applications with Azure functions custom handlers" src="data:image/png;base64,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" width="382" height="324" class="img_ev3q"></p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="azure-portal-monitoring">Azure portal monitoring<a class="hash-link" href="#azure-portal-monitoring" title="Direct link to heading">‚Äã</a></h2><p>Let‚Äôs go back to Azure portal portal the events see how those messages in Azure Service Bus queue were being processed. There was 3000 messages were queued in the Service Bus queue ( the Blue line stands for incoming Messages ). The outgoing messages (the red line in smaller wave shape ) showing there are progressively being read by Azure functions as the following :</p><p><img loading="lazy" alt="Monitoring Serverless Go Applications with Azure functions custom handlers" src="/Cloud-Native/assets/images/melony-monitoring-1430568906cea1cff64b9a49f40419e0.png" width="998" height="301" class="img_ev3q"></p><p>Check out <a href="https://docs.microsoft.com/azure/service-bus-messaging/monitor-service-bus?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">this article about monitoring Azure Service bus</a> for further information.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="next-steps">Next steps<a class="hash-link" href="#next-steps" title="Direct link to heading">‚Äã</a></h2><p>Thanks for following along, we‚Äôre looking forward to hearing your feedback.  Also, if you discover potential issues, please record them on <a href="https://github.com/Azure/azure-functions-host/issues" target="_blank" rel="noopener noreferrer">Azure Functions host</a>  GitHub repository or tag us <a href="https://twitter.com/AzureFunctions" target="_blank" rel="noopener noreferrer">@AzureFunctions on Twitter</a>. </p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>RESOURCES </div><div class="admonitionContent_S0QG"><p>Start to build your serverless applications with custom handlers, check out the official documentation:</p><ul><li><a href="https://docs.microsoft.com/azure/azure-functions/functions-custom-handlers?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Getting started with Azure functions custom handlers</a> </li><li><a href="https://docs.microsoft.com/azure/azure-functions/create-first-function-vs-code-other?tabs=go%2Cwindows&amp;WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Create a Go or Rust function in Azure using Visual Studio Code</a></li></ul></div></div><p>Life is a journey of learning.  Let‚Äôs stay tuned!</p>]]></content>
        <author>
            <name>Melony Qin</name>
            <uri>https://github.com/cloudmelon</uri>
        </author>
        <category label="serverless-september" term="serverless-september"/>
        <category label="zero-to-hero" term="zero-to-hero"/>
        <category label="azure-functions" term="azure-functions"/>
        <category label="azure-container-apps" term="azure-container-apps"/>
        <category label="dapr" term="dapr"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[12. Build With Dapr!]]></title>
        <id>12-build-with-dapr</id>
        <link href="https://azure.github.io/Cloud-Native/blog/12-build-with-dapr"/>
        <updated>2022-09-12T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Today we'll shift gears and talk about Dapr - the Distributed Application Runtime - and how it makes microservices development with ACA _easier_]]></summary>
        <content type="html"><![CDATA[<hr><p>Welcome to <code>Day 12</code> of #30DaysOfServerless!</p><p>So far we've looked at Azure Container Apps - what it is, how it enables microservices communication, and how it enables auto-scaling with KEDA compliant scalers. Today we'll shift gears and talk about Dapr - the Distributed Application Runtime - and how it makes microservices development with ACA <em>easier</em> with core building blocks and a sidecar architecture!</p><p>Ready? Let's go!</p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-well-cover">What We'll Cover<a class="hash-link" href="#what-well-cover" title="Direct link to heading">‚Äã</a></h2><ul><li>What is Dapr and why use it?</li><li>Building Block APIs</li><li>Dapr Quickstart and Tutorials</li><li>Dapr-enabled ACA: A Sidecar Approach</li><li>Exercise: Build &amp; Deploy a Dapr-enabled ACA.</li><li>Resources: For self-study!</li></ul><p><img loading="lazy" src="/Cloud-Native/assets/images/banner-cc3cfe656444b6f21e4bc8d2c541bc3e.png" width="1600" height="672" class="img_ev3q"></p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="hello-dapr">Hello, Dapr!<a class="hash-link" href="#hello-dapr" title="Direct link to heading">‚Äã</a></h2><p>Building distributed applications is hard. Building <strong>reliable and portable microservces</strong> means having middleware that deals with challenges like service discovery, sync and async communications, state management, secure information sharing and more. Integrating these support services into your application can be challenging from both development and maintenance perspectives, adding complexity that is independent of the core application logic you want to focus on.</p><p>This is where <a href="https://dapr.io" target="_blank" rel="noopener noreferrer"><strong>Dapr (Distributed Application Runtime)</strong></a> shines - <a href="https://docs.dapr.io/" target="_blank" rel="noopener noreferrer">it's defined as:</a>:</p><blockquote><p> a portable, event-driven runtime that makes it easy for any developer to build resilient, stateless and stateful applications that run on the cloud and edge and embraces the diversity of languages and developer frameworks. </p></blockquote><p>But what does this actually mean to me as an app developer? </p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="dapr--apps-a-sidecar-approach">Dapr + Apps: A Sidecar Approach<a class="hash-link" href="#dapr--apps-a-sidecar-approach" title="Direct link to heading">‚Äã</a></h2><p>The strength of Dapr lies in its ability to:</p><ul><li>abstract complexities of distributed systems middleware - with  <strong>Building Block APIs</strong> that implement components using best practices to tackle key challenges.</li><li>implement a <strong>Sidecar Pattern</strong> with interactions via APIs - allowing applications to keep their codebase clean and focus on app logic.</li><li>be <strong>Incrementally Adoptable</strong> - allowing developers to start by integrating one API, then evolving to use more as and when needed.</li><li>be <strong>Platform Agnostic</strong> - allowing applications to be developed in a preferred language or framework without impacting integration capabilities.</li></ul><p>The application-dapr sidecar interaction is illustrated below. The API abstraction allows applications to get the desired functionality without having to know <em>how</em> it was implemented, or without having to integrate Dapr-specific code into their codebase. Note how the sidecar process listens on port <code>3500</code> and the API provides clear routes for the specific building blocks supported by Dapr (e.g, <code>/secrets</code>, <code>/state</code> etc.)</p><p><img loading="lazy" src="https://docs.dapr.io/images/overview-sidecar-model.png" class="img_ev3q"></p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="dapr-building-blocks-api-interactions">Dapr Building Blocks: API Interactions<a class="hash-link" href="#dapr-building-blocks-api-interactions" title="Direct link to heading">‚Äã</a></h2><p>Dapr Building Blocks refers to <strong>HTTP and gRPC endpoints exposed by Dapr</strong> API endpoints exposed by the Dapr sidecar, providing key capabilities like state management, observability, service-to-service invocation, pub/sub messaging and more to the associated application. </p><table><thead><tr><th align="left"></th><th align="left"><strong>Building Blocks: Under the Hood</strong></th></tr></thead><tbody><tr><td align="left"><img loading="lazy" src="https://docs.dapr.io/images/concepts-building-blocks.png" class="img_ev3q"></td><td align="left">The Dapr API is implemented by <a href="https://docs.dapr.io/concepts/building-blocks-concept/" target="_blank" rel="noopener noreferrer">modular components</a> that codify best practices for tackling the specific challenge that they represent. The API abstraction allows component implementations to evolve, or alternatives to be used , without requiring changes to the application codebase.</td></tr></tbody></table><p><img loading="lazy" src="https://docs.dapr.io/images/building_blocks.png" class="img_ev3q"></p><p>The <a href="https://docs.dapr.io/concepts/building-blocks-concept/" target="_blank" rel="noopener noreferrer">latest Dapr release</a> has the building blocks shown in the above figure. Not all capabilities are available to Azure Container Apps by default -  check the <a href="https://learn.microsoft.com/azure/container-apps/dapr-overview?tabs=bicep1%2Cyaml#unsupported-dapr-capabilities" target="_blank" rel="noopener noreferrer">documentation</a> for the latest updates on this. For now, Azure Container Apps + Dapr integration provides the following capabilities to the application:</p><ul><li><a href="https://docs.dapr.io/developing-applications/building-blocks/service-invocation/service-invocation-overview/" target="_blank" rel="noopener noreferrer">Service-to-Service Invocation</a> for synchronous communications</li><li><a href="https://docs.dapr.io/developing-applications/building-blocks/state-management/state-management-overview/" target="_blank" rel="noopener noreferrer">State management</a> for transactions and CRUD operations</li><li><a href="https://docs.dapr.io/developing-applications/building-blocks/pubsub/pubsub-overview" target="_blank" rel="noopener noreferrer">Pub/Sub messaging</a> for asynchronous (message-driven) communications</li><li><a href="https://docs.dapr.io/developing-applications/building-blocks/bindings/bindings-overview/" target="_blank" rel="noopener noreferrer">Bindings</a> for seamless workflow integrations using event triggers</li><li><a href="https://docs.dapr.io/developing-applications/building-blocks/actors/actors-overview/" target="_blank" rel="noopener noreferrer">Actors</a> for encapsulated &amp; reusable objects that enable reliable, scalable behaviors</li><li><a href="https://learn.microsoft.com/azure/container-apps/observability" target="_blank" rel="noopener noreferrer">Observability</a> to monitor application events for health and performance</li><li><a href="https://docs.dapr.io/developing-applications/building-blocks/secrets/" target="_blank" rel="noopener noreferrer">Secrets</a> for securely accessing sensitive values.</li></ul><p>In the next section, we'll dive into Dapr-enabled Azure Container Apps. Before we do that, here are a couple of resources to help you explore the Dapr platform by itself, and get more hands-on experience with the concepts and capabilities:</p><ul><li><a href="https://docs.dapr.io/getting-started/quickstarts/" target="_blank" rel="noopener noreferrer">Dapr Quickstarts</a> - build your first Dapr app, then explore quickstarts for a core APIs including service-to-service invocation, pub/sub, state mangement, bindings and secrets management.</li><li><a href="https://docs.dapr.io/getting-started/tutorials/" target="_blank" rel="noopener noreferrer">Dapr Tutorials</a> - go beyond the basic quickstart and explore more realistic service integrations and usage scenarios. Try the <a href="https://github.com/dapr/quickstarts/tree/master/tutorials/distributed-calculator" target="_blank" rel="noopener noreferrer">distributed calculator</a> example!</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="integrate-dapr--azure-container-apps">Integrate Dapr &amp; Azure Container Apps<a class="hash-link" href="#integrate-dapr--azure-container-apps" title="Direct link to heading">‚Äã</a></h2><p>Dapr currently has a <a href="https://v1-9.docs.dapr.io/" target="_blank" rel="noopener noreferrer">v1.9 (preview)</a> version, but Azure Container Apps supports <a href="https://learn.microsoft.com/azure/container-apps/dapr-overview#current-supported-dapr-version" target="_blank" rel="noopener noreferrer">Dapr v1.8</a>. In this section, we'll look at what it takes to enable, configure, and use, Dapr integration with Azure Container Apps. It involves 3 steps: <em>enabling</em> Dapr using settings, <em>configuring</em> Dapr components (API) for use, then invoking the APIs.</p><p>Here's a simple <a href="https://learn.microsoft.com/azure/container-apps/dapr-overview?tabs=bicep1%2Cyaml#dapr-settings" target="_blank" rel="noopener noreferrer">a publisher-subscriber scenario</a> from the documentation. We have two Container apps identified as <code>publisher-app</code> and <code>subscriber-app</code> deployed in a single environment. Each ACA has an activated <code>daprd</code> sidecar, allowing them to use the <em>Pub/Sub</em> API to communicate asynchronously with each other - without having to write the underlying pub/sub implementation themselves. Rather, we can see that the Dapr API uses a <code>pubsub,azure.servicebus</code> <strong>component</strong> to implement that capability.</p><p><img loading="lazy" src="https://learn.microsoft.com/azure/container-apps/media/dapr-overview/dapr-in-aca.png" alt="Pub/sub example" class="img_ev3q"></p><p>Let's look at how this is setup.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-enable-dapr-in-aca-settings">1. <a href="https://learn.microsoft.com/azure/container-apps/dapr-overview?tabs=bicep1%2Cyaml#enable-dapr" target="_blank" rel="noopener noreferrer">Enable Dapr in ACA: Settings</a><a class="hash-link" href="#1-enable-dapr-in-aca-settings" title="Direct link to heading">‚Äã</a></h3><p>We can enable Dapr integration in the Azure Container App during creation by <em>specifying settings</em> in one of two ways, based on your development preference:</p><ul><li><strong>Using Azure CLI</strong>: use custom commandline options for each setting</li><li><strong>Using Infrastructure-as-Code (IaC)</strong>: using properties for Bicep, ARM templates</li></ul><p>Once enabled, Dapr will run in the same <em>environment</em> as the Azure Container App, and listen on <strong>port 3500</strong> for API requests. The Dapr sidecar can be shared my multiple Container Apps <em>deployed in the same environment</em>. </p><p>There are four main settings we will focus on for this demo - the example below shows the ARM template properties, but you can <a href="https://learn.microsoft.com/azure/container-apps/dapr-overview?tabs=bicep1%2Cyaml#enable-dapr" target="_blank" rel="noopener noreferrer">find the equivalent CLI parameters here</a> for comparison.</p><ul><li><code>dapr.enabled</code> - enable Dapr for Azure Container App</li><li><code>dapr.appPort</code> - specify port on which app is listening</li><li><code>dapr.appProtocol</code> - specify if using <code>http</code> (default) or <code>gRPC</code> for API</li><li><code>dapr.appId</code> - specify unique application ID for service discovery, usage</li></ul><p>These are defined under the <code>properties.configuration</code> section for your resource. Changing Dapr settings does not update the revision but it <em>will</em> restart ACA revisions and replicas. Here is what the relevant section of the ARM template looks like for the <code>publisher-app</code> ACA in the scenario shown above.</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token property" style="color:#36acaa">"dapr"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token property" style="color:#36acaa">"enabled"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token property" style="color:#36acaa">"appId"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"publisher-app"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token property" style="color:#36acaa">"appProcotol"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"http"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token property" style="color:#36acaa">"appPort"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-configure-dapr-in-aca--components">2. <a href="https://learn.microsoft.com/azure/container-apps/dapr-overview?tabs=bicep1%2Cyaml#configure-dapr-components" target="_blank" rel="noopener noreferrer">Configure Dapr in ACA:  Components</a><a class="hash-link" href="#2-configure-dapr-in-aca--components" title="Direct link to heading">‚Äã</a></h3><p>The next step after activating the Dapr sidecar, is to define the <em>APIs</em> that you want to use and potentially specify the <strong>Dapr components</strong> (specific implementations of that API) that you prefer. These components are created at environment-level and by default, Dapr-enabled containers apps in an environment will load the complete set of deployed components -- <strong>use the <code>scopes</code> property</strong> to ensure only components needed by a given app are loaded at runtime. Here's what the ARM template <code>resources</code> section looks like for the example above. This tells us that the environment has a <code>dapr-pubsub</code> component of type <code>pubsub.azure.servicebus</code> deployed - where that component is loaded by container apps with dapr ids (<code>publisher-app</code>, <code>subscriber-app</code>).</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>USING MANAGED IDENTITY + DAPR</div><div class="admonitionContent_S0QG"><p>The secrets approach used here is idea for demo purposes. However, we recommend using <em>Managed Identity with Dapr</em> in production. For more details on secrets, check out tomorrow's post on <em>Secrets and Managed Identity in Azure Container Apps</em></p></div></div><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">"resources"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">"type"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"daprComponents"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">"name"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"dapr-pubsub"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">"properties"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">"componentType"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"pubsub.azure.servicebus"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">"version"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"v1"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">"secrets"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">"name"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"sb-root-connectionstring"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">"value"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"value"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">"metadata"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">"name"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"connectionString"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">"secretRef"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"sb-root-connectionstring"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// Application scopes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">"scopes"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">"publisher-app"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"subscriber-app"</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>With this configuration, the ACA is now set to use pub/sub capabilities from the Dapr sidecar, using standard HTTP requests to the exposed API endpoint for this service.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="exercise-deploy-dapr-enabled-aca">Exercise: Deploy Dapr-enabled ACA<a class="hash-link" href="#exercise-deploy-dapr-enabled-aca" title="Direct link to heading">‚Äã</a></h2><p>In the next couple posts in this series, we'll be discussing how you can use the Dapr secrets API and doing a walkthrough of a more complex example, to show how Dapr-enabled Azure Container Apps are created and deployed. </p><p>However, you can get hands-on experience with these concepts by walking through one of these two tutorials, each providing an alternative approach to configure and setup the application describe in the scenario below:</p><ul><li><strong>Tutorial 1</strong>: <a href="https://learn.microsoft.com/azure/container-apps/microservices-dapr" target="_blank" rel="noopener noreferrer">Deploy a Dapr-enabled ACA using <strong>Azure CLI</strong></a></li><li><strong>Tutorial 2</strong>: <a href="https://learn.microsoft.com/azure/container-apps/microservices-dapr" target="_blank" rel="noopener noreferrer">Deploy a Dapr-enabled ACA using <strong>Bicep or ARM templates</strong></a></li></ul><p><img loading="lazy" src="https://learn.microsoft.com/azure/container-apps/media/microservices-dapr/azure-container-apps-microservices-dapr.png" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="resources">Resources<a class="hash-link" href="#resources" title="Direct link to heading">‚Äã</a></h2><p>Here are the main resources to explore for self-study:</p><ul><li><a href="https://v1-9.docs.dapr.io/concepts/" target="_blank" rel="noopener noreferrer">Dapr Documentation: Core Concepts</a></li><li><a href="https://docs.dapr.io/getting-started/quickstarts/" target="_blank" rel="noopener noreferrer">Dapr Quickstarts</a></li><li><a href="https://docs.dapr.io/getting-started/tutorials/" target="_blank" rel="noopener noreferrer">Dapr Tutorials</a></li><li><a href="https://learn.microsoft.com/azure/container-apps/dapr-overview" target="_blank" rel="noopener noreferrer">Azure Container Apps: Dapr Integration</a></li><li><a href="https://learn.microsoft.com/azure/container-apps/microservices-dapr" target="_blank" rel="noopener noreferrer">Dapr-enable Azure Container Apps: Using Azure CLI</a></li><li><a href="https://learn.microsoft.com/azure/container-apps/microservices-dapr-azure-resource-manager" target="_blank" rel="noopener noreferrer">Dapr-enabled Azure Container Apps: Using Bicep or ARM</a></li></ul>]]></content>
        <author>
            <name>Nitya Narasimhan</name>
            <uri>https://github.com/nitya</uri>
        </author>
        <category label="serverless-september" term="serverless-september"/>
        <category label="30-days-of-serverless" term="30-days-of-serverless"/>
        <category label="azure-container-apps" term="azure-container-apps"/>
        <category label="dapr" term="dapr"/>
        <category label="microservices" term="microservices"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[13. Secrets + Managed Identity]]></title>
        <id>13-aca-managed-id</id>
        <link href="https://azure.github.io/Cloud-Native/blog/13-aca-managed-id"/>
        <updated>2022-09-13T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Learn to make use of Container Apps (ACA) secrets and managed identities to securely access cloud-hosted resources that your ACA depends on! ]]></summary>
        <content type="html"><![CDATA[<hr><p>Welcome to <code>Day 13</code> of #30DaysOfServerless! </p><p>In the previous post, we learned about all things Distributed Application Runtime (Dapr) and highlighted the capabilities you can unlock through managed Dapr in Azure Container Apps! Today, we'll dive into how we can make use of Container Apps secrets and managed identities to securely access cloud-hosted resources that your Container Apps depend on! </p><p>Ready? Let's go.</p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-well-cover">What We'll Cover<a class="hash-link" href="#what-well-cover" title="Direct link to heading">‚Äã</a></h2><ul><li>Secure access to external services overview</li><li>Using Container Apps Secrets</li><li>Using Managed Identity for connecting to Azure resources</li><li>Using Dapr secret store component references (Dapr-only)</li><li>Conclusion   </li><li>Resources: For self-study!</li></ul><p><img loading="lazy" src="/Cloud-Native/assets/images/banner-9d61f89816a8e8b5682eae3c4fcdb71c.png" width="1600" height="672" class="img_ev3q"></p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="securing-access-to-external-services">Securing access to external services<a class="hash-link" href="#securing-access-to-external-services" title="Direct link to heading">‚Äã</a></h2><p>In most, if not all, microservice-based applications, one or more services in the system will rely on other cloud-hosted resources; Think external services like databases, secret stores, message brokers, event sources, etc. To interact with these services, an application must have the ability to establish a secure connection. Traditionally, an application will authenticate to these backing resources using some type of connection string or password. </p><p>I'm not sure if it was just me, but one of the first things I learned as a developer was to ensure credentials and other sensitive information were never checked into the codebase. The ability to inject these values at runtime is a non-negotiable.</p><p>In Azure Container Apps, applications can securely leverage connection information via <strong>Container Apps Secrets</strong>. If the resource is Azure-based, a more ideal solution that removes the dependence on secrets altogether is using Managed Identity. </p><p>Specifically for Dapr-enabled container apps, users can now tap into the power of the <strong>Dapr secrets API!</strong> With this new capability unlocked in Container Apps, users can call the Dapr secrets API from application code to securely access secrets from Key Vault or other backing secret stores. In addition, customers can also make use of a secret store component reference when wiring up Dapr state store components and more! </p><p>ALSO, I'm excited to share that <strong>support for  Dapr + Managed Identity is now available</strong>!!. What does this mean? It means that you can enable Managed Identity for your container app - and when establishing connections via Dapr, the Dapr sidecar can use this identity! This means simplified components without the need for secrets when connecting to Azure services! </p><p>Let's dive a bit deeper into the following three topics:</p><ol><li>Using Container Apps secrets in your container apps</li><li>Using Managed Identity to connect to Azure services</li><li>Connecting to services securely for Dapr-enabled apps
</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="secure-access-to-external-services-without-dapr">Secure access to external services without Dapr<a class="hash-link" href="#secure-access-to-external-services-without-dapr" title="Direct link to heading">‚Äã</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="leveraging-container-apps-secrets-at-runtime">Leveraging Container Apps secrets at runtime<a class="hash-link" href="#leveraging-container-apps-secrets-at-runtime" title="Direct link to heading">‚Äã</a></h3><p>Users can leverage this approach for any values which need to be securely stored, however, it is recommended to use Managed Identity where possible when connecting to Azure-specific resources. </p><p>First, let's establish a few important points regarding secrets in container apps:  </p><ul><li>Secrets are scoped at the container app level, meaning secrets cannot be shared across container apps today </li><li>When running in multiple-revision mode, <ul><li>changes to secrets <strong>do not</strong> generate a new revision</li><li>running revisions will not be automatically restarted to reflect changes. If you want to force-update existing container app revisions to reflect the changed secrets values, you will need to perform revision restarts. </li></ul></li></ul><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>STEP 1</div><div class="admonitionContent_S0QG"><p>Provide the secure value as a secret parameter when creating your container app using the syntax <strong>"SECRET_NAME=SECRET_VALUE"</strong></p></div></div><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">az containerapp create </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --resource-group </span><span class="token string" style="color:#e3116c">"my-resource-group"</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --name queuereader </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --environment </span><span class="token string" style="color:#e3116c">"my-environment-name"</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --image demos/queuereader:v1 </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --secrets </span><span class="token string" style="color:#e3116c">"queue-connection-string=</span><span class="token string variable" style="color:#36acaa">$CONNECTION_STRING</span><span class="token string" style="color:#e3116c">"</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>STEP 2 </div><div class="admonitionContent_S0QG"><p>Create an environment variable which references the value of the secret created in step 1 using the syntax <strong>"ENV_VARIABLE_NAME=secretref:SECRET_NAME"</strong></p></div></div><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">az containerapp create </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --resource-group </span><span class="token string" style="color:#e3116c">"my-resource-group"</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --name myQueueApp </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --environment </span><span class="token string" style="color:#e3116c">"my-environment-name"</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --image demos/myQueueApp:v1 </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --secrets </span><span class="token string" style="color:#e3116c">"queue-connection-string=</span><span class="token string variable" style="color:#36acaa">$CONNECTIONSTRING</span><span class="token string" style="color:#e3116c">"</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --env-vars </span><span class="token string" style="color:#e3116c">"QueueName=myqueue"</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"ConnectionString=secretref:queue-connection-string"</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This <strong>ConnectionString</strong> environment variable can be used within your application code to securely access the connection string value at runtime.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="using-managed-identity-to-connect-to-azure-services">Using Managed Identity to connect to Azure services<a class="hash-link" href="#using-managed-identity-to-connect-to-azure-services" title="Direct link to heading">‚Äã</a></h3><p>A managed identity from Azure Active Directory (Azure AD) allows your container app to access other Azure AD-protected resources. This approach is recommended where possible as it eliminates the need for managing secret credentials in your container apps and allows you to properly scope the permissions needed for a given container app using role-based access control. Both system-assigned and user-assigned identities are available in container apps. For more background on managed identities in Azure AD, see <a href="https://learn.microsoft.com/azure/active-directory/managed-identities-azure-resources/overview" target="_blank" rel="noopener noreferrer">Managed identities for Azure resources</a>.</p><p>To configure your app with a system-assigned managed identity you will follow similar steps to the following: </p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>STEP 1</div><div class="admonitionContent_S0QG"><p>Run the following command to create a system-assigned identity for your container app </p></div></div><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">az containerapp identity assign </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --name </span><span class="token string" style="color:#e3116c">"myQueueApp"</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --resource-group </span><span class="token string" style="color:#e3116c">"my-resource-group"</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --system-assigned</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>STEP 2</div><div class="admonitionContent_S0QG"><p>Retrieve the identity details for your container app and store the Principal ID for the identity in a variable <strong>"PRINCIPAL_ID"</strong></p></div></div><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">az containerapp identity show </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --name </span><span class="token string" style="color:#e3116c">"myQueueApp"</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --resource-group </span><span class="token string" style="color:#e3116c">"my-resource-group"</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>STEP 3 </div><div class="admonitionContent_S0QG"><p>Assign the appropriate roles and permissions to your container app's managed identity using the Principal ID in step 2 based on the resources you need to access (example below)</p></div></div><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">az role assignment create </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --role </span><span class="token string" style="color:#e3116c">"Storage Queue Data Contributor"</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --assignee </span><span class="token variable" style="color:#36acaa">$PRINCIPAL_ID</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --scope </span><span class="token string" style="color:#e3116c">"/subscriptions/&lt;subscription&gt;/resourceGroups/&lt;resource-group&gt;/providers/Microsoft.Storage/storageAccounts/&lt;storage-account&gt;/queueServices/default/queues/&lt;queue&gt;"</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>After running the above commands, your container app will be able to access your Azure Store Queue because it's managed identity has been assigned the "Store Queue Data Contributor" role. The role assignments you create will be contingent solely on the resources your container app needs to access. To instrument your code to use this managed identity, see more details <a href="https://learn.microsoft.com/azure/container-apps/managed-identity?tabs=portal%2Cdotnet#connect-to-azure-services-in-app-code" target="_blank" rel="noopener noreferrer">here</a>. </p><p>In addition to using managed identity to access services from your container app, you can also use managed identity to <a href="https://learn.microsoft.com/azure/container-apps/containers#container-registries" target="_blank" rel="noopener noreferrer">pull your container images from Azure Container Registry</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="secure-access-to-external-services-with-dapr">Secure access to external services with Dapr<a class="hash-link" href="#secure-access-to-external-services-with-dapr" title="Direct link to heading">‚Äã</a></h2><p>For Dapr-enabled apps, there are a few ways to connect to the resources your solutions depend on. In this section, we will discuss when to use each approach. </p><ol><li>Using Container Apps secrets in your Dapr components</li><li>Using Managed Identity with Dapr Components </li><li>Using Dapr Secret Stores for runtime secrets and component references </li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="using-container-apps-secrets-in-dapr-components">Using Container Apps secrets in Dapr components<a class="hash-link" href="#using-container-apps-secrets-in-dapr-components" title="Direct link to heading">‚Äã</a></h3><p>Prior to providing support for the Dapr Secret's Management building block, this was the only approach available for securely storing sensitive values for use in Dapr components. </p><p>In Dapr OSS, when no secret store reference is provided in a Dapr component file, the default secret store is set to "Kubernetes secrets". In Container Apps, we do not expose the ability to use this default store. Rather, Container Apps secrets can be used in it's place. </p><p>With the introduction of the Secrets API and the ability to use Dapr + Managed Identity, this approach is useful for a limited number of scenarios: </p><ul><li>Quick demos and dev/test scenarios using the Container Apps CLI </li><li>Securing values when a secret store is not configured or available for use</li><li>Using service principal credentials to configure an Azure Key Vault secret store component (Using Managed Identity is recommend) </li><li>Securing access credentials which may be required when creating a non-Azure secret store component </li></ul><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>STEP 1 </div><div class="admonitionContent_S0QG"><p>Create a Dapr component which can be used by one or more services in the container apps environment. In the below example, you will create a secret to store the storage account key and reference this secret from the appropriate Dapr metadata property. </p></div></div><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token key atrule" style="color:#00a4db">componentType</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> state.azure.blobstorage</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token key atrule" style="color:#00a4db">version</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> accountName</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token key atrule" style="color:#00a4db">value</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> testStorage</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> accountKey</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token key atrule" style="color:#00a4db">secretRef</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> account</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> containerName</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token key atrule" style="color:#00a4db">value</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> myContainer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token key atrule" style="color:#00a4db">secrets</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> account</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token key atrule" style="color:#00a4db">value</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"&lt;STORAGE_ACCOUNT_KEY&gt;"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token key atrule" style="color:#00a4db">scopes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> myApp</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>STEP 2</div><div class="admonitionContent_S0QG"><p>Deploy the Dapr component using the below command with the appropriate arguments.</p></div></div><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> az containerapp </span><span class="token function" style="color:#d73a49">env</span><span class="token plain"> dapr-component </span><span class="token builtin class-name">set</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   --name </span><span class="token string" style="color:#e3116c">"my-environment"</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   --resource-group </span><span class="token string" style="color:#e3116c">"my-resource-group"</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   --dapr-component-name statestore </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   --yaml </span><span class="token string" style="color:#e3116c">"./statestore.yaml"</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="using-managed-identity-with-dapr-components">Using Managed Identity with Dapr Components<a class="hash-link" href="#using-managed-identity-with-dapr-components" title="Direct link to heading">‚Äã</a></h3><p>Dapr-enabled container apps can now make use of managed identities within Dapr components. This is the most ideal path for connecting to Azure services securely, and allows for the removal of sensitive values in the component itself. </p><p>The Dapr sidecar makes use of the existing identities available within a given container app; Dapr itself does not have it's own identity. Therefore, the steps to enable Dapr + MI are similar to those in the section regarding managed identity for non-Dapr apps. See example steps below specifically for using a system-assigned identity: </p><ol><li><p>Create a system-assigned identity for your container app </p></li><li><p>Retrieve the identity details for your container app and store the Principal ID for the identity in a variable <strong>"PRINCIPAL_ID"</strong></p></li><li><p>Assign the appropriate roles and permissions (for accessing resources backing your Dapr components) to your ACA's managed identity using the Principal ID</p></li><li><p>Create a simplified Dapr component without any secrets required </p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">componentType</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> state.azure.blobstorage</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">version</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> accountName</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">value</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> testStorage</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> containerName</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">value</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> myContainer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">scopes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> myApp</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Deploy the component to test the connection from your container app via Dapr! </p></li></ol><p>Keep in mind, all Dapr components will be loaded by each Dapr-enabled container app in an environment by default. In order to avoid apps without the appropriate permissions from loading a component unsuccessfully, use scopes. This will ensure that only applications with the appropriate identities to access the backing resource load the component. </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="using-dapr-secret-stores-for-runtime-secrets-and-component-references">Using Dapr Secret Stores for runtime secrets and component references<a class="hash-link" href="#using-dapr-secret-stores-for-runtime-secrets-and-component-references" title="Direct link to heading">‚Äã</a></h3><p>Dapr integrates with secret stores to provide apps and other components with secure storage and access to secrets such as access keys and passwords. The Dapr Secrets API is now available for use in Container Apps. </p><p>Using Dapr‚Äôs secret store building block typically involves the following:</p><ul><li>Setting up a component for a specific secret store solution.</li><li>Retrieving secrets using the Dapr secrets API in the application code.</li><li>Optionally, referencing secrets in Dapr component files.</li></ul><p><img loading="lazy" src="/Cloud-Native/assets/images/secrets-overview-cloud-stores-f0c9f823ba6a3246dac070c4da40a80a.png" width="1739" height="1057" class="img_ev3q"></p><p>Let's walk through a couple sample workflows involving the use of Dapr's Secrets Management capabilities! </p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="setting-up-a-component-for-a-specific-secret-store-solution">Setting up a component for a specific secret store solution<a class="hash-link" href="#setting-up-a-component-for-a-specific-secret-store-solution" title="Direct link to heading">‚Äã</a></h4><ol><li><p>Create an Azure Key Vault instance for hosting the secrets required by your application.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">az keyvault create --name </span><span class="token string" style="color:#e3116c">"&lt;your-unique-keyvault-name&gt;"</span><span class="token plain"> --resource-group </span><span class="token string" style="color:#e3116c">"my-resource-group"</span><span class="token plain"> --location </span><span class="token string" style="color:#e3116c">"&lt;your-location&gt;"</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Create an Azure Key Vault component in your environment without the secrets values, as the connection will be established to Azure Key Vault via Managed Identity.</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">componentType</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> secretstores.azure.keyvault</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">version</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> vaultName</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">value</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"[your_keyvault_name]"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">scopes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> myApp </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">az containerapp </span><span class="token function" style="color:#d73a49">env</span><span class="token plain"> dapr-component </span><span class="token builtin class-name">set</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --name </span><span class="token string" style="color:#e3116c">"my-environment"</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --resource-group </span><span class="token string" style="color:#e3116c">"my-resource-group"</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --dapr-component-name secretstore </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --yaml </span><span class="token string" style="color:#e3116c">"./secretstore.yaml"</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Run the following command to create a system-assigned identity for your container app </p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">az containerapp identity assign </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --name </span><span class="token string" style="color:#e3116c">"myApp"</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --resource-group </span><span class="token string" style="color:#e3116c">"my-resource-group"</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --system-assigned</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Retrieve the identity details for your container app and store the Principal ID for the identity in a variable <strong>"PRINCIPAL_ID"</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">az containerapp identity show </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --name </span><span class="token string" style="color:#e3116c">"myApp"</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --resource-group </span><span class="token string" style="color:#e3116c">"my-resource-group"</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Assign the appropriate roles and permissions to your container app's managed identity to access Azure Key Vault</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">az role assignment create </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--role </span><span class="token string" style="color:#e3116c">"Key Vault Secrets Officer"</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--assignee </span><span class="token variable" style="color:#36acaa">$PRINCIPAL_ID</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--scope /subscriptions/</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">subscriptionid</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">/resourcegroups/</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">resource-group-name</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">/providers/Microsoft.KeyVault/vaults/</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">key-vault-name</span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Begin using the Dapr Secrets API in your application code to retrieve secrets! See additional details <a href="https://docs.dapr.io/reference/api/secrets_api/" target="_blank" rel="noopener noreferrer">here</a>.</p></li></ol><h4 class="anchor anchorWithStickyNavbar_LWe7" id="referencing-secrets-in-dapr-component-files">Referencing secrets in Dapr component files<a class="hash-link" href="#referencing-secrets-in-dapr-component-files" title="Direct link to heading">‚Äã</a></h4><p>Once a Dapr secret store component is available in the environment, it can be used to retrieve secrets for use in other components. For example, when creating a state store component, you can add a reference to the Dapr secret store from which you would like to source connection information. You will no longer use secrets directly in the component spec, but rather will instruct the Dapr sidecar to retrieve the secrets from the specified store. </p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">componentType</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> state.azure.blobstorage</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">version</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> accountName</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">value</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> testStorage</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> accountKey</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">secretRef</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> account</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> containerName</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">value</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> myContainer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">secretStoreComponent</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"&lt;SECRET_STORE_COMPONENT_NAME&gt;"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">scopes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> myApp</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="summary">Summary<a class="hash-link" href="#summary" title="Direct link to heading">‚Äã</a></h2><p>In this post, we have covered the high-level details on how to work with secret values in Azure Container Apps for both Dapr and Non-Dapr apps. In the next article, we will walk through a complex Dapr example from end-to-end which makes use of the new support for Dapr + Managed Identity. Stayed tuned for additional documentation around Dapr secrets as it will be release in the next two weeks! </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="resources">Resources<a class="hash-link" href="#resources" title="Direct link to heading">‚Äã</a></h2><p>Here are the main resources to explore for self-study:</p><ul><li><a href="https://learn.microsoft.com/azure/container-apps/manage-secrets?tabs=azure-cli" target="_blank" rel="noopener noreferrer">Azure Container Apps Secrets</a></li><li><a href="https://learn.microsoft.com/azure/container-apps/managed-identity?tabs=portal%2Cdotnet" target="_blank" rel="noopener noreferrer">Managed Identities in Azure Container Apps</a></li><li><a href="https://v1-9.docs.dapr.io/concepts/" target="_blank" rel="noopener noreferrer">Dapr Documentation: Core Concepts</a></li><li><a href="https://docs.dapr.io/getting-started/quickstarts/" target="_blank" rel="noopener noreferrer">Dapr Quickstarts</a></li><li><a href="https://docs.dapr.io/getting-started/tutorials/" target="_blank" rel="noopener noreferrer">Dapr Tutorials</a></li><li><a href="https://learn.microsoft.com/azure/container-apps/dapr-overview" target="_blank" rel="noopener noreferrer">Azure Container Apps: Dapr Integration</a></li><li><a href="https://learn.microsoft.com/azure/container-apps/microservices-dapr" target="_blank" rel="noopener noreferrer">Dapr-enabled Azure Container Apps: Using Azure CLI</a></li><li><a href="https://learn.microsoft.com/azure/container-apps/microservices-dapr-azure-resource-manager" target="_blank" rel="noopener noreferrer">Dapr-enabled Azure Container Apps: Using Bicep or ARM</a></li></ul>]]></content>
        <author>
            <name>Kendall Roden</name>
            <uri>https://github.com/kendallroden</uri>
        </author>
        <category label="serverless-september" term="serverless-september"/>
        <category label="30-days-of-serverless" term="30-days-of-serverless"/>
        <category label="azure-container-apps" term="azure-container-apps"/>
        <category label="dapr" term="dapr"/>
        <category label="microservices" term="microservices"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[14. Build ACA with Dapr]]></title>
        <id>14-dapr-aca-quickstart</id>
        <link href="https://azure.github.io/Cloud-Native/blog/14-dapr-aca-quickstart"/>
        <updated>2022-09-14T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Let's build our first Azure Container Apps solution with Dapr!]]></summary>
        <content type="html"><![CDATA[<hr><p>Welcome to <code>Day 14</code> of #30DaysOfServerless!</p><p>In the past few days we focused our attention on Azure Container Apps, building microservices-based solutions and learning related concepts like environments, networking and auto-scaling - before introducing the sidecar capability of Dapr. Today, we look at how Dapr and ACA work seamlessly together to simplify microservices development in the cloud.</p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-well-cover">What We'll Cover<a class="hash-link" href="#what-well-cover" title="Direct link to heading">‚Äã</a></h2><ul><li>Dapr refresher</li><li>Application scenario we are covering today</li><li>Quickstart: Build your first ACA with Dapr</li><li>Exercise: Try this yourself!</li><li>What's Next: Advanced scenario in 12-part series </li><li>Resources: For self-study!</li></ul><p><img loading="lazy" src="/Cloud-Native/assets/images/banner-7d7a40cad48fa26cd9b62cdf2a073fe5.png" width="1600" height="672" class="img_ev3q"></p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction-to-dapr">Introduction To Dapr<a class="hash-link" href="#introduction-to-dapr" title="Direct link to heading">‚Äã</a></h2><p>As developers, we are often tasked with create scalable resilient and distributed microservices, but face challenges such as recovering state after failures, establishing reliable communication between services, integrating with external resources and instrumenting distributed tracing for end-to-end solution observability. Dapr (Distributed Application Runtime) offers an approach for solving these common problems more easily. </p><p>Dapr provides its core capabilities as a set of <a href="https://docs.dapr.io/concepts/building-blocks-concept/" target="_blank" rel="noopener noreferrer">Building Blocks</a> as detailed in the introduction to dapr article released as a part of this series. Building Blocks provide consistent APIs that abstract away the implementation details to keep microservices code simple and portable.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="todays-app-scenario">Today's App Scenario<a class="hash-link" href="#todays-app-scenario" title="Direct link to heading">‚Äã</a></h2><p>In this blog post we will create an Azure Container App which will act as an internal-only, background processor service. This service will not be accessible from the internet or from other services directly. We will also configure two Dapr building blocks (APIs): Pub/Sub and State Management. Let's take a look at the architecture diagram below to have better understanding of what we are building:</p><p><img loading="lazy" alt="Diagram showing architecture of sample project" src="/Cloud-Native/assets/images/ACA-Tutorial-AsyncComm-0922-909e943512d388e21a69516efb153bdf.jpg" width="1222" height="735" class="img_ev3q"></p><p>Our service, <code>orders-processor</code>, will be processing messages published to an Azure Service Bus Topic named <code>orderreceivedtopic</code>. The Dapr Pub/Sub building block will be configured by providing a configuration file named <code>pubsub-svcbus.yaml</code> which contains all the needed information to establish the connection between the container app and the service bus topic. Once a message is consumed by the <code>orders-processor</code> service, it will store a copy of it in Azure Cosmos DB. To wire up Cosmos DB, we will use the Dapr State Store building block and a <code>statestore-cosmosdb.yaml</code> component.</p><p>Because we are leveraging Dapr, we will not introduce any SDK for Azure Service Bus nor Azure Cosmos DB; everything will be configured using the component files, so let's jump into the code! :)</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Looking for Advanced scenarios?</div><div class="admonitionContent_S0QG"><p>This scenario is a simplified version of a detailed tutorial which covers more advanced scenarios, if you are interested you can check more <a href="https://bitoftech.net/2022/08/25/tutorial-building-microservice-applications-azure-container-apps-dapr/" target="_blank" rel="noopener noreferrer">Advanced scenarios on my blog.</a></p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="build-aca-with-dapr">Build ACA with Dapr<a class="hash-link" href="#build-aca-with-dapr" title="Direct link to heading">‚Äã</a></h2><p>In today's post, we'll be using VS Code to build the app using ASP.NET Core 6.0. In the process, we'll setup our development environment with the relevant command-line tools and VS Code extensions. In addition, we will use the Azure CLI to create the Azure resources which will be used in this solution.</p><p><em>Note: Completing this exercise may incur a a cost of a few USD based on your Azure subscription.</em></p><p>First, make sure you have your development environment setup and configured.</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>PRE-REQUISITES</div><div class="admonitionContent_S0QG"><ol><li><strong>An Azure account with an active subscription</strong> - <a href="https://azure.microsoft.com/free/?ref=microsoft.com&amp;utm_source=microsoft.com&amp;utm_medium=docs&amp;utm_campaign=visualstudio" target="_blank" rel="noopener noreferrer">Create an account for free</a></li><li><strong>dotnet 6.0</strong> - <a href="https://dotnet.microsoft.com/download/dotnet/6.0" target="_blank" rel="noopener noreferrer">Install</a></li><li><strong>Docker Desktop</strong> - <a href="https://docs.docker.com/desktop/install/windows-install/" target="_blank" rel="noopener noreferrer">Install</a> </li><li><strong>Visual Studio Code</strong> - <a href="https://code.visualstudio.com/" target="_blank" rel="noopener noreferrer">Install</a></li><li><strong>VS Code Docker extension</strong> - <a href="https://marketplace.visualstudio.com/items?itemName=ms-azuretools.vscode-docker" target="_blank" rel="noopener noreferrer">Install</a></li><li><strong>Dapr CLI. Details on installation on this post too</strong> - <a href="https://docs.dapr.io/getting-started/install-dapr-cli/" target="_blank" rel="noopener noreferrer">Install</a></li><li><strong>VS Code Dapr extension. Depends on Dapr CLI</strong> - <a href="https://marketplace.visualstudio.com/items?itemName=ms-azuretools.vscode-dapr" target="_blank" rel="noopener noreferrer">Install</a></li><li><strong>Azure CLI</strong> - <a href="https://docs.microsoft.com/cli/azure/install-azure-cli" target="_blank" rel="noopener noreferrer">Install</a></li></ol></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-the-service-project-web-api">Create the service project (Web API)<a class="hash-link" href="#create-the-service-project-web-api" title="Direct link to heading">‚Äã</a></h3><ol><li><p>Open a command-line terminal and create a folder for your project. Use the <code>code</code> command to launch Visual Studio Code from that directory as shown:</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mkdir orders-service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd orders-service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">code .</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>From VS Code Terminal tab, open developer command prompt or PowerShell terminal in the project folder <code>orders-service</code> and initialize the project by typing: <code>dotnet new webapi -o Orders.Processor  --no-https</code> This will create and ASP.NET Web API project scaffolded with 1 single controller. </p></li><li><p>We need to containerize this application so we can push it to Azure Container Registry as a docker image and deploy it to Azure Container Apps. To do so, Open the VS Code Command Palette (<kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>p</kbd>) and select <code>Docker: Add Docker Files to Workspace...</code></p><ul><li>Use <code>.NET: ASP.NET Core</code> when prompted for application platform.</li><li>Choose <code>Linux</code> when prompted to choose the operating system.</li><li>You will be asked if you want to add Docker Compose files. Select <code>No</code>.</li><li>Take a not of the provided <strong>application port</strong> as we will be using later on.</li><li><code>Dockerfile</code> and <code>.dockerignore</code> files are added to the workspace.</li></ul></li><li><p>Now we will add the DTO which will be used to deserialize the consumed message from Azure Service Bus Topic, so add a new file named <code>OrderModel.cs</code> under a new folder named <code>Models</code> and use the code below</p><div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public class OrderModel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public Guid OrderId { get; set; } = Guid.NewGuid();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public string Reference { get; set; } = string.Empty;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public int Quantity { get; set; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public DateTime CreatedOn { get; set; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Install Dapr Client NuGet package, we will use this package to subscribe to the Azure Service Bus Topic in a programmatic way. From the developer command prompt or PowerShell terminal type <code>dotnet add package Dapr.AspNetCore</code></p></li><li><p>Create an API endpoint for the consumer/service to subscribe to the topic, this endpoint will start receiving the messages published to the topic <code>orderreceivedtopic</code>. Add a new controller named <code>ExternalOrdersController.cs</code> under the <code>Controllers</code> folder and use the code below:</p><div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[ApiController]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Route("api/externalorders")]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class ExternalOrdersController : ControllerBase</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private readonly ILogger&lt;ExternalOrdersController&gt; _logger;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private readonly DaprClient _daprClient;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public ExternalOrdersController(ILogger&lt;ExternalOrdersController&gt; logger, DaprClient daprClient)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _logger = logger;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _daprClient = daprClient;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [Topic("pubsub-servicebus", "orderreceivedtopic")]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [HttpPost("orderreceived")]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public async Task&lt;IActionResult&gt; OrderReceived([FromBody] OrderModel orderModel)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _logger.LogInformation("Received new order at: '{0}' Order Id: '{1}' Order reference: '{2}', Order quantity: '{3}'",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                DateTime.UtcNow, orderModel.OrderId, orderModel.Reference, orderModel.Quantity);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //Do your business logic with order received</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        orderModel.CreatedOn = DateTime.UtcNow;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ////ToDo: Your exercise :) Save the received message into CosmoDb using the SveStateAsync</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //await _daprClient.SaveStateAsync&lt;OrderModel&gt;("statestore-cosmosdb", orderModel.OrderId.ToString(), orderModel);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //Return 200 ok to acknowledge order is processed successfully          </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return Ok($"Order Processing completed successfully");</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //Retunr 400 bad request to retry re-processing based on service broker configuration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //return BadRequest($"Failed to process order due to: failure reason");</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In summary, the above steps result in: </p><ul><li>An action method called <code>orderreceived</code> which can be reached on the route <code>api/externalorders/orderreceived</code> and receives an <code>OrderModel</code> object.</li><li>An attribute <code>Topic</code> on the action method including the name of the pub/sub component and the topic to subscribe to. </li><li>Business logic for processing the message which will result in an appropriate response which dictates if the message was process successfully, should be retried or should be dead-lettered.</li></ul></li><li><p>Register the Dapr client and Subscribe handler at service startup. Open the file <code>Program.cs</code> and replace with the content below:</p><div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    var builder = WebApplication.CreateBuilder(args);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Add services to the container.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    builder.Services.AddControllers().AddDapr();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Learn more about configuring Swagger/OpenAPI at https://aka.ms/aspnetcore/swashbuckle</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    builder.Services.AddEndpointsApiExplorer();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    builder.Services.AddSwaggerGen();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var app = builder.Build();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Configure the HTTP request pipeline.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (app.Environment.IsDevelopment())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    app.UseSwagger();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    app.UseSwaggerUI();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    app.UseAuthorization();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    app.UseCloudEvents();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    app.MapControllers();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    app.MapSubscribeHandler();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    app.Run();</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Want to know more?</div><div class="admonitionContent_S0QG"><p>   Check this <a href="https://bitoftech.net/2022/09/02/azure-container-apps-async-communication-with-dapr-pub-sub-api-part-6/" target="_blank" rel="noopener noreferrer">blog post</a> which describes in detail how the consumer was able to discover available topic names, Pub/Sub names, and which routes/endpoints to push messages to.</p></div></div></li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="provision-azure-service-bus-topic-and-subscription">Provision Azure Service Bus, Topic and Subscription<a class="hash-link" href="#provision-azure-service-bus-topic-and-subscription" title="Direct link to heading">‚Äã</a></h3><p>We need to create the Azure Service Bus so we can configure the Dapr Pub/Sub component and test locally</p><ol><li><p>Open your Powershell console and login to Azure by using the command <code>az login</code>. If you have multiple subscriptions, set the subscription you want to use in this tutorial before proceeding, you can do this by using <code>az account set --subscription &lt;name or id&gt;</code>. Calling <code>az upgrade</code> is a good practice to ensure you are running the latest Aure CLI version.</p></li><li><p>Create an Azure Resource Group by using the code below, feel free to change the name and location of the resource group</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$RESOURCE_GROUP="orders-services-rg"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$LOCATION="eastus"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">az group create `</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --name $RESOURCE_GROUP `</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --location "$LOCATION"</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Create the necessary Azure Service Bus resource and retrieve the primary connection string (for local dev testing).</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$NamespaceName="ordersservices"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$TopicName="orderreceivedtopic"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$TopicSubscription="orders-processor-subscription"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">##Create servicebus namespace</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">az servicebus namespace create --resource-group $RESOURCE_GROUP --name $NamespaceName --location $LOCATION</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">##Create a topic under namespace</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">az servicebus topic create --resource-group $RESOURCE_GROUP --namespace-name $NamespaceName --name $TopicName</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">##Create a topic subscription</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">az servicebus topic subscription create `</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --resource-group $RESOURCE_GROUP `</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --namespace-name $NamespaceName `</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --topic-name $TopicName `</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --name $TopicSubscription</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">##List connection string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">az servicebus namespace authorization-rule keys list --resource-group $RESOURCE_GROUP --namespace-name $NamespaceName --name RootManageSharedAccessKey --query primaryConnectionString --output tsv</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ol><p>You can navigate to the Azure Portal and check that the resource group is created and the service bus namespace is created too.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="setup-dapr-for-local-dev">Setup Dapr for local dev<a class="hash-link" href="#setup-dapr-for-local-dev" title="Direct link to heading">‚Äã</a></h3><p>In order to run Dapr locally on our development machine, we need to install Dapr CLI, you can follow the <a href="https://docs.dapr.io/getting-started/install-dapr-cli/" target="_blank" rel="noopener noreferrer">official documentation</a> or use the steps below.</p><ol><li><p>Install the Dapr CLI, run PowerShell console as an administrator and run the below command: </p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> powershell -Command "iwr -useb https://raw.githubusercontent.com/dapr/cli/master/install/install.ps1 | iex"</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Note: You might need to execute the following  PowerShell command <code>Set-ExecutionPolicy RemoteSigned -scope CurrentUser</code> before installing the Dapr CLI, this command is to allow local PowerShell scripts to run regardless of signature, and requires trusted digital signatures only for remote scripts.</p></li><li><p>Initialize Dapr in your local development environment. By initializing Dapr, we will fetch and install the Dapr sidecar binaries locally, and we will create a development environment that streamlines application development with Dapr. To do so open the PowerShell console as an administrator and run the below command:</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dapr init</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>To verify the deployment; check Dapr version by running the following command: <code>dapr --version</code> </p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Want to know more?</div><div class="admonitionContent_S0QG"><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Check this [blog post](https://bitoftech.net/2022/08/29/dapr-integration-with-azure-container-apps/) which describes in detail what components added to your machine when we called `dapr init`</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-a-local-dapr-component-file-for-pubsub">Create a local Dapr Component file for Pub/Sub<a class="hash-link" href="#create-a-local-dapr-component-file-for-pubsub" title="Direct link to heading">‚Äã</a></h3><p>Dapr uses a modular design where functionality is delivered as a component. Each component has an interface definition. All of the components are pluggable so that you can swap out one component with the same interface for another.</p><p>Components are configured at design-time with a YAML file which is stored in either a components/local folder within your solution, or globally in the .dapr folder created when invoking dapr init <a href="https://bitoftech.net/2022/08/29/dapr-integration-with-azure-container-apps/" target="_blank" rel="noopener noreferrer">(read here for more details)</a>. These YAML files adhere to the generic <a href="https://docs.dapr.io/operations/components/component-schema/" target="_blank" rel="noopener noreferrer">Dapr component schema</a>, but each is specific to the component specification.</p><ol><li><p>Create 2 new folders under the project root directory <code>orders-service</code>, one called <code>dapr-component</code> and the second one <code>component</code> (will be used in next steps). Add a new yaml file called <code>pubsub-svcbus.yaml</code> under folder <code>dapr-component</code> using the content below:</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> dapr.io/v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Component</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> pubsub</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">servicebus</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> pubsub.azure.servicebus</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">version</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> connectionString </span><span class="token comment" style="color:#999988;font-style:italic"># Used for local dev testing.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">value</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"&lt;connection string from step 2.3&gt;"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> consumerID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">value</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"orders-processor-subscription"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">scopes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> orders</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">processor</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Note that we used the name <code>pubsub-servicebus</code> which should match the name of Pub/Sub component we've used earlier in the <code>ExternalOrdersController.cs</code> controller on the action method with the attribute <code>Topic</code>. As well we have set the metadata (key/value) to allow us to connect to Azure Service Bus topic. The metdata <code>consumerID</code> value should match the topic subscription name <code>orders-processor-subscription</code>. We have set the scopes section to include the <code>orders-processor</code> app id, as this will be the specific application that needs access to Azure Service Bus.</p><p>You need to replace the <code>connectionString</code> value with your Service Bus connection string. This is only needed for your local testing on your development machine, we'll be using a different approach (<strong>Managed Identities</strong>) when deploying Dapr component to Azure Container Apps Environment. For full metadata specs, you can <a href="https://docs.dapr.io/reference/components-reference/supported-pubsub/setup-azure-servicebus/" target="_blank" rel="noopener noreferrer">check this page</a>.</p><div class="theme-admonition theme-admonition-warning alert alert--danger admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>danger</div><div class="admonitionContent_S0QG"><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">The above sample uses secrets as plain strings for local dev testing. It is recommended to use Managed Identities approach when we deploy the app to Azure Container Apps. Your Dapr components directory should be added to your .gitignore to avoid checking in secrets.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="preview-dapr-app-locally-for-e2e-testing">Preview Dapr app locally for e2e testing<a class="hash-link" href="#preview-dapr-app-locally-for-e2e-testing" title="Direct link to heading">‚Äã</a></h3><ol><li><p>Within VS Code, open PowerShell terminal, change the directory in the terminal to folder <code>orders-service</code> and run the below command in PS terminal:</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dapr run --app-id orders-processor --app-port 5039 --dapr-http-port 3500 --components-path "../dapr-components" dotnet run</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>When using the <code>dapr run</code> command we are running a dapr process as a sidecar next to the Web API application. The following properties were configured:</p><ul><li>app-id: The unique identifier of the application. Used for service discovery, state encapsulation, and the pub/sub consumer identifier.</li><li>app-port: This parameter tells Dapr which port your application is listening on, you can get the app port from <code>dockerfile</code> in the Web API Project.</li><li>dapr-http-port: the HTTP port for Dapr to listen on.</li><li>components-path: path to the Dapr component(s) folder.</li></ul><p>If all is working as expected, you can open the VS Code Dapr extension to see the application <code>orders-processor</code> up and running as shown below:</p><p><img loading="lazy" alt="Image showing Dapr Application up and Running" src="/Cloud-Native/assets/images/DaprRunning-792ed943c5235ef05dede830b5e4d317.jpg" width="406" height="450" class="img_ev3q"></p></li><li><p>To publish a message to the topic <code>orderreceivedtopic</code> we can use Dapr extension: </p><ul><li>Right click on the Dapr application <code>orders-processor</code> and select <code>Publish Message to Application</code>.</li><li>Wizard will ask what is the Pub/sub component name you want to publish to, provide <code>pubsub-servicebus</code> and hit enter.</li><li>Wizard will ask what topic name to publish to, provide <code>orderreceivedtopic</code> and hit enter.</li><li>Wizard will ask to provide a JSON payload for the method, provide the JSON below and hit enter.<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">"reference"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"Order 1"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">"quantity"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">"createdOn"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"2022-08-19T12:45:22.0983978Z"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul></li></ol><p>To check the results, go to the VS Code terminal and check the logs. In the action method, we are logging information when a message is consumed. You should see something similar to the below
<img loading="lazy" alt="Image showing logs in terminal" src="/Cloud-Native/assets/images/TerminalLogs-4813eaba2150ac7a867dafd58ba5dbfc.jpg" width="1444" height="161" class="img_ev3q"></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">:::info Want to debug Dapr application locally?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  If you want to set breakpoints and debug your daper application locally, you can do this in VS code by following simple steps. This is very important when you are running multiple services together and want to test your microservice where multi-services are invoking each other. To learn more, you can continue reading on [my blog.](https://bitoftech.net/2022/08/29/dapr-integration-with-azure-container-apps/)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">:::</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="deploy-the-app-to-azure-container-apps">Deploy the app to Azure Container Apps<a class="hash-link" href="#deploy-the-app-to-azure-container-apps" title="Direct link to heading">‚Äã</a></h3><p>We will follow few steps in order to deploy the service <code>Orders.Processor</code> to Azure Container Apps, but we need to do one addition before deploying, we have to create a component file for Azure Service Bus which meets the <a href="https://docs.microsoft.com/azure/container-apps/dapr-overview?tabs=bicep1%2Cyaml#configure-dapr-components" target="_blank" rel="noopener noreferrer">specs defined by Azure Container Apps</a>.</p><ol><li>Create a new yaml file named <code>pubsub-svcbus.yaml</code> and add it under folder <code>components</code> (folder created earlier), use the file content below:<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># pubsub.yaml for Azure Service Bus component</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">componentType</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> pubsub.azure.servicebus</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">version</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> namespaceName</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">value</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"ordersservices.servicebus.windows.net"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> consumerID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">value</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"orders-processor-subscription"</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Application scopes  </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">scopes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> orders</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">processor</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ol><p>Things to notice here:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  - We didn't specify the component name `pubsub-servicebus` when we created this component file, we are going to specify it once we add this dapr component to Azure Container Apps Environment via CLI.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - We are not referencing any service bus connection strings as the authentication between Dapr and Azure Service Bus will be configured using Managed Identities. </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - The metadata `namespaceName` value is set to the address of the Service Bus namespace as a fully qualified domain name. The key is mandatory when using Managed Identities for authentication.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - We are setting the metadata `consumerID` value to match the topic subscription name `orders-processor-subscription`. If you didn't set this metadata, dapr runtime will try to create a subscription using the dapr application ID.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="2"><li><p>Createan  Azure Container Registry (ACR) instance in the resource group to build/push and store docker images of our service. Feel free to change the name of the ACR, to do so run the following command:</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  ## Create Azure Container Registry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  $ACR_NAME="ordersservicesacr"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  az acr create `</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --resource-group $RESOURCE_GROUP `</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --name $ACR_NAME `</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --sku Basic `</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --admin-enabled true</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Build the Web API project on ACR and push the docker image to ACR. Use the below command to initiate the image build and push process using ACR:</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">## Build and push image to ACR</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$BACKEND_SVC_NAME="orders-processor"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd {YourLocalPath}\orders-service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">az acr build --registry $ACR_NAME --image $BACKEND_SVC_NAME --file 'Orders.Processor/Dockerfile' .      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Provision an Azure Container Apps Env and Container App: the Azure Container Apps Environment acts as a secure boundary around a group of all container apps:</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ## Upgrade az container app cli or install it</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  az extension add --name containerapp --upgrade</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ## Create ACA Env</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  $ENVIRONMENT="orders-services-aca-env"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  az containerapp env create `</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --name $ENVIRONMENT `</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --resource-group $RESOURCE_GROUP `</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --location $LOCATION</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Deploy the Dapr Pub/Sub Component to the Azure Container Apps Environment using the following command: </p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    az containerapp env dapr-component set `</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --name $ENVIRONMENT --resource-group $RESOURCE_GROUP `</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --dapr-component-name pubsub-servicebus `</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --yaml '.\components\pubsub-svcbus.yaml'</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Create a new Azure Container App with the below capabilities:</p><ul><li>Ingress should be disabled</li><li>Dapr needs to be enabled </li></ul><p>To achieve the above run the below PowerShell script:</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">## Create Azure COntain App</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$BACKEND_SVC_NAME="orders-processor"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">az containerapp create `</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --name $BACKEND_SVC_NAME  `</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --resource-group $RESOURCE_GROUP `</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --environment $ENVIRONMENT `</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --registry-server "$ACR_NAME.azurecr.io" `</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --image "$ACR_NAME.azurecr.io/$BACKEND_SVC_NAME" `</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --min-replicas 1 `</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --max-replicas 1 `</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --cpu 0.50 --memory 1.0Gi `</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --enable-dapr `</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --dapr-app-id  $BACKEND_SVC_NAME `</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --dapr-app-port 5039</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="configure-managed-identities-in-azure-container-app">Configure Managed Identities in Azure Container App<a class="hash-link" href="#configure-managed-identities-in-azure-container-app" title="Direct link to heading">‚Äã</a></h3><p>As you noticed so far, we are not using any connection strings to establish the relation between our Container App and Azure Service Bus, we will rely on <a href="https://learn.microsoft.com/azure/container-apps/managed-identity?tabs=portal%2Cdotnet" target="_blank" rel="noopener noreferrer">Managed Identities</a> to allow our container app to access Azure Service Bus. </p><p>We will be using a <code>system-assigned</code> identity with a role assignments to grant our container app the <code>Azure Service Bus Data Receiver</code> role which will allow it to receive messages from Service Bus queues and subscriptions.</p><ol><li><p>Run the command below to create <code>system-assigned</code> identity for our container app:</p><div class="language-PowerShell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-PowerShell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">##assigning the system assigned identity</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">az containerapp identity assign `</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --resource-group $RESOURCE_GROUP `</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --name $BACKEND_SVC_NAME `</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --system-assigned</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This command will create an Enterprise Application (so a Service Principal) within Azure AD, which is linked to our container app, the output of this command will be as the below, keep a note of the property <code>principalId</code> as we are going to use it in the next step.</p><div class="language-Json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-Json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   "principalId": "456782b0-d5be-4dbd-afa0-5e2cff05d04d",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   "tenantId": "0a02a8b1-XXXX-XXXX-XXXX-67ceb9132d81",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   "type": "SystemAssigned"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Note: This can be done from Azure Portal as described <a href="https://learn.microsoft.com/azure/container-apps/managed-identity?tabs=portal%2Cdotnet#add-a-system-assigned-identity" target="_blank" rel="noopener noreferrer">here.</a></p></li><li><p>Next, we need to associate the container app system-identity with the target Azure Service Bus resouce. You can read more about <a href="https://learn.microsoft.com/azure/service-bus-messaging/service-bus-managed-service-identity#azure-built-in-roles-for-azure-service-bus" target="_blank" rel="noopener noreferrer">Azure built-in roles for Azure Service Bus.</a>. Run the command below to associate the <code>system-assigned</code> with access-control role <code>Azure Service Bus Data Receiver</code></p><div class="language-PowerShell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-PowerShell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  $subscription_id = "&lt;Your Azure Subscription ID&gt;" ## Your Azure Subscription</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  $principalId = "456782b0-d5be-4dbd-afa0-5e2cff05d04d" ## Principal Id after creating system identity for container app </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  $roleNameOrId =  "Azure Service Bus Data Receiver" ## Built in role name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  $resourceName = "ordersservices" ##Name of your Service Bus Namespace</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  az role assignment create `</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --assignee $principalId `</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --role $roleNameOrId `</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --scope /subscriptions/$subscription_id/resourcegroups/$RESOURCE_GROUP/providers/Microsoft.ServiceBus/namespaces/$resourceName</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p> You can verify from Azure Portal that the association relation is created by going to your container app, select <code>identity</code> tab, then click on <code>Azure role assignments</code> button, you should see the role assignment below:
<img loading="lazy" alt="Image showing container apps role assignment" src="/Cloud-Native/assets/images/RoleAssignment-S-4d69197e34696dc635708ccffc9bbe66.jpg" width="855" height="338" class="img_ev3q"></p></li><li><p>Lastly, we need to restart the container app revision, to do so run the command below:</p><div class="language-PowerShell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-PowerShell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> ##Get revision name and assign it to a variable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $REVISION_NAME = (az containerapp revision list `</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         --name $BACKEND_SVC_NAME  `</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         --resource-group $RESOURCE_GROUP `</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         --query [0].name)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ##Restart revision by name                            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> az containerapp revision restart `</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   --resource-group $RESOURCE_GROUP `</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   --name $BACKEND_SVC_NAME  `</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   --revision $REVISION_NAME</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="run-end-to-end-test-on-azure">Run end-to-end Test on Azure<a class="hash-link" href="#run-end-to-end-test-on-azure" title="Direct link to heading">‚Äã</a></h3><p>From the Azure Portal, select the Azure Container App <code>orders-processor</code> and navigate to <code>Log stream</code> under <code>Monitoring</code> tab, leave the stream connected and opened. From the Azure Portal, select the Azure Service Bus Namespace <code>ordersservices</code>, select the topic <code>orderreceivedtopic</code>, select the subscription named <code>orders-processor-subscription</code>, then click on <code>Service Bus Explorer (preview)</code>. From there we need to publish/send a message. Use the JSON payload below</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">```json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "data": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "reference": "Order 150",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "quantity": 150,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "createdOn": "2022-05-10T12:45:22.0983978Z"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p> If all is configured correctly, you should start seeing the information logs in Container Apps Log stream, similar to the images below
<img loading="lazy" alt="Image showing publishing messages from Azure Service" src="/Cloud-Native/assets/images/SvsBusPublishMessage-S-db3c800138a71f277bc45fcdab54e297.jpg" width="669" height="344" class="img_ev3q"></p><p> Information logs on the <code>Log stream</code> of the deployed Azure Container App
<img loading="lazy" alt="Image showing ACA Log Stream" src="/Cloud-Native/assets/images/ACA-Logstream-s-93516646409771be6bbdeac37155df15.jpg" width="686" height="394" class="img_ev3q"></p><div class="theme-admonition theme-admonition-success alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>üéâ CONGRATULATIONS</div><div class="admonitionContent_S0QG"><p>You have successfully deployed to the cloud an Azure Container App and configured Dapr Pub/Sub API with Azure Service Bus.</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="9-clean-up">9. Clean up<a class="hash-link" href="#9-clean-up" title="Direct link to heading">‚Äã</a></h3><p>If you are done with the tutorial, use the following command to delete the resource group and all its contained resources to avoid incurring further costs.</p><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">az group delete --name $RESOURCE_GROUP</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="exercise">Exercise<a class="hash-link" href="#exercise" title="Direct link to heading">‚Äã</a></h2><p>I left for you the configuration of the Dapr State Store API with Azure Cosmos DB :) </p><p>When you look at the action method <code>OrderReceived</code> in controller <code>ExternalOrdersController</code>, you will see that I left a line with <code>ToDo:</code> note, this line is responsible to save the received message (OrderModel) into Azure Cosmos DB. </p><p>There is no need to change anything on the code base (other than removing this commented line), that's the beauty of Dapr Building Blocks and how easy it allows us to plug components to our microservice application without any plumping and brining external SDKs.</p><p>For sure you need to work on the configuration part of Dapr State Store by creating a new component file like what we have done with the Pub/Sub API, things that you need to work on are:</p><ul><li>Provision Azure Cosmos DB Account and obtain its masterKey.</li><li>Create a Dapr Component file adhering to Dapr Specs.</li><li>Create an Azure Container Apps component file adhering to ACA component specs.</li><li>Test locally on your dev machine using Dapr Component file.</li><li>Register the new Dapr State Store component with Azure Container Apps Environment and set the Cosmos Db masterKey from the Azure Portal. <em>If you want to challenge yourself more, use the Managed Identity approach as done in this post! The right way to protect your keys and you will not worry about managing CosmosDb keys anymore!</em></li><li>Build a new image of the application and push it to Azure Container Registry.</li><li>Update Azure Container Apps and create a new revision which contains the updated code.</li><li>Verify the results by checking Azure Cosmos DB, you should see the Order Model stored in Cosmos DB.</li></ul><p>If you need help, you can always refer to my blog post <a href="https://bitoftech.net/2022/08/29/azure-container-apps-state-store-with-dapr-state-management-api/" target="_blank" rel="noopener noreferrer">Azure Container Apps State Store With Dapr State Management API</a> which contains exactly what you need to implement here, so I'm very confident you will be able to complete this exercise with no issues, happy coding :)</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="whats-next">What's Next?<a class="hash-link" href="#whats-next" title="Direct link to heading">‚Äã</a></h2><p>If you enjoyed working with Dapr and Azure Container Apps, and you want to have a deep dive with more complex scenarios (Dapr bindings, service discovery, auto scaling with KEDA, sync services communication, distributed tracing, health probes, etc...) where multiple services deployed to a single Container App Environment; I have created a detailed tutorial which should walk you through step by step with through details to build the application.</p><p>So far, the published posts below, and I'm publishing more posts on weekly basis, so stay tuned :)</p><ul><li><a href="https://bitoftech.net/2022/08/25/tutorial-building-microservice-applications-azure-container-apps-dapr/" target="_blank" rel="noopener noreferrer">Tutorial for building Microservice Applications with Azure Container Apps and Dapr ‚Äì Part 1</a></li><li><a href="https://bitoftech.net/2022/08/25/deploy-microservice-application-azure-container-apps/" target="_blank" rel="noopener noreferrer">Deploy backend API Microservice to Azure Container Apps ‚Äì Part 2</a></li><li><a href="https://bitoftech.net/2022/08/25/communication-microservices-azure-container-apps/" target="_blank" rel="noopener noreferrer">Communication between Microservices in Azure Container Apps ‚Äì Part 3</a></li><li><a href="https://bitoftech.net/2022/08/29/dapr-integration-with-azure-container-apps/" target="_blank" rel="noopener noreferrer">Dapr Integration with Azure Container Apps ‚Äì Part 4</a></li><li><a href="https://bitoftech.net/2022/08/29/azure-container-apps-state-store-with-dapr-state-management-api/" target="_blank" rel="noopener noreferrer">Azure Container Apps State Store With Dapr State Management API ‚Äì Part 5</a></li><li><a href="https://bitoftech.net/2022/09/02/azure-container-apps-async-communication-with-dapr-pub-sub-api-part-6/" target="_blank" rel="noopener noreferrer">Azure Container Apps Async Communication with Dapr Pub/Sub API ‚Äì Part 6</a></li><li><a href="https://bitoftech.net/2022/09/05/azure-container-apps-with-dapr-bindings-building-block/" target="_blank" rel="noopener noreferrer">Azure Container Apps with Dapr Bindings Building Block ‚Äì Part 7</a></li><li><a href="https://bitoftech.net/2022/09/09/azure-container-apps-monitoring-and-observability-with-application-insights-part-8/" target="_blank" rel="noopener noreferrer">Azure Container Apps Monitoring and Observability with Application Insights ‚Äì Part 8</a></li><li><a href="https://bitoftech.net/2022/09/13/continuous-deployment-for-azure-container-apps-using-github-actions-part-9/" target="_blank" rel="noopener noreferrer">Continuous Deployment for Azure Container Apps using GitHub Actions ‚Äì Part 9</a></li><li><a href="https://bitoftech.net/2022/09/16/use-bicep-to-deploy-dapr-microservices-apps-to-azure-container-apps-part-10/" target="_blank" rel="noopener noreferrer">Use Bicep to Deploy Dapr Microservices Apps to Azure Container Apps ‚Äì Part 10</a></li><li><a href="https://bitoftech.net/2022/09/22/azure-container-apps-auto-scaling-with-keda-part-11/" target="_blank" rel="noopener noreferrer">Azure Container Apps Auto Scaling with KEDA ‚Äì Part 11</a></li><li><em>Integrate Health probes in Azure Container Apps ‚Äì Part 12</em></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="resources">Resources<a class="hash-link" href="#resources" title="Direct link to heading">‚Äã</a></h2><ul><li><a href="https://docs.microsoft.com/azure/container-apps/" target="_blank" rel="noopener noreferrer">Azure Container Apps documentation</a></li><li><a href="https://docs.dapr.io/getting-started/" target="_blank" rel="noopener noreferrer">Getting started with Dapr</a></li><li><a href="https://docs.microsoft.com/dotnet/architecture/dapr-for-net-developers/" target="_blank" rel="noopener noreferrer">Dapr for .NET Developers</a></li><li><a href="https://docs.microsoft.com/cli/azure/containerapp?view=azure-cli-latest" target="_blank" rel="noopener noreferrer">az containerapp cli</a></li></ul>]]></content>
        <author>
            <name>Taisser Joudeh</name>
            <uri>https://github.com/tjoudeh</uri>
        </author>
        <category label="serverless-september" term="serverless-september"/>
        <category label="30-days-of-serverless" term="30-days-of-serverless"/>
        <category label="azure-container-apps" term="azure-container-apps"/>
        <category label="dapr" term="dapr"/>
        <category label="microservices" term="microservices"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[15. ACA + Serverless On Azure]]></title>
        <id>15-microservices-azure</id>
        <link href="https://azure.github.io/Cloud-Native/blog/15-microservices-azure"/>
        <updated>2022-09-15T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Recap of Week 2: Microservices, Azure Container Apps and Dapr]]></summary>
        <content type="html"><![CDATA[<hr><p>Welcome to <code>Day 15</code> of #30DaysOfServerless!</p><p>This post marks the midpoint of our Serverless on Azure journey! Our <a href="https://azure.github.io/Cloud-Native/serverless-september/30DaysOfServerless/" target="_blank" rel="noopener noreferrer">Week 2 Roadmap</a> showcased two key technologies - <a href="https://learn.microsoft.com/en-us/azure/container-apps/" target="_blank" rel="noopener noreferrer">Azure Container Apps (ACA)</a> and <a href="https://dapr.io" target="_blank" rel="noopener noreferrer">Dapr</a> - for building serverless microservices. We'll also look at what happened elsewhere in #ServerlessSeptember, then set the stage for our next week's focus: Serverless Integrations.</p><p>Ready? Let's Go!</p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-well-cover">What We'll Cover<a class="hash-link" href="#what-well-cover" title="Direct link to heading">‚Äã</a></h2><ul><li><strong>ICYMI</strong>: This Week on #ServerlessSeptember</li><li><strong>Recap</strong>: Microservices, Azure Container Apps &amp; Dapr</li><li><strong>Coming Next:</strong> Serverless Integrations</li><li><strong>Exercise</strong>: <a href="https://docs.microsoft.com/learn/challenges?id=b950cd7a-d456-46ab-81ba-3bd1ad86dc1c&amp;WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Take the Cloud Skills Challenge</a></li><li><strong>Resources</strong>: For self-study!</li></ul><p><img loading="lazy" src="/Cloud-Native/assets/images/banner-fd0bd63946ac545c6404a026fc1d19af.png" width="1600" height="672" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="this-week-in-events">This Week In Events<a class="hash-link" href="#this-week-in-events" title="Direct link to heading">‚Äã</a></h2><p>We had a number of activities happen this week - here's a quick summary:</p><ul><li>On <strong>Zero To Hero:</strong> <br>Anthony Chu took us on a <a href="http://localhost:3000/Cloud-Native/blog/zero2hero-aca-04" target="_blank" rel="noopener noreferrer">Journey to the Cloud with Azure Container Apps</a> exploring tools to simplify develop-deploy workflows for ACA. And Melony Qin talked about <a href="http://localhost:3000/Cloud-Native/blog/zero2hero-func-03" target="_blank" rel="noopener noreferrer">Using Custom Handlers For Go</a>, explaining how this allows extended languages support in Azure Functions.</li><li>On <strong>Serverless Hacks:</strong>  <br>Gwyn was joined by Liam Hampton as they talked about <a href="https://www.youtube.com/watch?v=EcsAcm22GqI" target="_blank" rel="noopener noreferrer">How to DevOps and Serverless The Right Way</a>. And it's not too late to complete the hack and <a href="https://azure.github.io/Cloud-Native/serverless-september/ServerlessHacks/" target="_blank" rel="noopener noreferrer">submit your solution to our hall of fame</a>.</li><li>On <strong>Ask The Expert:</strong> <br>We had our first Live Q&amp;A Session featuring members of the Azure Functions team, hosted by Gwyn. Catch up on the <a href="https://www.youtube.com/watch?v=wB5Va1a-MeY" target="_blank" rel="noopener noreferrer">recording</a> for useful tips and guidance.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="this-week-in-30days">This Week in #30Days<a class="hash-link" href="#this-week-in-30days" title="Direct link to heading">‚Äã</a></h2><p>In our #30Days series we focused on Azure Container Apps and Dapr.</p><ul><li>In <a href="https://azure.github.io/Cloud-Native/blog/09-aca-fundamentals" target="_blank" rel="noopener noreferrer">Hello Container Apps</a> we learned how Azure Container Apps helps you run microservices and containerized apps on serverless platforms. And we build and deployed our first ACA.</li><li>In <a href="https://azure.github.io/Cloud-Native/blog/microservices-10" target="_blank" rel="noopener noreferrer">Microservices Communication</a> we explored concepts like <em>environments</em> and <em>virtual networking</em>, with a hands-on example to show how two microservices communicate in a deployed ACA.</li><li>In <a href="https://azure.github.io/Cloud-Native/blog/11-scaling-container-apps" target="_blank" rel="noopener noreferrer">Scaling Your Container Apps</a> we learned about KEDA (Kubernetes Event-Driven Autoscaler) and how to configure autoscaling for your ACA based on KEDA-supported triggers.</li><li>In <a href="https://azure.github.io/Cloud-Native/blog/12-build-with-dapr" target="_blank" rel="noopener noreferrer">Build with Dapr</a> we introduced the Distributed Application Runtime (Dapr) and learned how its Building Block APIs and sidecar architecture make it easier to develop microservices with ACA.</li><li>In <a href="https://azure.github.io/Cloud-Native/blog/13-aca-managed-id" target="_blank" rel="noopener noreferrer">Secure ACA Access</a> we learned how to secure ACA access to external services with - and without - Dapr, covering Secret Stores and Managed Identity.</li><li>Finally, <a href="https://azure.github.io/Cloud-Native/blog/14-dapr-aca-quickstart" target="_blank" rel="noopener noreferrer">Build ACA with Dapr</a> tied it all together with a enterprise app scenario where an orders processor (ACA) uses Dapr APIs (PubSub, State Management) to receive and store order messages from Azure Service Bus.</li></ul><p>Here's a visual recap:</p><p><img loading="lazy" src="/Cloud-Native/assets/images/roadmap-Week2-cdacf0e02c8a938d944f3c4d9a29721a.png" width="3840" height="2160" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="self-study-code-samples--tutorials">Self Study: Code Samples &amp; Tutorials<a class="hash-link" href="#self-study-code-samples--tutorials" title="Direct link to heading">‚Äã</a></h2><p>There's no better way to get familiar with the concepts, than to dive in and play with code samples and hands-on tutorials. Here are 4 resources to bookmark and try out:</p><ol><li><a href="https://docs.dapr.io/getting-started/quickstarts/" target="_blank" rel="noopener noreferrer">Dapr Quickstarts</a> - these walk you through samples showcasing individual Building Block APIs - with multiple language options available.</li><li><a href="https://docs.dapr.io/getting-started/tutorials/" target="_blank" rel="noopener noreferrer">Dapr Tutorials</a> provides more complex examples of microservices applications and tools usage, including a <a href="https://github.com/dapr/quickstarts/tree/master/tutorials/distributed-calculator" target="_blank" rel="noopener noreferrer">Distributed Calculator</a> polyglot app.</li><li>Next, try to <a href="https://learn.microsoft.com/en-us/azure/container-apps/microservices-dapr?tabs=bash" target="_blank" rel="noopener noreferrer">Deploy a Dapr application to Azure Container Apps</a> to get familiar with the process of setting up the environment, then deploying the app.</li><li>Or, explore the many <a href="https://learn.microsoft.com/en-us/azure/container-apps/samples?source=recommendations" target="_blank" rel="noopener noreferrer">Azure Container Apps samples</a> showcasing various features and more complex architectures tied to real world scenarios.</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="whats-next-serverless-integrations">What's Next: Serverless Integrations!<a class="hash-link" href="#whats-next-serverless-integrations" title="Direct link to heading">‚Äã</a></h2><p>So far we've talked about core technologies (Azure Functions, Azure Container Apps, Dapr) that provide foundational support for your serverless solution. Next, we'll look at <strong>Serverless Integrations</strong> - specifically at technologies like Azure Logic Apps and Azure Event Grid that <em>automate workflows</em> and create seamless end-to-end solutions that integrate <em>other</em> Azure services in serverless-friendly ways.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="take-the-challenge">Take the Challenge!<a class="hash-link" href="#take-the-challenge" title="Direct link to heading">‚Äã</a></h2><p>The <a href="https://docs.microsoft.com/learn/challenges?id=b950cd7a-d456-46ab-81ba-3bd1ad86dc1c&amp;WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer"><strong>Cloud Skills Challenge</strong></a> is still going on, and we've already had hundreds of participants join and complete the learning modules to skill up on Serverless.</p><p>There's still time to join and get yourself on the leaderboard. Get familiar with Azure Functions, SignalR, Logic Apps, Azure SQL and more - in serverless contexts!! </p><hr>]]></content>
        <author>
            <name>Nitya Narasimhan</name>
            <uri>https://github.com/nitya</uri>
        </author>
        <author>
            <name>Devanshi Joshi</name>
            <uri>https://github.com/devanshidiaries</uri>
        </author>
        <category label="serverless-september" term="serverless-september"/>
        <category label="30-days-of-serverless" term="30-days-of-serverless"/>
        <category label="azure-container-apps" term="azure-container-apps"/>
        <category label="dapr" term="dapr"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[üöÄ | Observability with ACA]]></title>
        <id>zero2hero-aca-06</id>
        <link href="https://azure.github.io/Cloud-Native/blog/zero2hero-aca-06"/>
        <updated>2022-09-19T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Azure Container Apps provides several observability features to help you debug and diagnose your apps. There are both Azure portal and CLI options you can use to help understand the health of your apps and help identify when issues arise. Let's explore the options.]]></summary>
        <content type="html"><![CDATA[<hr><p>Welcome to <code>Day 19</code> of #30DaysOfServerless!</p><p>Today, we have a special set of posts from our <a href="/Cloud-Native/serverless-september/ZeroToHero">Zero To Hero üöÄ</a> initiative, featuring blog posts authored by our Product Engineering teams for #ServerlessSeptember. <em>Posts were originally published on the <a href="https://techcommunity.microsoft.com/t5/apps-on-azure-blog/observability-with-azure-container-apps/ba-p/3627909?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Apps on Azure</a> blog on Microsoft Tech Community.</em></p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-well-cover">What We'll Cover<a class="hash-link" href="#what-well-cover" title="Direct link to heading">‚Äã</a></h2><ul><li>Log Streaming - in Azure Portal</li><li>Console Connect - in Azure Portal</li><li>Metrics - using Azure Monitor</li><li>Log Analytics - using Azure Monitor</li><li>Metric Alerts and Log Alerts - using Azure Monitor</li></ul><p><img loading="lazy" src="/Cloud-Native/assets/images/mike-aca-observability-fdc8af07553b1411298f719b22ceca15.png" width="1600" height="672" class="img_ev3q"></p><hr><p>In past weeks, <a href="https://techcommunity.microsoft.com/t5/user/viewprofilepage/user-id/296868" target="_blank" rel="noopener noreferrer">@kendallroden</a> wrote about <a href="https://techcommunity.microsoft.com/t5/apps-on-azure-blog/go-cloud-native-with-azure-container-apps/ba-p/3616407" target="_blank" rel="noopener noreferrer">what it means to be cloud native</a> and <a href="https://techcommunity.microsoft.com/t5/user/viewprofilepage/user-id/236816" target="_blank" rel="noopener noreferrer">@Anthony Chu</a> the various ways to <a href="https://techcommunity.microsoft.com/t5/apps-on-azure-blog/journey-to-the-cloud-with-azure-container-apps/ba-p/3622609" target="_blank" rel="noopener noreferrer">get your apps running on Azure Container Apps</a>. Today, we will talk about the <strong>observability tools</strong> you can use to observe, debug, and diagnose your Azure Container Apps.</p><p><strong>Azure Container Apps</strong> provides several observability features to help you debug and diagnose your apps. There are both Azure portal and CLI options you can use to help understand the health of your apps and help identify when issues arise.</p><p>While these features are helpful throughout your container app‚Äôs lifetime, there are two that are especially helpful.  Log streaming and console connect can be a huge help in the initial stages when issues often rear their ugly head. Let's dig into both of these a little.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="log-streaming">Log Streaming<a class="hash-link" href="#log-streaming" title="Direct link to heading">‚Äã</a></h2><p>Log streaming allows you to use the Azure portal to view the streaming logs from your app. You‚Äôll see the logs written from the app to the container‚Äôs console (stderr and stdout). If your app is running multiple revisions, you can choose from which revision to view logs. You can also select a specific replica if your app is configured to scale. Lastly, you can choose from which container to view the log output. This is useful when you are running a custom or Dapr sidecar container.
<img loading="lazy" alt="view streaming logs" src="/Cloud-Native/assets/images/mike-observability-1-f28ac55d716d668659b11621cee6119c.png" width="549" height="334" class="img_ev3q"></p><p>Here‚Äôs an example CLI command to view the logs of a container app.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">az containerapp logs show -n MyContainerapp -g MyResourceGroup</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can find more information about the different options in our <a href="https://aka.ms/container-apps/logs-cli" target="_blank" rel="noopener noreferrer">CLI docs</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="console-connect">Console Connect<a class="hash-link" href="#console-connect" title="Direct link to heading">‚Äã</a></h2><p>In the Azure portal, you can connect to the console of a container in your app. Like log streaming, you can select the revision, replica, and container if applicable. After connecting to the console of the container, you can execute shell commands and utilities that you have installed in your container.  You can view files and their contents, monitor processes, and perform other debugging tasks.</p><p>This can be great for checking configuration files or even modifying a setting or library your container is using. Of course, updating a container in this fashion is not something you should do to a production app, but tweaking and re-testing an app in a non-production environment can speed up development.</p><p><img loading="lazy" src="/Cloud-Native/assets/images/mike-observability-2-2e21617739406a5d9b090b9580b95dd3.png" width="550" height="336" class="img_ev3q"></p><p>Here‚Äôs an example CLI command to connect to the console of a container app.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">az containerapp </span><span class="token builtin class-name">exec</span><span class="token plain"> -n MyContainerapp -g MyResourceGroup</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can find more information about the different options in our <a href="https://aka.ms/container-apps/exec-cli" target="_blank" rel="noopener noreferrer">CLI docs</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="metrics">Metrics<a class="hash-link" href="#metrics" title="Direct link to heading">‚Äã</a></h2><p>Azure Monitor collects metric data from your container app at regular intervals to help you gain insights into the performance and health of your container app. Container apps provide these metrics:</p><ul><li>CPU usage</li><li>Memory working set bytes</li><li>Network in bytes</li><li>Network out bytes</li><li>Requests</li><li>Replica count</li><li>Replica restart count</li></ul><p>Here you can see the metrics explorer showing the replica count for an app as it scaled from one replica to fifteen, and then back down to one.</p><p><img loading="lazy" src="/Cloud-Native/assets/images/mike-observability-3-fcd3dd1c9bc4cc4ab8df18c1321502a8.png" width="550" height="319" class="img_ev3q"></p><p>You can also retrieve metric data through <a href="https://aka.ms/container-apps/azure-monitor-metrics-cli" target="_blank" rel="noopener noreferrer">the Azure CLI</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="log-analytics">Log Analytics<a class="hash-link" href="#log-analytics" title="Direct link to heading">‚Äã</a></h2><p>Azure Monitor Log Analytics is great for viewing your historical logs emitted from your container apps. There are two custom tables of interest, the ContainerAppConsoleLogs_CL which contains all the log messages written by your app (stdout and stderr), and the ContainerAppSystemLogs_CL which contain the system messages from the Azure Container Apps service.	</p><p><img loading="lazy" src="/Cloud-Native/assets/images/mike-observability-4-d284a4303e3c243917edb8eb2685f1ac.png" width="550" height="345" class="img_ev3q"></p><p>You can also query Log Analytics through the <a href="https://aka.ms/container-apps/azure-monitor-logs-cli" target="_blank" rel="noopener noreferrer">Azure CLI</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="alerts">Alerts<a class="hash-link" href="#alerts" title="Direct link to heading">‚Äã</a></h2><p>Azure Monitor alerts notify you so that you can respond quickly to critical issues. There are two types of alerts that you can define:</p><ul><li><a href="https://docs.microsoft.com/azure/azure-monitor/alerts/alerts-types#metric-alerts" target="_blank" rel="noopener noreferrer">Metric alerts</a> based on Azure Monitor metric data</li><li><a href="https://docs.microsoft.com/azure/azure-monitor/alerts/alerts-types#log-alerts" target="_blank" rel="noopener noreferrer">Log alerts</a> based on Azure Monitor Log Analytics data</li></ul><p>You can create alert rules from metric charts in the metric explorer and from queries in Log Analytics. You can also define and manage alerts from the <strong>Monitor|Alerts</strong> page.</p><p>Here is what creating an alert looks like in the Azure portal. In this case we are setting an alert rule from the metric explorer to trigger an alert if the replica restart count for a specific container app is greater than two within the last fifteen minutes.</p><p><img loading="lazy" src="/Cloud-Native/assets/images/mike-observability-5-b64a5cdcac00d2090c8efdd42861e339.png" width="550" height="302" class="img_ev3q"></p><p>To learn more about alerts, refer to <a href="https://docs.microsoft.com/azure/azure-monitor/alerts/alerts-overview" target="_blank" rel="noopener noreferrer">Overview of alerts in Microsoft Azure</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a class="hash-link" href="#conclusion" title="Direct link to heading">‚Äã</a></h2><p>In this article, we looked at the several ways to observe, debug, and diagnose your Azure Container Apps. As you can see there are rich portal tools and a complete set of CLI commands to use. All the tools are helpful throughout the lifecycle of your app, be sure to take advantage of them when having an issue and/or to prevent issues.</p><p>To learn more, visit <a href="https://aka.ms/containerapps" target="_blank" rel="noopener noreferrer">Azure Container Apps | Microsoft Azure</a> today!</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>ASK THE EXPERT: LIVE Q&amp;A</div><div class="admonitionContent_S0QG"><p>The Azure Container Apps team will answer questions live on <strong>September 29</strong>. </p><ul><li><a href="https://reactor.microsoft.com/reactor/events/17004/?WT.mc_id=javascript-74010-ninarasi" target="_blank" rel="noopener noreferrer">Sign up to attend</a> for live Q&amp;A with the team</li><li><a href="https://github.com/Azure/Cloud-Native/issues/new?assignees=&amp;labels=ask+the+expert&amp;template=---ask-the-expert-.md&amp;title=%5BAsk+The+Expert%5D++" target="_blank" rel="noopener noreferrer">submit your questions</a> ahead of time, for prioritization.</li></ul></div></div>]]></content>
        <author>
            <name>Mike Morton</name>
            <uri>https://github.com/BigMorty</uri>
        </author>
        <category label="serverless-september" term="serverless-september"/>
        <category label="zero-to-hero" term="zero-to-hero"/>
        <category label="azure-container-apps" term="azure-container-apps"/>
        <category label="dapr" term="dapr"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[üöÄ | Error Handling w/ Apache Kafka]]></title>
        <id>zero2hero-func-05</id>
        <link href="https://azure.github.io/Cloud-Native/blog/zero2hero-func-05"/>
        <updated>2022-09-19T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Recently we have launched the Apache Kafka extension for Azure functions in GA with some cool new features like deserialization of Avro Generic records and Kafka headers support. Let's learn more about it.]]></summary>
        <content type="html"><![CDATA[<hr><p>Welcome to <code>Day 19</code> of #30DaysOfServerless!</p><p>Today, we have a special set of posts from our <a href="/Cloud-Native/serverless-september/ZeroToHero">Zero To Hero üöÄ</a> initiative, featuring blog posts authored by our Product Engineering teams for #ServerlessSeptember. <em>Posts were originally published on the <a href="https://techcommunity.microsoft.com/t5/apps-on-azure-blog/error-handling-with-apache-kafka-extension-for-azure-functions/ba-p/3628936?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Apps on Azure</a> blog on Microsoft Tech Community.</em></p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-well-cover">What We'll Cover<a class="hash-link" href="#what-well-cover" title="Direct link to heading">‚Äã</a></h2><ul><li>Retry Policy Support - in Apache Kafka Extension</li><li>AutoOffsetReset property - in Apache Kafka Extension</li><li>Key support for Kafka messages - in Apache Kafka Extension</li><li>References: Apache Kafka Extension for Azure Functions</li></ul><p><img loading="lazy" src="/Cloud-Native/assets/images/ramya-functions-kafka-5a847320c1814350e946ac762907c8e3.png" width="1600" height="672" class="img_ev3q"></p><hr><p><em>Recently we launched the <a href="https://github.com/Azure/azure-functions-kafka-extension" target="_blank" rel="noopener noreferrer">Apache Kafka extension for Azure functions</a> in GA with some cool new features like deserialization of Avro Generic records and Kafka headers support. We received great responses - so we're back with more updates!</em></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="retry-policy-support">Retry Policy support<a class="hash-link" href="#retry-policy-support" title="Direct link to heading">‚Äã</a></h2><p>Handling errors in Azure Functions is important to avoid data loss or miss events or monitor the health of an application. Apache Kafka Extension for Azure Functions supports retry policy which tells the runtime to rerun a failed execution until either successful completion occurs or the maximum number of retries is reached.</p><p>A retry policy is evaluated when a trigger function raises an uncaught exception. As a best practice, you should catch all exceptions in your code and rethrow any errors that you want to result in a retry.</p><p>There are two retry strategies supported by policy that you can configure :- fixed delay and exponential backoff</p><ol><li><strong>Fixed Delay</strong> -  A specified amount of time is allowed to elapse between each retry.</li><li><strong>Exponential Backoff</strong> - The first retry waits for the minimum delay. On subsequent retries, time is added exponentially to the initial duration for each retry, until the maximum delay is reached. Exponential back-off adds some small randomization to delays to stagger retries in high-throughput scenarios.</li></ol><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Please Note</div><div class="admonitionContent_S0QG"><p>Retry Policy for Kafka extension <strong>is NOT supported</strong> for C# (in proc and out proc) trigger and output binding. This is supported for languages like Java, Node (JS , TypeScript), PowerShell and Python trigger and output bindings.</p></div></div><p>Here is the sample code view of exponential backoff retry strategy</p><p><img loading="lazy" alt="Error Handling with Apache Kafka extension for Azure Functions" src="/Cloud-Native/assets/images/ramya-kafka-1-f619e8e934a373383a58a0b2c69dd146.png" width="400" height="239" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="autooffsetreset-property">AutoOffsetReset property<a class="hash-link" href="#autooffsetreset-property" title="Direct link to heading">‚Äã</a></h2><p>AutoOffsetReset property enables customers to configure the behaviour in the absence of an initial offset. Imagine a scenario when there is a need to change consumer group name. The consumer connected using a new consumer group had to reprocess all events starting from the oldest (earliest) one,  as this was the default one and this setting wasn‚Äôt exposed as configurable option in the Apache Kafka extension for Azure Functions(previously). With the help of this kafka setting you can configure on how to start processing events for newly created consumer groups.</p><p>Due to lack of the ability to configure this setting, offset commit errors were causing topics to restart from earliest offset¬∑ Users were looking to be able to set  offset setting  to either latest or earliest  based on their requirements.</p><p>We are happy to share that we have enabled the AutoOffsetReset setting as a configurable one to either - Earliest(Default) and Latest. Setting the value to Earliest configures the consumption of the messages from the the earliest/smallest offset or beginning of the topic partition. Setting the property to Latest configures the consumption of the messages from the latest/largest offset or from the end of the topic partition. This is supported for all the Azure Functions supported languages (C# (in &amp; out), Java, Node (JS and TypeScript), PowerShell and python) and can be used for both triggers and output binding</p><p><img loading="lazy" alt="Error Handling with Apache Kafka extension for Azure Functions" src="/Cloud-Native/assets/images/ramya-kafka-2-55db6b33ea9564e6af55bd6dfca64f89.png" width="400" height="175" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="key-support-for-kafka-messages">Key support for Kafka messages<a class="hash-link" href="#key-support-for-kafka-messages" title="Direct link to heading">‚Äã</a></h2><p>With keys the producer/output binding can be mapped to broker and partition to write based on the message. So alongside the message value, we can choose to send a message key and that key can be whatever you want it could be a string, it could be a number . In case  you don‚Äôt send the key, the key is set to null then the data will be sent in a <a href="https://www.geeksforgeeks.org/round-robin-scheduling-with-different-arrival-times/" target="_blank" rel="noopener noreferrer">Round Robin</a> fashion to make it very simple. <strong>But in case you send a key with your message</strong>, all the messages that share the same key will always go to the same partition and thus you can enable grouping of similar messages into partitions</p><p>Previously while consuming a Kafka event message using the Azure Function kafka extension, the event key was always none although the key was present in the event message.</p><p>Key support was implemented in the extension which enables customers to set/view key in the Kafka event messages coming in to the kafka trigger and set keys to the messages going in to kafka topics (with keys set) through output binding. Therefore key support was enabled in the extension to support both trigger and output binding for all Azure Functions supported languages ( (C# (in &amp; out), Java, Node (JS and TypeScript), PowerShell and python)</p><p>Here is the view of an output binding producer code where Kafka messages are being set with key</p><p><img loading="lazy" alt="Error Handling with Apache Kafka extension for Azure Functions" src="/Cloud-Native/assets/images/ramya-kafka-3-3e5a8fd156c09ad453e579efcbab521b.png" width="400" height="284" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion:<a class="hash-link" href="#conclusion" title="Direct link to heading">‚Äã</a></h2><p>In this article you have learnt about the latest additions to the Apache Kafka extension for Azure Functions. Incase you have been waiting for these features to get released or need them you are all set and please go head and try them out!! They are available in the latest extension bundles</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Want to learn more?</div><div class="admonitionContent_S0QG"><p>Please refer to <a href="https://docs.microsoft.com/azure/azure-functions/functions-bindings-kafka?tabs=in-process%2Cportal&amp;pivots=programming-language-csharp" target="_blank" rel="noopener noreferrer">Apache Kafka bindings for Azure Functions</a> | Microsoft Docs for detail documentation, samples on the Azure function supported languages and more!</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="references">References<a class="hash-link" href="#references" title="Direct link to heading">‚Äã</a></h2><ul><li><a href="https://docs.microsoft.com/azure/azure-functions/functions-bindings-kafka?tabs=in-process%2Cportal&amp;pivots=programming-language-csharp" target="_blank" rel="noopener noreferrer">Apache Kafka bindings for Azure Functions | Microsoft Docs</a></li></ul><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>FEEDBACK WELCOME</div><div class="admonitionContent_S0QG"><ul><li>If you would like to provide feedback on Kafka trigger extension, please post them to our GitHub repository- Issues ¬∑ <a href="https://github.com/Azure/azure-functions-kafka-extension/issues" target="_blank" rel="noopener noreferrer">Azure/azure-functions-kafka-extension (github.com)</a></li><li>This extension is being developed in the open-source community. Please contribute, try out and post any issues on the <a href="https://github.com/Azure/azure-functions-kafka-extension" target="_blank" rel="noopener noreferrer">Azure Functions Kafka extension GitHub repo</a></li></ul></div></div><p>Keep in touch with us on Twitter via <a href="https://twitter.com/AzureFunctions" target="_blank" rel="noopener noreferrer">@AzureFunctions</a>.</p>]]></content>
        <author>
            <name>Ramya Oruganti</name>
            <uri>https://twitter.com/ramyaoncloud</uri>
        </author>
        <category label="serverless-september" term="serverless-september"/>
        <category label="zero-to-hero" term="zero-to-hero"/>
        <category label="azure-functions" term="azure-functions"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[üöÄ | Monitor + Troubleshoot Apps]]></title>
        <id>zero2hero-func-07</id>
        <link href="https://azure.github.io/Cloud-Native/blog/zero2hero-func-07"/>
        <updated>2022-09-26T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[When you‚Äôre running a function app, you want to be prepared for any issues that may arise, from 4xx errors to trigger failures. Azure Functions offers built-in integration with Azure Application Insights to monitor function executions. Let's learn more.]]></summary>
        <content type="html"><![CDATA[<hr><p>Welcome to <code>Day 26</code> of #30DaysOfServerless!</p><p>Today, we have a special set of posts from our <a href="/Cloud-Native/serverless-september/ZeroToHero">Zero To Hero üöÄ</a> initiative, featuring blog posts authored by our Product Engineering teams for #ServerlessSeptember. <em>Posts were originally published on the <a href="https://techcommunity.microsoft.com/t5/apps-on-azure-blog/monitoring-and-troubleshooting-apps-in-azure-functions/ba-p/3638230?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Apps on Azure</a> blog on Microsoft Tech Community.</em></p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-well-cover">What We'll Cover<a class="hash-link" href="#what-well-cover" title="Direct link to heading">‚Äã</a></h2><ul><li>Monitoring your Azure Functions</li><li>Built-in log streaming</li><li>Live Metrics stream</li><li>Troubleshooting Azure Functions</li></ul><p><img loading="lazy" src="/Cloud-Native/assets/images/zero-to-hero-madhura-9186d0cba8bf8974d76dfdeb73cd5f50.png" width="1600" height="672" class="img_ev3q"></p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="monitoring-your-azure-functions">Monitoring your Azure Functions:<a class="hash-link" href="#monitoring-your-azure-functions" title="Direct link to heading">‚Äã</a></h2><p>Azure Functions uses <strong>Application Insights</strong> to collect and analyze log data from individual function executions in your function app.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="using-application-insights">Using Application Insights<a class="hash-link" href="#using-application-insights" title="Direct link to heading">‚Äã</a></h3><p>Application Insights collects <em>log, performance, and error data</em>. By automatically detecting performance anomalies and featuring powerful analytics tools, you can more easily diagnose issues and better understand how your functions are used. These tools are designed to help you continuously improve performance and usability of your functions. You can even use Application Insights during local function app project development.</p><p>Typically, you create an Application Insights instance when you create your function app. In this case, the instrumentation key required for the integration is already set as an application setting named <code>APPINSIGHTS_INSTRUMENTATIONKEY</code>. With Application Insights integration enabled, telemetry data is sent to your connected Application Insights instance. This data includes logs generated by the Functions host, traces written from your functions code, and performance data. In addition to data from your functions and the Functions host, you can also collect data from the <a href="https://learn.microsoft.com/azure/azure-functions/functions-monitoring#scale-controller-logs?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Functions scale controller</a>.</p><p>By default, the data collected from your function app is stored in Application Insights. In the <a href="https://portal.azure.com/" target="_blank" rel="noopener noreferrer">Azure portal</a>, Application Insights provides an extensive set of visualizations of your telemetry data. You can drill into error logs and query events and metrics. To learn more, including basic examples of how to view and query your collected data, see <a href="https://learn.microsoft.com/azure/azure-functions/analyze-telemetry-data?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Analyze Azure Functions telemetry in Application Insights</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="using-log-streaming">Using Log Streaming<a class="hash-link" href="#using-log-streaming" title="Direct link to heading">‚Äã</a></h3><p>In addition to this, you can have a smoother debugging experience through log streaming. There are two ways to view a stream of log files being generated by your function executions.</p><ul><li><strong>Built-in log streaming</strong>: the App Service platform lets you view a stream of your application log files. This is equivalent to the output seen when you debug your functions during <a href="https://learn.microsoft.com/azure/azure-functions/functions-develop-local?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">local development</a> and when you use the Test tab in the portal. All log-based information is displayed. For more information, see <a href="https://learn.microsoft.com/azure/app-service/troubleshoot-diagnostic-logs#stream-logs?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Stream logs</a>. This streaming method supports only a single instance and can't be used with an app running on Linux in a Consumption plan.</li><li><strong>Live Metrics Stream</strong>: when your function app is <a href="https://learn.microsoft.com/azure/azure-functions/configure-monitoring#enable-application-insights-integration?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">connected to Application Insights</a>, you can view log data and other metrics in near real-time in the Azure portal using <a href="https://learn.microsoft.com/azure/azure-monitor/app/live-stream?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Live Metrics Stream</a>. Use this method when monitoring functions running on multiple-instances or on Linux in a Consumption plan. This method uses <a href="https://learn.microsoft.com/azure/azure-functions/configure-monitoring#configure-sampling?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">sampled data</a>.
Log streams can be viewed both in the portal and in most local development environments.</li></ul><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Monitoring Azure Functions</div><div class="admonitionContent_S0QG"><p>Learn how to <a href="https://learn.microsoft.com/azure/azure-functions/configure-monitoring?source=recommendations&amp;tabs=v2&amp;WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">configure monitoring for your Azure Functions</a>. See <a href="https://learn.microsoft.com/azure/azure-functions/monitor-functions-reference?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Monitoring Azure Functions data reference</a> for detailed information on the metrics and logs metrics created by Azure Functions.</p></div></div><p>In addition to this, Azure Functions uses <a href="https://learn.microsoft.com/azure/azure-monitor/overview" target="_blank" rel="noopener noreferrer">Azure Monitor</a> to <a href="https://learn.microsoft.com/azure/azure-functions/monitor-functions?tabs=portal" target="_blank" rel="noopener noreferrer">monitor the health of your function apps</a>. Azure Functions collects the same kinds of monitoring data as other Azure resources that are described in <a href="https://learn.microsoft.com/azure/azure-monitor/essentials/monitor-azure-resource#monitoring-data-from-azure-resources" target="_blank" rel="noopener noreferrer">Azure Monitor data collection</a>. See <a href="https://learn.microsoft.com/azure/azure-functions/monitor-functions-reference" target="_blank" rel="noopener noreferrer">Monitoring Azure Functions data reference</a> for detailed information on the metrics and logs metrics created by Azure Functions.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting-your-azure-functions">Troubleshooting your Azure Functions:<a class="hash-link" href="#troubleshooting-your-azure-functions" title="Direct link to heading">‚Äã</a></h2><p>When you do run into issues with your function app, Azure Functions diagnostics points out what‚Äôs wrong. It guides you to the right information to troubleshoot and resolve the issue more easily and quickly.</p><p>Let‚Äôs explore how to use Azure Functions diagnostics to diagnose and solve common function app issues.</p><ol><li>Navigate to your function app <a href="https://portal.azure.com/?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">in the Azure portal</a>.</li><li>Select Diagnose and solve problems to open Azure Functions diagnostics.</li><li>Once you‚Äôre here, there are multiple ways to retrieve the information you‚Äôre looking for. Choose a category that best describes the issue of your function app by using the keywords in the homepage tile. You can also type a keyword that best describes your issue in the search bar. There‚Äôs also a section at the bottom of the page that will directly take you to some of the more popular troubleshooting tools. For example, you could type execution to see a list of diagnostic reports related to your function app execution and open them directly from the homepage.</li></ol><p><img loading="lazy" alt="Monitoring and troubleshooting apps in Azure Functions" src="/Cloud-Native/assets/images/madhura-functions-1-cf245312022dd74d8e0c0325d6cddc20.png" width="777" height="361" class="img_ev3q"></p><ol start="4"><li>For example, click on the Function App Down or Reporting Errors link under Popular troubleshooting tools section. You will find detailed analysis, insights and next steps for the issues that were detected. On the left you‚Äôll see a list of detectors. Click on them to explore more, or if there‚Äôs a particular keyword you want to look for, type it Into the search bar on the top.</li></ol><p><img loading="lazy" alt="Monitoring and troubleshooting apps in Azure Functions" src="/Cloud-Native/assets/images/madhura-functions-2-9e52c0d12e76850ce3bb4c1d9c8d970a.png" width="788" height="390" class="img_ev3q"></p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>TROUBLESHOOTING TIP</div><div class="admonitionContent_S0QG"><p>Here are some general troubleshooting tips that you can follow if you find your Function App throwing <a href="https://learn.microsoft.com/azure/azure-functions/functions-recover-storage-account?WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">Azure Functions Runtime unreachable</a> error. </p><p>Also be sure to check out the recommended best practices to ensure your Azure Functions are highly reliable. <a href="https://learn.microsoft.com/azure/azure-functions/functions-best-practices?source=recommendations&amp;tabs=csharp&amp;WT.mc_id=javascript-74010-cxa" target="_blank" rel="noopener noreferrer">This article</a> details some best practices for designing and deploying efficient function apps that remain healthy and perform well in a cloud-based environment.</p></div></div><p>Bonus tip:</p>]]></content>
        <author>
            <name>Madhura Bharadwaj</name>
            <uri>https://techcommunity.microsoft.com/t5/user/viewprofilepage/user-id/360851#profile</uri>
        </author>
        <category label="serverless-september" term="serverless-september"/>
        <category label="zero-to-hero" term="zero-to-hero"/>
        <category label="azure-functions" term="azure-functions"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[28. Serverless + Power Platforms]]></title>
        <id>28-where-am-i</id>
        <link href="https://azure.github.io/Cloud-Native/blog/28-where-am-i"/>
        <updated>2022-09-28T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Build a Power Platform custom connector with Azure Functions and OpenAPI to read my current GPS location and display it on Google Maps and Naver Map.]]></summary>
        <content type="html"><![CDATA[<hr><p>Welcome to <code>Day 28</code> of #30DaysOfServerless! </p><p>Since it's the serverless end-to-end week, I'm going to discuss how to use a serverless application <!-- -->‚Äì<!-- --> <a href="https://docs.microsoft.com/azure/azure-functions/functions-overview?WT.mc_id=dotnet-75362-juyoo" target="_blank" rel="noopener noreferrer">Azure Functions</a> with <a href="https://aka.ms/azfunc-openapi" target="_blank" rel="noopener noreferrer">OpenAPI extension</a> <!-- -->‚Äì<!-- --> to be seamlessly integrated with <a href="https://docs.microsoft.com/connectors/custom-connectors/?WT.mc_id=dotnet-75362-juyoo" target="_blank" rel="noopener noreferrer">Power Platform custom connector</a> through <a href="https://docs.microsoft.com/azure/api-management/api-management-key-concepts?WT.mc_id=dotnet-75362-juyoo" target="_blank" rel="noopener noreferrer">Azure API Management</a> - in a post I call <em>"Where am I? My GPS Location with Serverless Power Platform Custom Connector"</em></p><p>OK. Are you ready? Let's get started!</p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-well-cover">What We'll Cover<a class="hash-link" href="#what-well-cover" title="Direct link to heading">‚Äã</a></h2><ul><li>What is Power Platform custom connector?</li><li>Proxy app to Google Maps and Naver Map API</li><li>API Management integration</li><li>Two ways of building custom connector</li><li>Where am I? <!-- -->‚Äì<!-- --> Power Apps app</li><li>Exercise: Try this yourself!</li><li>Resources: For self-study!</li></ul><p><img loading="lazy" src="/Cloud-Native/assets/images/banner-3e7c6e6693ff558354358bf059a7c853.png" width="1600" height="672" class="img_ev3q"></p><hr><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>SAMPLE REPO</div><div class="admonitionContent_S0QG"><p>Want to follow along? Check out the <a href="https://github.com/justinyoo/google-naver-maps-custom-connector-sample" target="_blank" rel="noopener noreferrer">sample app on GitHub repository</a> used in this post.</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-power-platform-custom-connector">What is Power Platform custom connector?<a class="hash-link" href="#what-is-power-platform-custom-connector" title="Direct link to heading">‚Äã</a></h2><p><a href="https://docs.microsoft.com/power-platform/?WT.mc_id=dotnet-75362-juyoo" target="_blank" rel="noopener noreferrer">Power Platform</a> is a low-code/no-code application development tool for <a href="https://www.gartner.com/en/articles/why-fusion-teams-matter" target="_blank" rel="noopener noreferrer">fusion teams</a> that consist of a group of people. Those people come from various disciplines, including field experts (domain experts), IT professionals and professional developers, to draw business values successfully. Within the fusion team, the domain experts become citizen developers or low-code developers by Power Platform. In addition, Making Power Platform more powerful is that it offers hundreds of connectors to other Microsoft 365 and third-party services like SAP, ServiceNow, Salesforce, Google, etc.</p><p>However, what if you want to use your internal APIs or APIs not yet offering their official connectors? Here's an example. If your company has an inventory management system, and you want to use it within your <a href="https://docs.microsoft.com/power-apps/powerapps-overview?WT.mc_id=dotnet-75362-juyoo" target="_blank" rel="noopener noreferrer">Power Apps</a> or <a href="https://docs.microsoft.com/power-automate/getting-started?WT.mc_id=dotnet-75362-juyoo" target="_blank" rel="noopener noreferrer">Power Automate</a>. That point is exactly where <a href="https://docs.microsoft.com/connectors/custom-connectors/?WT.mc_id=dotnet-75362-juyoo" target="_blank" rel="noopener noreferrer">Power Platform custom connectors</a> is necessary.</p><p><img loading="lazy" src="./img/28-serverless-power-platform-custom-connector-01.png" alt="Inventory Management System for Power Apps" class="img_ev3q"></p><p>Therefore, Power Platform custom connectors enrich those citizen developers' capabilities because those connectors can connect any API applications for the citizen developers to use.</p><p>In this post, let's build a custom connector that provides a static map image generated by <a href="https://developers.google.com/maps" target="_blank" rel="noopener noreferrer">Google Maps API</a> and <a href="https://www.ncloud.com/product/applicationService/maps" target="_blank" rel="noopener noreferrer">Naver Map API</a> using your GPS location.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="proxy-app-to-google-maps-and-naver-map-api">Proxy app to Google Maps and Naver Map API<a class="hash-link" href="#proxy-app-to-google-maps-and-naver-map-api" title="Direct link to heading">‚Äã</a></h2><p>First, let's build an Azure Functions app that connects to Google Maps and Naver Map. Suppose that you've already got the API keys for both services. If you haven't yet, get the keys first by visiting <a href="https://developers.google.com/maps" target="_blank" rel="noopener noreferrer">here for Google</a> and <a href="https://www.ncloud.com/product/applicationService/maps" target="_blank" rel="noopener noreferrer">here for Naver</a>. Then, store them to <code>local.settings.json</code> within your Azure Functions app.</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">"Values"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">"Maps__Google__ApiKey"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"&lt;GOOGLE_MAPS_API_KEY&gt;"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">"Maps__Naver__ClientId"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"&lt;NAVER_MAP_API_CLIENT_ID&gt;"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">"Maps__Naver__ClientSecret"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"&lt;NAVER_MAP_API_CLIENT_SECRET&gt;"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Here's the sample logic to get the static image from Google Maps API. It takes the latitude and longitude of your current location and image zoom level, then returns the static map image. There are a few hard-coded assumptions, though:</p><ul><li>The image size should be 400x400.</li><li>The image should be in <code>.png</code> format.</li><li>The marker should show be red and show my location.</li></ul><div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public class GoogleMapService : IMapService</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public async Task&lt;byte[]&gt; GetMapAsync(HttpRequest req)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var latitude = req.Query["lat"];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var longitude = req.Query["long"];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var zoom = (string)req.Query["zoom"] ?? "14";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var sb = new StringBuilder();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sb.Append("https://maps.googleapis.com/maps/api/staticmap")</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          .Append($"?center={latitude},{longitude}")</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          .Append("&amp;size=400x400")</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          .Append($"&amp;zoom={zoom}")</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          .Append($"&amp;markers=color:red|{latitude},{longitude}")</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          .Append("&amp;format=png32")</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          .Append($"&amp;key={this._settings.Google.ApiKey}");</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var requestUri = new Uri(sb.ToString());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var bytes = await this._http.GetByteArrayAsync(requestUri).ConfigureAwait(false);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return bytes;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <code>NaverMapService</code> class has a similar logic with the same input and assumptions. Here's the code:</p><div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public class NaverMapService : IMapService</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public async Task&lt;byte[]&gt; GetMapAsync(HttpRequest req)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var latitude = req.Query["lat"];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var longitude = req.Query["long"];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var zoom = (string)req.Query["zoom"] ?? "13";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var sb = new StringBuilder();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sb.Append("https://naveropenapi.apigw.ntruss.com/map-static/v2/raster")</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          .Append($"?center={longitude},{latitude}")</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          .Append("&amp;w=400")</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          .Append("&amp;h=400")</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          .Append($"&amp;level={zoom}")</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          .Append($"&amp;markers=color:blue|pos:{longitude}%20{latitude}")</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          .Append("&amp;format=png")</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          .Append("&amp;lang=en");</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var requestUri = new Uri(sb.ToString());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        this._http.DefaultRequestHeaders.Clear();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        this._http.DefaultRequestHeaders.Add("X-NCP-APIGW-API-KEY-ID", this._settings.Naver.ClientId);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        this._http.DefaultRequestHeaders.Add("X-NCP-APIGW-API-KEY", this._settings.Naver.ClientSecret);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var bytes = await this._http.GetByteArrayAsync(requestUri).ConfigureAwait(false);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return bytes;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let's take a look at the function endpoints. Here's for the Google Maps and Naver Map. As the <code>GetMapAsync(req)</code> method returns a byte array value, you need to transform it as <code>FileContentResult</code>, with the content type of <code>image/png</code>.</p><div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Google Maps</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class GoogleMapsTrigger</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [FunctionName(nameof(GoogleMapsTrigger.GetGoogleMapImage))]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public async Task&lt;IActionResult&gt; GetGoogleMapImage(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        [HttpTrigger(AuthorizationLevel.Anonymous, "GET", Route = "google/image")] HttpRequest req)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        this._logger.LogInformation("C# HTTP trigger function processed a request.");</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var bytes = await this._service.GetMapAsync(req).ConfigureAwait(false);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new FileContentResult(bytes, "image/png");</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Naver Map</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class NaverMapsTrigger</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [FunctionName(nameof(NaverMapsTrigger.GetNaverMapImage))]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public async Task&lt;IActionResult&gt; GetNaverMapImage(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        [HttpTrigger(AuthorizationLevel.Anonymous, "GET", Route = "naver/image")] HttpRequest req)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        this._logger.LogInformation("C# HTTP trigger function processed a request.");</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var bytes = await this._service.GetMapAsync(req).ConfigureAwait(false);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new FileContentResult(bytes, "image/png");</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then, add the OpenAPI capability to each function endpoint. Here's the example:</p><div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Google Maps</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class GoogleMapsTrigger</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [FunctionName(nameof(GoogleMapsTrigger.GetGoogleMapImage))]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ‚¨áÔ∏è‚¨áÔ∏è‚¨áÔ∏è Add decorators provided by the OpenAPI extension ‚¨áÔ∏è‚¨áÔ∏è‚¨áÔ∏è</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [OpenApiOperation(operationId: nameof(GoogleMapsTrigger.GetGoogleMapImage), tags: new[] { "google" })]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [OpenApiParameter(name: "lat", In = ParameterLocation.Query, Required = true, Type = typeof(string), Description = "The **latitude** parameter")]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [OpenApiParameter(name: "long", In = ParameterLocation.Query, Required = true, Type = typeof(string), Description = "The **longitude** parameter")]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [OpenApiParameter(name: "zoom", In = ParameterLocation.Query, Required = false, Type = typeof(string), Description = "The **zoom level** parameter &amp;ndash; Default value is `14`")]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [OpenApiResponseWithBody(statusCode: HttpStatusCode.OK, contentType: "image/png", bodyType: typeof(byte[]), Description = "The map image as an OK response")]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ‚¨ÜÔ∏è‚¨ÜÔ∏è‚¨ÜÔ∏è Add decorators provided by the OpenAPI extension ‚¨ÜÔ∏è‚¨ÜÔ∏è‚¨ÜÔ∏è</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public async Task&lt;IActionResult&gt; GetGoogleMapImage(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        [HttpTrigger(AuthorizationLevel.Anonymous, "GET", Route = "google/image")] HttpRequest req)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Naver Map</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class NaverMapsTrigger</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [FunctionName(nameof(NaverMapsTrigger.GetNaverMapImage))]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ‚¨áÔ∏è‚¨áÔ∏è‚¨áÔ∏è Add decorators provided by the OpenAPI extension ‚¨áÔ∏è‚¨áÔ∏è‚¨áÔ∏è</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [OpenApiOperation(operationId: nameof(NaverMapsTrigger.GetNaverMapImage), tags: new[] { "naver" })]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [OpenApiParameter(name: "lat", In = ParameterLocation.Query, Required = true, Type = typeof(string), Description = "The **latitude** parameter")]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [OpenApiParameter(name: "long", In = ParameterLocation.Query, Required = true, Type = typeof(string), Description = "The **longitude** parameter")]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [OpenApiParameter(name: "zoom", In = ParameterLocation.Query, Required = false, Type = typeof(string), Description = "The **zoom level** parameter &amp;ndash; Default value is `13`")]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [OpenApiResponseWithBody(statusCode: HttpStatusCode.OK, contentType: "image/png", bodyType: typeof(byte[]), Description = "The map image as an OK response")]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ‚¨ÜÔ∏è‚¨ÜÔ∏è‚¨ÜÔ∏è Add decorators provided by the OpenAPI extension ‚¨ÜÔ∏è‚¨ÜÔ∏è‚¨ÜÔ∏è</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public async Task&lt;IActionResult&gt; GetNaverMapImage(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        [HttpTrigger(AuthorizationLevel.Anonymous, "GET", Route = "naver/image")] HttpRequest req)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Run the function app in the local. Here are the latitude and longitude values for Seoul, Korea.</p><ul><li>latitude: 37.574703</li><li>longitude: 126.978519</li></ul><p><img loading="lazy" src="./img/28-serverless-power-platform-custom-connector-02.png" alt="Google Map for Seoul" class="img_ev3q"></p><p>It seems to be working! Let's deploy it to Azure.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="api-management-integration">API Management integration<a class="hash-link" href="#api-management-integration" title="Direct link to heading">‚Äã</a></h2><p><a href="https://visualstudio.microsoft.com/vs/?WT.mc_id=dotnet-75362-juyoo" target="_blank" rel="noopener noreferrer">Visual Studio 2022</a> provides a built-in deployment tool for <a href="https://docs.microsoft.com/azure/azure-functions/functions-overview?WT.mc_id=dotnet-75362-juyoo" target="_blank" rel="noopener noreferrer">Azure Functions</a> app onto Azure. In addition, the deployment tool supports seamless integration with <a href="https://docs.microsoft.com/azure/api-management/api-management-key-concepts?WT.mc_id=dotnet-75362-juyoo" target="_blank" rel="noopener noreferrer">Azure API Management</a> as long as your Azure Functions app enables the OpenAPI capability. In this post, I'm going to use this feature. Right-mouse click on the Azure Functions project and select the "Publish" menu.</p><p><img loading="lazy" src="./img/28-serverless-power-platform-custom-connector-03.png" alt="Visual Studio context menu for publish" class="img_ev3q"></p><p>Then, you will see the publish screen. Click the "‚ûï New" button to create a new publish profile.</p><p><img loading="lazy" src="./img/28-serverless-power-platform-custom-connector-04.png" alt="Create a new publish profile" class="img_ev3q"></p><p>Choose "Azure" and click the "Next" button.</p><p><img loading="lazy" src="./img/28-serverless-power-platform-custom-connector-05.png" alt="Choose the target platform for publish" class="img_ev3q"></p><p>Select the app instance. This time simply pick up the "Azure Function App (Windows)" option, then click "Next".</p><p><img loading="lazy" src="./img/28-serverless-power-platform-custom-connector-06.png" alt="Choose the target OS for publish" class="img_ev3q"></p><p>If you already provision an Azure Function app instance, you will see it on the screen. Otherwise, create a new one. Then, click "Next".</p><p><img loading="lazy" src="./img/28-serverless-power-platform-custom-connector-07.png" alt="Choose the target instance for publish" class="img_ev3q"></p><p>In the next step, you are asked to choose the Azure API Management instance for integration. Choose one, or create a new one. Then, click "Next".</p><p><img loading="lazy" src="./img/28-serverless-power-platform-custom-connector-08.png" alt="Choose the APIM instance for integration" class="img_ev3q"></p><p>Finally, select the publish method <!-- -->‚Äì<!-- --> either local publish or GitHub Actions workflow. Let's pick up the local publish method for now. Then, click "Finish".</p><p><img loading="lazy" src="./img/28-serverless-power-platform-custom-connector-09.png" alt="Choose the deployment type" class="img_ev3q"></p><p>The publish profile has been created. Click "Close" to move on.</p><p><img loading="lazy" src="./img/28-serverless-power-platform-custom-connector-10.png" alt="Publish profile created" class="img_ev3q"></p><p>Now the function app is ready for deployment. Click the "Publish" button and see how it goes.</p><p><img loading="lazy" src="./img/28-serverless-power-platform-custom-connector-11.png" alt="Publish function app" class="img_ev3q"></p><p>The Azure function app has been deployed and integrated with the Azure API Management instance.</p><p><img loading="lazy" src="./img/28-serverless-power-platform-custom-connector-12.png" alt="Function app published" class="img_ev3q"></p><p>Go to the published function app site, and everything looks OK.</p><p><img loading="lazy" src="./img/28-serverless-power-platform-custom-connector-13.png" alt="Function app on Azure" class="img_ev3q"></p><p>And API Management shows the function app integrated perfectly.</p><p><img loading="lazy" src="./img/28-serverless-power-platform-custom-connector-14.png" alt="Function app integrated with APIM" class="img_ev3q"></p><p>Now, you are ready to create a custom connector. Let's move on.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="two-ways-of-building-custom-connector">Two ways of building custom connector<a class="hash-link" href="#two-ways-of-building-custom-connector" title="Direct link to heading">‚Äã</a></h2><p>There are two ways to create a custom connector.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="export-custom-connector-from-api-management">Export custom connector from API Management<a class="hash-link" href="#export-custom-connector-from-api-management" title="Direct link to heading">‚Äã</a></h3><p>First, you can directly use the built-in API Management feature. Then, click the ellipsis icon and select the "Create Power Connector" menu.</p><p><img loading="lazy" src="./img/28-serverless-power-platform-custom-connector-15.png" alt="Create Power Connector menu" class="img_ev3q"></p><p>Then, you are redirected to this screen. While the "API" and "API display name" fields are pre-populated, you need to choose the Power Platform environment tied to your tenant. Choose an environment, click "Authenticate", and click "Create".</p><p><img loading="lazy" src="./img/28-serverless-power-platform-custom-connector-16.png" alt="Create custom connector screen" class="img_ev3q"></p><p>Check your custom connector on Power Apps or Power Automate side.</p><p><img loading="lazy" src="./img/28-serverless-power-platform-custom-connector-17.png" alt="Custom connector created on Power Apps" class="img_ev3q"></p><p>However, there's a caveat to this approach. Because it's tied to your tenant, you should use the second approach if you want to use this custom connector on the other tenant.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="import-custom-connector-from-openapi-document-or-url">Import custom connector from OpenAPI document or URL<a class="hash-link" href="#import-custom-connector-from-openapi-document-or-url" title="Direct link to heading">‚Äã</a></h3><p>Click the ellipsis icon again and select the "Export" menu.</p><p><img loading="lazy" src="./img/28-serverless-power-platform-custom-connector-18.png" alt="Export menu" class="img_ev3q"></p><p>On the Export API screen, choose the "OpenAPI v2 (JSON)" panel because Power Platform custom connector currently accepts version 2 of the OpenAPI document.</p><p><img loading="lazy" src="./img/28-serverless-power-platform-custom-connector-19.png" alt="Select OpenAPI v2" class="img_ev3q"></p><p>Download the OpenAPI document to your local computer and move to your Power Apps or Power Automate page under your desired environment. I'm going to use the Power Automate page. First, go to the "Data" ‚û°Ô∏è "Custom connectors" page. Then, click the "‚ûï New custom connector" ‚û°Ô∏è "Import an OpenAPI file" at the top right corner.</p><p><img loading="lazy" src="./img/28-serverless-power-platform-custom-connector-20.png" alt="New custom connector" class="img_ev3q"></p><p>When a modal pops up, give the custom connector name and import the OpenAPI document exported above. Then, click "Continue".</p><p><img loading="lazy" src="./img/28-serverless-power-platform-custom-connector-21.png" alt="Import custom connector" class="img_ev3q"></p><p>Actually, that's it! Next, click the "‚úîÔ∏è Create connector" button to create the connector.</p><p><img loading="lazy" src="./img/28-serverless-power-platform-custom-connector-22.png" alt="Create custom connector" class="img_ev3q"></p><p>Go back to the custom connector page, and you will see the "Maps API" custom connector you just created.</p><p><img loading="lazy" src="./img/28-serverless-power-platform-custom-connector-23.png" alt="Custom connector imported" class="img_ev3q"></p><p>So, you are ready to create a Power Apps app to display your location on Google Maps or Naver Map! Let's move on.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="where-am-i--power-apps-app">Where am I? <!-- -->‚Äì<!-- --> Power Apps app<a class="hash-link" href="#where-am-i--power-apps-app" title="Direct link to heading">‚Äã</a></h2><p>Open the Power Apps Studio, and create an empty canvas app, named <code>Who am I</code> with a phone layout.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="custom-connector-integration">Custom connector integration<a class="hash-link" href="#custom-connector-integration" title="Direct link to heading">‚Äã</a></h3><p>To use the custom connector created above, you need to add it to the Power App. Click the cylinder icon on the left and click the "Add data" button.</p><p><img loading="lazy" src="./img/28-serverless-power-platform-custom-connector-24.png" alt="Add custom connector to data pane" class="img_ev3q"></p><p>Search the custom connector name, "Maps API", and click the custom connector to add.</p><p><img loading="lazy" src="./img/28-serverless-power-platform-custom-connector-25.png" alt="Search custom connector" class="img_ev3q"></p><p>To use the custom connector, you also need to create a connection to it. Click the "Connect" button and move on.</p><p><img loading="lazy" src="./img/28-serverless-power-platform-custom-connector-26.png" alt="Create connection to custom connector" class="img_ev3q"></p><p>Now, you've got the connection to the custom connector.</p><p><img loading="lazy" src="./img/28-serverless-power-platform-custom-connector-27.png" alt="Connection to custom connector ready" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="controls">Controls<a class="hash-link" href="#controls" title="Direct link to heading">‚Äã</a></h3><p>Let's build the Power Apps app. First of all, put three controls <!-- -->‚Äì<!-- --> <a href="https://docs.microsoft.com/power-apps/maker/canvas-apps/controls/control-image?WT.mc_id=dotnet-75362-juyoo" target="_blank" rel="noopener noreferrer">Image</a>, <a href="https://docs.microsoft.com/power-apps/maker/canvas-apps/controls/control-slider?WT.mc_id=dotnet-75362-juyoo" target="_blank" rel="noopener noreferrer">Slider</a> and <a href="https://docs.microsoft.com/power-apps/maker/canvas-apps/controls/control-button?WT.mc_id=dotnet-75362-juyoo" target="_blank" rel="noopener noreferrer">Button</a> onto the canvas.</p><p><img loading="lazy" src="./img/28-serverless-power-platform-custom-connector-28.png" alt="Power Apps control added" class="img_ev3q"></p><p>Click the "Screen1" control and change the value on the property "OnVisible" to the formula below. The formula stores the current slider value in the <code>zoomlevel</code> collection.</p><div class="language-powerappsfl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powerappsfl codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ClearCollect(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    zoomlevel,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Slider1.Value</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Click the "Botton1" control and change the value on the property "OnSelected" to the formula below. It passes the current latitude, longitude and zoom level to the custom connector and receives the image data. The received image data is stored in the <code>result</code> collection.</p><div class="language-powerappsfl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powerappsfl codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ClearCollect(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    result,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MAPS.GetGoogleMapImage(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Location.Latitude,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Location.Longitude,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        { zoom: First(zoomlevel).Value }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Click the "Image1" control and change the value on the property "Image" to the formula below. It gets the image data from the <code>result</code> collection.</p><div class="language-powerappsfl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powerappsfl codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">First(result).Url</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Click the "Slider1" control and change the value on the property "OnChange" to the formula below. It stores the current slider value to the <code>zoomlevel</code> collection, followed by calling the custom connector to get the image data against the current location.</p><div class="language-powerappsfl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powerappsfl codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ClearCollect(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    zoomlevel,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Slider1.Value</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ClearCollect(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    result,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MAPS.GetGoogleMapImage(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Location.Latitude,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Location.Longitude,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        { zoom: First(zoomlevel).Value }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>That seems to be OK. Let's click the "Where am I?" button. But it doesn't show the image. The <code>First(result).Url</code> value is actually similar to this:</p><div class="language-powerappsfl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powerappsfl codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">appres://blobmanager/1090a86393a843adbfcf428f0b90e91b/1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>It's the image reference value somewhere you can't get there.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="workaround--power-automate-workflow">Workaround <!-- -->‚Äì<!-- --> Power Automate workflow<a class="hash-link" href="#workaround--power-automate-workflow" title="Direct link to heading">‚Äã</a></h3><p>Therefore, you need a workaround using a Power Automate workflow to sort out this issue. Open the Power Automate Studio, create an instant cloud flow with the Power App trigger, and give it the "Where am I" name. Then add input parameters of <code>lat</code>, <code>long</code> and <code>zoom</code>.</p><p><img loading="lazy" src="./img/28-serverless-power-platform-custom-connector-29.png" alt="Power Apps trigger on Power Automate workflow" class="img_ev3q"></p><p>Add custom connector action to get the map image.</p><p><img loading="lazy" src="./img/28-serverless-power-platform-custom-connector-30.png" alt="Select action to get the Google Maps image" class="img_ev3q"></p><p>In the action, pass the appropriate parameters to the action.</p><p><img loading="lazy" src="./img/28-serverless-power-platform-custom-connector-31.png" alt="Pass parameters to the custom connector action" class="img_ev3q"></p><p>Add a "Response" action and put the following values into each field.</p><ul><li><p>"Body" field:</p><div class="language-bicep codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bicep codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  "base64Image": &lt;power_automate_expression&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>The <code>&lt;power_automate_expression&gt;</code> should be <code>concat('data:', body('GetGoogleMapImage')?['$content-type'], ';base64,', body('GetGoogleMapImage')?['$content'])</code>.</p></blockquote></li><li><p>"Response Body JSON Schema" field:</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">"type"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"object"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">"properties"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">"base64Image"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">"type"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"string"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul><p><img loading="lazy" src="./img/28-serverless-power-platform-custom-connector-32.png" alt="Format the Response action" class="img_ev3q"></p><p>Let's return to the Power Apps Studio and add the Power Automate workflow you created.</p><p><img loading="lazy" src="./img/28-serverless-power-platform-custom-connector-33.png" alt="Add Power Automate workflow" class="img_ev3q"></p><p>Select "Button1" and change the value on the property "OnSelect" below. It replaces the direct call to the custom connector with the Power Automate workflow.</p><div class="language-powerappsfl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powerappsfl codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ClearCollect(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    result,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    WhereamI.Run(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Location.Latitude,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Location.Longitude,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        First(zoomlevel).Value</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Also, change the value on the property "OnChange" of the "Slider1" control below, replacing the custom connector call with the Power Automate workflow call.</p><div class="language-powerappsfl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powerappsfl codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ClearCollect(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    zoomlevel,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Slider1.Value</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ClearCollect(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    result,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    WhereamI.Run(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Location.Latitude,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Location.Longitude,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        First(zoomlevel).Value</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And finally, change the "Image1" control's "Image" property value below.</p><div class="language-powerappsfl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powerappsfl codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">First(result).base64Image</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The workaround has been applied. Click the "Where am I?" button to see your current location from Google Maps.</p><p><img loading="lazy" src="./img/28-serverless-power-platform-custom-connector-34.png" alt="Run Power Apps app #1" class="img_ev3q"></p><p>If you change the slider left or right, you will see either the zoomed-in image or the zoomed-out image.</p><p><img loading="lazy" src="./img/28-serverless-power-platform-custom-connector-35.png" alt="Run Power Apps app #2" class="img_ev3q"></p><p>Now, you've created a Power Apps app to show your current location using:</p><ul><li>Google Maps API through the custom connector, and</li><li>Custom connector written in Azure Functions with OpenAPI extension!</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="exercise-try-this-yourself">Exercise: Try this yourself!<a class="hash-link" href="#exercise-try-this-yourself" title="Direct link to heading">‚Äã</a></h2><p>You can fork this <a href="https://github.com/justinyoo/google-naver-maps-custom-connector-sample" target="_blank" rel="noopener noreferrer">GitHub repository</a> to your account and play around with it to see how the custom connector works. After forking the repository, make sure that you create all the necessary secrets to your repository documented in the README file.</p><p>Then, click the "Deploy to Azure" button, and it will provision all necessary Azure resources and deploy an Azure Functions app for a custom connector.</p><p><img loading="lazy" src="https://raw.githubusercontent.com/Azure/azure-quickstart-templates/master/1-CONTRIBUTION-GUIDE/images/deploytoazure.svg?sanitize=true" alt="Deploy To Azure" class="img_ev3q"></p><p>Once everything is deployed successfully, try to create a <a href="https://docs.microsoft.com/power-apps/powerapps-overview?WT.mc_id=dotnet-75362-juyoo" target="_blank" rel="noopener noreferrer">Power Apps app</a> and <a href="https://docs.microsoft.com/power-automate/getting-started?WT.mc_id=dotnet-75362-juyoo" target="_blank" rel="noopener noreferrer">Power Automate workflow</a> to see your current location in real-time!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="resources-for-self-study">Resources: For self-study!<a class="hash-link" href="#resources-for-self-study" title="Direct link to heading">‚Äã</a></h2><p>Want to know more about Power Platform custom connector and Azure Functions OpenAPI extension? Here are several resources you can take a look at:</p><ul><li><a href="https://docs.microsoft.com/training/paths/transform-business-applications-with-fusion-development/?WT.mc_id=dotnet-75362-juyoo" target="_blank" rel="noopener noreferrer"><strong>Microsoft Learn</strong>: Transform your business applications with fusion development</a></li><li><a href="https://aka.ms/azfunc-openapi" target="_blank" rel="noopener noreferrer"><strong>GitHub repository</strong>: Azure Functions OpenAPI Extension</a></li></ul>]]></content>
        <author>
            <name>Justin Yoo</name>
            <uri>https://github.com/justinyoo</uri>
        </author>
        <category label="serverless-september" term="serverless-september"/>
        <category label="30-days-of-serverless" term="30-days-of-serverless"/>
        <category label="azure-functions" term="azure-functions"/>
        <category label="openapi" term="openapi"/>
        <category label="power-platform" term="power-platform"/>
        <category label="custom-connector" term="custom-connector"/>
    </entry>
</feed>