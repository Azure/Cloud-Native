<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-blog-60daysofIA" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.0">
<title data-rh="true">7.5 Real-time Voice Sentiment Analysis System 2 | Build Intelligent Apps On Azure</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" name="og:title" content="#IntelligentApps start today | Microsoft Azure"><meta data-rh="true" name="og:description" content="Develop adaptive, responsive, and personalized experiences by building and modernizing intelligent applications with Azure!"><meta data-rh="true" name="og:url" content="https://aka.ms/FallForIA"><meta data-rh="true" name="twitter:site" content="@AzureAdvocates"><meta data-rh="true" name="awa-env" content="Production"><meta data-rh="true" name="description" content="In today&#x27;s fast-paced digital world, understanding customer sentiment in real-time during voice calls can provide businesses with a competitive edge. This guide will show developers how to build a robust real-time voice sentiment analysis application using several key Azure services. In this second part, we will develop the backend to handle interactions with Azure Communication Services, Azure AI Language and Azure OpenAI, connect it to the frontend, and deploy to Azure Container Apps ."><meta data-rh="true" name="keywords" content="Cloud,Data,AI,AI/ML,intelligent apps,cloud-native,60-days,enterprise apps,digital experiences,app modernization,serverless,ai apps"><meta data-rh="true" property="article:published_time" content="2024-04-17T09:05:00.000Z"><meta data-rh="true" property="article:author" content="https://azure.github.io/Cloud-Native/Build-IA/"><meta data-rh="true" property="article:tag" content="Build-Intelligent-Apps,60-days-of-IA,learn-live,hack-together,community-buzz,ask-the-expert,azure-kubernetes-service,azure-functions,azure-openai,azure-container-apps,azure-cosmos-db,github-copilot,github-codespaces,github-actions"><meta data-rh="true" property="og:url" content="https://azure.github.io/cloud-native/60daysofia/real-time-voice-sentiment-analysis-system-2"><meta data-rh="true" property="og:type" content="website"><meta data-rh="true" property="og:title" content="Build Intelligent Apps | AI Apps on Azure"><meta data-rh="true" property="og:description" content="Join us on a learning journey to build intelligent apps on Azure. Read all about the upcoming #BuildIntelligentApps initiative on this post!"><meta data-rh="true" property="og:image" content="https://github.com/Azure/Cloud-Native/blob/main/website/static/img/ogImage.png"><meta data-rh="true" name="twitter:url" content="https://azure.github.io/Cloud-Native/60daysofIA/real-time-voice-sentiment-analysis-system-2"><meta data-rh="true" name="twitter:title" content="Build Intelligent Apps | AI Apps on Azure"><meta data-rh="true" name="twitter:description" content="Azure and platform engineering pave the way for the efficient development, deployment, and maintenance of Intelligent Apps, triumphing over traditional approaches."><meta data-rh="true" name="twitter:image" content="https://azure.github.io/Cloud-Native/img/ogImage.png"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" name="twitter:creator" content="@devanshidiaries"><link data-rh="true" rel="icon" href="/Cloud-Native/img/favicon.ico"><link data-rh="true" rel="alternate" href="https://azure.github.io/Cloud-Native/60DaysOfIA/real-time-voice-sentiment-analysis-system-2" hreflang="en"><link data-rh="true" rel="alternate" href="https://azure.github.io/Cloud-Native/60DaysOfIA/real-time-voice-sentiment-analysis-system-2" hreflang="x-default"><link data-rh="true" rel="canonical" href="https://azure.github.io/Cloud-Native/60daysofIA/real-time-voice-sentiment-analysis-system-2"><link rel="alternate" type="application/rss+xml" href="/Cloud-Native/blog/rss.xml" title="Build Intelligent Apps On Azure RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Cloud-Native/blog/atom.xml" title="Build Intelligent Apps On Azure Atom Feed">





<link rel="alternate" type="application/rss+xml" href="/Cloud-Native/cnny-2023/rss.xml" title="Build Intelligent Apps On Azure RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Cloud-Native/cnny-2023/atom.xml" title="Build Intelligent Apps On Azure Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/Cloud-Native/30DaysOfIA/rss.xml" title="Build Intelligent Apps On Azure RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Cloud-Native/30DaysOfIA/atom.xml" title="Build Intelligent Apps On Azure Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/Cloud-Native/60DaysOfIA/rss.xml" title="Build Intelligent Apps On Azure RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Cloud-Native/60DaysOfIA/atom.xml" title="Build Intelligent Apps On Azure Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/Cloud-Native/30-days-of-ia-2024/rss.xml" title="Build Intelligent Apps On Azure RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Cloud-Native/30-days-of-ia-2024/atom.xml" title="Build Intelligent Apps On Azure Atom Feed">
<script>!function(t,e,n,c,a,r,s){t[n]=t[n]||function(){(t[n].q=t[n].q||[]).push(arguments)},(r=e.createElement(c)).async=1,r.src="https://www.clarity.ms/tag/d61n997vq9",(s=e.getElementsByTagName(c)[0]).parentNode.insertBefore(r,s)}(window,document,"clarity","script")</script>

<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="https://js.monitor.azure.com/scripts/c/ms.analytics-web-3.min.js"></script><link rel="stylesheet" href="/Cloud-Native/assets/css/styles.fbc5305a.css">
<script src="/Cloud-Native/assets/js/runtime~main.8dbf3e4c.js" defer="defer"></script>
<script src="/Cloud-Native/assets/js/main.36ad55fe.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><header><div></div></header><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/Cloud-Native/"></a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="announcementBarBackground_Iz1u"><div class="container"><div class="row"><div class="col col--8 col--offset-2 announcementBarContainer_QNjo"><div class="col-demo"><p class="announcementBarContent_tvcd">Learn to use <a class="announcementLink_qKCm" target="_blank" href="https://developer.microsoft.com/reactor/events/23599/?ocid=biafy25h1_cn_webpage_azuremktg" data-bi-area="AnnouncementBar" data-bi-name="Announcement">Azure Functions OpenAI to ingest your own content</a> | Give us a ðŸŒŸ <a class="announcementLink_qKCm" target="_blank" href="https://github.com/azure/cloud-native" data-bi-area="AnnouncementBar" data-bi-name="Give us a star on GitHub">on GitHub</a></p></div></div><div class="col col--2 announcementBarIconContainer_GQot"><div class="col-demo"><a href="https://github.com/azure/cloud-native" target="_blank" class="icon_QeTG" aria-label="Visit us on GitHub"><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="#FFFFFF"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a><a href="https://azure.github.io/Cloud-Native/60DaysOfIA/rss.xml" target="_blank" class="icon_QeTG" aria-label="Subscribe to RSS"><svg width="24" height="24" viewBox="0 0 333333 333333" xmlns="http://www.w3.org/2000/svg" fill="#f49c4f"><path d="M166667 0c92048 0 166667 74619 166667 166667s-74619 166667-166667 166667S0 258715 0 166667 74619 0 166667 0zm-57698 203357c-11551 0-20938 9418-20938 20897 0 11537 9386 20857 20938 20857 11587 0 20967-9320 20967-20857 0-11479-9378-20897-20967-20897zm-20918-61899v30148c19632 0 38081 7677 51977 21585 13883 13868 21548 32406 21548 52114h30276c0-57254-46585-103838-103801-103838v-9zm38-53431v30154c70007 0 126979 57031 126979 127116l30235 3c0-86697-70539-157270-157212-157270l-2-3z"></path></svg></a><svg viewBox="0 0 24 24" width="24" height="24" class="icon_Kj6K"><path fill="white" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg></div></div></div></div></div><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">#60DaysOfIA</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/60DaysOfIA/kick-off">Kick-off #60Days of IA</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/60DaysOfIA/harnessing-the-power-of-intelligent-apps">1. Harnessing the power of Intelligent Apps</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/60DaysOfIA/power-up-crafting-an-intelligent-energy-forecasting-application-using-azure-kubernetes-service">2. Power Up: Crafting an Intelligent Energy Forecasting Application Using Azure Kubernetes Service</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/60DaysOfIA/forecasting-energy-usage-with-intelligent-apps-1">2.1 Forecasting Energy Usage with Intelligent Apps Part 1: Laying the Groundwork with AKS, KAITO, and LLaMA</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/60DaysOfIA/forecasting-energy-usage-with-intelligent-apps-2">2.2 Forecasting Energy Usage with Intelligent Apps Part 2</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/60DaysOfIA/forecasting-energy-usage-with-intelligent-apps-3">2.3 Forecasting Energy Usage with Intelligent Apps Part 3</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/60DaysOfIA/cosmos-db-and-intelligent-apps-a-match-made-for-innovation">3. Cosmos DB and Intelligent Apps: A Match Made for Innovation</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/60DaysOfIA/dynamic-repricing-of-products-using-intelligent-apps-part-1">3.1 Dynamic Repricing of Products Using Intelligent Apps Part 1</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/60DaysOfIA/dynamic-repricing-of-products-using-intelligent-apps-part-2">3.2 Dynamic Repricing of Products Using Intelligent Apps Part 2</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/60DaysOfIA/dynamic-repricing-of-products-using-intelligent-apps-part-3">3.3 Dynamic Repricing of Products Using Intelligent Apps Part 3: Graphing and Displaying Price Forecasts in a Web Interface</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/60DaysOfIA/fuel-your-intelligent-apps-with-azure-ai">4. Fuel Your Intelligent Apps with Azure AI</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/60DaysOfIA/build-contoso-chat-end-to-end">4.1 Build Contoso Chat End-to-End</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/60DaysOfIA/build-a-copilot-code-first-with-the-azure-ai-python-sdk">4.2 Build A Copilot Code-First with the Azure AI Python SDK</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/60DaysOfIA/build-a-copilot-on-azure-code-first-with-prompt-flow">4.3 Build a Copilot on Azure Code-First with Prompt Flow</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/60DaysOfIA/build-a-copilot-on-azure-code-first-with-langchain">4.4 Build a Copilot on Azure Code-First with Langchain</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/60DaysOfIA/deploying-your-copilot-on-azure">4.5 Deploying Your Copilot On Azure</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/60DaysOfIA/the-role-of-platform-engineering-in-developing-intelligent-apps">5 The Role of Platform Engineering in Developing Intelligent Apps</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/60DaysOfIA/creating-a-virtual-stylist-chatbot-part-1">6.1 Creating a Virtual Stylist Chatbot â€” Part 1: Analyzing Images with AI</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/60DaysOfIA/creating-a-virtual-stylist-chatbot-part-2">6.2 Creating a Virtual Stylist Chatbot â€” Part 2: Adding a Chatbot Interface</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/60DaysOfIA/creating-a-virtual-stylist-chatbot-part-3">6.3 Creating a Virtual Stylist Chatbot â€” Part 3: Deploying the App</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/60DaysOfIA/building-a-multichannel-notification-system-1">6.4 Building a Multichannel Notification System (1)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/60DaysOfIA/building-a-multichannel-notification-system-2">6.5 Building a Multichannel Notification System (2)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/60DaysOfIA/personalizing-education-with-generative-ai-and-retrieval-augmented-generation-1">7.1 Personalizing Education with Generative AI and Retrieval Augmented Generation Part 1</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/60DaysOfIA/personalizing-education-with-generative-ai-and-retrieval-augmented-generation-2">7.2 Personalizing Education with Generative AI and Retrieval Augmented Generation Part 2</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/60DaysOfIA/personalizing-education-with-generative-ai-and-retrieval-augmented-generation-3">7.3 Personalizing Education with Generative AI and Retrieval Augmented Generation Part 3</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/60DaysOfIA/real-time-voice-sentiment-analysis-system-1">7.4 Real-time Voice Sentiment Analysis System 1</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/Cloud-Native/60DaysOfIA/real-time-voice-sentiment-analysis-system-2">7.5 Real-time Voice Sentiment Analysis System 2</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/60DaysOfIA/managing-the-cost-of-intelligent-apps">8 Managing the Cost of Intelligent Apps</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="https://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="In today&#x27;s fast-paced digital world, understanding customer sentiment in real-time during voice calls can provide businesses with a competitive edge. This guide will show developers how to build a robust real-time voice sentiment analysis application using several key Azure services. In this second part, we will develop the backend to handle interactions with Azure Communication Services, Azure AI Language and Azure OpenAI, connect it to the frontend, and deploy to Azure Container Apps ."><link itemprop="image" href="https://github.com/Azure/Cloud-Native/blob/main/website/static/img/ogImage.png"><meta itemprop="keywords" content="Cloud,Data,AI,AI/ML,intelligent apps,cloud-native,60-days,enterprise apps,digital experiences,app modernization,serverless,ai apps"><header><h1 class="title_f1Hy" itemprop="headline">7.5 Real-time Voice Sentiment Analysis System 2</h1><div class="container_mt6G margin-vert--md"><time datetime="2024-04-17T09:05:00.000Z" itemprop="datePublished">April 17, 2024</time> Â· <!-- -->16 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://azure.github.io/Cloud-Native/Build-IA/" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://azure.github.io/Cloud-Native/img/logo-2024.png" alt="#60Days Of IA" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://azure.github.io/Cloud-Native/Build-IA/" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">#60Days Of IA</span></a></div><small class="avatar__subtitle" itemprop="description">BuildIA Content Team</small></div></div></div></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody">
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="real-time-voice-sentiment-analysis-system-using-azure-communication-services-azure-ai-and-azure-openai-part-2">Real-time Voice Sentiment Analysis System Using Azure Communication Services, Azure AI and Azure OpenAI (Part 2)<a href="#real-time-voice-sentiment-analysis-system-using-azure-communication-services-azure-ai-and-azure-openai-part-2" class="hash-link" aria-label="Direct link to Real-time Voice Sentiment Analysis System Using Azure Communication Services, Azure AI and Azure OpenAI (Part 2)" title="Direct link to Real-time Voice Sentiment Analysis System Using Azure Communication Services, Azure AI and Azure OpenAI (Part 2)">â€‹</a></h2>
<p>In theâ€¯<a href="https://azure.github.io/Cloud-Native/60daysofIA/real-time-voice-sentiment-analysis-system-1" target="_blank" rel="noopener noreferrer">first part</a>â€¯of this topic, we setup all the Azure resources like the <a href="https://learn.microsoft.com/azure/communication-services/overview?ocid=buildia24_60days_blogs" target="_blank" rel="noopener noreferrer">Azure Communication Services</a> for VoIP and PSTN, <a href="https://learn.microsoft.com/azure/ai-services/language-service/overview?ocid=buildia24_60days_blogs" target="_blank" rel="noopener noreferrer">Azure AI Language</a>, <a href="https://learn.microsoft.com/azure/ai-services/openai/overview?ocid=buildia24_60days_blogs" target="_blank" rel="noopener noreferrer">Azure OpenAI</a>, and developed the frontend for a simple yet functional UI to make voice calls and display closed captions generated from the conversation. In this second part, we will develop the backend to handle interactions with Azure Communication Services, Azure AI Language and Azure OpenAI, connect it to the frontend, and deploy to <a href="https://learn.microsoft.com/azure/container-apps/overview?ocid=buildia24_60days_blogs" target="_blank" rel="noopener noreferrer">Azure Container Apps</a>. Letâ€™s get started!</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisite">Prerequisite<a href="#prerequisite" class="hash-link" aria-label="Direct link to Prerequisite" title="Direct link to Prerequisite">â€‹</a></h3>
<p>To follow this tutorial, ensure you have completed the <a href="https://azure.github.io/Cloud-Native/60daysofIA/real-time-voice-sentiment-analysis-system-1" target="_blank" rel="noopener noreferrer">first part</a>â€¯of this topic.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="setting-up-the-backend-with-aspnet-core">Setting Up the Backend with ASP.NET Core<a href="#setting-up-the-backend-with-aspnet-core" class="hash-link" aria-label="Direct link to Setting Up the Backend with ASP.NET Core" title="Direct link to Setting Up the Backend with ASP.NET Core">â€‹</a></h3>
<p>The backend of our real-time voice sentiment analysis application, built with ASP.NET Core, plays a crucial role. It will handle interactions with Azure Communication Services for voice calling, manage sentiment analysis with Azure AI Language and Azure OpenAI, and serve the necessary tokens and endpoints to our frontend. Let&#x27;s set this up step by step.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="step-1-create-a-new-aspnet-core-project">Step 1: Create a New ASP.NET Core Project<a href="#step-1-create-a-new-aspnet-core-project" class="hash-link" aria-label="Direct link to Step 1: Create a New ASP.NET Core Project" title="Direct link to Step 1: Create a New ASP.NET Core Project">â€‹</a></h4>
<ol>
<li>
<p><strong>Open Your Command Line</strong>: Navigate to the directory where you want to create your project.</p>
</li>
<li>
<p><strong>Create the Project</strong>: Execute the following command to create a new ASP.NET Core Web API project. This command will generate a basic template for a RESTful API application.</p>
<p><code>bash</code></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dotnet new webapi --no-https </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<p><strong>Note</strong>: We are turning off HTTPS for simplicity in this guide. For production environments, HTTPS should be enabled and properly configured.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="step-2-add-azure-sdk-packages">Step 2: Add Azure SDK Packages<a href="#step-2-add-azure-sdk-packages" class="hash-link" aria-label="Direct link to Step 2: Add Azure SDK Packages" title="Direct link to Step 2: Add Azure SDK Packages">â€‹</a></h4>
<p>Our backend needs to interact with Azure Communication Services, Azure AI Language, and Azure OpenAI. We&#x27;ll add the necessary NuGet packages for these services.</p>
<ol>
<li>
<p><strong>Azure Communication Services SDK</strong>: This package allows us to manage voice calling and access tokens.</p>
<p><code>bash</code></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dotnet add package Azure.Communication.CallingServer </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p><strong>Azure AI Text Analytics SDK</strong>: We&#x27;ll use this for sentiment analysis through Azure AI Language.</p>
<p><code>bash</code></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dotnet add package Azure.AI.TextAnalytics </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p><strong>Azure OpenAI SDK</strong>: This package is used to interact with Azure OpenAI for more complex sentiment analysis.</p>
<p><code>bash</code></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dotnet add package Azure.AI.OpenAI --prerelease </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="step-3-set-up-configuration">Step 3: Set Up Configuration<a href="#step-3-set-up-configuration" class="hash-link" aria-label="Direct link to Step 3: Set Up Configuration" title="Direct link to Step 3: Set Up Configuration">â€‹</a></h4>
<ol>
<li>
<p><strong>appsettings.json</strong>: Open or create the <code>appsettings.json</code> file in your project root. Add placeholders for the keys and endpoints for the Azure services. Hereâ€™s an example configuration:</p>
<p><code>json</code></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;Logging&quot;: { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;LogLevel&quot;: { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;Default&quot;: &quot;Information&quot;, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;Microsoft.AspNetCore&quot;: &quot;Warning&quot; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;AllowedHosts&quot;: &quot;*&quot;, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;AzureSettings&quot;: { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;AZURE_LANGUAGE_SERVICE_KEY&quot;: &quot;YOUR_AZURE_LANGUAGE_KEY&quot;, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;AZURE_LANGUAGE_SERVICE_ENDPOINT&quot;: &quot;YOUR_AZURE_OPENAI_ENDPOINT&quot;, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;OPENAI_ENDPOINT&quot;: &quot;YOUR_AZURE_OPENAI_ENDPOINT&quot;, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;OPENAI_KEY&quot;: &quot;YOUR_AZURE_OPENAI_KEY&quot;, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;OPENAI_DEPLOYMENT_NAME&quot;: &quot;YOUR_AZURE_OPENAI_ENDPOINT_DEPLOYMENT&quot;, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;COMMUNICATION_CONNECTION_STRING&quot;: &quot;YOUR_AZURE_COMMUNICATION_SERVICES_CONNECTION_STRING&quot; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">} </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>Replace the placeholders with your actual Azure resource keys and endpoints.</li>
</ul>
</li>
<li>
<p><strong>Configure Services in Program.cs</strong>: Read the endpoint from appsettings.json and configure the services in the <code>Program.cs</code> file.</p>
<p><code>csharp</code></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Set keys and configuration </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var azureSettings = builder.Configuration.GetSection(&quot;AzureSettings&quot;); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">string GetSetting(string key) =&gt; azureSettings[key] ?? throw new Exception($&quot;{key} is not set&quot;); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var languageKey = GetSetting(&quot;AZURE_LANGUAGE_SERVICE_KEY&quot;); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var languageEndpoint = GetSetting(&quot;AZURE_LANGUAGE_SERVICE_ENDPOINT&quot;); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AzureKeyCredential credentials = new AzureKeyCredential(languageKey); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Uri endpoint = new Uri(languageEndpoint); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var textAnalyticsClient = new TextAnalyticsClient(endpoint, credentials); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var OPENAI_ENDPOINT = GetSetting(&quot;OPENAI_ENDPOINT&quot;); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var OPENAI_KEY = GetSetting(&quot;OPENAI_KEY&quot;); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var OPENAI_DEPLOYMENT_NAME = GetSetting(&quot;OPENAI_DEPLOYMENT_NAME&quot;); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OpenAIClient openAIClient = new OpenAIClient( </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    new Uri(OPENAI_ENDPOINT), </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    new AzureKeyCredential(OPENAI_KEY)); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var communicationConnectionString = GetSetting(&quot;COMMUNICATION_CONNECTION_STRING&quot;); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var communicationClient = new CommunicationIdentityClient(communicationConnectionString); </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p><strong>Implement the Token Endpoint</strong>:</p>
</li>
</ol>
<p>In your ASP.NET Core project Program.cs, create a new endpoint to generate and return an access token. We&#x27;ll call this endpoint from our client later.</p>
<p><code>csharp</code></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">app.MapGet(&quot;api/token&quot;, () =&gt; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var identityAndTokenResponse = communicationClient.CreateUserAndToken(scopes: [CommunicationTokenScope.VoIP]); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var result = new TokenResponse() </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Token = identityAndTokenResponse.Value.AccessToken.Token, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        PhoneNumber = &quot;+12533192954&quot;, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return Results.Json(result); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.WithName(&quot;Token&quot;) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.WithOpenApi(); </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>We&#x27;ll also need a TokenResponse object to return the token and phone number:</p>
<p><code>csharp</code></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public class TokenResponse </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public string Token { get; set; } </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public string PhoneNumber { get; set; } </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">} </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="step-4-implement-sentiment-analysis-endpoints">Step 4: Implement Sentiment Analysis Endpoints<a href="#step-4-implement-sentiment-analysis-endpoints" class="hash-link" aria-label="Direct link to Step 4: Implement Sentiment Analysis Endpoints" title="Direct link to Step 4: Implement Sentiment Analysis Endpoints">â€‹</a></h4>
<p>With the services configured, you can now implement the API endpoints needed for your application. Here are the essentials:</p>
<ol>
<li>
<p><strong>Token Provisioning</strong>: An endpoint to provide access tokens for Azure Communication Services.</p>
</li>
<li>
<p><strong>Sentiment Analysis</strong>: Endpoints to analyze sentiment using either Azure AI Language or Azure OpenAI.</p>
</li>
</ol>
<p><code>csharp</code></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">app.MapPost(&quot;api/sentiment&quot;, (SentimentRequest request) =&gt; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var result = SentimentAnalysisWithAzureLanguage(request.Content); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return Results.Json(result); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.WithName(&quot;Sentiment&quot;) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.WithOpenApi(); </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This endpoint takes a SentimentRequest object and returns a SentimentResponse object and calls one of our sentiment analysis methods, which we&#x27;ll implement shortly</p>
<p><code>csharp</code></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public class SentimentRequest </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public string Analyzer { get; set; } = string.Empty; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public string ParticipantToAnalyze { get; set; } = string.Empty; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public string Content { get; set; } = string.Empty; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">} </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class SentimentResult </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public string Sentiment { get; set; } = string.Empty; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public double PositiveContentScore { get; set; } </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">} </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>We&#x27;ll create a method that uses Azure AI Language and another that uses Azure OpenAI. Here&#x27;s an example of how to implement sentiment analysis using Azure AI Language:</p>
<p><code>csharp</code></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">SentimentResult SentimentAnalysisWithAzureLanguage(string document) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var review = textAnalyticsClient.AnalyzeSentiment(document); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return new SentimentResult() </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Sentiment = review.Value.Sentiment.ToString(), </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        PositiveContentScore = review.Value.ConfidenceScores.Positive </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">} </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>And we&#x27;ll create method endpoint that uses Azure OpenAI:</p>
<p><code>csharp</code></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">SentimentResult SentimentAnalysisWithGPT(string document) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var chatCompletionsOptions = new ChatCompletionsOptions() </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        DeploymentName = &quot;shawn-deployment&quot;, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Messages = </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                new ChatRequestSystemMessage(SentimentAnalysisPrompt), </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                new ChatRequestUserMessage(document), </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Temperature = (float)1, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        MaxTokens = 800             </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Response&lt;ChatCompletions&gt; response = openAIClient.GetChatCompletions(chatCompletionsOptions); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return new SentimentResult() { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Sentiment = response.Value.Choices[0].Message.Content </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">} </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="step-5-test-your-backend">Step 5: Test Your Backend<a href="#step-5-test-your-backend" class="hash-link" aria-label="Direct link to Step 5: Test Your Backend" title="Direct link to Step 5: Test Your Backend">â€‹</a></h4>
<p>Before moving forward, make sure to test your backend. Use tools like Postman or Swagger UI to ensure your endpoints are responsive and returning the expected results.</p>
<p>Your final backend should look like this:</p>
<p><code>csharp</code></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">using Azure; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using Azure.AI.TextAnalytics; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using Azure.AI.OpenAI; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using Azure.Communication.Identity; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var builder = WebApplication.CreateBuilder(args); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Add services to the container. </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Learn more about configuring Swagger/OpenAPI at https://aka.ms/aspnetcore/swashbuckle </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">builder.Services.AddEndpointsApiExplorer(); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">builder.Services.AddSwaggerGen(); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Set keys and configuration </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var azureSettings = builder.Configuration.GetSection(&quot;AzureSettings&quot;); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">string GetSetting(string key) =&gt; azureSettings[key] ?? throw new Exception($&quot;{key} is not set&quot;); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var languageKey = GetSetting(&quot;AZURE_LANGUAGE_SERVICE_KEY&quot;); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var languageEndpoint = GetSetting(&quot;AZURE_LANGUAGE_SERVICE_ENDPOINT&quot;); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AzureKeyCredential credentials = new AzureKeyCredential(languageKey); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Uri endpoint = new Uri(languageEndpoint); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var textAnalyticsClient = new TextAnalyticsClient(endpoint, credentials); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var OPENAI_ENDPOINT = GetSetting(&quot;OPENAI_ENDPOINT&quot;); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var OPENAI_KEY = GetSetting(&quot;OPENAI_KEY&quot;); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var OPENAI_DEPLOYMENT_NAME = GetSetting(&quot;OPENAI_DEPLOYMENT_NAME&quot;); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OpenAIClient openAIClient = new OpenAIClient( </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    new Uri(OPENAI_ENDPOINT), </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    new AzureKeyCredential(OPENAI_KEY)); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var communicationConnectionString = GetSetting(&quot;COMMUNICATION_CONNECTION_STRING&quot;); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var communicationClient = new CommunicationIdentityClient(communicationConnectionString); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">const string SentimentAnalysisPrompt = &quot;Please analyze the sentiment of the following text. The sentiment can be positive, negative, or neutral. Response on with one of those three values&quot;; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var app = builder.Build(); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Configure the HTTP request pipeline. </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if (app.Environment.IsDevelopment()) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    app.UseSwagger(); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    app.UseSwaggerUI(); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">} </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app.MapGet(&quot;api/token&quot;, () =&gt; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var identityAndTokenResponse = communicationClient.CreateUserAndToken(scopes: [CommunicationTokenScope.VoIP]); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var result = new TokenResponse() </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Token = identityAndTokenResponse.Value.AccessToken.Token, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        PhoneNumber = &quot;+12533192954&quot;, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return Results.Json(result); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.WithName(&quot;Token&quot;) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.WithOpenApi(); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app.MapPost(&quot;api/sentiment&quot;, (SentimentRequest request) =&gt; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var result = SentimentAnalysisWithAzureLanguage(request.Content); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return Results.Json(result); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.WithName(&quot;Sentiment&quot;) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.WithOpenApi(); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â€¯</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app.Run(); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SentimentResult SentimentAnalysisWithAzureLanguage(string document) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var review = textAnalyticsClient.AnalyzeSentiment(document); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return new SentimentResult() </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Sentiment = review.Value.Sentiment.ToString(), </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        PositiveContentScore = review.Value.ConfidenceScores.Positive </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">} </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// // Function to get a response from OpenAI&#x27;s ChatGPT </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SentimentResult SentimentAnalysisWithGPT(string document) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var chatCompletionsOptions = new ChatCompletionsOptions() </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        DeploymentName = &quot;shawn-deployment&quot;, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Messages = </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                new ChatRequestSystemMessage(SentimentAnalysisPrompt), </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                new ChatRequestUserMessage(document), </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Temperature = (float)1, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        MaxTokens = 800             </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Response&lt;ChatCompletions&gt; response = openAIClient.GetChatCompletions(chatCompletionsOptions); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return new SentimentResult() { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Sentiment = response.Value.Choices[0].Message.Content </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">} </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class TokenResponse </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public string Token { get; set; } = string.Empty; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public string PhoneNumber { get; set; } = string.Empty; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">} </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class SentimentRequest </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public string Analyzer { get; set; } = string.Empty; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public string ParticipantToAnalyze { get; set; } = string.Empty; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public string Content { get; set; } = string.Empty; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">} </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class SentimentResult </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public string Sentiment { get; set; } = string.Empty; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public double PositiveContentScore { get; set; } </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">} </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>Earn Microsoft-verified credentials for cloud-native app development skills by passing the <a href="https://learn.microsoft.com/credentials/applied-skills/deploy-cloud-native-apps-using-azure-container-apps/?ocid=buildia24_60days_blogs" target="_blank" rel="noopener noreferrer">Azure Container Apps</a> assessment to elevate your professional profile.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="connecting-the-frontend-with-the-aspnet-core-backend">Connecting the Frontend with the ASP.NET Core Backend<a href="#connecting-the-frontend-with-the-aspnet-core-backend" class="hash-link" aria-label="Direct link to Connecting the Frontend with the ASP.NET Core Backend" title="Direct link to Connecting the Frontend with the ASP.NET Core Backend">â€‹</a></h3>
<p>After setting up the backend and the frontend of our real-time voice sentiment analysis application separately, itâ€™s time to connect them. This connection ensures that our Node.js frontend can communicate with the ASP.NET Core backend to do things like obtaining access tokens for Azure Communication Services and conducting sentiment analysis through Azure AI Language and Azure OpenAI.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="step-1-get-the-access-token">Step 1: Get the Access Token<a href="#step-1-get-the-access-token" class="hash-link" aria-label="Direct link to Step 1: Get the Access Token" title="Direct link to Step 1: Get the Access Token">â€‹</a></h4>
<p>For our application to establish a call, the frontend needs to obtain an access token from Azure Communication Services. In the <code>app.js</code> file within your Node.js project, modify the <code>initCallAgent</code> function to fetch the token from the backend before initializing the call agent. Use the <code>fetch</code> API for this purpose:</p>
<p><code>javascript</code></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">async function initCallAgent() { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    try { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        const response = await fetch(&#x27;/api/communications/token&#x27;); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        const { token, userId } = await response.json(); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        const tokenCredential = new AzureCommunicationTokenCredential(token); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        const callClient = new CallClient(); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        callAgent = await callClient.createCallAgent(tokenCredential, { displayName: &#x27;Caller&#x27; }); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        attachCallListeners(); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } catch (error) { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        console.error(&#x27;Failed to obtain token:&#x27;, error); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">} </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="step-2-implement-sentiment-analysis-on-captions">Step 2: Implement Sentiment Analysis on Captions<a href="#step-2-implement-sentiment-analysis-on-captions" class="hash-link" aria-label="Direct link to Step 2: Implement Sentiment Analysis on Captions" title="Direct link to Step 2: Implement Sentiment Analysis on Captions">â€‹</a></h4>
<p>Our application should analyze the sentiment of the transcribed call captions. Weâ€™ll capture these captions on the frontend, then send them to our backend for sentiment analysis.</p>
<ol>
<li><strong>Make Sentiment Analysis Request:</strong></li>
</ol>
<p>In the <code>captionsReceivedHandler</code>, make a request to your backend sentiment analysis endpoint whenever captions are received. Update your captions event handler, under <code>if (captionData.resultType === &#x27;Final&#x27;)</code> to include this:</p>
<p><code>javascript</code></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">if (captionData.resultType === &#x27;Final&#x27;) { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    captionContainer.setAttribute(&#x27;isNotFinal&#x27;, &#x27;false&#x27;); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    transcript.push(captionText); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Call the sentiment service </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fetch(&#x27;/api/sentiment&#x27;, { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        method: &#x27;POST&#x27;, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        headers: { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;Content-Type&#x27;: &#x27;application/json&#x27; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        body: JSON.stringify({ content: transcript.join(&#x27;\n&#x27;) }) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .then(response =&gt; response.json()) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .then(data =&gt; { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Handle the sentiment response </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        const sentimentText = `Sentiment:${data.sentiment} (${data.positiveContentScore})`; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        document.getElementById(&#x27;sentimentScore&#x27;).textContent = captionText; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //update sentiment UI </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        updateSentimentMeter(data.positiveContentScore); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">} </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="step-3-display-analysis-results">Step 3: Display Analysis Results<a href="#step-3-display-analysis-results" class="hash-link" aria-label="Direct link to Step 3: Display Analysis Results" title="Direct link to Step 3: Display Analysis Results">â€‹</a></h4>
<p>Finally, utilize the sentiment analysis data received from the backend to inform the user about the callâ€™s sentiment in real-time.</p>
<ol>
<li><strong>Update the UI Dynamically</strong>:</li>
</ol>
<p>Enhance your frontend to dynamically display sentiment analysis results as they are received. We&#x27;ll add an indicator for positive, neutral, or negative sentiment.</p>
<p><code>javascript</code></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">function updateSentimentMeter(score) { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Ensure score is between 0 and 1 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    score = Math.max(0, Math.min(score, 1)); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Convert score to angle: -90Â° for 0, 90Â° for 1 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var angle = score * 180 - 90; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Rotate the arrow to the corresponding angle </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    document.getElementById(&#x27;meterArrow&#x27;).style.transform = &#x27;rotate(&#x27; + angle + &#x27;deg)&#x27;; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">} </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Create new elements in the HTML to display the sentiment score and meter:</p>
<p><code>html</code></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;div id=&quot;captionsArea&quot; &gt;&lt;/div&gt; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;h4&gt;Sentiment Score&lt;/h4&gt; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;div id=&quot;sentimentMeter&quot; class=&quot;meter&quot;&gt; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;div id=&quot;meterArrow&quot; class=&quot;arrow&quot;&gt;&lt;/div&gt; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;div id=&quot;sentimentScore&quot; &gt;&lt;/div&gt; </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Your complete code for app.js should look like this:</p>
<p><code>javascript</code></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import { CallClient, CallAgent, Features } from &quot;@azure/communication-calling&quot;; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import { AzureCommunicationTokenCredential } from &#x27;@azure/communication-common&#x27;; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let call; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let callAgent; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">const calleePhoneInput = document.getElementById(&quot;callee-phone-input&quot;); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">const callPhoneButton = document.getElementById(&quot;call-phone-button&quot;); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">const hangUpPhoneButton = document.getElementById(&quot;hang-up-phone-button&quot;); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let acsPhoneNumber; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let tokenCredential; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let captions; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">async function init() { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    const response = await fetch(&#x27;/api/token&#x27;);  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    const { token, phoneNumber } = await response.json(); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tokenCredential = new AzureCommunicationTokenCredential(token); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    acsPhoneNumber = phoneNumber; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    const callClient = new CallClient(); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    callAgent = await callClient.createCallAgent(tokenCredential); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">} </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">init(); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">callPhoneButton.addEventListener(&quot;click&quot;, () =&gt; { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // start a call to phone </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    const endpointToCall = calleePhoneInput.value; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    const guidPattern = /^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    const phoneNumberPattern = /^\+\d+$/; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    const userIdPattern = /^8:acs:[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}_[0-9a-f-]+$/i; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (guidPattern.test(endpointToCall)) { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        call = callAgent.join({ groupId: endpointToCall}); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } else if (phoneNumberPattern.test(endpointToCall)) { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        call = callAgent.startCall( </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            [{phoneNumber: endpointToCall}], { alternateCallerId: {phoneNumber: acsPhoneNumber} </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } else if (userIdPattern.test(endpointToCall)) { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        call = callAgent.startCall({ communicationUserId: endpointToCall }); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } else { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        console.error(&#x27;Invalid input. Must be a phone number, user ID, or GUID&#x27;); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    call.on(&#x27;stateChanged&#x27;, async () =&gt; { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        console.log(`Call state: ${call.state}`); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if(call.state === &#x27;Connected&#x27;) { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            console.log(&#x27;Call connected&#x27;); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            captions = call.feature(Features.Captions).captions; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            transcript = []; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            try { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                if (!captions.isCaptionsFeatureActive) { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    await captions.startCaptions({ spokenLanguage: &#x27;en-us&#x27; }); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                } </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                captions.on(&#x27;CaptionsReceived&#x27;, captionsReceivedHandler); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            } catch (e) { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                console.error(&#x27;startCaptions failed&#x27;, e); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            } </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    hangUpPhoneButton.disabled = false; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    callPhoneButton.disabled = true; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  hangUpPhoneButton.addEventListener(&quot;click&quot;, () =&gt; { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // end the current call </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    call.hangUp({ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      forEveryone: true </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // toggle button states </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    hangUpPhoneButton.disabled = true; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    callPhoneButton.disabled = false; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const captionsReceivedHandler = (captionData) =&gt; { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let mri = &#x27;&#x27;; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (captionData.speaker.identifier.kind === &#x27;communicationUser&#x27;) { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        mri = captionData.speaker.identifier.communicationUserId; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        mri = mri.slice(-8); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } else if (captionData.speaker.identifier.kind === &#x27;microsoftTeamsUser&#x27;) { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        mri = captionData.speaker.identifier.microsoftTeamsUserId; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        mri = mri.slice(-8); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } else if (captionData.speaker.identifier.kind === &#x27;phoneNumber&#x27;) { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        mri = captionData.speaker.identifier.phoneNumber; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let displayName = captionData.speaker.displayName || mri; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Get the captions area container </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let captionAreasContainer = document.getElementById(&#x27;captionsArea&#x27;); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Generate a class name based on the MRI </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    const newClassName = `prefix${mri.replace(/[:\-+]/g, &#x27;&#x27;)}`; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Generate the caption text </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    const captionText = `${captionData.timestamp.toUTCString()} ${displayName}: ${captionData.captionText ?? captionData.spokenText}`; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Try to find an existing caption container </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let captionContainer = captionAreasContainer.querySelector(`.${newClassName}[isNotFinal=&#x27;true&#x27;]`); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // If no existing caption container was found, create a new one </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (!captionContainer) { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        captionContainer = document.createElement(&#x27;div&#x27;); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        captionContainer.setAttribute(&#x27;isNotFinal&#x27;, &#x27;true&#x27;); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        captionContainer.classList.add(newClassName, &#x27;caption-item&#x27;); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        captionAreasContainer.appendChild(captionContainer); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Set the caption text </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    captionContainer.textContent = captionText; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // If the caption is final, update the &#x27;isNotFinal&#x27; attribute </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (captionData.resultType === &#x27;Final&#x27;) { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        captionContainer.setAttribute(&#x27;isNotFinal&#x27;, &#x27;false&#x27;); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        transcript.push(captionText); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         // Call the sentiment service </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         fetch(&#x27;/api/sentiment&#x27;, { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            method: &#x27;POST&#x27;, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            headers: { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &#x27;Content-Type&#x27;: &#x27;application/json&#x27; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            body: JSON.stringify({ content: transcript.join(&#x27;\n&#x27;) }) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .then(response =&gt; response.json()) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .then(data =&gt; { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // Handle the sentiment response </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            const sentimentText = `Sentiment:${data.sentiment} (${data.positiveContentScore})`; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            document.getElementById(&#x27;sentimentScore&#x27;).textContent = captionText; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            updateSentimentMeter(data.positiveContentScore); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    function updateSentimentMeter(score) { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Ensure score is between 0 and 1 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        score = Math.max(0, Math.min(score, 1)); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Convert score to angle: -90Â° for 0, 90Â° for 1 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var angle = score * 180 - 90; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Rotate the arrow to the corresponding angle </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        document.getElementById(&#x27;meterArrow&#x27;).style.transform = &#x27;rotate(&#x27; + angle + &#x27;deg)&#x27;; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}; </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>... and the HTML should look like this</p>
<p><code>HTML</code></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;!DOCTYPE html&gt; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;html lang=&quot;en&quot;&gt; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;head&gt; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;meta charset=&quot;utf-8&quot;&gt; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;title&gt;Azure Communication Service - Realtime Sentiment Analysis&lt;/title&gt; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;link rel=&quot;stylesheet&quot; href=&quot;styles.css&quot;&gt; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;/head&gt; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;body&gt; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;h4&gt;Azure Communication Services&lt;/h4&gt; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;input  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      id=&quot;callee-phone-input&quot; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      type=&quot;text&quot; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      placeholder=&quot;Who would you like to call?&quot; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /&gt; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;div&gt; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &lt;button id=&quot;call-phone-button&quot; type=&quot;button&quot;&gt; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Start Call </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &lt;/button&gt; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &amp;nbsp; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &lt;button id=&quot;hang-up-phone-button&quot; type=&quot;button&quot; disabled=&quot;true&quot;&gt; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Hang Up </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &lt;/button&gt; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &lt;div id=&quot;captionsArea&quot; &gt;&lt;/div&gt; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &lt;h4&gt;Sentiment Score&lt;/h4&gt; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &lt;div id=&quot;sentimentMeter&quot; class=&quot;meter&quot;&gt; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;div id=&quot;meterArrow&quot; class=&quot;arrow&quot;&gt;&lt;/div&gt; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &lt;div id=&quot;sentimentScore&quot; &gt;&lt;/div&gt; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/div&gt; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/div&gt; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;script src=&quot;./app.js&quot; type=&quot;module&quot;&gt;&lt;/script&gt; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;/body&gt; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/html&gt; </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="testing-the-complete-system">Testing the Complete System<a href="#testing-the-complete-system" class="hash-link" aria-label="Direct link to Testing the Complete System" title="Direct link to Testing the Complete System">â€‹</a></h4>
<p>With the frontend and backend now connected, thoroughly test your application:</p>
<ul>
<li>Ensure the voice call setup and teardown works flawlessly.</li>
<li>Verify that captions are accurately captured and displayed.</li>
<li>Confirm that sentiment analysis requests are successfully handled and that the results make sense for the given captions.</li>
</ul>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>Explore a variety of Azure Container Apps <a href="https://learn.microsoft.com/samples/browse/?terms=azure%20container%20apps&amp;ocid=buildia24_60days_blogs" target="_blank" rel="noopener noreferrer">code samples</a> for a quick start to your intelligent app development with cloud-native technologies.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="deployment">Deployment<a href="#deployment" class="hash-link" aria-label="Direct link to Deployment" title="Direct link to Deployment">â€‹</a></h3>
<p>With the real-time voice sentiment analysis system fully developed, including both the frontend and backend components, the next critical step is deployment. We&#x27;ll deploy the ASP.NET Core backend using Azure Container Apps and the Node.js frontend through Azure Static Web Apps.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="step-1-prepare-the-backend-for-deployment">Step 1: Prepare the Backend for Deployment<a href="#step-1-prepare-the-backend-for-deployment" class="hash-link" aria-label="Direct link to Step 1: Prepare the Backend for Deployment" title="Direct link to Step 1: Prepare the Backend for Deployment">â€‹</a></h4>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="create-a-dockerfile">Create a Dockerfile<a href="#create-a-dockerfile" class="hash-link" aria-label="Direct link to Create a Dockerfile" title="Direct link to Create a Dockerfile">â€‹</a></h5>
<ol>
<li>
<p><strong>Navigate to Your Backend Project Directory</strong>: Open the terminal or command prompt and ensure you&#x27;re in the root directory of your ASP.NET Core project.</p>
</li>
<li>
<p><strong>Create a Dockerfile</strong>: In the root of your project, create a file named <code>Dockerfile</code> with no file extension. This file will contain instructions for building a Docker image for your application.</p>
</li>
<li>
<p><strong>Define the Dockerfile Contents</strong>: Open the <code>Dockerfile</code> in your editor and add the following content:</p>
</li>
</ol>
<p><code>Dockerfile</code></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">FROM mcr.microsoft.com/dotnet/aspnet:6.0 AS base </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WORKDIR /app </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EXPOSE 80 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM mcr.microsoft.com/dotnet/sdk:6.0 AS build </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WORKDIR /src </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">COPY [&quot;VoiceSentimentBackend.csproj&quot;, &quot;.&quot;] </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN dotnet restore &quot;./VoiceSentimentBackend.csproj&quot; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">COPY . . </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WORKDIR &quot;/src/.&quot; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN dotnet build &quot;VoiceSentimentBackend.csproj&quot; -c Release -o /app/build </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM build AS publish </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN dotnet publish &quot;VoiceSentimentBackend.csproj&quot; -c Release -o /app/publish </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM base AS final </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WORKDIR /app </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">COPY --from=publish /app/publish . </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ENTRYPOINT [&quot;dotnet&quot;, &quot;VoiceSentimentBackend.dll&quot;] </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Note</strong>: Adjust <code>&quot;VoiceSentimentBackend.csproj&quot;</code> to match your project&#x27;s name.</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="create-and-test-the-docker-image-locally">Create and Test the Docker Image Locally<a href="#create-and-test-the-docker-image-locally" class="hash-link" aria-label="Direct link to Create and Test the Docker Image Locally" title="Direct link to Create and Test the Docker Image Locally">â€‹</a></h5>
<ol>
<li>
<p><strong>Build the Docker Image</strong>: Run the following command in your terminal:</p>
<p><code>bash</code></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker build -t voicesentimentbackend .</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p><strong>Run Your Docker Container</strong>: To test the Docker container locally, execute:</p>
<p><code>bash</code></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker run -d -p 8080:80 --name myapp voicesentimentbackend</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p><strong>Verify</strong>: Open your browser and navigate to <code>http://localhost:8080/api/token</code> to ensure your application is running correctly in the container.</p>
</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="step-2-deploy-the-backend-to-azure-container-apps">Step 2: Deploy the Backend to Azure Container Apps<a href="#step-2-deploy-the-backend-to-azure-container-apps" class="hash-link" aria-label="Direct link to Step 2: Deploy the Backend to Azure Container Apps" title="Direct link to Step 2: Deploy the Backend to Azure Container Apps">â€‹</a></h4>
<p>Azure Container Apps offers a fully managed serverless container service. It&#x27;s an excellent choice for deploying containers without managing complex infrastructure.</p>
<ol>
<li>
<p><strong>Create a Container App Environment</strong>: Use VS Code to create an Azure Container App and deploy your backend. Follow the <a href="https://learn.microsoft.com/azure/container-apps/deploy-visual-studio-code?ocid=buildia24_60days_blogs" target="_blank" rel="noopener noreferrer">official documentation</a> for detailed instructions. Type Crtl+Shift+P to open the command palette and type &quot;Azure Container Apps: Create New Container App&quot; and follow the prompts.</p>
</li>
<li>
<p><strong>Verify Deployment</strong>: Use the FQDN obtained from the previous command to verify your application is accessible via the internet.</p>
</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="step-3-deploy-the-frontend-to-azure-static-web-apps">Step 3: Deploy the Frontend to Azure Static Web Apps<a href="#step-3-deploy-the-frontend-to-azure-static-web-apps" class="hash-link" aria-label="Direct link to Step 3: Deploy the Frontend to Azure Static Web Apps" title="Direct link to Step 3: Deploy the Frontend to Azure Static Web Apps">â€‹</a></h4>
<p>Azure Static Web Apps is a service tailored for static web applications, providing global distribution, serverless APIs, and seamless integration with GitHub for continuous deployment.</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="setting-up-continuous-deployment-with-github">Setting Up Continuous Deployment with GitHub<a href="#setting-up-continuous-deployment-with-github" class="hash-link" aria-label="Direct link to Setting Up Continuous Deployment with GitHub" title="Direct link to Setting Up Continuous Deployment with GitHub">â€‹</a></h5>
<ol>
<li>
<p><strong>Push Your Frontend Code to GitHub</strong>: Ensure your Node.js frontend code is in a GitHub repository.</p>
</li>
<li>
<p><strong>Create a Static Web App Resource</strong>: In the Azure Portal, create a new Static Web App resource and connect it to your GitHub repository. Specify your build details during the setup.</p>
</li>
<li>
<p><strong>Verify Deployment</strong>: Once the GitHub Actions workflow is completed, your Static Web App will be accessible via the provided URL. Check it to ensure your frontend is live and functional.</p>
</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">â€‹</a></h4>
<p>Over the course of this guide, you&#x27;ve:</p>
<ul>
<li>Set up and configured critical Azure resources, including Azure Communication Services for managing voice calls, Azure AI Language for basic sentiment analysis, and Azure OpenAI for more nuanced sentiment insights.</li>
<li>Developed a Node.js frontend to interface with users, initiating and managing voice calls, and dynamically displaying sentiment analysis results.</li>
<li>Implemented an ASP.NET Core backend to handle business logic, interact with Azure services, and provide APIs for the frontend.</li>
<li>Connected your frontend and backend, ensuring seamless communication and data flow within your application.</li>
<li>Deployed your application to Azure, leveraging Azure Container Apps for the backend and Azure Static Web Apps for the frontend, making your project accessible from anywhere.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="future-enhancements">Future Enhancements<a href="#future-enhancements" class="hash-link" aria-label="Direct link to Future Enhancements" title="Direct link to Future Enhancements">â€‹</a></h4>
<p>While your current application is fully functional, there&#x27;s always room for improvement and expansion. Consider the following possibilities for future development:</p>
<ul>
<li><strong>Language Support</strong>: Expand the application to support additional languages, enhancing its accessibility and utility across different geographical locations.</li>
<li><strong>Advanced AI Insights</strong>: Explore deeper insights beyond sentiment, such as emotional tone, intent recognition, or specific topic detection, to provide more detailed analysis of voice calls.</li>
</ul></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_mRVl"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Cloud-Native/60DaysOfIA/tags/build-intelligent-apps">Build-Intelligent-Apps</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Cloud-Native/60DaysOfIA/tags/60-days-of-ia">60-days-of-IA</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Cloud-Native/60DaysOfIA/tags/learn-live">learn-live</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Cloud-Native/60DaysOfIA/tags/hack-together">hack-together</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Cloud-Native/60DaysOfIA/tags/community-buzz">community-buzz</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Cloud-Native/60DaysOfIA/tags/ask-the-expert">ask-the-expert</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Cloud-Native/60DaysOfIA/tags/azure-kubernetes-service">azure-kubernetes-service</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Cloud-Native/60DaysOfIA/tags/azure-functions">azure-functions</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Cloud-Native/60DaysOfIA/tags/azure-openai">azure-openai</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Cloud-Native/60DaysOfIA/tags/azure-container-apps">azure-container-apps</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Cloud-Native/60DaysOfIA/tags/azure-cosmos-db">azure-cosmos-db</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Cloud-Native/60DaysOfIA/tags/github-copilot">github-copilot</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Cloud-Native/60DaysOfIA/tags/github-codespaces">github-codespaces</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Cloud-Native/60DaysOfIA/tags/github-actions">github-actions</a></li></ul></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/Cloud-Native/60DaysOfIA/real-time-voice-sentiment-analysis-system-1"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">7.4 Real-time Voice Sentiment Analysis System 1</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/Cloud-Native/60DaysOfIA/managing-the-cost-of-intelligent-apps"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">8 Managing the Cost of Intelligent Apps</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#real-time-voice-sentiment-analysis-system-using-azure-communication-services-azure-ai-and-azure-openai-part-2" class="table-of-contents__link toc-highlight">Real-time Voice Sentiment Analysis System Using Azure Communication Services, Azure AI and Azure OpenAI (Part 2)</a><ul><li><a href="#prerequisite" class="table-of-contents__link toc-highlight">Prerequisite</a></li><li><a href="#setting-up-the-backend-with-aspnet-core" class="table-of-contents__link toc-highlight">Setting Up the Backend with ASP.NET Core</a></li><li><a href="#connecting-the-frontend-with-the-aspnet-core-backend" class="table-of-contents__link toc-highlight">Connecting the Frontend with the ASP.NET Core Backend</a></li><li><a href="#deployment" class="table-of-contents__link toc-highlight">Deployment</a></li></ul></li></ul></div></div></div></div></div><footer><div></div></footer></div>
</body>
</html>