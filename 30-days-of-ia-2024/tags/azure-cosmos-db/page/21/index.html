<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-tags-post-list-page plugin-blog plugin-id-blog-30-days-of-ia-2024" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.0">
<title data-rh="true">26 posts tagged with &quot;azure-cosmos-db&quot; | Build Intelligent Apps On Azure</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="og:title" content="#IntelligentApps start today | Microsoft Azure"><meta data-rh="true" name="og:description" content="Develop adaptive, responsive, and personalized experiences by building and modernizing intelligent applications with Azure!"><meta data-rh="true" name="og:url" content="https://aka.ms/FallForIA"><meta data-rh="true" name="twitter:site" content="@AzureAdvocates"><meta data-rh="true" name="awa-env" content="Production"><meta data-rh="true" name="docusaurus_tag" content="blog_tags_posts"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_tags_posts"><meta data-rh="true" property="og:url" content="https://azure.github.io/cloud-native/deploy-with-aca"><meta data-rh="true" property="og:type" content="website"><meta data-rh="true" property="og:title" content="**Build Intelligent Apps | AI Apps on Azure"><meta data-rh="true" property="og:description" content="In today&#x27;s post we go from Prompty prototype to hosted API endpoint using the FastAPI framework with Azure Container Apps."><meta data-rh="true" property="og:image" content="https://github.com/Azure/Cloud-Native/blob/main/website/static/img/ogImage.png"><meta data-rh="true" name="twitter:url" content="https://azure.github.io/Cloud-Native/deploy-with-aca"><meta data-rh="true" name="twitter:title" content="**Build Intelligent Apps | AI Apps on Azure"><meta data-rh="true" name="twitter:description" content="In today&#x27;s post we go from Prompty prototype to hosted API endpoint using the FastAPI framework with Azure Container Apps."><meta data-rh="true" name="twitter:image" content="https://azure.github.io/Cloud-Native/img/ogImage.png"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" name="twitter:creator" content="@devanshidiaries"><link data-rh="true" rel="icon" href="/Cloud-Native/img/favicon.ico"><link data-rh="true" rel="alternate" href="https://azure.github.io/Cloud-Native/30-days-of-ia-2024/tags/azure-cosmos-db/page/21" hreflang="en"><link data-rh="true" rel="alternate" href="https://azure.github.io/Cloud-Native/30-days-of-ia-2024/tags/azure-cosmos-db/page/21" hreflang="x-default"><link data-rh="true" rel="canonical" href="https://azure.github.io/Cloud-Native/deploy-with-aca"><link rel="alternate" type="application/rss+xml" href="/Cloud-Native/blog/rss.xml" title="Build Intelligent Apps On Azure RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Cloud-Native/blog/atom.xml" title="Build Intelligent Apps On Azure Atom Feed">





<link rel="alternate" type="application/rss+xml" href="/Cloud-Native/cnny-2023/rss.xml" title="Build Intelligent Apps On Azure RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Cloud-Native/cnny-2023/atom.xml" title="Build Intelligent Apps On Azure Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/Cloud-Native/30DaysOfIA/rss.xml" title="Build Intelligent Apps On Azure RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Cloud-Native/30DaysOfIA/atom.xml" title="Build Intelligent Apps On Azure Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/Cloud-Native/60DaysOfIA/rss.xml" title="Build Intelligent Apps On Azure RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Cloud-Native/60DaysOfIA/atom.xml" title="Build Intelligent Apps On Azure Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/Cloud-Native/30-days-of-ia-2024/rss.xml" title="Build Intelligent Apps On Azure RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Cloud-Native/30-days-of-ia-2024/atom.xml" title="Build Intelligent Apps On Azure Atom Feed">
<script>!function(t,e,n,c,a,r,s){t[n]=t[n]||function(){(t[n].q=t[n].q||[]).push(arguments)},(r=e.createElement(c)).async=1,r.src="https://www.clarity.ms/tag/d61n997vq9",(s=e.getElementsByTagName(c)[0]).parentNode.insertBefore(r,s)}(window,document,"clarity","script")</script>

<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="https://js.monitor.azure.com/scripts/c/ms.analytics-web-3.min.js"></script><link rel="stylesheet" href="/Cloud-Native/assets/css/styles.c41badcd.css">
<script src="/Cloud-Native/assets/js/runtime~main.1aae2929.js" defer="defer"></script>
<script src="/Cloud-Native/assets/js/main.2244487d.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><header><div></div></header><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/Cloud-Native/"></a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="announcementBarBackground_Iz1u"><div class="container"><div class="row"><div class="col col--8 col--offset-2 announcementBarContainer_QNjo"><div class="col-demo"><p class="announcementBarContent_tvcd">Learn to use <a class="announcementLink_qKCm" target="_blank" href="https://developer.microsoft.com/reactor/events/23599/?ocid=biafy25h1_cn_webpage_azuremktg" data-bi-area="AnnouncementBar" data-bi-name="Announcement">Azure Functions OpenAI to ingest your own content</a> | Give us a üåü <a class="announcementLink_qKCm" target="_blank" href="https://github.com/azure/cloud-native" data-bi-area="AnnouncementBar" data-bi-name="Give us a star on GitHub">on GitHub</a></p></div></div><div class="col col--2 announcementBarIconContainer_GQot"><div class="col-demo"><a href="https://github.com/azure/cloud-native" target="_blank" class="icon_QeTG" aria-label="Visit us on GitHub"><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="#FFFFFF"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a><a href="https://azure.github.io/Cloud-Native/60DaysOfIA/rss.xml" target="_blank" class="icon_QeTG" aria-label="Subscribe to RSS"><svg width="24" height="24" viewBox="0 0 333333 333333" xmlns="http://www.w3.org/2000/svg" fill="#f49c4f"><path d="M166667 0c92048 0 166667 74619 166667 166667s-74619 166667-166667 166667S0 258715 0 166667 74619 0 166667 0zm-57698 203357c-11551 0-20938 9418-20938 20897 0 11537 9386 20857 20938 20857 11587 0 20967-9320 20967-20857 0-11479-9378-20897-20967-20897zm-20918-61899v30148c19632 0 38081 7677 51977 21585 13883 13868 21548 32406 21548 52114h30276c0-57254-46585-103838-103801-103838v-9zm38-53431v30154c70007 0 126979 57031 126979 127116l30235 3c0-86697-70539-157270-157212-157270l-2-3z"></path></svg></a><svg viewBox="0 0 24 24" width="24" height="24" class="icon_Kj6K"><path fill="white" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg></div></div></div></div></div><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">#30Days Of IA 2024</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/kick-off">Kick-off #30Days of IA</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/use-generative-ai-to-build-intelligent-apps">1.1 Use Generative AI to build intelligent apps</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/setting-up-your-development-environment-1">1.2a Setting up your development environment Part 1</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/setting-up-your-development-environment-2">1.2b Setting Up Your Development Environment Part 2</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/build-content-generation-app-part-1">1.3a Build Content Generation App Part 1</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/build-content-generation-app-part-2">1.3b Build Content Generation App Part 2</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/deploy-application-with-azure-app-service-part-1">1.4a Deploy application with Azure App Service Part 1</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/deploy-application-with-azure-app-service-part-2">1.4b Deploy application with Azure App Service Part 2</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/deploy-application-with-AKS-part-1">1.5a Deploy Application with AKS Part 1</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/deploy-application-with-AKS-part-2">1.5b Deploy Application with AKS Part 2</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/setting-up-ci-cd-pipelines-for-azure-app-servicea-and-aks-using-azure-devops-1">1.6a Setting Up CI/CD Pipelines for Azure App Service and AKS Using Azure DevOps Part 1</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/setting-up-ci-cd-pipelines-for-azure-app-servicea-and-aks-using-azure-devops-2">1.6b Setting Up CI/CD Pipelines for Azure App Service and AKS Using Azure DevOps Part 2</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/post-production-monitoring-scaling-and-optimization">1.7 Post-production monitoring, scaling, and optimization</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/demo-our-ai-based-content-generation-app">1.8 Demo our AI-based content generation app</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/how-it-works-behind-the-scenes-of-our-ai-based-content-generation-app">1.9 How it works: Behind the scenes of our AI-based content generation app</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/closing-summary">1.10 Closing Summary</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/kicking-off-azure-ai-week">2.1 Kicking Off Azure AI Week!</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/provision-with-azd">2.2 Provision With AZD!</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/ideate-with-prompty">2.3 Ideate with Prompty!</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/evaluate-with-ai">2.4 Evaluate with AI!</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/deploy-with-aca">2.5 Deploy with ACA</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/improving-the-developer-experience-with-modern-dev-tools">3.1 Improving the developer experience with modern dev tools</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/using-github-copilot">3.2 Using GitHub Copilot</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/simplifying-web-app-deployment-with-microsoft-copilot-in-azure">3.3 Simplifying web app deployment with Microsoft Copilot in Azure</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/hosting-considerations-for-scalable-apps-by-using-azure-app-service-and-azure-kubernetes-service">3.4 Hosting considerations for scalable apps by using Azure App Service and Azure Kubernetes Service (AKS)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/deploy-to-production-at-scale">3.5 Using continuous integration/continuous deployment (CI/CD) processes, monitoring, and AI to help ensure that your app can deploy to production at scale</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="https://schema.org/Blog"><header class="margin-bottom--xl"><h1>26 posts tagged with &quot;azure-cosmos-db&quot;</h1><a href="/Cloud-Native/30-days-of-ia-2024/tags">View All Tags</a></header><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="In today&#x27;s post we go from Prompty prototype to hosted API endpoint using the FastAPI framework with Azure Container Apps."><link itemprop="image" href="https://github.com/Azure/Cloud-Native/blob/main/website/static/img/ogImage.png"><meta itemprop="keywords" content="Cloud,Data,AI,AI/ML,intelligent apps,cloud-native,30-days-2024,30-days,enterprise apps,digital experiences,app modernization,serverless,ai apps"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/Cloud-Native/30-days-of-ia-2024/deploy-with-aca">2.5 Deploy with ACA</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2024-10-29T09:00:00.000Z" itemprop="datePublished">October 29, 2024</time> ¬∑ <!-- -->12 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/nitya" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/nitya.png" alt="Nitya Narasimhan" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/nitya" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Nitya Narasimhan</span></a></div><small class="avatar__subtitle" itemprop="description">Senior AI Advocate</small></div></div></div><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/marlenezw" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/marlenezw.png" alt="Marlene Mhangami" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/marlenezw" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Marlene Mhangami</span></a></div><small class="avatar__subtitle" itemprop="description">Senior Developer Advocate</small></div></div></div></div></header><div class="markdown" itemprop="articleBody">
<p>Welcome to Day 5Ô∏è‚É£ of Azure AI Week on the #30DaysOfIA series!</p>
<p><img loading="lazy" alt="Developer Workflow" src="/Cloud-Native/assets/images/05-developer-workflow-ea28bc208380d98a8041016271b8e50a.png" width="1433" height="448" class="img_ev3q"></p>
<p>In yesterday&#x27;s post, we <strong>evaluated</strong> our application for quality using 4 key metrics and a larger test inputs dataset. After getting acceptable results, it&#x27;s time to <strong>deploy</strong> the protoype to production. In today&#x27;s post we go from Prompty prototype to hosted API endpoint using the FastAPI framework with Azure Container Apps.</p>
<p>Ready? Let&#x27;s get started!</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-well-cover-today">What We&#x27;ll Cover Today<a href="#what-well-cover-today" class="hash-link" aria-label="Direct link to What We&#x27;ll Cover Today" title="Direct link to What We&#x27;ll Cover Today">‚Äã</a></h2>
<ul>
<li><strong>Build a FastAPI App</strong> - Create an API server for your copilot app</li>
<li><strong>Deploy with Azure Container Apps</strong> - Get a hosted API endpoint</li>
<li><strong>Testing your App Endpoint</strong> - Contoso Chat Example</li>
<li><strong>Monitoring for App Insights</strong> - Contoso Creative Writer Example</li>
<li><strong>Keep Learning</strong> - Resources For Self-Guided Study</li>
</ul>
<hr>
<p><img loading="lazy" alt="Card Banner" src="/Cloud-Native/assets/images/05-deploy-aca-247b2bf6b42b0aca87c9f2ccc6f038ec.png" width="960" height="403" class="img_ev3q"></p>
<br>
<p>In the previous sections, we used the Prompty runtime to generate Python code that we were able to run locally, for interactive testing (single input) or batch evaluation (input daatset). Now, we need to ready our application for deployment <strong>as a hosted API endpoint</strong> to a production environment.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1--create-a-fastapi-server">1 | Create a FastAPI Server<a href="#1--create-a-fastapi-server" class="hash-link" aria-label="Direct link to 1 | Create a FastAPI Server" title="Direct link to 1 | Create a FastAPI Server">‚Äã</a></h2>
<p>The first step is to create a <strong>server application</strong> that can expose an API endpoint through which copilot requests can be received, for processing and response. We used the <a href="https://fastapi.tiangolo.com/" target="_blank" rel="noopener noreferrer">FastAPI</a> framework - a modern, high-performance <strong>Python</strong> web framework for building and serving APIs.</p>
<ul>
<li>Run the FastAPI server <em>locally</em> using <code>fastapi dev ..</code> to get a development server with hot refresh. Changes you make to the code are visible immediately, making it easy to iterate quickly on your app.</li>
<li>Run the FastAPI server <em>in production</em> by using a compute service like Azure Container Apps. Simply package up the FastAPI application into a container image and deploy it to get a hosted API endpoint.</li>
</ul>
<p><strong>Let&#x27;s look at the Contoso Chat codebase to see this in action</strong>. The code block below reproduces a subset of the code from <a href="https://github.com/Azure-Samples/contoso-chat/blob/main/src/api/main.py" target="_blank" rel="noopener noreferrer"><code>contoso-chat/src/api/main.py</code></a> to show how we implement this. Code is annotated to explain the key steps in the process.</p>
<ol>
<li>We import the <code>get_response</code> function which is our Prompty-based chat function.</li>
<li>We load environment variables and create the FastAPI application instance.</li>
<li>We configure CORS middleware to allow requests from specified origins.</li>
<li>We set a default route (&quot;/&quot;) to return a message (&quot;Hello World&quot;) as a health check.</li>
<li>We define the <code>/api/create_response</code> route to be the entry point for our custom copilot.</li>
</ol>
<p>A copilot client (e.g., web application, cURL, or other API client) can now &quot;POST&quot; a request to the <code>/api/create_response</code> endpoint with the required input fields. The FastAPI server will pass these inputs to the <code>get_response</code> function and return the response back to the caller.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 1. The _get_response_ function is the entry point to the copilot code</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> contoso_chat</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">chat_request </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> get_response</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 2. Load the environment variables and create the FastAPI application</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">load_dotenv</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> FastAPI</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 3. Configure CORS middleware to allow requests from specified origins</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">code_space </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">getenv</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;CODESPACE_NAME&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app_insights </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">getenv</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;APPINSIGHTS_CONNECTIONSTRING&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> code_space</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    origin_8000</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;https://</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">code_space</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">-8000.app.github.dev&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    origin_5173 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;https://</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">code_space</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">-5173.app.github.dev&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ingestion_endpoint </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> app_insights</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;=&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    origins </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">origin_8000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> origin_5173</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">getenv</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;API_SERVICE_ACA_URI&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">getenv</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;WEB_SERVICE_ACA_URI&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ingestion_endpoint</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    origins </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        o</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">strip</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> o </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> Path</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Path</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">__file__</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">parent </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;origins.txt&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">read_text</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">splitlines</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    origins </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;*&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_middleware</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CORSMiddleware</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    allow_origins</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">origins</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    allow_credentials</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    allow_methods</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;*&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    allow_headers</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;*&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 4. Define the default route (&quot;/&quot;) to </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#     return a message (&quot;Hello World&quot;) as health check</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@app</span><span class="token decorator annotation punctuation" style="color:#393A34">.</span><span class="token decorator annotation punctuation" style="color:#393A34">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;/&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">root</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;message&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Hello World&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># (5) Define the &quot;/api/create_response&quot; route to </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#     accept a POST request with query data &amp; invoke _get_response_</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#     then return the response to the caller </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@app</span><span class="token decorator annotation punctuation" style="color:#393A34">.</span><span class="token decorator annotation punctuation" style="color:#393A34">post</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;/api/create_response&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@trace</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">create_response</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">question</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> customer_id</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> chat_history</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token builtin">dict</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> get_response</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">customer_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> question</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> chat_history</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> result</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2--deploy-azure-container-app">2 | Deploy Azure Container App<a href="#2--deploy-azure-container-app" class="hash-link" aria-label="Direct link to 2 | Deploy Azure Container App" title="Direct link to 2 | Deploy Azure Container App">‚Äã</a></h2>
<p>Next, we need to deploy the FastAPI application to Azure using a relevant compute option.  <a href="https://learn.microsoft.com/en-us/azure/developer/python/tutorial-containerize-simple-web-app?tabs=web-app-fastapi" target="_blank" rel="noopener noreferrer">Azure Container Apps makes this simple</a> requiring just a few steps. The links below point to the relevant files in the <strong>Contoso Chat</strong> sample as a reference.</p>
<ol>
<li>
<p><em>Create a <a href="https://github.com/Azure-Samples/contoso-creative-writer/blob/main/src/api/Dockerfile" target="_blank" rel="noopener noreferrer">Dockerfile</a>  and <a href="https://github.com/Azure-Samples/contoso-creative-writer/blob/main/src/.dockerignore" target="_blank" rel="noopener noreferrer">.dockerignore</a> files for your FastAPI application.</em> This instructs Docker how to build the container image for your application (and what to leave out).</p>
</li>
<li>
<p><em>Configure that application server with the right port and entry function to use.</em> In this case, we use the <code>fastapi</code> server, with <code>main.py</code> as entry point, running on port 80.</p>
</li>
<li>
<p><em>Provision the Azure Container Apps (ACA) resource on Azure</em>. In our case, we do this using <code>azd up</code> at the start, with configuration specified in <a href="https://github.com/Azure-Samples/contoso-chat/blob/main/infra/main.bicep" target="_blank" rel="noopener noreferrer">main.bicep</a>. The <code>azd provision</code> step creates the default ACA resource with the Application Uri showing this image on success.</p>
<p><img loading="lazy" alt="Default" src="/Cloud-Native/assets/images/05-aca-default-7d0f08b7981126cab8d7420582e91770.png" width="710" height="401" class="img_ev3q"></p>
</li>
<li>
<p><em>Deploy the updated application to Azure Container Apps</em>. As you make more code updates, you can use <code>az acr build</code> to build the container image and <code>az containerapp update</code> to update the deployed application - see this in action in the <code>azd</code> <a href="https://github.com/Azure-Samples/contoso-chat/blob/main/infra/hooks/postprovision.sh" target="_blank" rel="noopener noreferrer">postprovision script</a>. The <code>azd hooks run postprovision</code> step deploys the application to ACA, with the Application Uri showing this image when refreshed. <strong>Note that this corresponds to the health check message we defined in our FastAPI server for the default route (&quot;/&quot;)</strong>.</p>
<p><img loading="lazy" alt="Default" src="/Cloud-Native/assets/images/05-aca-fastapi-13b0d6717b7483b88222446c40ffd397.png" width="483" height="52" class="img_ev3q"></p>
</li>
</ol>
<p>Now, let&#x27;s learn to <em>test</em> our application in development (local) and in production (deployed).</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3--testing-your-app-endpoint">3 | Testing your App Endpoint<a href="#3--testing-your-app-endpoint" class="hash-link" aria-label="Direct link to 3 | Testing your App Endpoint" title="Direct link to 3 | Testing your App Endpoint">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="31-testing-in-production">3.1 Testing In Production<a href="#31-testing-in-production" class="hash-link" aria-label="Direct link to 3.1 Testing In Production" title="Direct link to 3.1 Testing In Production">‚Äã</a></h3>
<p>The FastAPI server comes with a built-in Swagger UI that you can use to test the API endpoint in production. Simply navigate to the <code>/docs</code> route of the default application URL - and you should see something like this. Clicking on the <code>Try it out</code> button makes the form editable, allowing you to submit a request (using the inputs defined in the API specification) and see the returned response (or error message) rendered back in the UI. We&#x27;ll see this in a minute.</p>
<p><img loading="lazy" alt="Testing in Production" src="/Cloud-Native/assets/images/05-fastapi-docs-0b3bd4bc058b608c08d7ff6cd3d6c493.png" width="1511" height="698" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="32-testing-locally">3.2 Testing Locally<a href="#32-testing-locally" class="hash-link" aria-label="Direct link to 3.2 Testing Locally" title="Direct link to 3.2 Testing Locally">‚Äã</a></h3>
<p>But first, let&#x27;s talk briefly about testing the FastAPI application <em>in development</em>. We can run the same server from the Visual Studio Code terminal using the command: <code>fastapi dev src/api/main.py</code> as shown:</p>
<p><img loading="lazy" alt="Default" src="/Cloud-Native/assets/images/05-fastapi-local-e40a605b1445e2d2395eb7d4ad677c26.png" width="870" height="598" class="img_ev3q"></p>
<p>When in GitHub Codespaces, this will prompt you to open the browser to a preview page - with port forwarding to the local server, allowing you to work with the same browser-based application experience you see in production. <em>Note however that the local server URL will end with a <code>github.dev</code> domain reflecting the Codespaces environment we are using.</em>.</p>
<p><img loading="lazy" alt="Default" src="/Cloud-Native/assets/images/05-fastapi-codespace-2580ea7ac7cc6408bb38b6e40c7844d5.png" width="953" height="701" class="img_ev3q"></p>
<p>The other thing to note is that the dev server has hot refresh - so changes you make to the code are reflected instantly. This means you can change the behavior of the <code>get_response</code> function - and you should see the result reflected when you invoke the <code>create_response</code> endpoint, without needing to restart the dev server at commandline.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="33-testing-the-copilot">3.3 Testing The Copilot<a href="#33-testing-the-copilot" class="hash-link" aria-label="Direct link to 3.3 Testing The Copilot" title="Direct link to 3.3 Testing The Copilot">‚Äã</a></h3>
<p>Let&#x27;s test the copilot by clicking <code>Try it out</code> in the Swagger UI. You can now edit the form fields to add values as shown. (Hint: you can use the sample input from the <code>chat.prompty</code> file if you need valid data).</p>
<p><img loading="lazy" alt="Testing in Production 2" src="/Cloud-Native/assets/images/05-fastapi-test-3e828e42cbae6ec9911779d489b65aac.png" width="1506" height="650" class="img_ev3q"></p>
<p>Here, we asked: <code>Tell me about camping stoves</code>. The response will be rendered right in the UI, and look something like this.</p>
<p><img loading="lazy" alt="Testing in Production 3" src="/Cloud-Native/assets/images/05-fastapi-response-eea287a6c16fae9175359201938895d7.png" width="722" height="329" class="img_ev3q"></p>
<p>More importantly, if you switch back to the VS Code terminal, you should see the output also printed to the console along with additional execution traces. <em>This makes it easy to debug the application in development</em>, and see log messages you may have instrumented in the code.</p>
<p><img loading="lazy" alt="Console" src="/Cloud-Native/assets/images/05-fastapi-console-6ff98b00844066074f4b8f10b87f7525.png" width="611" height="321" class="img_ev3q"></p>
<p>You can now test code changes at various levels, iterating rapidly in VS Code.</p>
<ol>
<li>Change the way the FastAPI server handles the request (in <code>src/api/main.py</code>)</li>
<li>Change the way the Prompty template behaves (in <code>src/api/contoso_chat/chat.prompty</code>)</li>
<li>Change the way the RAG flow is orchestrated (in <code>src/api/contoso_chat/chat_request.py</code>)</li>
</ol>
<p>The changes have an instant effect in the local dev server, so you can test them out using the Swagger UI before deploying to production. To <em>redeploy</em> to production, you can try using an <a href="https://learn.microsoft.com/en-us/azure/developer/python/tutorial-containerize-simple-web-app?tabs=web-app-fastapi#make-updates-and-redeploy" target="_blank" rel="noopener noreferrer">az containerapp up</a> for minor changes, or use the <code>az acr build</code> and <code>az containerapp update</code> commands together as explained before, for more complex update scenarios.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="4--monitoring-with-app-insights">4 | Monitoring with App Insights<a href="#4--monitoring-with-app-insights" class="hash-link" aria-label="Direct link to 4 | Monitoring with App Insights" title="Direct link to 4 | Monitoring with App Insights">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="41-what-is-app-insights">4.1 What is App Insights?<a href="#41-what-is-app-insights" class="hash-link" aria-label="Direct link to 4.1 What is App Insights?" title="Direct link to 4.1 What is App Insights?">‚Äã</a></h3>
<p>Once our application is deployed into production, we can use <a href="https://learn.microsoft.com/en-us/azure/azure-monitor/app/app-insights-overview" target="_blank" rel="noopener noreferrer">Azure Application Insights</a> to monitor and track everything about it. Application Insights provides many experiences to enhance the performance, reliability, and quality of applications. These can be grouped into 4 main categories:</p>
<ol>
<li>
<p><strong>Investigate:</strong> A comprehensive suite of tools for real-time monitoring, performance tracking, and issue diagnosis, providing insights into your application&#x27;s health and architecture.</p>
</li>
<li>
<p><strong>Monitoring:</strong> Visualizations of metrics, logs, and alerts, allowing proactive monitoring and customization of reports for application health and operational data.</p>
</li>
<li>
<p><strong>Usage:</strong> Provides insights into user behavior, allowing you to track interactions, visualize user journeys, and analyze engagement to improve app performance.</p>
</li>
<li>
<p><strong>Code analysis:</strong> Focuses on optimizing application code and performance, using tools like a profiler and AI-driven insights to improve efficiency and resolve issues quickly.</p>
</li>
</ol>
<p><img loading="lazy" alt="App insights" src="/Cloud-Native/assets/images/app_insights_logic-f990d6bf954da0f1bc05b3f8c1945155.png" width="2756" height="1170" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="42-app-insights-dashboard">4.2 App Insights Dashboard<a href="#42-app-insights-dashboard" class="hash-link" aria-label="Direct link to 4.2 App Insights Dashboard" title="Direct link to 4.2 App Insights Dashboard">‚Äã</a></h3>
<p>In Contoso Creative Writer we utilize the <a href="https://learn.microsoft.com/en-us/azure/azure-monitor/app/overview-dashboard" target="_blank" rel="noopener noreferrer">App Insights Dashboard</a> to access realtime information about our deployed application through a dashboard in Azure Portal. The dashboard provides an overview pane to allow at-a-glance assessment of our application&#x27;s health and performance. We can also can also use Application Insights to track custom information, and add it to our dashboard. In this case we want to add the evaluation scores and LLM token information we got from the running the evaluations and Prompty tracing we saw in <a href="https://azure.github.io/Cloud-Native/30-days-of-ia-2024/evaluate-with-ai" target="_blank" rel="noopener noreferrer">yesterday&#x27;s post</a>.</p>
<p>To enable custom insights in Contoso Creative Writer we added the following code to a <a href="https://github.com/Azure-Samples/contoso-creative-writer/blob/a304cc691d1657b6d1e93e18df871de37633efb9/src/api/tracing.py#L51" target="_blank" rel="noopener noreferrer">tracing.py</a> file.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> prompty</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tracer </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Tracer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> PromptyTracer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> opentelemetry </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> trace </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> oteltrace</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> opentelemetry </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> trace</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> opentelemetry</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sdk</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">trace </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> TracerProvider</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> opentelemetry</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sdk</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">trace</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">export </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> BatchSpanProcessor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> opentelemetry</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sdk</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">trace</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">export </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> SimpleSpanProcessor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> opentelemetry</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sdk</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">trace</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sampling </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> ParentBasedTraceIdRatio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> azure</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">monitor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">opentelemetry</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">exporter </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> AzureMonitorTraceExporter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">_tracer </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;prompty&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@contextlib</span><span class="token decorator annotation punctuation" style="color:#393A34">.</span><span class="token decorator annotation punctuation" style="color:#393A34">contextmanager</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">trace_span</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tracer </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> oteltrace</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_tracer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_tracer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> tracer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">start_as_current_span</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> span</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">verbose_trace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token builtin">isinstance</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">dict</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">                </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> k</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> v </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> value</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">items</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">                  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    verbose_trace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">key</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">.</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">k</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> v</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">                </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                span</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">set_attribute</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">key</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">yield</span><span class="token plain"> verbose_trace</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">init_tracing</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">local_tracing</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">bool</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    Initialize tracing for the application</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    If local_tracing is True, use the PromptyTracer</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    If remote_tracing is True, use the OpenTelemetry tracer</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    If remote_tracing is not specified, defaults to using the OpenTelemetry tracer only if local_tracing is False</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> local_tracing</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        local_trace </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> PromptyTracer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Tracer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;PromptyTracer&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> local_trace</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tracer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Tracer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;OpenTelemetry&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> trace_span</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        azmon_logger </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> logging</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">getLogger</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;azure&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        azmon_logger</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">setLevel</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">logging</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">INFO</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># Configure Azure Monitor as the Exporter</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        app_insights </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">getenv</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;APPINSIGHTS_CONNECTIONSTRING&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># Add the Azure exporter to the tracer provider</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        oteltrace</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">set_tracer_provider</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">TracerProvider</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sampler</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">ParentBasedTraceIdRatio</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1.0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        oteltrace</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_tracer_provider</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_span_processor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">BatchSpanProcessor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">AzureMonitorTraceExporter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">connection_string</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">app_insights</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> oteltrace</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_tracer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_tracer</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>For sending tracing insights from the app to the dashboard we use the Prompty Tracer alongside the <a href="https://learn.microsoft.com/en-us/azure/azure-monitor/app/opentelemetry-enable?tabs=python" target="_blank" rel="noopener noreferrer">Opentelemetry</a> Python package. The connection string (which is automatically generated when you run <code>azd up</code> for this sample) is unique and specifies where the Azure Monitor OpenTelemetry Distro sends the telemetry it collects. When our application is running in production, and we open Application Insights in the Azure portal the following data can be seen in the dashboard. (It might take a few minutes for data to show up.)</p>
<p><img loading="lazy" alt="App Insights" src="/Cloud-Native/assets/images/app_insights-2a430a88c32738fdb11722e7d244e7a0.png" width="2826" height="1876" class="img_ev3q"></p>
<p>Our dashboard now provides extensive information from LLM calls, token usage, and various evaluation metrics. This provides detailed insights into performance and helps identify areas of improvement or any issues that may arise. For example, by visualizing token usage over time, businesses can track cost and performance metrics, making it easier to make decisons. We can also look at average evaluation scores, such as relevance, fluency, and coherence, which can be viewed in real-time, providing a clear understanding of the quality of LLM-generated outputs.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="5---wrap-up--next-steps">5 |  Wrap-up &amp; Next Steps<a href="#5---wrap-up--next-steps" class="hash-link" aria-label="Direct link to 5 |  Wrap-up &amp; Next Steps" title="Direct link to 5 |  Wrap-up &amp; Next Steps">‚Äã</a></h2>
<p>We made it!! Thank you for following along with us all through Azure AI Week on the #30DaysOfIA series! Let&#x27;s quickly recap what we covered over these 5 days.</p>
<ol>
<li><strong>Kickoff</strong> - We introduced two signature use cases for our copilot - Contoso Chat and Contoso Creative Writer - and introduced the end-to-end workflow that both samples follow, for code-first development on Azure AI Studio with Prompty assets.</li>
<li><strong>Provision &amp; Setup</strong> - Next, we walked through how we provisioned the application architectures for each sample (with <code>azd</code>) and launched a pre-built development environment for each sample (using GitHub Codespaces) connected to that infra.&#x27;</li>
<li><strong>Ideate</strong> - We then began the first stage of our GenAIOps lifecycle by going from prompt to prototype, using Prompty assets, tooling, and runtime. We learned how to use Prompty to shape the data (for RAG) and help orchestrate flows (for Agentic AI).</li>
<li><strong>Evaluate</strong> - We learned about AI-Assisted evaluation flows, quality and safety assessment metrics, and the process for crafting custom evaluators with Prompty. We also learned about support for observability in Prompty, with tracing options and a built-in viewer.</li>
<li><strong>Deploy</strong> - Finally, we learned how to use FastAPI to create a server app, deploy it using Azure Container Apps, and test it in development and production using a built-in UI that allows us to iterate quickly to improve app quality, debug issue, or evolve functionality.</li>
</ol>
<p><img loading="lazy" alt="Developer Workflow" src="/Cloud-Native/assets/images/05-developer-workflow-ea28bc208380d98a8041016271b8e50a.png" width="1433" height="448" class="img_ev3q"></p>
<p>Found this series useful and want to keep going? Here are a few things you can do to continue your learning journey!</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>&quot;Want to get hands-on experience building intelligent apps on Azure?&quot;</p></div></div>
<p>Take these actions today, to jumpstart your skilling journey:</p>
<ul>
<li><a href="https://aka.ms/aitour" target="_blank" rel="noopener noreferrer">Register for Microsoft AI Tour</a> - join an instructor-led workshop session.</li>
<li><a href="https://ignite.microsoft.com/sessions" target="_blank" rel="noopener noreferrer">Register for Microsoft Ignite</a> - look for related lab &amp; breakout sessions on Azure AI.</li>
<li><a href="https://aka.ms/azd-ai-templates" target="_blank" rel="noopener noreferrer">Browse the AI Templates Collection</a> - explore samples for new frameworks and scenarios.</li>
</ul>
<hr></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Cloud-Native/30-days-of-ia-2024/tags/build-intelligent-apps">Build-Intelligent-Apps</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Cloud-Native/30-days-of-ia-2024/tags/30-days-of-ia-2024">30-days-of-IA-2024</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Cloud-Native/30-days-of-ia-2024/tags/learn-live">learn-live</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Cloud-Native/30-days-of-ia-2024/tags/demo-bytes">demo-bytes</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Cloud-Native/30-days-of-ia-2024/tags/community-gallery">community-gallery</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Cloud-Native/30-days-of-ia-2024/tags/azure-kubernetes-service">azure-kubernetes-service</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Cloud-Native/30-days-of-ia-2024/tags/azure-functions">azure-functions</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Cloud-Native/30-days-of-ia-2024/tags/azure-openai">azure-openai</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Cloud-Native/30-days-of-ia-2024/tags/azure-container-apps">azure-container-apps</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Cloud-Native/30-days-of-ia-2024/tags/azure-cosmos-db">azure-cosmos-db</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Cloud-Native/30-days-of-ia-2024/tags/github-copilot">github-copilot</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Cloud-Native/30-days-of-ia-2024/tags/github-codespaces">github-codespaces</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Cloud-Native/30-days-of-ia-2024/tags/github-actions">github-actions</a></li></ul></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/Cloud-Native/30-days-of-ia-2024/tags/azure-cosmos-db/page/20"><div class="pagination-nav__label">Newer Entries</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/Cloud-Native/30-days-of-ia-2024/tags/azure-cosmos-db/page/22"><div class="pagination-nav__label">Older Entries</div></a></nav></main></div></div></div><footer><div></div></footer></div>
</body>
</html>