<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-tags-post-list-page plugin-blog plugin-id-blog-30-days-of-ia-2024" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.0">
<title data-rh="true">26 posts tagged with &quot;azure-container-apps&quot; | AI Apps and Agents - Microsoft Azure</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="og:title" content="AI Apps and Agents | Microsoft Azure"><meta data-rh="true" name="og:description" content="Develop adaptive, responsive, and personalized experiences by building and modernizing intelligent applications with Azure!"><meta data-rh="true" name="og:url" content="https://aka.ms/FallForIA"><meta data-rh="true" name="twitter:site" content="@AzureAdvocates"><meta data-rh="true" name="awa-env" content="Production"><meta data-rh="true" name="docusaurus_tag" content="blog_tags_posts"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_tags_posts"><meta data-rh="true" property="og:url" content="https://azure.github.io/cloud-native/30-days-of-ia-2024/deploy-application-with-azure-app-service-part-1"><meta data-rh="true" property="og:type" content="website"><meta data-rh="true" property="og:title" content="**Build Intelligent Apps | AI Apps on Azure"><meta data-rh="true" property="og:description" content="In this section, we will configure Azure API Management (APIM) to define and secure our APIs, and then use Azure Key Vault to securely store and access the required secrets for these APIs. This setup ensures that all API endpoints are protected and that sensitive information is securely managed."><meta data-rh="true" property="og:image" content="https://github.com/Azure/Cloud-Native/blob/main/website/static/img/ogImage.png"><meta data-rh="true" name="twitter:url" content="https://azure.github.io/Cloud-Native/30-days-of-ia-2024/deploy-application-with-azure-app-service-part-1"><meta data-rh="true" name="twitter:title" content="**Build Intelligent Apps | AI Apps on Azure"><meta data-rh="true" name="twitter:description" content="In this section, we will configure Azure API Management (APIM) to define and secure our APIs, and then use Azure Key Vault to securely store and access the required secrets for these APIs. This setup ensures that all API endpoints are protected and that sensitive information is securely managed."><meta data-rh="true" name="twitter:image" content="https://azure.github.io/Cloud-Native/img/ogImage.png"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" name="twitter:creator" content="@devanshidiaries"><link data-rh="true" rel="icon" href="/Cloud-Native/img/favicon.ico"><link data-rh="true" rel="alternate" href="https://azure.github.io/Cloud-Native/30-days-of-ia-2024/tags/azure-container-apps/page/7" hreflang="en"><link data-rh="true" rel="alternate" href="https://azure.github.io/Cloud-Native/30-days-of-ia-2024/tags/azure-container-apps/page/7" hreflang="x-default"><link data-rh="true" rel="canonical" href="https://azure.github.io/Cloud-Native/30-days-of-ia-2024/deploy-application-with-azure-app-service-part-1"><link rel="alternate" type="application/rss+xml" href="/Cloud-Native/blog/rss.xml" title="AI Apps and Agents - Microsoft Azure RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Cloud-Native/blog/atom.xml" title="AI Apps and Agents - Microsoft Azure Atom Feed">





<link rel="alternate" type="application/rss+xml" href="/Cloud-Native/cnny-2023/rss.xml" title="AI Apps and Agents - Microsoft Azure RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Cloud-Native/cnny-2023/atom.xml" title="AI Apps and Agents - Microsoft Azure Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/Cloud-Native/30DaysOfIA/rss.xml" title="AI Apps and Agents - Microsoft Azure RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Cloud-Native/30DaysOfIA/atom.xml" title="AI Apps and Agents - Microsoft Azure Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/Cloud-Native/60DaysOfIA/rss.xml" title="AI Apps and Agents - Microsoft Azure RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Cloud-Native/60DaysOfIA/atom.xml" title="AI Apps and Agents - Microsoft Azure Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/Cloud-Native/30-days-of-ia-2024/rss.xml" title="AI Apps and Agents - Microsoft Azure RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Cloud-Native/30-days-of-ia-2024/atom.xml" title="AI Apps and Agents - Microsoft Azure Atom Feed">
<script>!function(t,e,n,c,a,r,s){t[n]=t[n]||function(){(t[n].q=t[n].q||[]).push(arguments)},(r=e.createElement(c)).async=1,r.src="https://www.clarity.ms/tag/d61n997vq9",(s=e.getElementsByTagName(c)[0]).parentNode.insertBefore(r,s)}(window,document,"clarity","script")</script>

<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="https://js.monitor.azure.com/scripts/c/ms.analytics-web-3.min.js"></script><link rel="stylesheet" href="/Cloud-Native/assets/css/styles.149fd0a3.css">
<script src="/Cloud-Native/assets/js/runtime~main.393a2b19.js" defer="defer"></script>
<script src="/Cloud-Native/assets/js/main.deaf60a5.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><header><div></div></header><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/Cloud-Native/"></a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="announcementBarBackground_Iz1u"><div class="container"><div class="row"><div class="col col--8 col--offset-2 announcementBarContainer_QNjo"><div class="col-demo"><p class="announcementBarContent_tvcd">Join us Apr 9-10 at  <a class="announcementLink_qKCm" target="_blank" href="https://jdconf.com/?ocid=biafy25h1_cn_webpage_azuremktg" data-bi-area="AnnouncementBar" data-bi-name="Announcement">Microsoft JDConf 2025</a> | Give us a ðŸŒŸ <a class="announcementLink_qKCm" target="_blank" href="https://github.com/azure/cloud-native" data-bi-area="AnnouncementBar" data-bi-name="Give us a star on GitHub">on GitHub</a></p></div></div><div class="col col--2 announcementBarIconContainer_GQot"><div class="col-demo"><a href="https://github.com/azure/cloud-native" target="_blank" class="icon_QeTG" aria-label="Visit us on GitHub"><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="#FFFFFF"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a><a href="https://azure.github.io/Cloud-Native/60DaysOfIA/rss.xml" target="_blank" class="icon_QeTG" aria-label="Subscribe to RSS"><svg width="24" height="24" viewBox="0 0 333333 333333" xmlns="http://www.w3.org/2000/svg" fill="#f49c4f"><path d="M166667 0c92048 0 166667 74619 166667 166667s-74619 166667-166667 166667S0 258715 0 166667 74619 0 166667 0zm-57698 203357c-11551 0-20938 9418-20938 20897 0 11537 9386 20857 20938 20857 11587 0 20967-9320 20967-20857 0-11479-9378-20897-20967-20897zm-20918-61899v30148c19632 0 38081 7677 51977 21585 13883 13868 21548 32406 21548 52114h30276c0-57254-46585-103838-103801-103838v-9zm38-53431v30154c70007 0 126979 57031 126979 127116l30235 3c0-86697-70539-157270-157212-157270l-2-3z"></path></svg></a><svg viewBox="0 0 24 24" width="24" height="24" class="icon_Kj6K"><path fill="white" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg></div></div></div></div></div><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">#30Days Of IA 2024</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/kick-off">Kick-off #30Days of IA</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/use-generative-ai-to-build-intelligent-apps">1.1 Use Generative AI to build intelligent apps</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/setting-up-your-development-environment-1">1.2a Setting up your development environment Part 1</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/setting-up-your-development-environment-2">1.2b Setting Up Your Development Environment Part 2</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/build-content-generation-app-part-1">1.3a Build Content Generation App Part 1</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/build-content-generation-app-part-2">1.3b Build Content Generation App Part 2</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/deploy-application-with-azure-app-service-part-1">1.4a Deploy application with Azure App Service Part 1</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/deploy-application-with-azure-app-service-part-2">1.4b Deploy application with Azure App Service Part 2</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/deploy-application-with-AKS-part-1">1.5a Deploy Application with AKS Part 1</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/deploy-application-with-AKS-part-2">1.5b Deploy Application with AKS Part 2</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/setting-up-ci-cd-pipelines-for-azure-app-servicea-and-aks-using-azure-devops-1">1.6a Setting Up CI/CD Pipelines for Azure App Service and AKS Using Azure DevOps Part 1</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/setting-up-ci-cd-pipelines-for-azure-app-servicea-and-aks-using-azure-devops-2">1.6b Setting Up CI/CD Pipelines for Azure App Service and AKS Using Azure DevOps Part 2</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/post-production-monitoring-scaling-and-optimization">1.7 Post-production monitoring, scaling, and optimization</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/demo-our-ai-based-content-generation-app">1.8 Demo our AI-based content generation app</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/how-it-works-behind-the-scenes-of-our-ai-based-content-generation-app">1.9 How it works: Behind the scenes of our AI-based content generation app</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/closing-summary">1.10 Closing Summary</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/kicking-off-azure-ai-week">2.1 Kicking Off Azure AI Week!</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/provision-with-azd">2.2 Provision With AZD!</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/ideate-with-prompty">2.3 Ideate with Prompty!</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/evaluate-with-ai">2.4 Evaluate with AI!</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/deploy-with-aca">2.5 Deploy with ACA</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/improving-the-developer-experience-with-modern-dev-tools">3.1 Improving the developer experience with modern dev tools</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/using-github-copilot">3.2 Using GitHub Copilot</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/simplifying-web-app-deployment-with-microsoft-copilot-in-azure">3.3 Simplifying web app deployment with Microsoft Copilot in Azure</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/hosting-considerations-for-scalable-apps-by-using-azure-app-service-and-azure-kubernetes-service">3.4 Hosting considerations for scalable apps by using Azure App Service and Azure Kubernetes Service (AKS)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Cloud-Native/30-days-of-ia-2024/deploy-to-production-at-scale">3.5 Using continuous integration/continuous deployment (CI/CD) processes, monitoring, and AI to help ensure that your app can deploy to production at scale</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="https://schema.org/Blog"><header class="margin-bottom--xl"><h1>26 posts tagged with &quot;azure-container-apps&quot;</h1><a href="/Cloud-Native/30-days-of-ia-2024/tags">View All Tags</a></header><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="In this section, we will configure Azure API Management (APIM) to define and secure our APIs, and then use Azure Key Vault to securely store and access the required secrets for these APIs. This setup ensures that all API endpoints are protected and that sensitive information is securely managed."><link itemprop="image" href="https://github.com/Azure/Cloud-Native/blob/main/website/static/img/ogImage.png"><meta itemprop="keywords" content="Cloud,Data,AI,AI/ML,intelligent apps,cloud-native,30-days-2024,30-days,enterprise apps,digital experiences,app modernization,serverless,ai apps"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/Cloud-Native/30-days-of-ia-2024/deploy-application-with-azure-app-service-part-1">1.4a Deploy application with Azure App Service Part 1</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2024-10-09T09:02:00.000Z" itemprop="datePublished">October 9, 2024</time> Â· <!-- -->12 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://azure.github.io/Cloud-Native/Build-IA/" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://azure.github.io/Cloud-Native/img/logo-2024.png" alt="#30Days Of IA" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://azure.github.io/Cloud-Native/Build-IA/" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">#30Days Of IA</span></a></div><small class="avatar__subtitle" itemprop="description">BuildIA Content Team</small></div></div></div></div></header><div class="markdown" itemprop="articleBody">
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="part-1-securing-application-with-azure-api-management-and-key-vault-integration">Part 1: Securing Application with Azure API Management and Key Vault Integration<a href="#part-1-securing-application-with-azure-api-management-and-key-vault-integration" class="hash-link" aria-label="Direct link to Part 1: Securing Application with Azure API Management and Key Vault Integration" title="Direct link to Part 1: Securing Application with Azure API Management and Key Vault Integration">â€‹</a></h2>
<p>In this section, we will configure <strong><a href="https://learn.microsoft.com/azure/api-management/api-management-key-concepts" target="_blank" rel="noopener noreferrer">Azure API Management (APIM)</a></strong> to define and secure our APIs, and then use <strong><a href="https://learn.microsoft.com/azure/key-vault/general/overview" target="_blank" rel="noopener noreferrer">Azure Key Vault</a></strong> to securely store and access the required secrets for these APIs. This setup ensures that all API endpoints are protected and that sensitive information is securely managed.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-we-will-cover">What we will cover:<a href="#what-we-will-cover" class="hash-link" aria-label="Direct link to What we will cover:" title="Direct link to What we will cover:">â€‹</a></h2>
<ol>
<li>Defining and Adding APIs to <strong>Azure API Management</strong></li>
<li>Configuring <strong>Azure Key Vault</strong> and Granting Accessâ€¯</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">â€‹</a></h2>
<p>In our previous blog post, we ran the application locally to verify its functionality. Now, we will focus on securing the APIs and managing sensitive data before deploying the application. First, we will define and add the necessary APIs for the back-end and middleware services using <strong>Azure API Management (APIM)</strong>. After configuring APIM, we will set up <strong>Azure Key Vault</strong> to securely store API keys and other sensitive information and grant secure access to these secrets using <a href="https://learn.microsoft.com/azure/app-service/overview-managed-identity?tabs=portal%2Chttp?ocid=biafy25h1_30daysofia_webpage_azuremktg" target="_blank" rel="noopener noreferrer">Managed Identities</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="step-1-defining-and-adding-apis-to-azure-api-management-apim">Step 1: Defining and Adding APIs to Azure API Management (APIM)<a href="#step-1-defining-and-adding-apis-to-azure-api-management-apim" class="hash-link" aria-label="Direct link to Step 1: Defining and Adding APIs to Azure API Management (APIM)" title="Direct link to Step 1: Defining and Adding APIs to Azure API Management (APIM)">â€‹</a></h2>
<p>We will start by creating and configuring the APIs for both back-end and middleware services in <strong>Azure API Management (APIM)</strong>. Each service will have its own set of operations that clients can interact with.â€¯</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="11-define-and-add-apis-to-apim">1.1 Define and Add APIs to APIMâ€¯<a href="#11-define-and-add-apis-to-apim" class="hash-link" aria-label="Direct link to 1.1 Define and Add APIs to APIMâ€¯" title="Direct link to 1.1 Define and Add APIs to APIMâ€¯">â€‹</a></h3>
<p>To add and configure the APIs for both back-end and middleware services, follow these steps:â€¯</p>
<ol>
<li><strong>Navigate to the Azure API Management Service:</strong>
<ul>
<li>Go to the <strong>Azure portal</strong>.</li>
<li>Select your <strong>API Management instance</strong>.</li>
<li>Click on <strong>APIs</strong> and then select <strong>+ Add API</strong>.</li>
</ul>
</li>
</ol>
<p>The screenshot shows the navigation to the &quot;APIs&quot; section in Azure API Management.</p>
<p><img loading="lazy" alt="a screenshot shows the navigation to the &amp;quot;APIs&amp;quot; section in Azure API Management" src="/Cloud-Native/assets/images/1-4a-1-196892894326d0d621f5cdf18ac566d5.png" width="436" height="464" class="img_ev3q"></p>
<ol start="2">
<li>
<p><strong>Select the API Type:</strong></p>
<ul>
<li>Choose <strong>HTTP</strong> as the API type since we are exposing HTTP endpoints.</li>
</ul>
</li>
</ol>
<p>The screenshot shows the &quot;Add API&quot; button and the selection of the <strong>HTTP</strong> type.â€¯</p>
<p><img loading="lazy" alt="screenshot shows the &amp;quot;Add API&amp;quot; button and the selection of the HTTP type" src="/Cloud-Native/assets/images/1-4a-2-81b8ab6faf39be49fe682ad0007a4aaa.png" width="1430" height="490" class="img_ev3q"></p>
<ol start="3">
<li><strong>Configure the API Details</strong>:<!-- -->
<ul>
<li>For each API, configure the following settings:<!-- -->
<ul>
<li><strong>Display Name:</strong> Name of the API (e.g., <code>Product API</code> for back-end, <code>Generate Content API</code> for middleware).</li>
<li><strong>Name:</strong> A unique identifier for the API (e.g., <code>products</code>, <code>generate-content</code>).</li>
<li><strong>URL:</strong> The relative path for the API endpoint (e.g., <code>/api/v1/products</code> for Product List, <code>/api/v1/generate/content</code> for content generation).</li>
<li><strong>Method:</strong> Choose the HTTP method (e.g., <code>GET</code>, <code>POST</code>).</li>
</ul>
</li>
<li>Click <strong>Create</strong> to add the API.</li>
</ul>
</li>
</ol>
<p><img loading="lazy" alt="screenshot of HTTP API configuration for backend_service_app_service_URL" src="/Cloud-Native/assets/images/1-4a-3-33510a3f3478da9296b84226457770bb.png" width="1432" height="493" class="img_ev3q"></p>
<p><img loading="lazy" alt="screenshot of HTTP API configuration for backend_service_app_service_URL" src="/Cloud-Native/assets/images/1-4a-4-1d3aa12245615c3d557552cb464b8b00.png" width="1429" height="678" class="img_ev3q"></p>
<p><img loading="lazy" alt="screenshot of HTTP API configuration for middleware_service_app_service_URL" src="/Cloud-Native/assets/images/1-4a-5-1d3aa12245615c3d557552cb464b8b00.png" width="1429" height="678" class="img_ev3q"></p>
<p><img loading="lazy" alt="screenshot of API fields in Azure portal" src="/Cloud-Native/assets/images/1-4a-6-7dc8143e0e2c405eaaf347636170ab40.png" width="1429" height="678" class="img_ev3q"></p>
<ol start="4">
<li>
<p><strong>Add Operations for Each API:</strong></p>
<ul>
<li>After the API is created, add operations that define specific actions for the API. Follow these steps for both back-end and middleware services:<!-- -->
<ul>
<li><strong>Back-end Service Operations:</strong>
<ul>
<li><code>GET /api/v1/products</code>: Retrieves a list of products.</li>
<li><code>POST /api/v1/products/similar</code>: Returns similar products based on the request body.</li>
</ul>
</li>
<li><strong>Middleware Service Operations:</strong>
<ul>
<li><code>POST /api/v1/generate/content</code>: Generates content based on input data.</li>
<li><code>POST /api/v1/generate/embeddings</code>: Generates embeddings based on input data.</li>
</ul>
</li>
</ul>
</li>
<li>For each operation, configure the following:<!-- -->
<ul>
<li><strong>Operation Name</strong>: A descriptive name for the operation (e.g., &quot;<code>Get Product List</code>&quot;, &quot;<code>Generate Content</code>&quot;).</li>
<li><strong>Method</strong>: HTTP method (<code>GET</code> or <code>POST</code>).</li>
<li><strong>URL</strong>: Relative URL path.</li>
<li><strong>Request Body/Parameters</strong>: Define any request body or parameters required for the operation.</li>
</ul>
</li>
<li>Click <strong>Save</strong> to add the operation.</li>
</ul>
</li>
</ol>
<p><img loading="lazy" alt="screenshot of ai-study-middleware-apim fields in Azure portal" src="/Cloud-Native/assets/images/1-4a-7-7dc8143e0e2c405eaaf347636170ab40.png" width="1429" height="678" class="img_ev3q"></p>
<p><img loading="lazy" alt="screenshot of ai-study-middleware-apim POST fields in Azure portal" src="/Cloud-Native/assets/images/1-4a-8-5eb3a0804fb2fe87d4e3b088d505df5d.png" width="1429" height="678" class="img_ev3q"></p>
<p><img loading="lazy" alt="screenshot of ai-study-backend-apim fields in Azure portal" src="/Cloud-Native/assets/images/1-4a-9-4e6992ae8b4de8f2eb013e711117f4c3.png" width="1429" height="678" class="img_ev3q"></p>
<ol start="5">
<li><strong>Configure Security Policies for the APIs:</strong>
<ul>
<li>After adding the APIs, go to the <strong>Design</strong> tab for each API and add security policies.<!-- -->
<ul>
<li><strong>Header Check Policy</strong>: Validate the presence of an API key.</li>
<li><strong>CORS Policy</strong>: Allow only specific origins to access the API endpoints.</li>
<li><strong>Rate Limit Policy</strong>: Limit the number of requests a client can make to the API within a specified time frameâ€¯</li>
</ul>
</li>
</ul>
</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="header-check-policy">Header Check Policy:<a href="#header-check-policy" class="hash-link" aria-label="Direct link to Header Check Policy:" title="Direct link to Header Check Policy:">â€‹</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;check-header name=&quot;api-key&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">failed-check-httpcode=&quot;401&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">failed-check-error-message=&quot;API Key Invalid or Not Found&quot; ignore-case=&quot;true&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â€¯â€¯â€¯ &lt;value&gt;API_ACCESS_KEY&lt;/value&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/check-header&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="cors-policy">CORS Policy:<a href="#cors-policy" class="hash-link" aria-label="Direct link to CORS Policy:" title="Direct link to CORS Policy:">â€‹</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;cors allow-credentials=&quot;false&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;allowed-origins&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;origin&gt;APP_SERVICE_URL&lt;/origin&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/allowed-origins&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;allowed-methods&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;method&gt;GET&lt;/method&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;method&gt;POST&lt;/method&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/allowed-methods&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/cors&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="rate-limit-policy">Rate Limit Policy:<a href="#rate-limit-policy" class="hash-link" aria-label="Direct link to Rate Limit Policy:" title="Direct link to Rate Limit Policy:">â€‹</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;rate-limit calls=&quot;100&quot; renewal-period=&quot;60&quot; /&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>This policy limits each client to 100 requests per minute.</li>
</ul>
<p><img loading="lazy" alt="screenshot of code response" src="/Cloud-Native/assets/images/1-4a-10-3e353a50bbe4c31c111667064bbceb55.png" width="1429" height="607" class="img_ev3q"></p>
<ol start="6">
<li><strong>Verify the API Configuration:</strong>
<ul>
<li>Once the APIs and operations are defined and secured, verify the configuration by using the <strong>Test</strong> feature in Azure API Management.â€¯</li>
<li>Make a sample request to each endpoint to ensure that they respond correctly.This testing will occur after the application has been deployed for both the back-end and middleware services.</li>
</ul>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="azure-cli-instructions">Azure CLI instructions<a href="#azure-cli-instructions" class="hash-link" aria-label="Direct link to Azure CLI instructions" title="Direct link to Azure CLI instructions">â€‹</a></h3>
<p>You can create and configure all of the APIs used by our back-end and middleware services by saving and running the following script:</p>
<p>Shell script: Create API and add policy (<code>create-api.sh</code>)</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/bashâ€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Function to display helpâ€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">function display_help() {â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  echo &quot;Usage: $0 -g &lt;resource-group&gt; -b &lt;backend-url&gt; -m &lt;middleware-url&gt; -f &lt;frontend-url&gt; -ba &lt;backend-apim-name&gt; -ma &lt;middleware-apim-name&gt; [--backend-api-key &lt;backend-api-key&gt;] [--middleware-api-key &lt;middleware-api-key&gt;]&quot;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  echoâ€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  echo &quot;Options:&quot;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  echo &quot;  -g, --resource-group              Azure Resource Group&quot;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  echo &quot;  -b, --backend-url                 Backend service URL&quot;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  echo &quot;  -m, --middleware-url              Middleware service URL&quot;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  echo &quot;  -f, --frontend-url                Frontend service URL&quot;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  echo &quot;  -ba, --backend-apim-name          Backend API Management name&quot;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  echo &quot;  -ma, --middleware-apim-name       Middleware API Management name&quot;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  echo &quot;  --backend-api-key                 (Optional) API Key for Backend service&quot;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  echo &quot;  --middleware-api-key              (Optional) API Key for Middleware service&quot;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  echo &quot;  -h, --help                        Display this help message&quot;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  exit 0â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Function to generate API key if not providedâ€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">function generate_api_key() {â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  echo $(uuidgen)â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Parse argumentsâ€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">while [[ &quot;$#&quot; -gt 0 ]]; doâ€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  case $1 inâ€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -g|--resource-group) RESOURCE_GROUP=&quot;$2&quot;; shift ;;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -b|--backend-url) BACKEND_URL=&quot;$2&quot;; shift ;;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -m|--middleware-url) MIDDLEWARE_URL=&quot;$2&quot;; shift ;;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -f|--frontend-url) FRONTEND_URL=&quot;$2&quot;; shift ;;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -ba|--backend-apim-name) BACKEND_APIM_NAME=&quot;$2&quot;; shift ;;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -ma|--middleware-apim-name) MIDDLEWARE_APIM_NAME=&quot;$2&quot;; shift ;;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --backend-api-key) BACKEND_API_KEY=&quot;$2&quot;; shift ;;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --middleware-api-key) MIDDLEWARE_API_KEY=&quot;$2&quot;; shift ;;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -h|--help) display_help ;;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    *) echo &quot;Unknown option: $1&quot;; display_help ;;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  esacâ€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  shiftâ€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">doneâ€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Check for required argumentsâ€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if [[ -z &quot;$RESOURCE_GROUP&quot; || -z &quot;$BACKEND_URL&quot; || -z &quot;$MIDDLEWARE_URL&quot; || -z &quot;$FRONTEND_URL&quot; || -z &quot;$BACKEND_APIM_NAME&quot; || -z &quot;$MIDDLEWARE_APIM_NAME&quot; ]]; thenâ€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  echo &quot;Error: Missing required arguments.&quot;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  display_helpâ€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fiâ€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Generate API keys if not providedâ€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BACKEND_API_KEY=${BACKEND_API_KEY:-$(generate_api_key)}â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MIDDLEWARE_API_KEY=${MIDDLEWARE_API_KEY:-$(generate_api_key)}â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;Using Backend API Key: $BACKEND_API_KEY&quot;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;Using Middleware API Key: $MIDDLEWARE_API_KEY&quot;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Create Backend API in APIMâ€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">az apim api create \â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --resource-group &quot;$RESOURCE_GROUP&quot; \â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --service-name &quot;$BACKEND_APIM_NAME&quot; \â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --api-id backend-api \â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --path /api/v1/products \â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --display-name &quot;Backend Product API&quot; \â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --service-url &quot;$BACKEND_URL&quot; \â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --protocols httpsâ€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Add Backend API Operationsâ€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">az apim api operation create \â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --resource-group &quot;$RESOURCE_GROUP&quot; \â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --service-name &quot;$BACKEND_APIM_NAME&quot; \â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --api-id backend-api \â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --url-template &quot;/&quot; \â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --method GET \â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --display-name &quot;Get Product List&quot;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">az apim api operation create \â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --resource-group &quot;$RESOURCE_GROUP&quot; \â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --service-name &quot;$BACKEND_APIM_NAME&quot; \â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --api-id backend-api \â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --url-template &quot;/similar&quot; \â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --method POST \â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --display-name &quot;Get Similar Product List&quot;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Apply Backend API Policy (CORS, API Key Validation)â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">az apim api policy create \â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --resource-group &quot;$RESOURCE_GROUP&quot; \â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --service-name &quot;$BACKEND_APIM_NAME&quot; \â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --api-id backend-api \â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --xml-policy &quot;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;inbound&gt;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;base /&gt;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;cors allow-credentials=&#x27;true&#x27;&gt;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;allowed-origins&gt;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &lt;origin&gt;$MIDDLEWARE_URL&lt;/origin&gt;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/allowed-origins&gt;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;allowed-methods&gt;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &lt;method&gt;GET&lt;/method&gt;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &lt;method&gt;POST&lt;/method&gt;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/allowed-methods&gt;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;allowed-headers&gt;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &lt;header&gt;*&lt;/header&gt;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/allowed-headers&gt;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;/cors&gt;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;check-header name=&#x27;api-key&#x27; failed-check-httpcode=&#x27;401&#x27; failed-check-error-message=&#x27;API Key Invalid or Not Found&#x27; ignore-case=&#x27;true&#x27;&gt;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;value&gt;$BACKEND_API_KEY&lt;/value&gt;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;/check-header&gt;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/inbound&gt;&quot;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Create Middleware API in APIMâ€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">az apim api create \â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --resource-group &quot;$RESOURCE_GROUP&quot; \â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --service-name &quot;$MIDDLEWARE_APIM_NAME&quot; \â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --api-id middleware-api \â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --path /api/v1/generate \â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --display-name &quot;Middleware Generate API&quot; \â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --service-url &quot;$MIDDLEWARE_URL&quot; \â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --protocols httpsâ€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Add Middleware API Operationsâ€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">az apim api operation create \â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --resource-group &quot;$RESOURCE_GROUP&quot; \â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --service-name &quot;$MIDDLEWARE_APIM_NAME&quot; \â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --api-id middleware-api \â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --url-template &quot;/content&quot; \â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --method POST \â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --display-name &quot;Generate Content&quot;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">az apim api operation create \â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --resource-group &quot;$RESOURCE_GROUP&quot; \â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --service-name &quot;$MIDDLEWARE_APIM_NAME&quot; \â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --api-id middleware-api \â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --url-template &quot;/embeddings&quot; \â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --method POST \â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --display-name &quot;Generate Embeddings&quot;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Apply Middleware API Policy (CORS, API Key Validation)â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">az apim api policy create \â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --resource-group &quot;$RESOURCE_GROUP&quot; \â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --service-name &quot;$MIDDLEWARE_APIM_NAME&quot; \â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --api-id middleware-api \â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --xml-policy &quot;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;inbound&gt;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;base /&gt;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;cors allow-credentials=&#x27;true&#x27;&gt;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;allowed-origins&gt;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &lt;origin&gt;$BACKEND_URL&lt;/origin&gt;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &lt;origin&gt;$FRONTEND_URL&lt;/origin&gt;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/allowed-origins&gt;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;allowed-methods&gt;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &lt;method&gt;POST&lt;/method&gt;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/allowed-methods&gt;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;allowed-headers&gt;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &lt;header&gt;*&lt;/header&gt;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/allowed-headers&gt;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;/cors&gt;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;check-header name=&#x27;api-key&#x27; failed-check-httpcode=&#x27;401&#x27; failed-check-error-message=&#x27;API Key Invalid or Not Found&#x27; ignore-case=&#x27;true&#x27;&gt;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;value&gt;$MIDDLEWARE_API_KEY&lt;/value&gt;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;/check-header&gt;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/inbound&gt;&quot;â€¯ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;APIs created and policies applied successfully.&quot;â€¯ </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="what-does-the-script-do">What does the script do?<a href="#what-does-the-script-do" class="hash-link" aria-label="Direct link to What does the script do?" title="Direct link to What does the script do?">â€‹</a></h4>
<p>The script configures the following API rules:</p>
<ul>
<li><strong>Allowed origins in CORS:</strong>
<ul>
<li>The back-end API allows only the <strong>middleware URL</strong> as the allowed origin.</li>
<li>The middleware API allows both <strong>back-end URL</strong> and <strong>front-end URL</strong> as allowed origins.</li>
</ul>
</li>
<li><strong>Updated <code>check-header</code> validation:</strong>
<ul>
<li>Replaces <code>validate-header</code> with <code>check-header</code> for API key validation.</li>
<li>Includes failed-check-httpcode=&quot;401&quot;, <code>failed-check-error-message=&quot;API Key Invalid or Not Found&quot;</code>, and <code>ignore-case=&quot;true&quot;</code>.</li>
</ul>
</li>
</ul>
<p>After running the script, weâ€™ll have created the APIs to use and will have applied the <code>CORS</code> and <code>check-header</code> policies for both back-end and middleware APIs. The script will also generate the requiredâ€¯API keys, if you didnâ€™t already provide them.</p>
<p><img loading="lazy" alt="screenshot of code response script" src="/Cloud-Native/assets/images/1-4a-11-eb6cb682b49e4542e48f7a0d64b01021.png" width="1431" height="888" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p><a href="https://aka.ms/demo-bytes/ep13?ocid=biafy25h1_30daysofia_webpage_azuremktg" target="_blank" rel="noopener noreferrer">Ingest your own content</a> using the Azure Functions OpenAI extension into a Cosmos DB vector database to enable OpenAI query on your data.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="step-2-configuring-azure-key-vault-and-granting-access">Step 2: Configuring Azure Key Vault and Granting Access<a href="#step-2-configuring-azure-key-vault-and-granting-access" class="hash-link" aria-label="Direct link to Step 2: Configuring Azure Key Vault and Granting Access" title="Direct link to Step 2: Configuring Azure Key Vault and Granting Access">â€‹</a></h2>
<p>Once the APIs are defined and secured, we need to securely store the API keys and other sensitive information in <strong>Azure Key Vault</strong> and grant the application access to these secrets.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="21-storing-api-keys-in-key-vault">2.1 Storing API Keys in Key Vault<a href="#21-storing-api-keys-in-key-vault" class="hash-link" aria-label="Direct link to 2.1 Storing API Keys in Key Vault" title="Direct link to 2.1 Storing API Keys in Key Vault">â€‹</a></h3>
<ol>
<li>Go to your <strong>Azure Key Vault</strong> in the Azure portal.</li>
<li>Select <strong>Secrets</strong> and create a new secret for each API key (e.g., <code>BackendServiceAccessKey</code>, <code>MiddlewareServiceAccessKey</code>).</li>
<li>Update the values with the API keys configured in APIM.</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="22-granting-access-to-key-vault-via-managed-identities">2.2 Granting Access to Key Vault via Managed Identities<a href="#22-granting-access-to-key-vault-via-managed-identities" class="hash-link" aria-label="Direct link to 2.2 Granting Access to Key Vault via Managed Identities" title="Direct link to 2.2 Granting Access to Key Vault via Managed Identities">â€‹</a></h3>
<ol>
<li>To allow your App Service to access the secrets in Key Vault, enable the <strong>System-assigned Managed Identity:</strong>
<ul>
<li>Navigate to your <strong>Azure App Service</strong>.</li>
<li>Under the <strong>Identity</strong> section, enable &quot;System-assigned Managed Identity&quot;.</li>
</ul>
</li>
</ol>
<p><img loading="lazy" alt="screenshot of fields under Identity in Azure App Service" src="/Cloud-Native/assets/images/1-4a-12-de4fe3adc523bc6581e269c58e793a48.png" width="1431" height="398" class="img_ev3q"></p>
<ol start="2">
<li>In the <strong>Azure Key Vault</strong>, navigate to <strong>Access policies</strong>.</li>
<li>Create a new access policy using the &quot;Secret Management&quot; template.</li>
<li>Select the Managed Identity of your App Service as the principal and grant it <strong>Get</strong> and <strong>List</strong> permissions for secrets.</li>
</ol>
<p><img loading="lazy" alt="screenshot of access configuration" src="/Cloud-Native/assets/images/1-4a-13-28638f0ebdda37bb8e15708aa55a16b7.png" width="1431" height="534" class="img_ev3q"></p>
<p><img loading="lazy" alt="screenshot of access policy" src="/Cloud-Native/assets/images/1-4a-14-aed39bc68e1a7f9c6ce14b5ba17e8a72.png" width="1431" height="398" class="img_ev3q"></p>
<p><img loading="lazy" alt="screenshot of access policy permissions when creating a new policy" src="/Cloud-Native/assets/images/1-4a-15-bc906dc886bbaee816f6024a99bd6b41.png" width="1430" height="1382" class="img_ev3q"></p>
<p><img loading="lazy" alt="screenshot of access policy principal selections when creating a new policy" src="/Cloud-Native/assets/images/1-4a-16-bbab999c2f1edaf72d98a603c5dd4774.png" width="1430" height="1382" class="img_ev3q"></p>
<p><img loading="lazy" alt="screenshot of access policy review screen when creating a new policy" src="/Cloud-Native/assets/images/1-4a-17-1d38df94a3ed19f6c5f8f2622e549c1c.png" width="1430" height="1382" class="img_ev3q"></p>
<p><img loading="lazy" alt="screenshot of access policy once created" src="/Cloud-Native/assets/images/1-4a-18-063e0c057f120d04f2cf73b8d555b44f.png" width="1431" height="693" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="azure-cli-instructions-1">Azure CLI instructions<a href="#azure-cli-instructions-1" class="hash-link" aria-label="Direct link to Azure CLI instructions" title="Direct link to Azure CLI instructions">â€‹</a></h4>
<p>Run the following commands:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Get the Managed Identity&#x27;s client ID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IDENTITY_CLIENT_ID=$(az webapp identity show --resource-group &lt;resource-group-name&gt; --name &lt;app-service-name&gt; --query principalId --output tsv)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Grant access to the Key Vault for the Managed Identity</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">az keyvault set-policy --name &lt;key-vault-name&gt; --secret-permissions get list --object-id $IDENTITY_CLIENT_ID</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="23-configure-environment-variables-in-app-service">2.3 Configure Environment Variables in App Service<a href="#23-configure-environment-variables-in-app-service" class="hash-link" aria-label="Direct link to 2.3 Configure Environment Variables in App Service" title="Direct link to 2.3 Configure Environment Variables in App Service">â€‹</a></h3>
<ol>
<li><strong>Navigate to your App Service</strong> in the Azure portal:<!-- -->
<ul>
<li>Go to the <strong>Azure portal</strong> and select your <strong>App Service</strong>.</li>
</ul>
</li>
<li><strong>Open Configuration Settings:</strong>
<ul>
<li>In the left-hand menu, select <strong>Configuration</strong> under the <strong>Settings</strong> section.</li>
</ul>
</li>
</ol>
<p><img loading="lazy" alt="screenshot of App Service Configuration Settings in Azure Portal" src="/Cloud-Native/assets/images/1-4a-19-4bf0b69f507e1418573b98fd9944b8b7.png" width="1431" height="693" class="img_ev3q"></p>
<ol start="3">
<li><strong>Add a New Application Setting</strong></li>
</ol>
<ul>
<li>In the <strong>Application settings</strong> tab, click on <strong>+ New application setting</strong>.</li>
<li>Enter the following details:<!-- -->
<ul>
<li><strong>Name</strong>: <code>AZURE_KEYVAULT_URL</code></li>
<li><strong>Value</strong>: <code>https://&lt;your-key-vault-name&gt;.vault.azure.net/</code></li>
</ul>
</li>
</ul>
<ol start="4">
<li><strong>Save the Changes</strong>:<!-- -->
<ul>
<li>After adding the setting, click <strong>Save</strong> at the top to apply the changes.</li>
</ul>
</li>
</ol>
<p><img loading="lazy" alt="screenshot of the new application setting after saving it in Azure Portal" src="/Cloud-Native/assets/images/1-4a-20-cde48bd4a11ba16924db3421e1ac383d.png" width="1431" height="693" class="img_ev3q"></p>
<ol start="5">
<li><strong>Restart the App Service</strong> (if necessary):<!-- -->
<ul>
<li>You may need to restart your App Service for the changes to take effect. You can do this by going to the <strong>Overview</strong> section and clicking on the <strong>Restart</strong> button.</li>
</ul>
</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="azure-cli-instructions-2">Azure CLI instructions<a href="#azure-cli-instructions-2" class="hash-link" aria-label="Direct link to Azure CLI instructions" title="Direct link to Azure CLI instructions">â€‹</a></h4>
<p>Run the following command:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Set the environment variable in the App Service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">az webapp config appsettings set --resource-group &lt;resource-group-name&gt; --name &lt;app-service-name&gt; --settings AZURE_KEYVAULT_URL=https://&lt;key-vault-name&gt;.vault.azure.net/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>Join live experts to dive into <a href="https://aka.ms/learn-live/ep3?ocid=biafy25h1_30daysofia_webpage_azuremktg" target="_blank" rel="noopener noreferrer">operational excellence with AKS</a>.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">â€‹</a></h2>
<p>In this section, we created and configured the APIs for both back-end and middleware services using <strong>Azure API Management (APIM)</strong>. We secured the APIs using CORS policies, header checks, and rate limits. After configuring APIM, we securely stored the API keys and other sensitive data in Azure Key Vault and granted access using Managed Identity. This setup ensures that all components interact securely and that sensitive information is managed properly.</p>
<p>In the next section, we will deploy the application using Azure App Service, ensuring it utilizes the secure configurations established here.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="additional-resources">Additional Resources<a href="#additional-resources" class="hash-link" aria-label="Direct link to Additional Resources" title="Direct link to Additional Resources">â€‹</a></h2>
<ul>
<li><a href="https://learn.microsoft.com/azure/api-management/api-management-key-concepts?ocid=biafy25h1_30daysofia_webpage_azuremktg" target="_blank" rel="noopener noreferrer">Understanding Azure API Management</a></li>
<li><a href="https://learn.microsoft.com/azure/key-vault/general/overview?ocid=biafy25h1_30daysofia_webpage_azuremktg" target="_blank" rel="noopener noreferrer">Getting Started with Azure Key Vault</a></li>
<li><a href="https://learn.microsoft.com/azure/app-service/overview-managed-identity?tabs=portal%2Chttp?ocid=biafy25h1_30daysofia_webpage_azuremktg" target="_blank" rel="noopener noreferrer">Configuring Managed Identities in Azure</a></li>
</ul></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Cloud-Native/30-days-of-ia-2024/tags/build-intelligent-apps">Build-Intelligent-Apps</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Cloud-Native/30-days-of-ia-2024/tags/30-days-of-ia-2024">30-days-of-IA-2024</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Cloud-Native/30-days-of-ia-2024/tags/learn-live">learn-live</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Cloud-Native/30-days-of-ia-2024/tags/demo-bytes">demo-bytes</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Cloud-Native/30-days-of-ia-2024/tags/community-gallery">community-gallery</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Cloud-Native/30-days-of-ia-2024/tags/azure-kubernetes-service">azure-kubernetes-service</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Cloud-Native/30-days-of-ia-2024/tags/azure-functions">azure-functions</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Cloud-Native/30-days-of-ia-2024/tags/azure-openai">azure-openai</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Cloud-Native/30-days-of-ia-2024/tags/azure-container-apps">azure-container-apps</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Cloud-Native/30-days-of-ia-2024/tags/azure-cosmos-db">azure-cosmos-db</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Cloud-Native/30-days-of-ia-2024/tags/github-copilot">github-copilot</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Cloud-Native/30-days-of-ia-2024/tags/github-codespaces">github-codespaces</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Cloud-Native/30-days-of-ia-2024/tags/github-actions">github-actions</a></li></ul></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/Cloud-Native/30-days-of-ia-2024/tags/azure-container-apps/page/6"><div class="pagination-nav__label">Newer Entries</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/Cloud-Native/30-days-of-ia-2024/tags/azure-container-apps/page/8"><div class="pagination-nav__label">Older Entries</div></a></nav></main></div></div></div><footer><div></div></footer></div>
</body>
</html>