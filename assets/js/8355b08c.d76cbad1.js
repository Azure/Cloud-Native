"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[331],{3905:(e,t,o)=>{o.d(t,{Zo:()=>c,kt:()=>h});var n=o(67294);function r(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function a(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function i(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?a(Object(o),!0).forEach((function(t){r(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):a(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function s(e,t){if(null==e)return{};var o,n,r=function(e,t){if(null==e)return{};var o,n,r={},a=Object.keys(e);for(n=0;n<a.length;n++)o=a[n],t.indexOf(o)>=0||(r[o]=e[o]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)o=a[n],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(r[o]=e[o])}return r}var u=n.createContext({}),l=function(e){var t=n.useContext(u),o=t;return e&&(o="function"==typeof e?e(t):i(i({},t),e)),o},c=function(e){var t=l(e.components);return n.createElement(u.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var o=e.components,r=e.mdxType,a=e.originalType,u=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),m=l(o),h=r,d=m["".concat(u,".").concat(h)]||m[h]||p[h]||a;return o?n.createElement(d,i(i({ref:t},c),{},{components:o})):n.createElement(d,i({ref:t},c))}));function h(e,t){var o=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=o.length,i=new Array(a);i[0]=m;var s={};for(var u in t)hasOwnProperty.call(t,u)&&(s[u]=t[u]);s.originalType=e,s.mdxType="string"==typeof e?e:r,i[1]=s;for(var l=2;l<a;l++)i[l]=o[l];return n.createElement.apply(null,i)}return n.createElement.apply(null,o)}m.displayName="MDXCreateElement"},94769:(e,t,o)=>{o.r(t),o.d(t,{assets:()=>u,contentTitle:()=>i,default:()=>p,frontMatter:()=>a,metadata:()=>s,toc:()=>l});var n=o(87462),r=(o(67294),o(3905));const a={slug:"zero2hero-func-07",title:"\ud83d\ude80 | Monitor + Troubleshoot Apps",authors:["madhura"],draft:!1,hide_table_of_contents:!1,toc_min_heading_level:2,toc_max_heading_level:3,keywords:["azure","functions","serverless","monitoring"],image:"./img/zero-to-hero-madhura.png",description:"When you\u2019re running a function app, you want to be prepared for any issues that may arise, from 4xx errors to trigger failures. Azure Functions offers built-in integration with Azure Application Insights to monitor function executions. Let's learn more.",tags:["serverless-september","zero-to-hero","azure-functions"]},i=void 0,s={permalink:"/Cloud-Native/blog/zero2hero-func-07",source:"@site/blog/zero-to-hero/2022-09-26-azurefunctions.md",title:"\ud83d\ude80 | Monitor + Troubleshoot Apps",description:"When you\u2019re running a function app, you want to be prepared for any issues that may arise, from 4xx errors to trigger failures. Azure Functions offers built-in integration with Azure Application Insights to monitor function executions. Let's learn more.",date:"2022-09-26T00:00:00.000Z",formattedDate:"September 26, 2022",tags:[{label:"serverless-september",permalink:"/Cloud-Native/blog/tags/serverless-september"},{label:"zero-to-hero",permalink:"/Cloud-Native/blog/tags/zero-to-hero"},{label:"azure-functions",permalink:"/Cloud-Native/blog/tags/azure-functions"}],readingTime:4.76,hasTruncateMarker:!1,authors:[{name:"Madhura Bharadwaj",title:"Product Manager, Azure Functions @Microsoft",url:"https://techcommunity.microsoft.com/t5/user/viewprofilepage/user-id/360851#profile",imageURL:"https://techcommunity.microsoft.com/t5/image/serverpage/image-id/252689i712A569920A3BE85/image-dimensions/150x150/image-coordinates/0%2C74%2C472%2C546?v=v2",key:"madhura"}],frontMatter:{slug:"zero2hero-func-07",title:"\ud83d\ude80 | Monitor + Troubleshoot Apps",authors:["madhura"],draft:!1,hide_table_of_contents:!1,toc_min_heading_level:2,toc_max_heading_level:3,keywords:["azure","functions","serverless","monitoring"],image:"./img/zero-to-hero-madhura.png",description:"When you\u2019re running a function app, you want to be prepared for any issues that may arise, from 4xx errors to trigger failures. Azure Functions offers built-in integration with Azure Application Insights to monitor function executions. Let's learn more.",tags:["serverless-september","zero-to-hero","azure-functions"]},prevItem:{title:"28. Serverless + Power Platforms",permalink:"/Cloud-Native/blog/28-where-am-i"},nextItem:{title:"25. Deploy Spring Boot App to ACA",permalink:"/Cloud-Native/blog/25-aca-java"}},u={image:o(12321).Z,authorsImageUrls:[void 0]},l=[{value:"What We&#39;ll Cover",id:"what-well-cover",level:2},{value:"Monitoring your Azure Functions:",id:"monitoring-your-azure-functions",level:2},{value:"Using Application Insights",id:"using-application-insights",level:3},{value:"Using Log Streaming",id:"using-log-streaming",level:3},{value:"Troubleshooting your Azure Functions:",id:"troubleshooting-your-azure-functions",level:2}],c={toc:l};function p(e){let{components:t,...a}=e;return(0,r.kt)("wrapper",(0,n.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("head",null,(0,r.kt)("meta",{name:"twitter:url",content:"https://azure.github.io/Cloud-Native/blog/zero2hero-func-07"}),(0,r.kt)("meta",{name:"twitter:title",content:"#ZeroToHero: Monitoring and troubleshooting apps in Azure Functions "}),(0,r.kt)("meta",{name:"twitter:description",content:"#ZeroToHero: Monitoring and troubleshooting apps in Azure Functions"}),(0,r.kt)("meta",{name:"twitter:image",content:"https://azure.github.io/Cloud-Native/img/banners/serverless-zero2hero.png"}),(0,r.kt)("meta",{name:"twitter:card",content:"summary_large_image"}),(0,r.kt)("meta",{name:"twitter:creator",content:"@nitya"}),(0,r.kt)("meta",{name:"twitter:site",content:"@AzureAdvocates"}),(0,r.kt)("link",{rel:"canonical",href:"https://techcommunity.microsoft.com/t5/apps-on-azure-blog/error-handling-with-apache-kafka-extension-for-azure-functions/ba-p/3628936"})),(0,r.kt)("hr",null),(0,r.kt)("p",null,"Welcome to ",(0,r.kt)("inlineCode",{parentName:"p"},"Day 26")," of #30DaysOfServerless!"),(0,r.kt)("p",null,"Today, we have a special set of posts from our ",(0,r.kt)("a",{parentName:"p",href:"/serverless-september/ZeroToHero"},"Zero To Hero \ud83d\ude80")," initiative, featuring blog posts authored by our Product Engineering teams for #ServerlessSeptember. ",(0,r.kt)("em",{parentName:"p"},"Posts were originally published on the ",(0,r.kt)("a",{parentName:"em",href:"https://techcommunity.microsoft.com/t5/apps-on-azure-blog/monitoring-and-troubleshooting-apps-in-azure-functions/ba-p/3638230?WT.mc_id=javascript-74010-cxa"},"Apps on Azure")," blog on Microsoft Tech Community.")),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"what-well-cover"},"What We'll Cover"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Monitoring your Azure Functions"),(0,r.kt)("li",{parentName:"ul"},"Built-in log streaming"),(0,r.kt)("li",{parentName:"ul"},"Live Metrics stream"),(0,r.kt)("li",{parentName:"ul"},"Troubleshooting Azure Functions")),(0,r.kt)("p",null,(0,r.kt)("img",{src:o(12321).Z,width:"1600",height:"672"})),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"monitoring-your-azure-functions"},"Monitoring your Azure Functions:"),(0,r.kt)("p",null,"Azure Functions uses ",(0,r.kt)("strong",{parentName:"p"},"Application Insights")," to collect and analyze log data from individual function executions in your function app."),(0,r.kt)("h3",{id:"using-application-insights"},"Using Application Insights"),(0,r.kt)("p",null,"Application Insights collects ",(0,r.kt)("em",{parentName:"p"},"log, performance, and error data"),". By automatically detecting performance anomalies and featuring powerful analytics tools, you can more easily diagnose issues and better understand how your functions are used. These tools are designed to help you continuously improve performance and usability of your functions. You can even use Application Insights during local function app project development."),(0,r.kt)("p",null,"Typically, you create an Application Insights instance when you create your function app. In this case, the instrumentation key required for the integration is already set as an application setting named ",(0,r.kt)("inlineCode",{parentName:"p"},"APPINSIGHTS_INSTRUMENTATIONKEY"),". With Application Insights integration enabled, telemetry data is sent to your connected Application Insights instance. This data includes logs generated by the Functions host, traces written from your functions code, and performance data. In addition to data from your functions and the Functions host, you can also collect data from the ",(0,r.kt)("a",{parentName:"p",href:"https://learn.microsoft.com/azure/azure-functions/functions-monitoring#scale-controller-logs?WT.mc_id=javascript-74010-cxa"},"Functions scale controller"),"."),(0,r.kt)("p",null,"By default, the data collected from your function app is stored in Application Insights. In the ",(0,r.kt)("a",{parentName:"p",href:"https://portal.azure.com/"},"Azure portal"),", Application Insights provides an extensive set of visualizations of your telemetry data. You can drill into error logs and query events and metrics. To learn more, including basic examples of how to view and query your collected data, see ",(0,r.kt)("a",{parentName:"p",href:"https://learn.microsoft.com/azure/azure-functions/analyze-telemetry-data?WT.mc_id=javascript-74010-cxa"},"Analyze Azure Functions telemetry in Application Insights"),"."),(0,r.kt)("h3",{id:"using-log-streaming"},"Using Log Streaming"),(0,r.kt)("p",null,"In addition to this, you can have a smoother debugging experience through log streaming. There are two ways to view a stream of log files being generated by your function executions."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Built-in log streaming"),": the App Service platform lets you view a stream of your application log files. This is equivalent to the output seen when you debug your functions during ",(0,r.kt)("a",{parentName:"li",href:"https://learn.microsoft.com/azure/azure-functions/functions-develop-local?WT.mc_id=javascript-74010-cxa"},"local development")," and when you use the Test tab in the portal. All log-based information is displayed. For more information, see ",(0,r.kt)("a",{parentName:"li",href:"https://learn.microsoft.com/azure/app-service/troubleshoot-diagnostic-logs#stream-logs?WT.mc_id=javascript-74010-cxa"},"Stream logs"),". This streaming method supports only a single instance and can't be used with an app running on Linux in a Consumption plan."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Live Metrics Stream"),": when your function app is ",(0,r.kt)("a",{parentName:"li",href:"https://learn.microsoft.com/azure/azure-functions/configure-monitoring#enable-application-insights-integration?WT.mc_id=javascript-74010-cxa"},"connected to Application Insights"),", you can view log data and other metrics in near real-time in the Azure portal using ",(0,r.kt)("a",{parentName:"li",href:"https://learn.microsoft.com/azure/azure-monitor/app/live-stream?WT.mc_id=javascript-74010-cxa"},"Live Metrics Stream"),". Use this method when monitoring functions running on multiple-instances or on Linux in a Consumption plan. This method uses ",(0,r.kt)("a",{parentName:"li",href:"https://learn.microsoft.com/azure/azure-functions/configure-monitoring#configure-sampling?WT.mc_id=javascript-74010-cxa"},"sampled data"),".\nLog streams can be viewed both in the portal and in most local development environments.")),(0,r.kt)("admonition",{title:"Monitoring Azure Functions",type:"info"},(0,r.kt)("p",{parentName:"admonition"},"Learn how to ",(0,r.kt)("a",{parentName:"p",href:"https://learn.microsoft.com/azure/azure-functions/configure-monitoring?source=recommendations&tabs=v2&WT.mc_id=javascript-74010-cxa"},"configure monitoring for your Azure Functions"),". See ",(0,r.kt)("a",{parentName:"p",href:"https://learn.microsoft.com/azure/azure-functions/monitor-functions-reference?WT.mc_id=javascript-74010-cxa"},"Monitoring Azure Functions data reference")," for detailed information on the metrics and logs metrics created by Azure Functions.")),(0,r.kt)("p",null,"In addition to this, Azure Functions uses ",(0,r.kt)("a",{parentName:"p",href:"https://learn.microsoft.com/azure/azure-monitor/overview"},"Azure Monitor")," to ",(0,r.kt)("a",{parentName:"p",href:"https://learn.microsoft.com/azure/azure-functions/monitor-functions?tabs=portal"},"monitor the health of your function apps"),". Azure Functions collects the same kinds of monitoring data as other Azure resources that are described in ",(0,r.kt)("a",{parentName:"p",href:"https://learn.microsoft.com/azure/azure-monitor/essentials/monitor-azure-resource#monitoring-data-from-azure-resources"},"Azure Monitor data collection"),". See ",(0,r.kt)("a",{parentName:"p",href:"https://learn.microsoft.com/azure/azure-functions/monitor-functions-reference"},"Monitoring Azure Functions data reference")," for detailed information on the metrics and logs metrics created by Azure Functions."),(0,r.kt)("h2",{id:"troubleshooting-your-azure-functions"},"Troubleshooting your Azure Functions:"),(0,r.kt)("p",null,"When you do run into issues with your function app, Azure Functions diagnostics points out what\u2019s wrong. It guides you to the right information to troubleshoot and resolve the issue more easily and quickly."),(0,r.kt)("p",null,"Let\u2019s explore how to use Azure Functions diagnostics to diagnose and solve common function app issues."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Navigate to your function app ",(0,r.kt)("a",{parentName:"li",href:"https://portal.azure.com/?WT.mc_id=javascript-74010-cxa"},"in the Azure portal"),"."),(0,r.kt)("li",{parentName:"ol"},"Select Diagnose and solve problems to open Azure Functions diagnostics."),(0,r.kt)("li",{parentName:"ol"},"Once you\u2019re here, there are multiple ways to retrieve the information you\u2019re looking for. Choose a category that best describes the issue of your function app by using the keywords in the homepage tile. You can also type a keyword that best describes your issue in the search bar. There\u2019s also a section at the bottom of the page that will directly take you to some of the more popular troubleshooting tools. For example, you could type execution to see a list of diagnostic reports related to your function app execution and open them directly from the homepage.")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Monitoring and troubleshooting apps in Azure Functions",src:o(62007).Z,width:"777",height:"361"})),(0,r.kt)("ol",{start:4},(0,r.kt)("li",{parentName:"ol"},"For example, click on the Function App Down or Reporting Errors link under Popular troubleshooting tools section. You will find detailed analysis, insights and next steps for the issues that were detected. On the left you\u2019ll see a list of detectors. Click on them to explore more, or if there\u2019s a particular keyword you want to look for, type it Into the search bar on the top.")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Monitoring and troubleshooting apps in Azure Functions",src:o(48933).Z,width:"788",height:"390"})),(0,r.kt)("admonition",{title:"TROUBLESHOOTING TIP",type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"Here are some general troubleshooting tips that you can follow if you find your Function App throwing ",(0,r.kt)("a",{parentName:"p",href:"https://learn.microsoft.com/azure/azure-functions/functions-recover-storage-account?WT.mc_id=javascript-74010-cxa"},"Azure Functions Runtime unreachable")," error. "),(0,r.kt)("p",{parentName:"admonition"},"Also be sure to check out the recommended best practices to ensure your Azure Functions are highly reliable. ",(0,r.kt)("a",{parentName:"p",href:"https://learn.microsoft.com/azure/azure-functions/functions-best-practices?source=recommendations&tabs=csharp&WT.mc_id=javascript-74010-cxa"},"This article")," details some best practices for designing and deploying efficient function apps that remain healthy and perform well in a cloud-based environment.")),(0,r.kt)("p",null,"Bonus tip:"))}p.isMDXComponent=!0},62007:(e,t,o)=>{o.d(t,{Z:()=>n});const n=o.p+"assets/images/madhura-functions-1-cf245312022dd74d8e0c0325d6cddc20.png"},48933:(e,t,o)=>{o.d(t,{Z:()=>n});const n=o.p+"assets/images/madhura-functions-2-9e52c0d12e76850ce3bb4c1d9c8d970a.png"},12321:(e,t,o)=>{o.d(t,{Z:()=>n});const n=o.p+"assets/images/zero-to-hero-madhura-9186d0cba8bf8974d76dfdeb73cd5f50.png"}}]);