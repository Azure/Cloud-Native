"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[827],{64520:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>p,frontMatter:()=>s,metadata:()=>o,toc:()=>c});var i=t(85893),r=t(11151);const s={date:"2024-04-17T09:05",slug:"real-time-voice-sentiment-analysis-system-2",title:"7.5 Real-time Voice Sentiment Analysis System 2",authors:["cnteam"],draft:!1,hide_table_of_contents:!1,toc_min_heading_level:2,toc_max_heading_level:3,keywords:["Cloud","Data","AI","AI/ML","intelligent apps","cloud-native","60-days","enterprise apps","digital experiences","app modernization","serverless","ai apps"],image:"https://github.com/Azure/Cloud-Native/blob/main/website/static/img/ogImage.png",description:"In today's fast-paced digital world, understanding customer sentiment in real-time during voice calls can provide businesses with a competitive edge. This guide will show developers how to build a robust real-time voice sentiment analysis application using several key Azure services. In this second part, we will develop the backend to handle interactions with Azure Communication Services, Azure AI Language and Azure OpenAI, connect it to the frontend, and deploy to Azure Container Apps .",tags:["Build-Intelligent-Apps","60-days-of-IA","learn-live","hack-together","community-buzz","ask-the-expert","azure-kubernetes-service","azure-functions","azure-openai","azure-container-apps","azure-cosmos-db","github-copilot","github-codespaces","github-actions"]},a=void 0,o={permalink:"/Cloud-Native/60DaysOfIA/real-time-voice-sentiment-analysis-system-2",source:"@site/blog-60daysofIA/2024-04-17/real-time-voice-sentiment-analysis-system-2.md",title:"7.5 Real-time Voice Sentiment Analysis System 2",description:"In today's fast-paced digital world, understanding customer sentiment in real-time during voice calls can provide businesses with a competitive edge. This guide will show developers how to build a robust real-time voice sentiment analysis application using several key Azure services. In this second part, we will develop the backend to handle interactions with Azure Communication Services, Azure AI Language and Azure OpenAI, connect it to the frontend, and deploy to Azure Container Apps .",date:"2024-04-17T09:05:00.000Z",formattedDate:"April 17, 2024",tags:[{label:"Build-Intelligent-Apps",permalink:"/Cloud-Native/60DaysOfIA/tags/build-intelligent-apps"},{label:"60-days-of-IA",permalink:"/Cloud-Native/60DaysOfIA/tags/60-days-of-ia"},{label:"learn-live",permalink:"/Cloud-Native/60DaysOfIA/tags/learn-live"},{label:"hack-together",permalink:"/Cloud-Native/60DaysOfIA/tags/hack-together"},{label:"community-buzz",permalink:"/Cloud-Native/60DaysOfIA/tags/community-buzz"},{label:"ask-the-expert",permalink:"/Cloud-Native/60DaysOfIA/tags/ask-the-expert"},{label:"azure-kubernetes-service",permalink:"/Cloud-Native/60DaysOfIA/tags/azure-kubernetes-service"},{label:"azure-functions",permalink:"/Cloud-Native/60DaysOfIA/tags/azure-functions"},{label:"azure-openai",permalink:"/Cloud-Native/60DaysOfIA/tags/azure-openai"},{label:"azure-container-apps",permalink:"/Cloud-Native/60DaysOfIA/tags/azure-container-apps"},{label:"azure-cosmos-db",permalink:"/Cloud-Native/60DaysOfIA/tags/azure-cosmos-db"},{label:"github-copilot",permalink:"/Cloud-Native/60DaysOfIA/tags/github-copilot"},{label:"github-codespaces",permalink:"/Cloud-Native/60DaysOfIA/tags/github-codespaces"},{label:"github-actions",permalink:"/Cloud-Native/60DaysOfIA/tags/github-actions"}],readingTime:15.745,hasTruncateMarker:!1,authors:[{name:"#60Days Of IA",title:"BuildIA Content Team",url:"https://azure.github.io/Cloud-Native/Build-IA/",imageURL:"https://azure.github.io/Cloud-Native/img/logo-2024.png",key:"cnteam"}],frontMatter:{date:"2024-04-17T09:05",slug:"real-time-voice-sentiment-analysis-system-2",title:"7.5 Real-time Voice Sentiment Analysis System 2",authors:["cnteam"],draft:!1,hide_table_of_contents:!1,toc_min_heading_level:2,toc_max_heading_level:3,keywords:["Cloud","Data","AI","AI/ML","intelligent apps","cloud-native","60-days","enterprise apps","digital experiences","app modernization","serverless","ai apps"],image:"https://github.com/Azure/Cloud-Native/blob/main/website/static/img/ogImage.png",description:"In today's fast-paced digital world, understanding customer sentiment in real-time during voice calls can provide businesses with a competitive edge. This guide will show developers how to build a robust real-time voice sentiment analysis application using several key Azure services. In this second part, we will develop the backend to handle interactions with Azure Communication Services, Azure AI Language and Azure OpenAI, connect it to the frontend, and deploy to Azure Container Apps .",tags:["Build-Intelligent-Apps","60-days-of-IA","learn-live","hack-together","community-buzz","ask-the-expert","azure-kubernetes-service","azure-functions","azure-openai","azure-container-apps","azure-cosmos-db","github-copilot","github-codespaces","github-actions"]},unlisted:!1,prevItem:{title:"7.4 Real-time Voice Sentiment Analysis System 1",permalink:"/Cloud-Native/60DaysOfIA/real-time-voice-sentiment-analysis-system-1"},nextItem:{title:"8 Managing the Cost of Intelligent Apps",permalink:"/Cloud-Native/60DaysOfIA/managing-the-cost-of-intelligent-apps"}},l={authorsImageUrls:[void 0]},c=[{value:"Real-time Voice Sentiment Analysis System Using Azure Communication Services, Azure AI and Azure OpenAI (Part 2)",id:"real-time-voice-sentiment-analysis-system-using-azure-communication-services-azure-ai-and-azure-openai-part-2",level:2},{value:"Prerequisite",id:"prerequisite",level:3},{value:"Setting Up the Backend with ASP.NET Core",id:"setting-up-the-backend-with-aspnet-core",level:3},{value:"Step 1: Create a New ASP.NET Core Project",id:"step-1-create-a-new-aspnet-core-project",level:4},{value:"Step 2: Add Azure SDK Packages",id:"step-2-add-azure-sdk-packages",level:4},{value:"Step 3: Set Up Configuration",id:"step-3-set-up-configuration",level:4},{value:"Step 4: Implement Sentiment Analysis Endpoints",id:"step-4-implement-sentiment-analysis-endpoints",level:4},{value:"Step 5: Test Your Backend",id:"step-5-test-your-backend",level:4},{value:"Connecting the Frontend with the ASP.NET Core Backend",id:"connecting-the-frontend-with-the-aspnet-core-backend",level:3},{value:"Step 1: Get the Access Token",id:"step-1-get-the-access-token",level:4},{value:"Step 2: Implement Sentiment Analysis on Captions",id:"step-2-implement-sentiment-analysis-on-captions",level:4},{value:"Step 3: Display Analysis Results",id:"step-3-display-analysis-results",level:4},{value:"Testing the Complete System",id:"testing-the-complete-system",level:4},{value:"Deployment",id:"deployment",level:3},{value:"Step 1: Prepare the Backend for Deployment",id:"step-1-prepare-the-backend-for-deployment",level:4},{value:"Create a Dockerfile",id:"create-a-dockerfile",level:5},{value:"Create and Test the Docker Image Locally",id:"create-and-test-the-docker-image-locally",level:5},{value:"Step 2: Deploy the Backend to Azure Container Apps",id:"step-2-deploy-the-backend-to-azure-container-apps",level:4},{value:"Step 3: Deploy the Frontend to Azure Static Web Apps",id:"step-3-deploy-the-frontend-to-azure-static-web-apps",level:4},{value:"Setting Up Continuous Deployment with GitHub",id:"setting-up-continuous-deployment-with-github",level:5},{value:"Conclusion",id:"conclusion",level:4},{value:"Future Enhancements",id:"future-enhancements",level:4}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",h5:"h5",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.a)(),...e.components},{Head:t}=n;return t||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Head",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(t,{children:[(0,i.jsx)("meta",{property:"og:url",content:"https://azure.github.io/cloud-native/60daysofia/real-time-voice-sentiment-analysis-system-2"}),(0,i.jsx)("meta",{property:"og:type",content:"website"}),(0,i.jsx)("meta",{property:"og:title",content:"Build Intelligent Apps | AI Apps on Azure"}),(0,i.jsx)("meta",{property:"og:description",content:"Join us on a learning journey to build intelligent apps on Azure. Read all about the upcoming #BuildIntelligentApps initiative on this post!"}),(0,i.jsx)("meta",{property:"og:image",content:"https://github.com/Azure/Cloud-Native/blob/main/website/static/img/ogImage.png"}),(0,i.jsx)("meta",{name:"twitter:url",content:"https://azure.github.io/Cloud-Native/60daysofIA/real-time-voice-sentiment-analysis-system-2"}),(0,i.jsx)("meta",{name:"twitter:title",content:"Build Intelligent Apps | AI Apps on Azure"}),(0,i.jsx)("meta",{name:"twitter:description",content:"Azure and platform engineering pave the way for the efficient development, deployment, and maintenance of Intelligent Apps, triumphing over traditional approaches."}),(0,i.jsx)("meta",{name:"twitter:image",content:"https://azure.github.io/Cloud-Native/img/ogImage.png"}),(0,i.jsx)("meta",{name:"twitter:card",content:"summary_large_image"}),(0,i.jsx)("meta",{name:"twitter:creator",content:"@devanshidiaries"}),(0,i.jsx)("link",{rel:"canonical",href:"https://azure.github.io/Cloud-Native/60daysofIA/real-time-voice-sentiment-analysis-system-2"})]}),"\n",(0,i.jsx)(n.h2,{id:"real-time-voice-sentiment-analysis-system-using-azure-communication-services-azure-ai-and-azure-openai-part-2",children:"Real-time Voice Sentiment Analysis System Using Azure Communication Services, Azure AI and Azure OpenAI (Part 2)"}),"\n",(0,i.jsxs)(n.p,{children:["In the\u202f",(0,i.jsx)(n.a,{href:"https://azure.github.io/Cloud-Native/60daysofIA/real-time-voice-sentiment-analysis-system-1",children:"first part"}),"\u202fof this topic, we setup all the Azure resources like the ",(0,i.jsx)(n.a,{href:"https://learn.microsoft.com/azure/communication-services/overview?ocid=buildia24_60days_blogs",children:"Azure Communication Services"})," for VoIP and PSTN, ",(0,i.jsx)(n.a,{href:"https://learn.microsoft.com/azure/ai-services/language-service/overview?ocid=buildia24_60days_blogs",children:"Azure AI Language"}),", ",(0,i.jsx)(n.a,{href:"https://learn.microsoft.com/azure/ai-services/openai/overview?ocid=buildia24_60days_blogs",children:"Azure OpenAI"}),", and developed the frontend for a simple yet functional UI to make voice calls and display closed captions generated from the conversation. In this second part, we will develop the backend to handle interactions with Azure Communication Services, Azure AI Language and Azure OpenAI, connect it to the frontend, and deploy to ",(0,i.jsx)(n.a,{href:"https://learn.microsoft.com/azure/container-apps/overview?ocid=buildia24_60days_blogs",children:"Azure Container Apps"}),". Let\u2019s get started!"]}),"\n",(0,i.jsx)(n.h3,{id:"prerequisite",children:"Prerequisite"}),"\n",(0,i.jsxs)(n.p,{children:["To follow this tutorial, ensure you have completed the ",(0,i.jsx)(n.a,{href:"https://azure.github.io/Cloud-Native/60daysofIA/real-time-voice-sentiment-analysis-system-1",children:"first part"}),"\u202fof this topic."]}),"\n",(0,i.jsx)(n.h3,{id:"setting-up-the-backend-with-aspnet-core",children:"Setting Up the Backend with ASP.NET Core"}),"\n",(0,i.jsx)(n.p,{children:"The backend of our real-time voice sentiment analysis application, built with ASP.NET Core, plays a crucial role. It will handle interactions with Azure Communication Services for voice calling, manage sentiment analysis with Azure AI Language and Azure OpenAI, and serve the necessary tokens and endpoints to our frontend. Let's set this up step by step."}),"\n",(0,i.jsx)(n.h4,{id:"step-1-create-a-new-aspnet-core-project",children:"Step 1: Create a New ASP.NET Core Project"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Open Your Command Line"}),": Navigate to the directory where you want to create your project."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Create the Project"}),": Execute the following command to create a new ASP.NET Core Web API project. This command will generate a basic template for a RESTful API application."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"bash"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"dotnet new webapi --no-https \n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Note"}),": We are turning off HTTPS for simplicity in this guide. For production environments, HTTPS should be enabled and properly configured."]}),"\n",(0,i.jsx)(n.h4,{id:"step-2-add-azure-sdk-packages",children:"Step 2: Add Azure SDK Packages"}),"\n",(0,i.jsx)(n.p,{children:"Our backend needs to interact with Azure Communication Services, Azure AI Language, and Azure OpenAI. We'll add the necessary NuGet packages for these services."}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Azure Communication Services SDK"}),": This package allows us to manage voice calling and access tokens."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"bash"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"dotnet add package Azure.Communication.CallingServer \n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Azure AI Text Analytics SDK"}),": We'll use this for sentiment analysis through Azure AI Language."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"bash"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"dotnet add package Azure.AI.TextAnalytics \n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Azure OpenAI SDK"}),": This package is used to interact with Azure OpenAI for more complex sentiment analysis."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"bash"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"dotnet add package Azure.AI.OpenAI --prerelease \n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"step-3-set-up-configuration",children:"Step 3: Set Up Configuration"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"appsettings.json"}),": Open or create the ",(0,i.jsx)(n.code,{children:"appsettings.json"})," file in your project root. Add placeholders for the keys and endpoints for the Azure services. Here\u2019s an example configuration:"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"json"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'{ \r\n    "Logging": { \r\n        "LogLevel": { \r\n        "Default": "Information", \r\n        "Microsoft.AspNetCore": "Warning" \r\n        } \r\n    }, \r\n    "AllowedHosts": "*", \r\n    "AzureSettings": { \r\n        "AZURE_LANGUAGE_SERVICE_KEY": "YOUR_AZURE_LANGUAGE_KEY", \r\n        "AZURE_LANGUAGE_SERVICE_ENDPOINT": "YOUR_AZURE_OPENAI_ENDPOINT", \r\n        "OPENAI_ENDPOINT": "YOUR_AZURE_OPENAI_ENDPOINT", \r\n        "OPENAI_KEY": "YOUR_AZURE_OPENAI_KEY", \r\n        "OPENAI_DEPLOYMENT_NAME": "YOUR_AZURE_OPENAI_ENDPOINT_DEPLOYMENT", \r\n        "COMMUNICATION_CONNECTION_STRING": "YOUR_AZURE_COMMUNICATION_SERVICES_CONNECTION_STRING" \r\n    } \r\n} \n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Replace the placeholders with your actual Azure resource keys and endpoints."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Configure Services in Program.cs"}),": Read the endpoint from appsettings.json and configure the services in the ",(0,i.jsx)(n.code,{children:"Program.cs"})," file."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"csharp"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'// Set keys and configuration \r\nvar azureSettings = builder.Configuration.GetSection("AzureSettings"); \r\n\r\nstring GetSetting(string key) => azureSettings[key] ?? throw new Exception($"{key} is not set"); \r\n\r\nvar languageKey = GetSetting("AZURE_LANGUAGE_SERVICE_KEY"); \r\nvar languageEndpoint = GetSetting("AZURE_LANGUAGE_SERVICE_ENDPOINT"); \r\nAzureKeyCredential credentials = new AzureKeyCredential(languageKey); \r\nUri endpoint = new Uri(languageEndpoint); \r\nvar textAnalyticsClient = new TextAnalyticsClient(endpoint, credentials); \r\n\r\nvar OPENAI_ENDPOINT = GetSetting("OPENAI_ENDPOINT"); \r\nvar OPENAI_KEY = GetSetting("OPENAI_KEY"); \r\nvar OPENAI_DEPLOYMENT_NAME = GetSetting("OPENAI_DEPLOYMENT_NAME"); \r\nOpenAIClient openAIClient = new OpenAIClient( \r\n    new Uri(OPENAI_ENDPOINT), \r\n    new AzureKeyCredential(OPENAI_KEY)); \r\n\r\nvar communicationConnectionString = GetSetting("COMMUNICATION_CONNECTION_STRING"); \r\nvar communicationClient = new CommunicationIdentityClient(communicationConnectionString); \n'})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Implement the Token Endpoint"}),":"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"In your ASP.NET Core project Program.cs, create a new endpoint to generate and return an access token. We'll call this endpoint from our client later."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"csharp"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'app.MapGet("api/token", () => \r\n{ \r\n    var identityAndTokenResponse = communicationClient.CreateUserAndToken(scopes: [CommunicationTokenScope.VoIP]); \r\n\r\n\r\n    var result = new TokenResponse() \r\n    { \r\n        Token = identityAndTokenResponse.Value.AccessToken.Token, \r\n        PhoneNumber = "+12533192954", \r\n    }; \r\n\r\n    return Results.Json(result); \r\n}) \r\n.WithName("Token") \r\n.WithOpenApi(); \n'})}),"\n",(0,i.jsx)(n.p,{children:"We'll also need a TokenResponse object to return the token and phone number:"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"csharp"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"public class TokenResponse \r\n{ \r\n    public string Token { get; set; } \r\n    public string PhoneNumber { get; set; } \r\n} \n"})}),"\n",(0,i.jsx)(n.h4,{id:"step-4-implement-sentiment-analysis-endpoints",children:"Step 4: Implement Sentiment Analysis Endpoints"}),"\n",(0,i.jsx)(n.p,{children:"With the services configured, you can now implement the API endpoints needed for your application. Here are the essentials:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Token Provisioning"}),": An endpoint to provide access tokens for Azure Communication Services."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Sentiment Analysis"}),": Endpoints to analyze sentiment using either Azure AI Language or Azure OpenAI."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"csharp"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'app.MapPost("api/sentiment", (SentimentRequest request) => \r\n{ \r\n    var result = SentimentAnalysisWithAzureLanguage(request.Content); \r\n\r\n\r\n    return Results.Json(result); \r\n}) \r\n.WithName("Sentiment") \r\n.WithOpenApi(); \n'})}),"\n",(0,i.jsx)(n.p,{children:"This endpoint takes a SentimentRequest object and returns a SentimentResponse object and calls one of our sentiment analysis methods, which we'll implement shortly"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"csharp"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"public class SentimentRequest \r\n{ \r\n    public string Analyzer { get; set; } = string.Empty; \r\n    public string ParticipantToAnalyze { get; set; } = string.Empty; \r\n    public string Content { get; set; } = string.Empty; \r\n} \r\n\r\npublic class SentimentResult \r\n{ \r\n    public string Sentiment { get; set; } = string.Empty; \r\n    public double PositiveContentScore { get; set; } \r\n} \n"})}),"\n",(0,i.jsx)(n.p,{children:"We'll create a method that uses Azure AI Language and another that uses Azure OpenAI. Here's an example of how to implement sentiment analysis using Azure AI Language:"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"csharp"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"SentimentResult SentimentAnalysisWithAzureLanguage(string document) \r\n{ \r\n    var review = textAnalyticsClient.AnalyzeSentiment(document); \r\n    return new SentimentResult() \r\n    { \r\n        Sentiment = review.Value.Sentiment.ToString(), \r\n        PositiveContentScore = review.Value.ConfidenceScores.Positive \r\n    }; \r\n} \n"})}),"\n",(0,i.jsx)(n.p,{children:"And we'll create method endpoint that uses Azure OpenAI:"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"csharp"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'SentimentResult SentimentAnalysisWithGPT(string document) \r\n{ \r\n    var chatCompletionsOptions = new ChatCompletionsOptions() \r\n    { \r\n        DeploymentName = "shawn-deployment", \r\n        Messages = \r\n            { \r\n                new ChatRequestSystemMessage(SentimentAnalysisPrompt), \r\n                new ChatRequestUserMessage(document), \r\n            }, \r\n        Temperature = (float)1, \r\n        MaxTokens = 800             \r\n    }; \r\n\r\n    Response<ChatCompletions> response = openAIClient.GetChatCompletions(chatCompletionsOptions); \r\n\r\n    return new SentimentResult() { \r\n        Sentiment = response.Value.Choices[0].Message.Content \r\n    }; \r\n} \n'})}),"\n",(0,i.jsx)(n.h4,{id:"step-5-test-your-backend",children:"Step 5: Test Your Backend"}),"\n",(0,i.jsx)(n.p,{children:"Before moving forward, make sure to test your backend. Use tools like Postman or Swagger UI to ensure your endpoints are responsive and returning the expected results."}),"\n",(0,i.jsx)(n.p,{children:"Your final backend should look like this:"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"csharp"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'using Azure; \r\nusing Azure.AI.TextAnalytics; \r\nusing Azure.AI.OpenAI; \r\nusing Azure.Communication.Identity; \r\n\r\nvar builder = WebApplication.CreateBuilder(args); \r\n\r\n// Add services to the container. \r\n// Learn more about configuring Swagger/OpenAPI at https://aka.ms/aspnetcore/swashbuckle \r\nbuilder.Services.AddEndpointsApiExplorer(); \r\nbuilder.Services.AddSwaggerGen(); \r\n\r\n// Set keys and configuration \r\nvar azureSettings = builder.Configuration.GetSection("AzureSettings"); \r\n\r\nstring GetSetting(string key) => azureSettings[key] ?? throw new Exception($"{key} is not set"); \r\n\r\nvar languageKey = GetSetting("AZURE_LANGUAGE_SERVICE_KEY"); \r\nvar languageEndpoint = GetSetting("AZURE_LANGUAGE_SERVICE_ENDPOINT"); \r\nAzureKeyCredential credentials = new AzureKeyCredential(languageKey); \r\nUri endpoint = new Uri(languageEndpoint); \r\nvar textAnalyticsClient = new TextAnalyticsClient(endpoint, credentials); \r\n\r\nvar OPENAI_ENDPOINT = GetSetting("OPENAI_ENDPOINT"); \r\nvar OPENAI_KEY = GetSetting("OPENAI_KEY"); \r\nvar OPENAI_DEPLOYMENT_NAME = GetSetting("OPENAI_DEPLOYMENT_NAME"); \r\nOpenAIClient openAIClient = new OpenAIClient( \r\n    new Uri(OPENAI_ENDPOINT), \r\n    new AzureKeyCredential(OPENAI_KEY)); \r\n\r\nvar communicationConnectionString = GetSetting("COMMUNICATION_CONNECTION_STRING"); \r\nvar communicationClient = new CommunicationIdentityClient(communicationConnectionString); \r\n\r\nconst string SentimentAnalysisPrompt = "Please analyze the sentiment of the following text. The sentiment can be positive, negative, or neutral. Response on with one of those three values"; \r\n\r\nvar app = builder.Build(); \r\n\r\n// Configure the HTTP request pipeline. \r\nif (app.Environment.IsDevelopment()) \r\n{ \r\n    app.UseSwagger(); \r\n    app.UseSwaggerUI(); \r\n} \r\n\r\napp.MapGet("api/token", () => \r\n{ \r\n    var identityAndTokenResponse = communicationClient.CreateUserAndToken(scopes: [CommunicationTokenScope.VoIP]); \r\n\u202f \r\n\r\n    var result = new TokenResponse() \r\n    { \r\n        Token = identityAndTokenResponse.Value.AccessToken.Token, \r\n        PhoneNumber = "+12533192954", \r\n    }; \r\n\r\n    return Results.Json(result); \r\n}) \r\n.WithName("Token") \r\n.WithOpenApi(); \r\n\r\napp.MapPost("api/sentiment", (SentimentRequest request) => \r\n{ \r\n    var result = SentimentAnalysisWithAzureLanguage(request.Content); \r\n\u202f \r\n\r\n    return Results.Json(result); \r\n}) \r\n.WithName("Sentiment") \r\n.WithOpenApi(); \r\n\r\n\u202f\r\napp.Run(); \r\n\r\n\r\nSentimentResult SentimentAnalysisWithAzureLanguage(string document) \r\n{ \r\n    var review = textAnalyticsClient.AnalyzeSentiment(document); \r\n    return new SentimentResult() \r\n    { \r\n        Sentiment = review.Value.Sentiment.ToString(), \r\n        PositiveContentScore = review.Value.ConfidenceScores.Positive \r\n    }; \r\n} \r\n\r\n// // Function to get a response from OpenAI\'s ChatGPT \r\nSentimentResult SentimentAnalysisWithGPT(string document) \r\n{ \r\n    var chatCompletionsOptions = new ChatCompletionsOptions() \r\n    { \r\n        DeploymentName = "shawn-deployment", \r\n        Messages = \r\n            { \r\n                new ChatRequestSystemMessage(SentimentAnalysisPrompt), \r\n                new ChatRequestUserMessage(document), \r\n            }, \r\n        Temperature = (float)1, \r\n        MaxTokens = 800             \r\n    }; \r\n\r\n    Response<ChatCompletions> response = openAIClient.GetChatCompletions(chatCompletionsOptions); \r\n\r\n    return new SentimentResult() { \r\n        Sentiment = response.Value.Choices[0].Message.Content \r\n    }; \r\n} \r\npublic class TokenResponse \r\n{ \r\n    public string Token { get; set; } = string.Empty; \r\n    public string PhoneNumber { get; set; } = string.Empty; \r\n} \r\n\r\npublic class SentimentRequest \r\n{ \r\n    public string Analyzer { get; set; } = string.Empty; \r\n    public string ParticipantToAnalyze { get; set; } = string.Empty; \r\n    public string Content { get; set; } = string.Empty; \r\n} \r\n\r\npublic class SentimentResult \r\n{ \r\n    public string Sentiment { get; set; } = string.Empty; \r\n    public double PositiveContentScore { get; set; } \r\n} \n'})}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsxs)(n.p,{children:["Earn Microsoft-verified credentials for cloud-native app development skills by passing the ",(0,i.jsx)(n.a,{href:"https://learn.microsoft.com/credentials/applied-skills/deploy-cloud-native-apps-using-azure-container-apps/?ocid=buildia24_60days_blogs",children:"Azure Container Apps"})," assessment to elevate your professional profile."]})}),"\n",(0,i.jsx)(n.h3,{id:"connecting-the-frontend-with-the-aspnet-core-backend",children:"Connecting the Frontend with the ASP.NET Core Backend"}),"\n",(0,i.jsx)(n.p,{children:"After setting up the backend and the frontend of our real-time voice sentiment analysis application separately, it\u2019s time to connect them. This connection ensures that our Node.js frontend can communicate with the ASP.NET Core backend to do things like obtaining access tokens for Azure Communication Services and conducting sentiment analysis through Azure AI Language and Azure OpenAI."}),"\n",(0,i.jsx)(n.h4,{id:"step-1-get-the-access-token",children:"Step 1: Get the Access Token"}),"\n",(0,i.jsxs)(n.p,{children:["For our application to establish a call, the frontend needs to obtain an access token from Azure Communication Services. In the ",(0,i.jsx)(n.code,{children:"app.js"})," file within your Node.js project, modify the ",(0,i.jsx)(n.code,{children:"initCallAgent"})," function to fetch the token from the backend before initializing the call agent. Use the ",(0,i.jsx)(n.code,{children:"fetch"})," API for this purpose:"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"javascript"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"async function initCallAgent() { \r\n    try { \r\n        const response = await fetch('/api/communications/token'); \r\n        const { token, userId } = await response.json(); \r\n\r\n        const tokenCredential = new AzureCommunicationTokenCredential(token); \r\n        const callClient = new CallClient(); \r\n        callAgent = await callClient.createCallAgent(tokenCredential, { displayName: 'Caller' }); \r\n\r\n        attachCallListeners(); \r\n    } catch (error) { \r\n        console.error('Failed to obtain token:', error); \r\n    } \r\n} \n"})}),"\n",(0,i.jsx)(n.h4,{id:"step-2-implement-sentiment-analysis-on-captions",children:"Step 2: Implement Sentiment Analysis on Captions"}),"\n",(0,i.jsx)(n.p,{children:"Our application should analyze the sentiment of the transcribed call captions. We\u2019ll capture these captions on the frontend, then send them to our backend for sentiment analysis."}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Make Sentiment Analysis Request:"})}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["In the ",(0,i.jsx)(n.code,{children:"captionsReceivedHandler"}),", make a request to your backend sentiment analysis endpoint whenever captions are received. Update your captions event handler, under ",(0,i.jsx)(n.code,{children:"if (captionData.resultType === 'Final')"})," to include this:"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"javascript"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"if (captionData.resultType === 'Final') { \r\n    captionContainer.setAttribute('isNotFinal', 'false'); \r\n    transcript.push(captionText); \r\n\r\n    // Call the sentiment service \r\n    fetch('/api/sentiment', { \r\n        method: 'POST', \r\n        headers: { \r\n            'Content-Type': 'application/json' \r\n        }, \r\n        body: JSON.stringify({ content: transcript.join('\\n') }) \r\n    }) \r\n    .then(response => response.json()) \r\n    .then(data => { \r\n        // Handle the sentiment response \r\n        const sentimentText = `Sentiment:${data.sentiment} (${data.positiveContentScore})`; \r\n        document.getElementById('sentimentScore').textContent = captionText; \r\n\r\n        //update sentiment UI \r\n        updateSentimentMeter(data.positiveContentScore); \r\n\r\n    }); \r\n} \n"})}),"\n",(0,i.jsx)(n.h4,{id:"step-3-display-analysis-results",children:"Step 3: Display Analysis Results"}),"\n",(0,i.jsx)(n.p,{children:"Finally, utilize the sentiment analysis data received from the backend to inform the user about the call\u2019s sentiment in real-time."}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Update the UI Dynamically"}),":"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Enhance your frontend to dynamically display sentiment analysis results as they are received. We'll add an indicator for positive, neutral, or negative sentiment."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"javascript"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"function updateSentimentMeter(score) { \r\n    // Ensure score is between 0 and 1 \r\n    score = Math.max(0, Math.min(score, 1)); \r\n\r\n    // Convert score to angle: -90\xb0 for 0, 90\xb0 for 1 \r\n    var angle = score * 180 - 90; \r\n\r\n    // Rotate the arrow to the corresponding angle \r\n    document.getElementById('meterArrow').style.transform = 'rotate(' + angle + 'deg)'; \r\n} \n"})}),"\n",(0,i.jsx)(n.p,{children:"Create new elements in the HTML to display the sentiment score and meter:"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"html"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'<div id="captionsArea" ></div> \r\n<h4>Sentiment Score</h4> \r\n<div id="sentimentMeter" class="meter"> \r\n    <div id="meterArrow" class="arrow"></div> \r\n<div id="sentimentScore" ></div> \n'})}),"\n",(0,i.jsx)(n.p,{children:"Your complete code for app.js should look like this:"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"javascript"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"import { CallClient, CallAgent, Features } from \"@azure/communication-calling\"; \r\nimport { AzureCommunicationTokenCredential } from '@azure/communication-common'; \r\n\r\nlet call; \r\nlet callAgent; \r\n\r\nconst calleePhoneInput = document.getElementById(\"callee-phone-input\"); \r\nconst callPhoneButton = document.getElementById(\"call-phone-button\"); \r\nconst hangUpPhoneButton = document.getElementById(\"hang-up-phone-button\"); \r\n\r\nlet acsPhoneNumber; \r\nlet tokenCredential; \r\n\r\nlet captions; \r\n\r\nasync function init() { \r\n\r\n    const response = await fetch('/api/token');  \r\n    const { token, phoneNumber } = await response.json(); \r\n\r\n    tokenCredential = new AzureCommunicationTokenCredential(token); \r\n    acsPhoneNumber = phoneNumber; \r\n\r\n    const callClient = new CallClient(); \r\n    callAgent = await callClient.createCallAgent(tokenCredential); \r\n} \r\n\r\ninit(); \r\n\r\ncallPhoneButton.addEventListener(\"click\", () => { \r\n    // start a call to phone \r\n    const endpointToCall = calleePhoneInput.value; \r\n\r\n    const guidPattern = /^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i; \r\n    const phoneNumberPattern = /^\\+\\d+$/; \r\n    const userIdPattern = /^8:acs:[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}_[0-9a-f-]+$/i; \r\n\r\n    if (guidPattern.test(endpointToCall)) { \r\n        call = callAgent.join({ groupId: endpointToCall}); \r\n    } else if (phoneNumberPattern.test(endpointToCall)) { \r\n        call = callAgent.startCall( \r\n            [{phoneNumber: endpointToCall}], { alternateCallerId: {phoneNumber: acsPhoneNumber} \r\n        }); \r\n    } else if (userIdPattern.test(endpointToCall)) { \r\n        call = callAgent.startCall({ communicationUserId: endpointToCall }); \r\n    } else { \r\n        console.error('Invalid input. Must be a phone number, user ID, or GUID'); \r\n        return; \r\n    } \r\n\u202f \r\n\r\n    call.on('stateChanged', async () => { \r\n        console.log(`Call state: ${call.state}`); \r\n        if(call.state === 'Connected') { \r\n            console.log('Call connected'); \r\n                 \r\n\r\n            captions = call.feature(Features.Captions).captions; \r\n            transcript = []; \r\n            try { \r\n                if (!captions.isCaptionsFeatureActive) { \r\n                    await captions.startCaptions({ spokenLanguage: 'en-us' }); \r\n                } \r\n                captions.on('CaptionsReceived', captionsReceivedHandler); \r\n            } catch (e) { \r\n                console.error('startCaptions failed', e); \r\n            } \r\n        } \r\n    }); \r\n\r\n    hangUpPhoneButton.disabled = false; \r\n    callPhoneButton.disabled = true; \r\n  }); \r\n\r\n  hangUpPhoneButton.addEventListener(\"click\", () => { \r\n    // end the current call \r\n    call.hangUp({ \r\n      forEveryone: true \r\n    }); \r\n\r\n    // toggle button states \r\n    hangUpPhoneButton.disabled = true; \r\n    callPhoneButton.disabled = false; \r\n  }); \r\n\r\n  const captionsReceivedHandler = (captionData) => { \r\n    let mri = ''; \r\n\r\n    if (captionData.speaker.identifier.kind === 'communicationUser') { \r\n        mri = captionData.speaker.identifier.communicationUserId; \r\n        mri = mri.slice(-8); \r\n    } else if (captionData.speaker.identifier.kind === 'microsoftTeamsUser') { \r\n        mri = captionData.speaker.identifier.microsoftTeamsUserId; \r\n        mri = mri.slice(-8); \r\n    } else if (captionData.speaker.identifier.kind === 'phoneNumber') { \r\n        mri = captionData.speaker.identifier.phoneNumber; \r\n    } \r\n\r\n    let displayName = captionData.speaker.displayName || mri; \r\n\r\n    // Get the captions area container \r\n    let captionAreasContainer = document.getElementById('captionsArea'); \r\n\r\n    // Generate a class name based on the MRI \r\n    const newClassName = `prefix${mri.replace(/[:\\-+]/g, '')}`; \r\n\r\n    // Generate the caption text \r\n    const captionText = `${captionData.timestamp.toUTCString()} ${displayName}: ${captionData.captionText ?? captionData.spokenText}`; \r\n\r\n    // Try to find an existing caption container \r\n    let captionContainer = captionAreasContainer.querySelector(`.${newClassName}[isNotFinal='true']`); \r\n\r\n    // If no existing caption container was found, create a new one \r\n    if (!captionContainer) { \r\n        captionContainer = document.createElement('div'); \r\n        captionContainer.setAttribute('isNotFinal', 'true'); \r\n        captionContainer.classList.add(newClassName, 'caption-item'); \r\n        captionAreasContainer.appendChild(captionContainer); \r\n    } \r\n\r\n    // Set the caption text \r\n    captionContainer.textContent = captionText; \r\n\r\n    // If the caption is final, update the 'isNotFinal' attribute \r\n    if (captionData.resultType === 'Final') { \r\n        captionContainer.setAttribute('isNotFinal', 'false'); \r\n        transcript.push(captionText); \r\n\r\n\r\n         // Call the sentiment service \r\n         fetch('/api/sentiment', { \r\n            method: 'POST', \r\n            headers: { \r\n                'Content-Type': 'application/json' \r\n            }, \r\n            body: JSON.stringify({ content: transcript.join('\\n') }) \r\n        }) \r\n        .then(response => response.json()) \r\n        .then(data => { \r\n            // Handle the sentiment response \r\n            const sentimentText = `Sentiment:${data.sentiment} (${data.positiveContentScore})`; \r\n            document.getElementById('sentimentScore').textContent = captionText; \r\n            updateSentimentMeter(data.positiveContentScore); \r\n        }); \r\n    } \r\n\r\n    function updateSentimentMeter(score) { \r\n        // Ensure score is between 0 and 1 \r\n        score = Math.max(0, Math.min(score, 1)); \r\n\r\n        // Convert score to angle: -90\xb0 for 0, 90\xb0 for 1 \r\n        var angle = score * 180 - 90; \r\n\r\n        // Rotate the arrow to the corresponding angle \r\n        document.getElementById('meterArrow').style.transform = 'rotate(' + angle + 'deg)'; \r\n    } \r\n}; \n"})}),"\n",(0,i.jsx)(n.p,{children:"... and the HTML should look like this"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"HTML"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'<!DOCTYPE html> \r\n<html lang="en"> \r\n<head> \r\n    <meta charset="utf-8"> \r\n    <meta name="viewport" content="width=device-width, initial-scale=1.0"> \r\n    <title>Azure Communication Service - Realtime Sentiment Analysis</title> \r\n    <link rel="stylesheet" href="styles.css"> \r\n  </head> \r\n  <body> \r\n    <h4>Azure Communication Services</h4> \r\n    <input  \r\n      id="callee-phone-input" \r\n      type="text" \r\n      placeholder="Who would you like to call?" \r\n    /> \r\n    <div> \r\n      <button id="call-phone-button" type="button"> \r\n        Start Call \r\n      </button> \r\n      &nbsp; \r\n      <button id="hang-up-phone-button" type="button" disabled="true"> \r\n        Hang Up \r\n      </button> \r\n      <div id="captionsArea" ></div> \r\n      <h4>Sentiment Score</h4> \r\n      <div id="sentimentMeter" class="meter"> \r\n        <div id="meterArrow" class="arrow"></div> \r\n      <div id="sentimentScore" ></div> \r\n    </div> \r\n\r\n    </div> \r\n    <script src="./app.js" type="module"><\/script> \r\n  </body> \r\n</html> \n'})}),"\n",(0,i.jsx)(n.h4,{id:"testing-the-complete-system",children:"Testing the Complete System"}),"\n",(0,i.jsx)(n.p,{children:"With the frontend and backend now connected, thoroughly test your application:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Ensure the voice call setup and teardown works flawlessly."}),"\n",(0,i.jsx)(n.li,{children:"Verify that captions are accurately captured and displayed."}),"\n",(0,i.jsx)(n.li,{children:"Confirm that sentiment analysis requests are successfully handled and that the results make sense for the given captions."}),"\n"]}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsxs)(n.p,{children:["Explore a variety of Azure Container Apps ",(0,i.jsx)(n.a,{href:"https://learn.microsoft.com/samples/browse/?terms=azure%20container%20apps&ocid=buildia24_60days_blogs",children:"code samples"})," for a quick start to your intelligent app development with cloud-native technologies."]})}),"\n",(0,i.jsx)(n.h3,{id:"deployment",children:"Deployment"}),"\n",(0,i.jsx)(n.p,{children:"With the real-time voice sentiment analysis system fully developed, including both the frontend and backend components, the next critical step is deployment. We'll deploy the ASP.NET Core backend using Azure Container Apps and the Node.js frontend through Azure Static Web Apps."}),"\n",(0,i.jsx)(n.h4,{id:"step-1-prepare-the-backend-for-deployment",children:"Step 1: Prepare the Backend for Deployment"}),"\n",(0,i.jsx)(n.h5,{id:"create-a-dockerfile",children:"Create a Dockerfile"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Navigate to Your Backend Project Directory"}),": Open the terminal or command prompt and ensure you're in the root directory of your ASP.NET Core project."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Create a Dockerfile"}),": In the root of your project, create a file named ",(0,i.jsx)(n.code,{children:"Dockerfile"})," with no file extension. This file will contain instructions for building a Docker image for your application."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Define the Dockerfile Contents"}),": Open the ",(0,i.jsx)(n.code,{children:"Dockerfile"})," in your editor and add the following content:"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Dockerfile"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'FROM mcr.microsoft.com/dotnet/aspnet:6.0 AS base \r\nWORKDIR /app \r\nEXPOSE 80 \r\n\r\nFROM mcr.microsoft.com/dotnet/sdk:6.0 AS build \r\nWORKDIR /src \r\nCOPY ["VoiceSentimentBackend.csproj", "."] \r\nRUN dotnet restore "./VoiceSentimentBackend.csproj" \r\nCOPY . . \r\nWORKDIR "/src/." \r\nRUN dotnet build "VoiceSentimentBackend.csproj" -c Release -o /app/build \r\n\r\nFROM build AS publish \r\nRUN dotnet publish "VoiceSentimentBackend.csproj" -c Release -o /app/publish \r\n\r\nFROM base AS final \r\nWORKDIR /app \r\nCOPY --from=publish /app/publish . \r\nENTRYPOINT ["dotnet", "VoiceSentimentBackend.dll"] \n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Note"}),": Adjust ",(0,i.jsx)(n.code,{children:'"VoiceSentimentBackend.csproj"'})," to match your project's name."]}),"\n",(0,i.jsx)(n.h5,{id:"create-and-test-the-docker-image-locally",children:"Create and Test the Docker Image Locally"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Build the Docker Image"}),": Run the following command in your terminal:"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"bash"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"docker build -t voicesentimentbackend .\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Run Your Docker Container"}),": To test the Docker container locally, execute:"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"bash"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"docker run -d -p 8080:80 --name myapp voicesentimentbackend\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Verify"}),": Open your browser and navigate to ",(0,i.jsx)(n.code,{children:"http://localhost:8080/api/token"})," to ensure your application is running correctly in the container."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"step-2-deploy-the-backend-to-azure-container-apps",children:"Step 2: Deploy the Backend to Azure Container Apps"}),"\n",(0,i.jsx)(n.p,{children:"Azure Container Apps offers a fully managed serverless container service. It's an excellent choice for deploying containers without managing complex infrastructure."}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Create a Container App Environment"}),": Use VS Code to create an Azure Container App and deploy your backend. Follow the ",(0,i.jsx)(n.a,{href:"https://learn.microsoft.com/azure/container-apps/deploy-visual-studio-code?ocid=buildia24_60days_blogs",children:"official documentation"}),' for detailed instructions. Type Crtl+Shift+P to open the command palette and type "Azure Container Apps: Create New Container App" and follow the prompts.']}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Verify Deployment"}),": Use the FQDN obtained from the previous command to verify your application is accessible via the internet."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"step-3-deploy-the-frontend-to-azure-static-web-apps",children:"Step 3: Deploy the Frontend to Azure Static Web Apps"}),"\n",(0,i.jsx)(n.p,{children:"Azure Static Web Apps is a service tailored for static web applications, providing global distribution, serverless APIs, and seamless integration with GitHub for continuous deployment."}),"\n",(0,i.jsx)(n.h5,{id:"setting-up-continuous-deployment-with-github",children:"Setting Up Continuous Deployment with GitHub"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Push Your Frontend Code to GitHub"}),": Ensure your Node.js frontend code is in a GitHub repository."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Create a Static Web App Resource"}),": In the Azure Portal, create a new Static Web App resource and connect it to your GitHub repository. Specify your build details during the setup."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Verify Deployment"}),": Once the GitHub Actions workflow is completed, your Static Web App will be accessible via the provided URL. Check it to ensure your frontend is live and functional."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"conclusion",children:"Conclusion"}),"\n",(0,i.jsx)(n.p,{children:"Over the course of this guide, you've:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Set up and configured critical Azure resources, including Azure Communication Services for managing voice calls, Azure AI Language for basic sentiment analysis, and Azure OpenAI for more nuanced sentiment insights."}),"\n",(0,i.jsx)(n.li,{children:"Developed a Node.js frontend to interface with users, initiating and managing voice calls, and dynamically displaying sentiment analysis results."}),"\n",(0,i.jsx)(n.li,{children:"Implemented an ASP.NET Core backend to handle business logic, interact with Azure services, and provide APIs for the frontend."}),"\n",(0,i.jsx)(n.li,{children:"Connected your frontend and backend, ensuring seamless communication and data flow within your application."}),"\n",(0,i.jsx)(n.li,{children:"Deployed your application to Azure, leveraging Azure Container Apps for the backend and Azure Static Web Apps for the frontend, making your project accessible from anywhere."}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"future-enhancements",children:"Future Enhancements"}),"\n",(0,i.jsx)(n.p,{children:"While your current application is fully functional, there's always room for improvement and expansion. Consider the following possibilities for future development:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Language Support"}),": Expand the application to support additional languages, enhancing its accessibility and utility across different geographical locations."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Advanced AI Insights"}),": Explore deeper insights beyond sentiment, such as emotional tone, intent recognition, or specific topic detection, to provide more detailed analysis of voice calls."]}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},11151:(e,n,t)=>{t.d(n,{Z:()=>o,a:()=>a});var i=t(67294);const r={},s=i.createContext(r);function a(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);