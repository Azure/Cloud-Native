"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[7192],{9493:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>p,frontMatter:()=>s,metadata:()=>o,toc:()=>c});var i=n(85893),a=n(11151);const s={date:"2023-10-16T09:00",slug:"deploy-an-intelligent-app-on-azure-container-apps-1",title:"3-1. Deploy an Intelligent App on Azure Container Apps (1)",authors:["cnteam"],draft:!1,hide_table_of_contents:!1,toc_min_heading_level:2,toc_max_heading_level:3,keywords:["Cloud","Data","AI","AI/ML","intelligent apps","cloud-native","30-days","enterprise apps","digital experiences","app modernization","serverless","ai apps","data"],image:"https://azure.github.io/Cloud-Native/img/ogImage.png",description:"Explore the power of multi-model databases for Intelligent Apps and their integration with Azure Cosmos DB and Azure Kubernetes Service (AKS).",tags:["Build-Intelligent-Apps","30-days-of-IA","learn-live","hack-together","community-buzz","ask-the-expert","azure-kubernetes-service","azure-functions","azure-openai","azure-container-apps","azure-cosmos-db","github-copilot","github-codespaces","github-actions"]},r=void 0,o={permalink:"/Cloud-Native/30DaysOfIA/deploy-an-intelligent-app-on-azure-container-apps-1",source:"@site/blog-30daysofIA/2023-10-16/deploy-an-intelligent-app-on-azure-container-apps-1.md",title:"3-1. Deploy an Intelligent App on Azure Container Apps (1)",description:"Explore the power of multi-model databases for Intelligent Apps and their integration with Azure Cosmos DB and Azure Kubernetes Service (AKS).",date:"2023-10-16T09:00:00.000Z",formattedDate:"October 16, 2023",tags:[{label:"Build-Intelligent-Apps",permalink:"/Cloud-Native/30DaysOfIA/tags/build-intelligent-apps"},{label:"30-days-of-IA",permalink:"/Cloud-Native/30DaysOfIA/tags/30-days-of-ia"},{label:"learn-live",permalink:"/Cloud-Native/30DaysOfIA/tags/learn-live"},{label:"hack-together",permalink:"/Cloud-Native/30DaysOfIA/tags/hack-together"},{label:"community-buzz",permalink:"/Cloud-Native/30DaysOfIA/tags/community-buzz"},{label:"ask-the-expert",permalink:"/Cloud-Native/30DaysOfIA/tags/ask-the-expert"},{label:"azure-kubernetes-service",permalink:"/Cloud-Native/30DaysOfIA/tags/azure-kubernetes-service"},{label:"azure-functions",permalink:"/Cloud-Native/30DaysOfIA/tags/azure-functions"},{label:"azure-openai",permalink:"/Cloud-Native/30DaysOfIA/tags/azure-openai"},{label:"azure-container-apps",permalink:"/Cloud-Native/30DaysOfIA/tags/azure-container-apps"},{label:"azure-cosmos-db",permalink:"/Cloud-Native/30DaysOfIA/tags/azure-cosmos-db"},{label:"github-copilot",permalink:"/Cloud-Native/30DaysOfIA/tags/github-copilot"},{label:"github-codespaces",permalink:"/Cloud-Native/30DaysOfIA/tags/github-codespaces"},{label:"github-actions",permalink:"/Cloud-Native/30DaysOfIA/tags/github-actions"}],readingTime:13.565,hasTruncateMarker:!1,authors:[{name:"It's 30DaysOfIA",title:"BuildIA Content Team",url:"https://azure.github.io/Cloud-Native/Build-IA/",imageURL:"https://azure.github.io/Cloud-Native/img/logo-ms-cloud-native.png",key:"cnteam"}],frontMatter:{date:"2023-10-16T09:00",slug:"deploy-an-intelligent-app-on-azure-container-apps-1",title:"3-1. Deploy an Intelligent App on Azure Container Apps (1)",authors:["cnteam"],draft:!1,hide_table_of_contents:!1,toc_min_heading_level:2,toc_max_heading_level:3,keywords:["Cloud","Data","AI","AI/ML","intelligent apps","cloud-native","30-days","enterprise apps","digital experiences","app modernization","serverless","ai apps","data"],image:"https://azure.github.io/Cloud-Native/img/ogImage.png",description:"Explore the power of multi-model databases for Intelligent Apps and their integration with Azure Cosmos DB and Azure Kubernetes Service (AKS).",tags:["Build-Intelligent-Apps","30-days-of-IA","learn-live","hack-together","community-buzz","ask-the-expert","azure-kubernetes-service","azure-functions","azure-openai","azure-container-apps","azure-cosmos-db","github-copilot","github-codespaces","github-actions"]},unlisted:!1,prevItem:{title:"2-6. Scaling Intelligent Apps on Azure Kubernetes Services (2)",permalink:"/Cloud-Native/30DaysOfIA/scaling-intelligent-apps-on-azure-kubernetes-services-2"},nextItem:{title:"3-2. Deploy an Intelligent App on Azure Container Apps (2)",permalink:"/Cloud-Native/30DaysOfIA/deploy-an-intelligent-app-on-azure-container-apps-2"}},l={authorsImageUrls:[void 0]},c=[{value:"What We&#39;ll Cover:",id:"what-well-cover",level:2},{value:"Deploy an Intelligent App on Azure Container Apps with Azure AI (1)",id:"deploy-an-intelligent-app-on-azure-container-apps-with-azure-ai-1",level:2},{value:"Solution Architecture",id:"solution-architecture",level:3},{value:"Understanding Azure AI and Azure Container Apps",id:"understanding-azure-ai-and-azure-container-apps",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Setting Up Your Azure Environment",id:"setting-up-your-azure-environment",level:2},{value:"Designing the Intelligent App",id:"designing-the-intelligent-app",level:2},{value:"Building the Basic App",id:"building-the-basic-app",level:3},{value:"Adding the Models and Connecting the Database",id:"adding-the-models-and-connecting-the-database",level:3},{value:"Building the Database Structure and Adding Products",id:"building-the-database-structure-and-adding-products",level:3},{value:"Creating Views",id:"creating-views",level:3},{value:"Exercise",id:"exercise",level:2},{value:"Next Steps",id:"next-steps",level:2}];function d(e){const t={a:"a",admonition:"admonition",br:"br",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.a)(),...e.components},{Head:s}=t;return s||function(e,t){throw new Error("Expected "+(t?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Head",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(s,{children:[(0,i.jsx)("meta",{property:"og:url",content:"https://azure.github.io/cloud-native/30daysofia/deploy-an-intelligent-app-on-azure-container-apps-1"}),(0,i.jsx)("meta",{property:"og:type",content:"website"}),(0,i.jsx)("meta",{property:"og:title",content:"Build Intelligent Apps!| Build AI Apps On Azure"}),(0,i.jsx)("meta",{property:"og:description",content:"Create a user feedback analysis application by setting up an Azure environment to deploy and manage the app using Azure Container Apps and Azure AI"}),(0,i.jsx)("meta",{property:"og:image",content:"https://azure.github.io/Cloud-Native/img/ogImage.png"}),(0,i.jsx)("meta",{name:"twitter:url",content:"https://azure.github.io/Cloud-Native/30daysofIA/deploy-an-intelligent-app-on-azure-container-apps-1"}),(0,i.jsx)("meta",{name:"twitter:title",content:"Build Intelligent Apps! | Build AI Apps On Azure"}),(0,i.jsx)("meta",{name:"twitter:description",content:"3-1. Create a user feedback analysis application by setting up an Azure environment to deploy and manage the app using Azure Container Apps and Azure AI."}),(0,i.jsx)("meta",{name:"twitter:image",content:"https://azure.github.io/Cloud-Native/img/ogImage.png"}),(0,i.jsx)("meta",{name:"twitter:card",content:"summary_large_image"}),(0,i.jsx)("meta",{name:"twitter:creator",content:"@devanshidiaries"}),(0,i.jsx)("meta",{name:"twitter:site",content:"@AzureAdvocates"}),(0,i.jsx)("link",{rel:"canonical",href:"https://azure.github.io/Cloud-Native/30daysofIA/deploy-an-intelligent-app-on-azure-container-apps-1"})]}),"\n",(0,i.jsxs)(t.p,{children:["In this article, explore how to create a user feedback analysis application by setting up an Azure environment to deploy and manage the app using ",(0,i.jsx)(t.a,{href:"https://learn.microsoft.com/en-us/azure/container-apps/?WT.mc_id=javascript-99907-ninarasi",children:"Azure Container Apps"})," and ",(0,i.jsx)(t.a,{href:"https://learn.microsoft.com/en-us/azure/ai-services/?WT.mc_id=javascript-99907-ninarasi",children:"Azure AI"}),"."]}),"\n",(0,i.jsx)(t.h2,{id:"what-well-cover",children:"What We'll Cover:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Understanding Azure AI and Azure Container Apps"}),"\n",(0,i.jsx)(t.li,{children:"Setting up your Azure environment"}),"\n",(0,i.jsx)(t.li,{children:"Designing the intelligent application"}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"image of an intelligent app on Azure",src:n(38447).Z+"",width:"624",height:"380"})}),"\n",(0,i.jsx)(t.h2,{id:"deploy-an-intelligent-app-on-azure-container-apps-with-azure-ai-1",children:"Deploy an Intelligent App on Azure Container Apps with Azure AI (1)"}),"\n",(0,i.jsx)(t.p,{children:"As developers, we\u2019re all acutely aware of how artificial intelligence (AI) has transformed and revolutionized application development. AI technologies like machine learning (ML) and natural language processing (NLP) have enabled us to create a personalized, adaptive user experience\u2014Intelligent Apps. Intelligent Apps leverage AI algorithms to learn from user interactions and make real-time decisions."}),"\n",(0,i.jsx)(t.p,{children:"As the demand for Intelligent Apps continues to soar, we\u2019ll increasingly need to integrate AI components into our applications. This work can be complex and resource-intensive, but it doesn\u2019t have to be."}),"\n",(0,i.jsxs)(t.p,{children:["In this article\u2014the first of a series on building Intelligent Apps with ",(0,i.jsx)(t.a,{href:"https://learn.microsoft.com/en-us/azure/container-apps/?WT.mc_id=javascript-99907-ninarasi",children:"Azure Container Apps"}),"\u2014we\u2019ll explore how to incorporate AI into an application and transition that app to production. We\u2019ll create a user feedback analysis application and walk through setting up an Azure environment, then deploying and managing the app using Azure Container Apps."]}),"\n",(0,i.jsx)(t.h3,{id:"solution-architecture",children:"Solution Architecture"}),"\n",(0,i.jsx)(t.p,{children:"The image below shows the architecture of the solution we\u2019re aiming for in this article."}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"image showing architecture of the solution described in this article",src:n(54052).Z+"",width:"624",height:"392"})}),"\n",(0,i.jsx)(t.h2,{id:"understanding-azure-ai-and-azure-container-apps",children:"Understanding Azure AI and Azure Container Apps"}),"\n",(0,i.jsxs)(t.p,{children:["In this tutorial, we\u2019ll use a combination of ",(0,i.jsx)(t.a,{href:"https://azure.microsoft.com/en-us/products/ai-services/openai-service?WT.mc_id=javascript-99907-ninarasi",children:"Azure OpenAI"}),"\u2014a tool for creating Intelligent Apps using large language models (LLMs)\u2014and ",(0,i.jsx)(t.a,{href:"https://azure.microsoft.com/en-us/products/container-apps?WT.mc_id=javascript-99907-ninarasi",children:"Azure Container Apps"}),"\u2014a fully managed Kubernetes-based platform that helps us deploy from containers and code. These two dynamic tools will serve as the backbone of our app\u2019s functionality."]}),"\n",(0,i.jsxs)(t.p,{children:["Azure Open AI will infuse intelligence into our application through APIs that process our data. Specifically, we\u2019ll leverage the ",(0,i.jsx)(t.a,{href:"https://azure.microsoft.com/en-ca/products/cognitive-services/language-service/?WT.mc_id=javascript-99907-ninarasi",children:"Sentiment Analysis API"})," to assess customer sentiment from their feedback and reviews."]}),"\n",(0,i.jsx)(t.p,{children:"On the front end, we\u2019ll employ Azure Container Apps to deploy our Kubernetes-based application. This approach relieves us from worrying about any infrastructure orchestration, enabling our application to scale up and down to meet load requirements."}),"\n",(0,i.jsxs)(t.p,{children:["Finally, we\u2019ll use ",(0,i.jsx)(t.a,{href:"https://learn.microsoft.com/en-us/azure/azure-sql/azure-sql-iaas-vs-paas-what-is-overview?view=azuresql&viewFallbackFrom=azuresql&WT.mc_id=3Djavascript-99907-ninarasi",children:"Azure SQL Database"})," to store both the feedback and sentiment datasets."]}),"\n",(0,i.jsx)(t.admonition,{type:"info",children:(0,i.jsxs)(t.p,{children:["Watch the ",(0,i.jsx)(t.a,{href:"https://azure.github.io/Cloud-Native/Build-IA/LearnLive/?WT.mc_id=javascript-99907-ninarasi",children:"on-demand Learn Live serverless series"})," that deconstructs a reference architecture for building intelligent apps using Azure Container Apps and Azure AI."]})}),"\n",(0,i.jsx)(t.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,i.jsx)(t.p,{children:"To follow this tutorial, you\u2019ll need:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["An Azure account. Signing up for a ",(0,i.jsx)(t.a,{href:"https://azure.microsoft.com/en-us/free/",children:"free account"})," gives you complimentary credits for the first month and access to a number of basic services. When you create a new account, you\u2019ll have to provide a credit card to verify transactions in case you use more resources than your allocation. For these articles, we\u2019ll minimize spending as much as possible."]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.a,{href:"https://www.docker.com/products/docker-desktop/",children:"Docker Desktop"})," version 3.5.1 or newer installed"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.a,{href:"https://visualstudio.microsoft.com/vs/community/",children:"Visual Studio"})," installed. This demonstration uses Community Edition 2022."]}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:["To see the project in action, check out the ",(0,i.jsx)(t.a,{href:"https://github.com/contentlab-io/Microsoft-Building-Your-First-Intelligent-App-with-Azure-Cognitive-Services/tree/main/Microsoft_Series_2_Code/Source%20-%20Article%207%20%2B%208/UserFeedbackApp/Models",children:"complete project code"}),"."]}),"\n",(0,i.jsx)(t.h2,{id:"setting-up-your-azure-environment",children:"Setting Up Your Azure Environment"}),"\n",(0,i.jsx)(t.p,{children:"Before we design our application, we need to configure our Azure environment, Visual Studio, and a basic application template."}),"\n",(0,i.jsxs)(t.p,{children:["First, we need an Azure account with a resource group ready to deploy our application. We\u2019ll start by creating a new resource group to hold all our project items. Log in, click ",(0,i.jsx)(t.strong,{children:"Resource Groups"}),", and hit ",(0,i.jsx)(t.strong,{children:"Create"}),"."]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"image of Azure services within Azure",src:n(87504).Z+"",width:"624",height:"313"})}),"\n",(0,i.jsxs)(t.p,{children:["Now, name your resource group and set the location. For this demo, we\u2019ll name the resource group \u201cUserFeedbackApp\u201d and select ",(0,i.jsx)(t.strong,{children:"East US"})," as the default region. Next, click ",(0,i.jsx)(t.strong,{children:"Review + create"}),"."]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"image of set up of an Azure service",src:n(60504).Z+"",width:"624",height:"685"})}),"\n",(0,i.jsx)(t.p,{children:"Now, navigate to the resource group section in Azure Portal on the left. Open it and create a new Azure AI multi-service instance. To do this, search for \u201cAzure AI\u201d in the Azure Marketplace and add it."}),"\n",(0,i.jsx)(t.p,{children:"You\u2019ll now have to name and configure the instance. For this demonstration, we\u2019ll use \u201cUserFeedbackAppAI\u201d and leave everything else as the default."}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Note:"})," The defaults are fine for this tutorial, but in a production environment, you may want to configure the instance under the ",(0,i.jsx)(t.strong,{children:"Network"})," tab for better access."]}),"\n",(0,i.jsx)(t.p,{children:"We also need to create an SQL Database to store our data. Back in the Azure Marketplace, search for Azure SQL to spot the SQL Database option. Create a database and a server to host it in the same resource group we just created."}),"\n",(0,i.jsx)(t.p,{children:"This demonstration uses the development tier and a basic server to keep costs low. Name the SQL database \u201cUserFeedbackDatabase\u201d and use a local administrator account rather than the identity-based access option."}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"image SQL database settings at set up",src:n(44195).Z+"",width:"624",height:"511"})}),"\n",(0,i.jsxs)(t.p,{children:["Next, we need to create several resources for the container application itself. Open Visual Studio and select ",(0,i.jsx)(t.strong,{children:"Create a new project"}),". Go with the new, standard ",(0,i.jsx)(t.strong,{children:"ASP.NET Core Web App (Model-View-Controller)"})," option for this tutorial. Find that template, name your project, and select a location to save it."]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"image of project templates",src:n(91255).Z+"",width:"624",height:"175"})}),"\n",(0,i.jsxs)(t.p,{children:["To containerize our application, we need to select ",(0,i.jsx)(t.strong,{children:"Enable Docker"})," on the next screen. This option bundles our application with a Dockerfile, which is essential for building the infrastructure to support it. Leave the default Linux OS selected for the Docker container."]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"image of additional settings for project",src:n(35886).Z+"",width:"624",height:"277"})}),"\n",(0,i.jsx)(t.p,{children:"Now, allow Visual Studio to build the templated project."}),"\n",(0,i.jsxs)(t.p,{children:["Next, run the application using Docker from Visual Studio. Once there, click ",(0,i.jsx)(t.strong,{children:"play"})," to build and run the application, push it to your local Docker environment, and launch a web browser to view the static opening page."]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"image of the opening page",src:n(11140).Z+"",width:"624",height:"207"})}),"\n",(0,i.jsxs)(t.p,{children:["With our application running locally, it\u2019s time to publish it. We do this so we can create the required container resources and have Visual Studio keep the configuration in our publishing profile. Right-click on the project, choose ",(0,i.jsx)(t.strong,{children:"Publish"}),", add a profile for publishing, click ",(0,i.jsx)(t.strong,{children:"Azure"}),", and name it ",(0,i.jsx)(t.strong,{children:"Azure Container Apps (Linux)"}),"."]}),"\n",(0,i.jsxs)(t.p,{children:["On the Container App screen, double-check that you\u2019re logged into your Azure account and that your subscription name is populated. Click ",(0,i.jsx)(t.strong,{children:"Create new"}),". Give your application and container a name, ensuring the right subscription and resource group are selected. You can also specify/name the Container Apps environment by selecting ",(0,i.jsx)(t.strong,{children:"New"}),". Otherwise, keep the default name."]}),"\n",(0,i.jsxs)(t.p,{children:["Finally, click ",(0,i.jsx)(t.strong,{children:"Create"})," to finalize the Container App setup."]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"image of container app setup",src:n(44166).Z+"",width:"592",height:"490"})}),"\n",(0,i.jsxs)(t.p,{children:["We also need to specify a ",(0,i.jsx)(t.a,{href:"https://azure.microsoft.com/en-ca/products/container-registry",children:"Container Registry"})," to store the application and its configuration that we\u2019ll publish into the container. Name the registry a name (let\u2019s say, \u201cUserFeedbackAppRegistry\u201d) and click ",(0,i.jsx)(t.strong,{children:"Create"}),"."]}),"\n",(0,i.jsxs)(t.p,{children:["During the container-building process, you\u2019ll have to enable admin rights for the container. Click ",(0,i.jsx)(t.strong,{children:"Yes"})," and wait for the infrastructure to build."]}),"\n",(0,i.jsxs)(t.p,{children:["Now, you can use the publish profile to push your Azure Web App to your Container App on Azure. Check out the infrastructure you\u2019ve created by opening the Azure Portal and navigating to the ",(0,i.jsx)(t.strong,{children:"Resource"})," folder."]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"image of resources list in Azure",src:n(47219).Z+"",width:"613",height:"428"})}),"\n",(0,i.jsx)(t.h2,{id:"designing-the-intelligent-app",children:"Designing the Intelligent App"}),"\n",(0,i.jsx)(t.p,{children:"With the groundwork laid, it\u2019s time to design and develop our application. This tutorial revolves around a simple use case: building a merchandise store feedback function. It will allow users to select a product and leave feedback using freeform text."}),"\n",(0,i.jsx)(t.p,{children:"Next, we\u2019ll save that feedback to our database. Subsequently, we\u2019ll send a call to the Azure AI API to perform sentiment analysis on the feedback, and then store the outcome in our database. Finally, based on these results, we\u2019ll create a report page showing our product sentiment."}),"\n",(0,i.jsx)(t.p,{children:"Let\u2019s get started."}),"\n",(0,i.jsx)(t.h3,{id:"building-the-basic-app",children:"Building the Basic App"}),"\n",(0,i.jsx)(t.p,{children:"Our goal is to enable users to leave feedback on a selection of products for future sentiment analysis. To facilitate this, we need a basic web application with database read and write capabilities."}),"\n",(0,i.jsx)(t.h3,{id:"adding-the-models-and-connecting-the-database",children:"Adding the Models and Connecting the Database"}),"\n",(0,i.jsx)(t.p,{children:"The initial function on our checklist is the capability to retrieve various products from our SQL database. This will allow us to populate a drop-down menu displaying a list of our products, which users can then write a review for."}),"\n",(0,i.jsx)(t.p,{children:"To configure the database connection for our application, install the following packages using the Package Manager in Visual Studio:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.code,{children:"Microsoft.EntityFrameworkCore"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.code,{children:"Microsoft.EntityFrameworkCore.Tools"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.code,{children:"Microsoft.EntityFrameworkCore.SqlServer"})}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"image of installed packages",src:n(35957).Z+"",width:"624",height:"125"})}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"image of browsing packages in Azure",src:n(39768).Z+"",width:"624",height:"119"})}),"\n",(0,i.jsxs)(t.p,{children:["Next, create two models for your data\u2014a ",(0,i.jsx)(t.code,{children:"Product"})," and a ",(0,i.jsx)(t.code,{children:"Review"}),"\u2014by adding the following code to the Models folder. First, create a ",(0,i.jsx)(t.code,{children:"Product.cs"})," file with the following code:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"namespace UserFeedbackApp.Models\n{\n    public class Product\n    {\n        public int Id { get; set; }\n        public string Name { get; set; }\n    }\n}\n"})}),"\n",(0,i.jsxs)(t.p,{children:["Then, create a ",(0,i.jsx)(t.code,{children:"Review.cs"})," file in the models directory with the following code:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"namespace UserFeedbackApp.Models\n{\n    public class Review\n    {\n        public int Id { get; set; }\n        public int ProductId { get; set; }\n        public string ProductName { get; set; }\n        public string ReviewText { get; set; }\n        public string PostDate { get; set; }\n \n        public string Sentiment { get; set; }\n        public float PositiveValue { get; set; }\n        public float NeutralValue { get; set; }\n        public float NegativeValue { get; set; }\n    }\n}\n"})}),"\n",(0,i.jsxs)(t.p,{children:["To bridge the gap between our models and the interface, we need a ",(0,i.jsx)(t.code,{children:"DbContext"})," class. Create a ",(0,i.jsx)(t.code,{children:"DatabaseContext.cs"})," file within the Models folder and populate it as follows:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"using Microsoft.EntityFrameworkCore;\n \nnamespace UserFeedbackApp.Models\n{\n    public class DatabaseContext : DbContext\n    {\n        private readonly string _connectionString;\n \n        public DatabaseContext(DbContextOptions<DatabaseContext> options) : base(options)\n        {\n        }\n \n        protected override void OnConfiguring(DbContextOptionsBuilder optionsBuilder)\n        {\n            base.OnConfiguring(optionsBuilder);\n        }\n \n        public DbSet<Product> Products => Set<Product>();\n        public DbSet<Review> Reviews => Set<Review>();\n    }\n}\n"})}),"\n",(0,i.jsxs)(t.p,{children:["The next step is to configure a connection to the Azure SQL database we just created. Double-click ",(0,i.jsx)(t.strong,{children:"Connected Services"})," in your project hierarchy and add a new ",(0,i.jsx)(t.strong,{children:"Service Dependency"}),". Select ",(0,i.jsx)(t.strong,{children:"Azure SQL database"})," and locate the one you created earlier. Then, edit the dependency details, ensuring you assign a database connection string name \u2014 you\u2019ll use it shortly. Click ",(0,i.jsx)(t.strong,{children:"Finish"}),"."]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"image of dependency setup in Azure SQL database",src:n(39769).Z+"",width:"624",height:"436"})}),"\n",(0,i.jsx)(t.p,{children:"This action creates the connection details for our database."}),"\n",(0,i.jsxs)(t.p,{children:["Now, modify the ",(0,i.jsx)(t.code,{children:"Program.cs"})," file to establish a connection to the database using the following code:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:'using Microsoft.EntityFrameworkCore;\nusing UserFeedbackApp.Models;\n \nvar builder = WebApplication.CreateBuilder(args);\n \n// Add Database Context\nif (builder.Environment.IsDevelopment())\n{\n    builder.Services.AddDbContext<DatabaseContext>(options =>\n        options.UseSqlServer(builder.Configuration["userfeedbackdatabaseconnection"]));\n}\nelse\n{\n    builder.Services.AddDbContext<DatabaseContext>(options =>\n        options.UseSqlServer(Environment.GetEnvironmentVariable("AZURE_SQL_CONNECTIONSTRING")));\n}\n'})}),"\n",(0,i.jsx)(t.p,{children:"This code uses an if statement to check the application\u2019s environment, either development or production. Depending on the environment, it uses either our local connection secret in development or the Azure connection string when published."}),"\n",(0,i.jsx)(t.h3,{id:"building-the-database-structure-and-adding-products",children:"Building the Database Structure and Adding Products"}),"\n",(0,i.jsxs)(t.p,{children:["With the code configured, we can now use Entity Framework tools to build our database structure. Open a Developer PowerShell window at the bottom of Visual Studio by selecting ",(0,i.jsx)(t.strong,{children:"View > Terminal"}),". Ensure you select ",(0,i.jsx)(t.strong,{children:"Developer PowerShell"})," in the drop-down and navigate to your project directory. Run the following commands:"]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.code,{children:"dotnet tool install dotnet-ef \u2013global"}),(0,i.jsx)(t.br,{}),"\n",(0,i.jsx)(t.code,{children:"dotnet ef migrations add Initial"}),(0,i.jsx)(t.br,{}),"\n",(0,i.jsx)(t.code,{children:"dotnet ef database update"})]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"image of commands in Developer PowerShell window",src:n(9872).Z+"",width:"624",height:"192"})}),"\n",(0,i.jsxs)(t.p,{children:["These three commands will create our basic database structure using the previously defined models for ",(0,i.jsx)(t.code,{children:"Products"})," and ",(0,i.jsx)(t.code,{children:"Review"}),"."]}),"\n",(0,i.jsxs)(t.p,{children:["Next, let\u2019s manually prepopulate some ",(0,i.jsx)(t.code,{children:"Product"})," data for reading. Open the Azure Console, navigate to your database in the apps resource group, and locate the Query Editor on the left-hand side. Use the following query to populate our Products table:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"SET IDENTITY_INSERT Products ON;\nINSERT INTO Products (id, name)\nVALUES (1, 'Apple Laptops'), (2, 'Camcorders'), (3, 'Cell Phones & Smartphones'), (4, 'Circular Saws'), (5, 'Clippers & Trimmers'), (6, 'Cordless Drills'), (7, 'Digital Cameras'), (8, 'Electric Toothbrushes'), (9, 'Headphones'), (10, 'Headsets'), (11, 'Ink Cartridges'), (12, 'Internal Hard Disk Drives'), (13, 'Keyboards & Keypads'), (14, 'Lenses'), (15, 'Media Streamers'), (16, 'Mens Shavers'), (17, 'Mice, Trackballs & Touchpads'), (18, 'Monitors'), (19, 'Motherboards'), (20, 'Other Automotive Hand Tools'), (21, 'PC Laptops & Netbooks'), (22, 'Power Tool Sets'), (23, 'Prepaid Gaming Cards'), (24, 'Receivers'), (25, 'Reciprocating Saws'), (26, 'Smart Speakers'), (27, 'Smart Watches'), (28, 'Tablets and eBook Readers'), (29, 'Video Game Consoles'), (30, 'Video Games'), (31, 'Wireless Routers');\nSET IDENTITY_INSERT Products OFF;\n"})}),"\n",(0,i.jsx)(t.p,{children:"After executing this query, we have about 30 products in our database ready to use in our application."}),"\n",(0,i.jsx)(t.h3,{id:"creating-views",children:"Creating Views"}),"\n",(0,i.jsxs)(t.p,{children:["With the data configured, let\u2019s create a basic ",(0,i.jsx)(t.a,{href:"https://learn.microsoft.com/en-us/aspnet/mvc/overview/older-versions-1/controllers-and-routing/aspnet-mvc-controllers-overview-cs",children:"MVC Controller"})," with views. Right-click on the ",(0,i.jsx)(t.code,{children:"Controllers"})," folder and select ",(0,i.jsx)(t.strong,{children:"Add New Scaffold Item"}),". Choose the ",(0,i.jsx)(t.strong,{children:"MVC Controller with views, using the Entity Framework"}),", and click ",(0,i.jsx)(t.strong,{children:"Add"}),". Select the ",(0,i.jsx)(t.code,{children:"Model"})," class as ",(0,i.jsx)(t.code,{children:"Product"}),", give the controller a name, and click Add. Repeat this process with the ",(0,i.jsx)(t.code,{children:"Reviews Model"}),"."]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"image of MVC Controller set up",src:n(29264).Z+"",width:"624",height:"424"})}),"\n",(0,i.jsx)(t.p,{children:"Now, run your application both locally and after publishing it to the Azure Container application to ensure everything is functioning correctly."}),"\n",(0,i.jsxs)(t.p,{children:["When you run your application locally, your web browser will open with the base URL. Add ",(0,i.jsx)(t.code,{children:"/Products"})," to the end of the URL to see a list of the manually entered pre-populated data."]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"image of page open in web browser",src:n(6430).Z+"",width:"624",height:"464"})}),"\n",(0,i.jsxs)(t.p,{children:["With the framework established, you can replace ",(0,i.jsx)(t.code,{children:"/Products"})," at the end of the URL with ",(0,i.jsx)(t.code,{children:"/Reviews"})," to look at any reviews you have. Alternatively, you can use ",(0,i.jsx)(t.code,{children:"/Reviews/Create"})," to create new reviews. However, currently, a review doesn\u2019t align with the model we\u2019ve provided, as we expect our product list to populate the ",(0,i.jsx)(t.code,{children:"Products"})," field. To fix this, we\u2019ll need to adjust the reviews view to better align with our requirements."]}),"\n",(0,i.jsxs)(t.p,{children:["In the ",(0,i.jsx)(t.code,{children:"ReviewsController"})," file, change the ",(0,i.jsx)(t.code,{children:"GET Create Action"})," as follows:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"public async Task<IActionResult> Create()\n{\n  var products = await _context.Products.ToListAsync<Product>();\n  List<SelectListItem> productSelections = new List<SelectListItem>();\n \n  foreach (var product in products)\n  {\n    productSelections.Add(new SelectListItem { Text = product.Name, Value = product.Id.ToString() });\n  }\n \n  ViewBag.Products = productSelections;\n \n  return View();\n}\n"})}),"\n",(0,i.jsxs)(t.p,{children:["This code fetches products from the database and places them into a select list or drop-down on the ",(0,i.jsx)(t.code,{children:"Review"})," creation page. We\u2019re focusing on having users select a single product and write a review, ensuring the sentiment analysis we perform later aligns with each product. So, let\u2019s also modify the ",(0,i.jsx)(t.code,{children:"Create"})," page within the ",(0,i.jsx)(t.code,{children:"Views/Reviews"})," directory:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:'@model UserFeedbackApp.Models.Review\n \n@{\n    ViewData["Title"] = "Create";\n}\n \n<h1>Create</h1>\n \n<h4>Review</h4>\n<hr />\n<div class="row">\n    <div class="col-md-4">\n        <form asp-action="Create">\n            <div asp-validation-summary="ModelOnly" class="text-danger"></div>\n            <div class="form-group">\n                @Html.DropDownList("Products", (IEnumerable\n                <SelectListItem>)ViewBag.Products)\n            </div>\n            <div class="form-group">\n                <label asp-for="ReviewText" class="control-label"></label>\n                <textarea rows="6" asp-for="ReviewText" class="form-control"></textarea>\n                <span asp-validation-for="ReviewText" class="text-danger"></span>\n            </div>\n            <br />\n            <div class="form-group">\n                <input type="submit" value="Create" class="btn btn-primary" />\n            </div>\n        </form>\n    </div>\n</div>\n \n<div>\n    <a asp-action="Index">Back to List</a>\n</div>\n \n@section Scripts {\n    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}\n}\n'})}),"\n",(0,i.jsx)(t.p,{children:"This confines the page to a product drop-down list and an area for entering a review."}),"\n",(0,i.jsxs)(t.p,{children:["Finally, let\u2019s adjust the ",(0,i.jsx)(t.code,{children:"POST Create Action"})," in the ",(0,i.jsx)(t.code,{children:"Reviews"})," controller to handle the two received values. Add placeholder values for elements we\u2019re currently generating:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:'[HttpPost]\n[ValidateAntiForgeryToken]\npublic async Task<IActionResult> Create([Bind("Id,ProductId,ProductName,ReviewText,PostDate,Sentiment,PositiveValue,NeutralValue,NegativeValue")] Review review)\n{\n  var selectedProductId = int.Parse(HttpContext.Request.Form["Products"].ToString());\n  var product = await _context.Products.FirstOrDefaultAsync(p => p.Id == selectedProductId);\n                   \n  review.ProductId = selectedProductId;\n  review.ProductName = product.Name;\n  review.PostDate = DateTime.Now.ToString("yyyy-MM-dd");\n  review.Sentiment = "";\n  review.PositiveValue = 0;\n  review.NeutralValue = 0;\n  review.NegativeValue = 0;\n\n  _context.Add(review);\n  await _context.SaveChangesAsync();\n  return RedirectToAction(nameof(Index));\n}\n'})}),"\n",(0,i.jsxs)(t.p,{children:["Now, run the application and go to the ",(0,i.jsx)(t.code,{children:"/Reviews/Create"})," endpoint. You\u2019ll see your newly written page. If you select a product and fill out a review, the database will save the review sans any sentiment information."]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"image of the application Index",src:n(39737).Z+"",width:"624",height:"220"})}),"\n",(0,i.jsx)(t.p,{children:"Finally, publish your changes to your Azure instance."}),"\n",(0,i.jsx)(t.h2,{id:"exercise",children:"Exercise"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["Complete this ",(0,i.jsx)(t.strong,{children:"hands-on sample"})," ",(0,i.jsx)(t.a,{href:"https://github.com/contentlab-io/Microsoft-Building-Your-First-Intelligent-App-with-Azure-Cognitive-Services/tree/main/Microsoft_Series_2_Code/Source%20-%20Article%207%20%2B%208/UserFeedbackApp/Models",children:"project code"})," to build your intelligent app with multi-modal databases."]}),"\n",(0,i.jsxs)(t.li,{children:["Complete the ",(0,i.jsx)(t.strong,{children:(0,i.jsx)(t.a,{href:"https://aka.ms/fallforIA/apps-csc",children:"Intelligent apps Cloud Skills Challenge"})})," to build on your app dev and AI skills."]}),"\n",(0,i.jsxs)(t.li,{children:["Register for ",(0,i.jsx)(t.strong,{children:(0,i.jsx)(t.a,{href:"https://reactor.microsoft.com/en-us/reactor/events/20728/?WT.mc_id=javascript-99907-ninarasi",children:"Ask the Expert: Azure Container Apps"})})," session for live Q&A with the Product Engineering team on building intelligent apps using Azure Container Apps."]}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,i.jsxs)(t.p,{children:["Continue to the next part of this ",(0,i.jsx)(t.a,{href:"https://azure.github.io/Cloud-Native/30daysofIA/deploy-an-intelligent-app-on-azure-container-apps-2",children:"topic"})," to further explore building, containerizing, deploying and analysing your intelligent app."]})]})}function p(e={}){const{wrapper:t}={...(0,a.a)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},38447:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/blog-image-4-1-1-38a4ded7b3c84eedd9f6a81813ef33dd.png"},47219:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/blog-image-4-1-10-bbbe6cfbd1242341b5074640f7afc0b4.png"},35957:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/blog-image-4-1-11-db2b18fa11114c1f1b24434bed1ebb46.png"},39768:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/blog-image-4-1-12-55f7312f395c80528b30370e95ef7a88.png"},39769:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/blog-image-4-1-13-7d77376088682d3e35280df038d48041.png"},9872:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/blog-image-4-1-14-e1591825ce7282d25dc9798462da2d37.png"},29264:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/blog-image-4-1-15-430e1db67417a4b089d7687d433f5d78.png"},6430:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/blog-image-4-1-16-c6d21af437ac86b902c4021303e309c1.png"},39737:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/blog-image-4-1-17-70b0fd4004e15e91823c7314bda9938b.png"},54052:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/blog-image-4-1-2-bb3a33c4b6cc8ef8baaf56e98121c783.png"},87504:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/blog-image-4-1-3-b87ee85577acad781e7630147ac8b2d2.png"},60504:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/blog-image-4-1-4-05e2c9b919a127e6046ebdd0e94f58a3.png"},44195:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/blog-image-4-1-5-2e65e0b9ebc90e7f97999eddca9de48e.png"},91255:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/blog-image-4-1-6-ae0fee5353e73fc015fa522f23dc6330.png"},35886:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/blog-image-4-1-7-ab5bf52b4573562654008288038c5311.png"},11140:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/blog-image-4-1-8-1484ead9e321c5b61964707e582add45.png"},44166:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/blog-image-4-1-9-f0ec2044b9f38d14110c4b8aeb733e81.png"},11151:(e,t,n)=>{n.d(t,{Z:()=>o,a:()=>r});var i=n(67294);const a={},s=i.createContext(a);function r(e){const t=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),i.createElement(s.Provider,{value:t},e.children)}}}]);